(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function UT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var tv={exports:{}},Ju={},nv={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var La=Symbol.for("react.element"),zT=Symbol.for("react.portal"),$T=Symbol.for("react.fragment"),qT=Symbol.for("react.strict_mode"),KT=Symbol.for("react.profiler"),GT=Symbol.for("react.provider"),WT=Symbol.for("react.context"),QT=Symbol.for("react.forward_ref"),HT=Symbol.for("react.suspense"),YT=Symbol.for("react.memo"),XT=Symbol.for("react.lazy"),vg=Symbol.iterator;function JT(n){return n===null||typeof n!="object"?null:(n=vg&&n[vg]||n["@@iterator"],typeof n=="function"?n:null)}var rv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sv=Object.assign,iv={};function Ki(n,e,t){this.props=n,this.context=e,this.refs=iv,this.updater=t||rv}Ki.prototype.isReactComponent={};Ki.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Ki.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function ov(){}ov.prototype=Ki.prototype;function gf(n,e,t){this.props=n,this.context=e,this.refs=iv,this.updater=t||rv}var yf=gf.prototype=new ov;yf.constructor=gf;sv(yf,Ki.prototype);yf.isPureReactComponent=!0;var wg=Array.isArray,av=Object.prototype.hasOwnProperty,_f={current:null},lv={key:!0,ref:!0,__self:!0,__source:!0};function uv(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)av.call(e,r)&&!lv.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];s.children=u}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:La,type:n,key:i,ref:o,props:s,_owner:_f.current}}function ZT(n,e){return{$$typeof:La,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function vf(n){return typeof n=="object"&&n!==null&&n.$$typeof===La}function ex(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Eg=/\/+/g;function oh(n,e){return typeof n=="object"&&n!==null&&n.key!=null?ex(""+n.key):e.toString(36)}function $l(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case La:case zT:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+oh(o,0):r,wg(s)?(t="",n!=null&&(t=n.replace(Eg,"$&/")+"/"),$l(s,e,t,"",function(c){return c})):s!=null&&(vf(s)&&(s=ZT(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Eg,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",wg(n))for(var a=0;a<n.length;a++){i=n[a];var u=r+oh(i,a);o+=$l(i,e,t,u,s)}else if(u=JT(n),typeof u=="function")for(n=u.call(n),a=0;!(i=n.next()).done;)i=i.value,u=r+oh(i,a++),o+=$l(i,e,t,u,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _l(n,e,t){if(n==null)return n;var r=[],s=0;return $l(n,r,"","",function(i){return e.call(t,i,s++)}),r}function tx(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var kt={current:null},ql={transition:null},nx={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:ql,ReactCurrentOwner:_f};function cv(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:_l,forEach:function(n,e,t){_l(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return _l(n,function(){e++}),e},toArray:function(n){return _l(n,function(e){return e})||[]},only:function(n){if(!vf(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ie.Component=Ki;ie.Fragment=$T;ie.Profiler=KT;ie.PureComponent=gf;ie.StrictMode=qT;ie.Suspense=HT;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nx;ie.act=cv;ie.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=sv({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=_f.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(u in e)av.call(e,u)&&!lv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:La,type:n.type,key:s,ref:i,props:r,_owner:o}};ie.createContext=function(n){return n={$$typeof:WT,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:GT,_context:n},n.Consumer=n};ie.createElement=uv;ie.createFactory=function(n){var e=uv.bind(null,n);return e.type=n,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(n){return{$$typeof:QT,render:n}};ie.isValidElement=vf;ie.lazy=function(n){return{$$typeof:XT,_payload:{_status:-1,_result:n},_init:tx}};ie.memo=function(n,e){return{$$typeof:YT,type:n,compare:e===void 0?null:e}};ie.startTransition=function(n){var e=ql.transition;ql.transition={};try{n()}finally{ql.transition=e}};ie.unstable_act=cv;ie.useCallback=function(n,e){return kt.current.useCallback(n,e)};ie.useContext=function(n){return kt.current.useContext(n)};ie.useDebugValue=function(){};ie.useDeferredValue=function(n){return kt.current.useDeferredValue(n)};ie.useEffect=function(n,e){return kt.current.useEffect(n,e)};ie.useId=function(){return kt.current.useId()};ie.useImperativeHandle=function(n,e,t){return kt.current.useImperativeHandle(n,e,t)};ie.useInsertionEffect=function(n,e){return kt.current.useInsertionEffect(n,e)};ie.useLayoutEffect=function(n,e){return kt.current.useLayoutEffect(n,e)};ie.useMemo=function(n,e){return kt.current.useMemo(n,e)};ie.useReducer=function(n,e,t){return kt.current.useReducer(n,e,t)};ie.useRef=function(n){return kt.current.useRef(n)};ie.useState=function(n){return kt.current.useState(n)};ie.useSyncExternalStore=function(n,e,t){return kt.current.useSyncExternalStore(n,e,t)};ie.useTransition=function(){return kt.current.useTransition()};ie.version="18.3.1";nv.exports=ie;var X=nv.exports;const rx=UT(X);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sx=X,ix=Symbol.for("react.element"),ox=Symbol.for("react.fragment"),ax=Object.prototype.hasOwnProperty,lx=sx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ux={key:!0,ref:!0,__self:!0,__source:!0};function hv(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ax.call(e,r)&&!ux.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ix,type:n,key:i,ref:o,props:s,_owner:lx.current}}Ju.Fragment=ox;Ju.jsx=hv;Ju.jsxs=hv;tv.exports=Ju;var C=tv.exports,$h={},dv={exports:{}},Qt={},fv={exports:{}},pv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(q,Z){var ee=q.length;q.push(Z);e:for(;0<ee;){var ye=ee-1>>>1,ue=q[ye];if(0<s(ue,Z))q[ye]=Z,q[ee]=ue,ee=ye;else break e}}function t(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var Z=q[0],ee=q.pop();if(ee!==Z){q[0]=ee;e:for(var ye=0,ue=q.length,he=ue>>>1;ye<he;){var $e=2*(ye+1)-1,it=q[$e],H=$e+1,ne=q[H];if(0>s(it,ee))H<ue&&0>s(ne,it)?(q[ye]=ne,q[H]=ee,ye=H):(q[ye]=it,q[$e]=ee,ye=$e);else if(H<ue&&0>s(ne,ee))q[ye]=ne,q[H]=ee,ye=H;else break e}}return Z}function s(q,Z){var ee=q.sortIndex-Z.sortIndex;return ee!==0?ee:q.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],c=[],d=1,f=null,m=3,_=!1,R=!1,b=!1,N=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(q){for(var Z=t(c);Z!==null;){if(Z.callback===null)r(c);else if(Z.startTime<=q)r(c),Z.sortIndex=Z.expirationTime,e(u,Z);else break;Z=t(c)}}function D(q){if(b=!1,A(q),!R)if(t(u)!==null)R=!0,Yt(B);else{var Z=t(c);Z!==null&&Ae(D,Z.startTime-q)}}function B(q,Z){R=!1,b&&(b=!1,x(g),g=-1),_=!0;var ee=m;try{for(A(Z),f=t(u);f!==null&&(!(f.expirationTime>Z)||q&&!S());){var ye=f.callback;if(typeof ye=="function"){f.callback=null,m=f.priorityLevel;var ue=ye(f.expirationTime<=Z);Z=n.unstable_now(),typeof ue=="function"?f.callback=ue:f===t(u)&&r(u),A(Z)}else r(u);f=t(u)}if(f!==null)var he=!0;else{var $e=t(c);$e!==null&&Ae(D,$e.startTime-Z),he=!1}return he}finally{f=null,m=ee,_=!1}}var L=!1,w=null,g=-1,v=5,I=-1;function S(){return!(n.unstable_now()-I<v)}function P(){if(w!==null){var q=n.unstable_now();I=q;var Z=!0;try{Z=w(!0,q)}finally{Z?T():(L=!1,w=null)}}else L=!1}var T;if(typeof E=="function")T=function(){E(P)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,et=ge.port2;ge.port1.onmessage=P,T=function(){et.postMessage(null)}}else T=function(){N(P,0)};function Yt(q){w=q,L||(L=!0,T())}function Ae(q,Z){g=N(function(){q(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){R||_||(R=!0,Yt(B))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var ee=m;m=Z;try{return q()}finally{m=ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,Z){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ee=m;m=q;try{return Z()}finally{m=ee}},n.unstable_scheduleCallback=function(q,Z,ee){var ye=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ye+ee:ye):ee=ye,q){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=ee+ue,q={id:d++,callback:Z,priorityLevel:q,startTime:ee,expirationTime:ue,sortIndex:-1},ee>ye?(q.sortIndex=ee,e(c,q),t(u)===null&&q===t(c)&&(b?(x(g),g=-1):b=!0,Ae(D,ee-ye))):(q.sortIndex=ue,e(u,q),R||_||(R=!0,Yt(B))),q},n.unstable_shouldYield=S,n.unstable_wrapCallback=function(q){var Z=m;return function(){var ee=m;m=Z;try{return q.apply(this,arguments)}finally{m=ee}}}})(pv);fv.exports=pv;var cx=fv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hx=X,Gt=cx;function U(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mv=new Set,ta={};function Vs(n,e){Ei(n,e),Ei(n+"Capture",e)}function Ei(n,e){for(ta[n]=e,n=0;n<e.length;n++)mv.add(e[n])}var jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qh=Object.prototype.hasOwnProperty,dx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ig={},Tg={};function fx(n){return qh.call(Tg,n)?!0:qh.call(Ig,n)?!1:dx.test(n)?Tg[n]=!0:(Ig[n]=!0,!1)}function px(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function mx(n,e,t,r){if(e===null||typeof e>"u"||px(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vt(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){dt[n]=new Vt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];dt[e]=new Vt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){dt[n]=new Vt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){dt[n]=new Vt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){dt[n]=new Vt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){dt[n]=new Vt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){dt[n]=new Vt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){dt[n]=new Vt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){dt[n]=new Vt(n,5,!1,n.toLowerCase(),null,!1,!1)});var wf=/[\-:]([a-z])/g;function Ef(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(wf,Ef);dt[e]=new Vt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(wf,Ef);dt[e]=new Vt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(wf,Ef);dt[e]=new Vt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){dt[n]=new Vt(n,1,!1,n.toLowerCase(),null,!1,!1)});dt.xlinkHref=new Vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){dt[n]=new Vt(n,1,!1,n.toLowerCase(),null,!0,!0)});function If(n,e,t,r){var s=dt.hasOwnProperty(e)?dt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mx(e,t,s,r)&&(t=null),r||s===null?fx(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Qn=hx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vl=Symbol.for("react.element"),ti=Symbol.for("react.portal"),ni=Symbol.for("react.fragment"),Tf=Symbol.for("react.strict_mode"),Kh=Symbol.for("react.profiler"),gv=Symbol.for("react.provider"),yv=Symbol.for("react.context"),xf=Symbol.for("react.forward_ref"),Gh=Symbol.for("react.suspense"),Wh=Symbol.for("react.suspense_list"),Af=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),_v=Symbol.for("react.offscreen"),xg=Symbol.iterator;function _o(n){return n===null||typeof n!="object"?null:(n=xg&&n[xg]||n["@@iterator"],typeof n=="function"?n:null)}var Fe=Object.assign,ah;function ko(n){if(ah===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);ah=e&&e[1]||""}return`
`+ah+n}var lh=!1;function uh(n,e){if(!n||lh)return"";lh=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=o&&0<=a);break}}}finally{lh=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?ko(n):""}function gx(n){switch(n.tag){case 5:return ko(n.type);case 16:return ko("Lazy");case 13:return ko("Suspense");case 19:return ko("SuspenseList");case 0:case 2:case 15:return n=uh(n.type,!1),n;case 11:return n=uh(n.type.render,!1),n;case 1:return n=uh(n.type,!0),n;default:return""}}function Qh(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ni:return"Fragment";case ti:return"Portal";case Kh:return"Profiler";case Tf:return"StrictMode";case Gh:return"Suspense";case Wh:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case yv:return(n.displayName||"Context")+".Consumer";case gv:return(n._context.displayName||"Context")+".Provider";case xf:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Af:return e=n.displayName||null,e!==null?e:Qh(n.type)||"Memo";case or:e=n._payload,n=n._init;try{return Qh(n(e))}catch{}}return null}function yx(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qh(e);case 8:return e===Tf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function vv(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _x(n){var e=vv(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function wl(n){n._valueTracker||(n._valueTracker=_x(n))}function wv(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=vv(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function cu(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Hh(n,e){var t=e.checked;return Fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Ag(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Rr(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ev(n,e){e=e.checked,e!=null&&If(n,"checked",e,!1)}function Yh(n,e){Ev(n,e);var t=Rr(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Xh(n,e.type,t):e.hasOwnProperty("defaultValue")&&Xh(n,e.type,Rr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Sg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Xh(n,e,t){(e!=="number"||cu(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Vo=Array.isArray;function fi(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Rr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Jh(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Fe({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Rg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(U(92));if(Vo(t)){if(1<t.length)throw Error(U(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Rr(t)}}function Iv(n,e){var t=Rr(e.value),r=Rr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Pg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Tv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zh(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Tv(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var El,xv=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(El=El||document.createElement("div"),El.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=El.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function na(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vx=["Webkit","ms","Moz","O"];Object.keys(Bo).forEach(function(n){vx.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Bo[e]=Bo[n]})});function Av(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Bo.hasOwnProperty(n)&&Bo[n]?(""+e).trim():e+"px"}function Sv(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=Av(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var wx=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ed(n,e){if(e){if(wx[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function td(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nd=null;function Sf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var rd=null,pi=null,mi=null;function Cg(n){if(n=ja(n)){if(typeof rd!="function")throw Error(U(280));var e=n.stateNode;e&&(e=rc(e),rd(n.stateNode,n.type,e))}}function Rv(n){pi?mi?mi.push(n):mi=[n]:pi=n}function Pv(){if(pi){var n=pi,e=mi;if(mi=pi=null,Cg(n),e)for(n=0;n<e.length;n++)Cg(e[n])}}function Cv(n,e){return n(e)}function bv(){}var ch=!1;function kv(n,e,t){if(ch)return n(e,t);ch=!0;try{return Cv(n,e,t)}finally{ch=!1,(pi!==null||mi!==null)&&(bv(),Pv())}}function ra(n,e){var t=n.stateNode;if(t===null)return null;var r=rc(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(U(231,e,typeof t));return t}var sd=!1;if(jn)try{var vo={};Object.defineProperty(vo,"passive",{get:function(){sd=!0}}),window.addEventListener("test",vo,vo),window.removeEventListener("test",vo,vo)}catch{sd=!1}function Ex(n,e,t,r,s,i,o,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(d){this.onError(d)}}var jo=!1,hu=null,du=!1,id=null,Ix={onError:function(n){jo=!0,hu=n}};function Tx(n,e,t,r,s,i,o,a,u){jo=!1,hu=null,Ex.apply(Ix,arguments)}function xx(n,e,t,r,s,i,o,a,u){if(Tx.apply(this,arguments),jo){if(jo){var c=hu;jo=!1,hu=null}else throw Error(U(198));du||(du=!0,id=c)}}function Ns(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Vv(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function bg(n){if(Ns(n)!==n)throw Error(U(188))}function Ax(n){var e=n.alternate;if(!e){if(e=Ns(n),e===null)throw Error(U(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return bg(s),n;if(i===r)return bg(s),e;i=i.sibling}throw Error(U(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(U(189))}}if(t.alternate!==r)throw Error(U(190))}if(t.tag!==3)throw Error(U(188));return t.stateNode.current===t?n:e}function Nv(n){return n=Ax(n),n!==null?Dv(n):null}function Dv(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Dv(n);if(e!==null)return e;n=n.sibling}return null}var Ov=Gt.unstable_scheduleCallback,kg=Gt.unstable_cancelCallback,Sx=Gt.unstable_shouldYield,Rx=Gt.unstable_requestPaint,qe=Gt.unstable_now,Px=Gt.unstable_getCurrentPriorityLevel,Rf=Gt.unstable_ImmediatePriority,Mv=Gt.unstable_UserBlockingPriority,fu=Gt.unstable_NormalPriority,Cx=Gt.unstable_LowPriority,Lv=Gt.unstable_IdlePriority,Zu=null,En=null;function bx(n){if(En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(Zu,n,void 0,(n.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:Nx,kx=Math.log,Vx=Math.LN2;function Nx(n){return n>>>=0,n===0?32:31-(kx(n)/Vx|0)|0}var Il=64,Tl=4194304;function No(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function pu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=No(a):(i&=o,i!==0&&(r=No(i)))}else o=t&~s,o!==0?r=No(o):i!==0&&(r=No(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-dn(e),s=1<<t,r|=n[t],e&=~s;return r}function Dx(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ox(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-dn(i),a=1<<o,u=s[o];u===-1?(!(a&t)||a&r)&&(s[o]=Dx(a,e)):u<=e&&(n.expiredLanes|=a),i&=~a}}function od(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Fv(){var n=Il;return Il<<=1,!(Il&4194240)&&(Il=64),n}function hh(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Fa(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-dn(e),n[e]=t}function Mx(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-dn(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function Pf(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-dn(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var ve=0;function Bv(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var jv,Cf,Uv,zv,$v,ad=!1,xl=[],yr=null,_r=null,vr=null,sa=new Map,ia=new Map,lr=[],Lx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vg(n,e){switch(n){case"focusin":case"focusout":yr=null;break;case"dragenter":case"dragleave":_r=null;break;case"mouseover":case"mouseout":vr=null;break;case"pointerover":case"pointerout":sa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ia.delete(e.pointerId)}}function wo(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ja(e),e!==null&&Cf(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function Fx(n,e,t,r,s){switch(e){case"focusin":return yr=wo(yr,n,e,t,r,s),!0;case"dragenter":return _r=wo(_r,n,e,t,r,s),!0;case"mouseover":return vr=wo(vr,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return sa.set(i,wo(sa.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ia.set(i,wo(ia.get(i)||null,n,e,t,r,s)),!0}return!1}function qv(n){var e=ls(n.target);if(e!==null){var t=Ns(e);if(t!==null){if(e=t.tag,e===13){if(e=Vv(t),e!==null){n.blockedOn=e,$v(n.priority,function(){Uv(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Kl(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=ld(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);nd=r,t.target.dispatchEvent(r),nd=null}else return e=ja(t),e!==null&&Cf(e),n.blockedOn=t,!1;e.shift()}return!0}function Ng(n,e,t){Kl(n)&&t.delete(e)}function Bx(){ad=!1,yr!==null&&Kl(yr)&&(yr=null),_r!==null&&Kl(_r)&&(_r=null),vr!==null&&Kl(vr)&&(vr=null),sa.forEach(Ng),ia.forEach(Ng)}function Eo(n,e){n.blockedOn===e&&(n.blockedOn=null,ad||(ad=!0,Gt.unstable_scheduleCallback(Gt.unstable_NormalPriority,Bx)))}function oa(n){function e(s){return Eo(s,n)}if(0<xl.length){Eo(xl[0],n);for(var t=1;t<xl.length;t++){var r=xl[t];r.blockedOn===n&&(r.blockedOn=null)}}for(yr!==null&&Eo(yr,n),_r!==null&&Eo(_r,n),vr!==null&&Eo(vr,n),sa.forEach(e),ia.forEach(e),t=0;t<lr.length;t++)r=lr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<lr.length&&(t=lr[0],t.blockedOn===null);)qv(t),t.blockedOn===null&&lr.shift()}var gi=Qn.ReactCurrentBatchConfig,mu=!0;function jx(n,e,t,r){var s=ve,i=gi.transition;gi.transition=null;try{ve=1,bf(n,e,t,r)}finally{ve=s,gi.transition=i}}function Ux(n,e,t,r){var s=ve,i=gi.transition;gi.transition=null;try{ve=4,bf(n,e,t,r)}finally{ve=s,gi.transition=i}}function bf(n,e,t,r){if(mu){var s=ld(n,e,t,r);if(s===null)Eh(n,e,r,gu,t),Vg(n,r);else if(Fx(s,n,e,t,r))r.stopPropagation();else if(Vg(n,r),e&4&&-1<Lx.indexOf(n)){for(;s!==null;){var i=ja(s);if(i!==null&&jv(i),i=ld(n,e,t,r),i===null&&Eh(n,e,r,gu,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else Eh(n,e,r,null,t)}}var gu=null;function ld(n,e,t,r){if(gu=null,n=Sf(r),n=ls(n),n!==null)if(e=Ns(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Vv(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return gu=n,null}function Kv(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Px()){case Rf:return 1;case Mv:return 4;case fu:case Cx:return 16;case Lv:return 536870912;default:return 16}default:return 16}}var fr=null,kf=null,Gl=null;function Gv(){if(Gl)return Gl;var n,e=kf,t=e.length,r,s="value"in fr?fr.value:fr.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Gl=s.slice(n,1<r?1-r:void 0)}function Wl(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Al(){return!0}function Dg(){return!1}function Ht(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Al:Dg,this.isPropagationStopped=Dg,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Al)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Al)},persist:function(){},isPersistent:Al}),e}var Gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vf=Ht(Gi),Ba=Fe({},Gi,{view:0,detail:0}),zx=Ht(Ba),dh,fh,Io,ec=Fe({},Ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Io&&(Io&&n.type==="mousemove"?(dh=n.screenX-Io.screenX,fh=n.screenY-Io.screenY):fh=dh=0,Io=n),dh)},movementY:function(n){return"movementY"in n?n.movementY:fh}}),Og=Ht(ec),$x=Fe({},ec,{dataTransfer:0}),qx=Ht($x),Kx=Fe({},Ba,{relatedTarget:0}),ph=Ht(Kx),Gx=Fe({},Gi,{animationName:0,elapsedTime:0,pseudoElement:0}),Wx=Ht(Gx),Qx=Fe({},Gi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Hx=Ht(Qx),Yx=Fe({},Gi,{data:0}),Mg=Ht(Yx),Xx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eA(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Zx[n])?!!e[n]:!1}function Nf(){return eA}var tA=Fe({},Ba,{key:function(n){if(n.key){var e=Xx[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Wl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Jx[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nf,charCode:function(n){return n.type==="keypress"?Wl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Wl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),nA=Ht(tA),rA=Fe({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lg=Ht(rA),sA=Fe({},Ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nf}),iA=Ht(sA),oA=Fe({},Gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),aA=Ht(oA),lA=Fe({},ec,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),uA=Ht(lA),cA=[9,13,27,32],Df=jn&&"CompositionEvent"in window,Uo=null;jn&&"documentMode"in document&&(Uo=document.documentMode);var hA=jn&&"TextEvent"in window&&!Uo,Wv=jn&&(!Df||Uo&&8<Uo&&11>=Uo),Fg=" ",Bg=!1;function Qv(n,e){switch(n){case"keyup":return cA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hv(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ri=!1;function dA(n,e){switch(n){case"compositionend":return Hv(e);case"keypress":return e.which!==32?null:(Bg=!0,Fg);case"textInput":return n=e.data,n===Fg&&Bg?null:n;default:return null}}function fA(n,e){if(ri)return n==="compositionend"||!Df&&Qv(n,e)?(n=Gv(),Gl=kf=fr=null,ri=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wv&&e.locale!=="ko"?null:e.data;default:return null}}var pA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jg(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!pA[n.type]:e==="textarea"}function Yv(n,e,t,r){Rv(r),e=yu(e,"onChange"),0<e.length&&(t=new Vf("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var zo=null,aa=null;function mA(n){aw(n,0)}function tc(n){var e=oi(n);if(wv(e))return n}function gA(n,e){if(n==="change")return e}var Xv=!1;if(jn){var mh;if(jn){var gh="oninput"in document;if(!gh){var Ug=document.createElement("div");Ug.setAttribute("oninput","return;"),gh=typeof Ug.oninput=="function"}mh=gh}else mh=!1;Xv=mh&&(!document.documentMode||9<document.documentMode)}function zg(){zo&&(zo.detachEvent("onpropertychange",Jv),aa=zo=null)}function Jv(n){if(n.propertyName==="value"&&tc(aa)){var e=[];Yv(e,aa,n,Sf(n)),kv(mA,e)}}function yA(n,e,t){n==="focusin"?(zg(),zo=e,aa=t,zo.attachEvent("onpropertychange",Jv)):n==="focusout"&&zg()}function _A(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tc(aa)}function vA(n,e){if(n==="click")return tc(e)}function wA(n,e){if(n==="input"||n==="change")return tc(e)}function EA(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var pn=typeof Object.is=="function"?Object.is:EA;function la(n,e){if(pn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!qh.call(e,s)||!pn(n[s],e[s]))return!1}return!0}function $g(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function qg(n,e){var t=$g(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=$g(t)}}function Zv(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Zv(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function ew(){for(var n=window,e=cu();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=cu(n.document)}return e}function Of(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function IA(n){var e=ew(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Zv(t.ownerDocument.documentElement,t)){if(r!==null&&Of(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=qg(t,i);var o=qg(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var TA=jn&&"documentMode"in document&&11>=document.documentMode,si=null,ud=null,$o=null,cd=!1;function Kg(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;cd||si==null||si!==cu(r)||(r=si,"selectionStart"in r&&Of(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$o&&la($o,r)||($o=r,r=yu(ud,"onSelect"),0<r.length&&(e=new Vf("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=si)))}function Sl(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ii={animationend:Sl("Animation","AnimationEnd"),animationiteration:Sl("Animation","AnimationIteration"),animationstart:Sl("Animation","AnimationStart"),transitionend:Sl("Transition","TransitionEnd")},yh={},tw={};jn&&(tw=document.createElement("div").style,"AnimationEvent"in window||(delete ii.animationend.animation,delete ii.animationiteration.animation,delete ii.animationstart.animation),"TransitionEvent"in window||delete ii.transitionend.transition);function nc(n){if(yh[n])return yh[n];if(!ii[n])return n;var e=ii[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in tw)return yh[n]=e[t];return n}var nw=nc("animationend"),rw=nc("animationiteration"),sw=nc("animationstart"),iw=nc("transitionend"),ow=new Map,Gg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(n,e){ow.set(n,e),Vs(e,[n])}for(var _h=0;_h<Gg.length;_h++){var vh=Gg[_h],xA=vh.toLowerCase(),AA=vh[0].toUpperCase()+vh.slice(1);jr(xA,"on"+AA)}jr(nw,"onAnimationEnd");jr(rw,"onAnimationIteration");jr(sw,"onAnimationStart");jr("dblclick","onDoubleClick");jr("focusin","onFocus");jr("focusout","onBlur");jr(iw,"onTransitionEnd");Ei("onMouseEnter",["mouseout","mouseover"]);Ei("onMouseLeave",["mouseout","mouseover"]);Ei("onPointerEnter",["pointerout","pointerover"]);Ei("onPointerLeave",["pointerout","pointerover"]);Vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Do="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Do));function Wg(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,xx(r,e,void 0,n),n.currentTarget=null}function aw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;Wg(s,a,c),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,c=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;Wg(s,a,c),i=u}}}if(du)throw n=id,du=!1,id=null,n}function Re(n,e){var t=e[md];t===void 0&&(t=e[md]=new Set);var r=n+"__bubble";t.has(r)||(lw(e,n,2,!1),t.add(r))}function wh(n,e,t){var r=0;e&&(r|=4),lw(t,n,r,e)}var Rl="_reactListening"+Math.random().toString(36).slice(2);function ua(n){if(!n[Rl]){n[Rl]=!0,mv.forEach(function(t){t!=="selectionchange"&&(SA.has(t)||wh(t,!1,n),wh(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Rl]||(e[Rl]=!0,wh("selectionchange",!1,e))}}function lw(n,e,t,r){switch(Kv(e)){case 1:var s=jx;break;case 4:s=Ux;break;default:s=bf}t=s.bind(null,e,t,n),s=void 0,!sd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Eh(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ls(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}kv(function(){var c=i,d=Sf(t),f=[];e:{var m=ow.get(n);if(m!==void 0){var _=Vf,R=n;switch(n){case"keypress":if(Wl(t)===0)break e;case"keydown":case"keyup":_=nA;break;case"focusin":R="focus",_=ph;break;case"focusout":R="blur",_=ph;break;case"beforeblur":case"afterblur":_=ph;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=Og;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=qx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=iA;break;case nw:case rw:case sw:_=Wx;break;case iw:_=aA;break;case"scroll":_=zx;break;case"wheel":_=uA;break;case"copy":case"cut":case"paste":_=Hx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Lg}var b=(e&4)!==0,N=!b&&n==="scroll",x=b?m!==null?m+"Capture":null:m;b=[];for(var E=c,A;E!==null;){A=E;var D=A.stateNode;if(A.tag===5&&D!==null&&(A=D,x!==null&&(D=ra(E,x),D!=null&&b.push(ca(E,D,A)))),N)break;E=E.return}0<b.length&&(m=new _(m,R,null,t,d),f.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",m&&t!==nd&&(R=t.relatedTarget||t.fromElement)&&(ls(R)||R[Un]))break e;if((_||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,_?(R=t.relatedTarget||t.toElement,_=c,R=R?ls(R):null,R!==null&&(N=Ns(R),R!==N||R.tag!==5&&R.tag!==6)&&(R=null)):(_=null,R=c),_!==R)){if(b=Og,D="onMouseLeave",x="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(b=Lg,D="onPointerLeave",x="onPointerEnter",E="pointer"),N=_==null?m:oi(_),A=R==null?m:oi(R),m=new b(D,E+"leave",_,t,d),m.target=N,m.relatedTarget=A,D=null,ls(d)===c&&(b=new b(x,E+"enter",R,t,d),b.target=A,b.relatedTarget=N,D=b),N=D,_&&R)t:{for(b=_,x=R,E=0,A=b;A;A=Ks(A))E++;for(A=0,D=x;D;D=Ks(D))A++;for(;0<E-A;)b=Ks(b),E--;for(;0<A-E;)x=Ks(x),A--;for(;E--;){if(b===x||x!==null&&b===x.alternate)break t;b=Ks(b),x=Ks(x)}b=null}else b=null;_!==null&&Qg(f,m,_,b,!1),R!==null&&N!==null&&Qg(f,N,R,b,!0)}}e:{if(m=c?oi(c):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var B=gA;else if(jg(m))if(Xv)B=wA;else{B=_A;var L=yA}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(B=vA);if(B&&(B=B(n,c))){Yv(f,B,t,d);break e}L&&L(n,m,c),n==="focusout"&&(L=m._wrapperState)&&L.controlled&&m.type==="number"&&Xh(m,"number",m.value)}switch(L=c?oi(c):window,n){case"focusin":(jg(L)||L.contentEditable==="true")&&(si=L,ud=c,$o=null);break;case"focusout":$o=ud=si=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,Kg(f,t,d);break;case"selectionchange":if(TA)break;case"keydown":case"keyup":Kg(f,t,d)}var w;if(Df)e:{switch(n){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else ri?Qv(n,t)&&(g="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(g="onCompositionStart");g&&(Wv&&t.locale!=="ko"&&(ri||g!=="onCompositionStart"?g==="onCompositionEnd"&&ri&&(w=Gv()):(fr=d,kf="value"in fr?fr.value:fr.textContent,ri=!0)),L=yu(c,g),0<L.length&&(g=new Mg(g,n,null,t,d),f.push({event:g,listeners:L}),w?g.data=w:(w=Hv(t),w!==null&&(g.data=w)))),(w=hA?dA(n,t):fA(n,t))&&(c=yu(c,"onBeforeInput"),0<c.length&&(d=new Mg("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:c}),d.data=w))}aw(f,e)})}function ca(n,e,t){return{instance:n,listener:e,currentTarget:t}}function yu(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ra(n,t),i!=null&&r.unshift(ca(n,i,s)),i=ra(n,e),i!=null&&r.push(ca(n,i,s))),n=n.return}return r}function Ks(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Qg(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,s?(u=ra(t,i),u!=null&&o.unshift(ca(t,u,a))):s||(u=ra(t,i),u!=null&&o.push(ca(t,u,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var RA=/\r\n?/g,PA=/\u0000|\uFFFD/g;function Hg(n){return(typeof n=="string"?n:""+n).replace(RA,`
`).replace(PA,"")}function Pl(n,e,t){if(e=Hg(e),Hg(n)!==e&&t)throw Error(U(425))}function _u(){}var hd=null,dd=null;function fd(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pd=typeof setTimeout=="function"?setTimeout:void 0,CA=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,bA=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(n){return Yg.resolve(null).then(n).catch(kA)}:pd;function kA(n){setTimeout(function(){throw n})}function Ih(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),oa(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);oa(e)}function wr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Xg(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Wi=Math.random().toString(36).slice(2),yn="__reactFiber$"+Wi,ha="__reactProps$"+Wi,Un="__reactContainer$"+Wi,md="__reactEvents$"+Wi,VA="__reactListeners$"+Wi,NA="__reactHandles$"+Wi;function ls(n){var e=n[yn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Un]||t[yn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Xg(n);n!==null;){if(t=n[yn])return t;n=Xg(n)}return e}n=t,t=n.parentNode}return null}function ja(n){return n=n[yn]||n[Un],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function oi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(U(33))}function rc(n){return n[ha]||null}var gd=[],ai=-1;function Ur(n){return{current:n}}function Ce(n){0>ai||(n.current=gd[ai],gd[ai]=null,ai--)}function Te(n,e){ai++,gd[ai]=n.current,n.current=e}var Pr={},wt=Ur(Pr),Bt=Ur(!1),ys=Pr;function Ii(n,e){var t=n.type.contextTypes;if(!t)return Pr;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function jt(n){return n=n.childContextTypes,n!=null}function vu(){Ce(Bt),Ce(wt)}function Jg(n,e,t){if(wt.current!==Pr)throw Error(U(168));Te(wt,e),Te(Bt,t)}function uw(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,yx(n)||"Unknown",s));return Fe({},t,r)}function wu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Pr,ys=wt.current,Te(wt,n),Te(Bt,Bt.current),!0}function Zg(n,e,t){var r=n.stateNode;if(!r)throw Error(U(169));t?(n=uw(n,e,ys),r.__reactInternalMemoizedMergedChildContext=n,Ce(Bt),Ce(wt),Te(wt,n)):Ce(Bt),Te(Bt,t)}var Dn=null,sc=!1,Th=!1;function cw(n){Dn===null?Dn=[n]:Dn.push(n)}function DA(n){sc=!0,cw(n)}function zr(){if(!Th&&Dn!==null){Th=!0;var n=0,e=ve;try{var t=Dn;for(ve=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Dn=null,sc=!1}catch(s){throw Dn!==null&&(Dn=Dn.slice(n+1)),Ov(Rf,zr),s}finally{ve=e,Th=!1}}return null}var li=[],ui=0,Eu=null,Iu=0,Jt=[],Zt=0,_s=null,On=1,Mn="";function Zr(n,e){li[ui++]=Iu,li[ui++]=Eu,Eu=n,Iu=e}function hw(n,e,t){Jt[Zt++]=On,Jt[Zt++]=Mn,Jt[Zt++]=_s,_s=n;var r=On;n=Mn;var s=32-dn(r)-1;r&=~(1<<s),t+=1;var i=32-dn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,On=1<<32-dn(e)+s|t<<s|r,Mn=i+n}else On=1<<i|t<<s|r,Mn=n}function Mf(n){n.return!==null&&(Zr(n,1),hw(n,1,0))}function Lf(n){for(;n===Eu;)Eu=li[--ui],li[ui]=null,Iu=li[--ui],li[ui]=null;for(;n===_s;)_s=Jt[--Zt],Jt[Zt]=null,Mn=Jt[--Zt],Jt[Zt]=null,On=Jt[--Zt],Jt[Zt]=null}var Kt=null,qt=null,ke=!1,hn=null;function dw(n,e){var t=en(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function ey(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Kt=n,qt=wr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Kt=n,qt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=_s!==null?{id:On,overflow:Mn}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=en(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Kt=n,qt=null,!0):!1;default:return!1}}function yd(n){return(n.mode&1)!==0&&(n.flags&128)===0}function _d(n){if(ke){var e=qt;if(e){var t=e;if(!ey(n,e)){if(yd(n))throw Error(U(418));e=wr(t.nextSibling);var r=Kt;e&&ey(n,e)?dw(r,t):(n.flags=n.flags&-4097|2,ke=!1,Kt=n)}}else{if(yd(n))throw Error(U(418));n.flags=n.flags&-4097|2,ke=!1,Kt=n}}}function ty(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Kt=n}function Cl(n){if(n!==Kt)return!1;if(!ke)return ty(n),ke=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!fd(n.type,n.memoizedProps)),e&&(e=qt)){if(yd(n))throw fw(),Error(U(418));for(;e;)dw(n,e),e=wr(e.nextSibling)}if(ty(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(U(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){qt=wr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}qt=null}}else qt=Kt?wr(n.stateNode.nextSibling):null;return!0}function fw(){for(var n=qt;n;)n=wr(n.nextSibling)}function Ti(){qt=Kt=null,ke=!1}function Ff(n){hn===null?hn=[n]:hn.push(n)}var OA=Qn.ReactCurrentBatchConfig;function To(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(U(309));var r=t.stateNode}if(!r)throw Error(U(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(U(284));if(!t._owner)throw Error(U(290,n))}return n}function bl(n,e){throw n=Object.prototype.toString.call(e),Error(U(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ny(n){var e=n._init;return e(n._payload)}function pw(n){function e(x,E){if(n){var A=x.deletions;A===null?(x.deletions=[E],x.flags|=16):A.push(E)}}function t(x,E){if(!n)return null;for(;E!==null;)e(x,E),E=E.sibling;return null}function r(x,E){for(x=new Map;E!==null;)E.key!==null?x.set(E.key,E):x.set(E.index,E),E=E.sibling;return x}function s(x,E){return x=xr(x,E),x.index=0,x.sibling=null,x}function i(x,E,A){return x.index=A,n?(A=x.alternate,A!==null?(A=A.index,A<E?(x.flags|=2,E):A):(x.flags|=2,E)):(x.flags|=1048576,E)}function o(x){return n&&x.alternate===null&&(x.flags|=2),x}function a(x,E,A,D){return E===null||E.tag!==6?(E=bh(A,x.mode,D),E.return=x,E):(E=s(E,A),E.return=x,E)}function u(x,E,A,D){var B=A.type;return B===ni?d(x,E,A.props.children,D,A.key):E!==null&&(E.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===or&&ny(B)===E.type)?(D=s(E,A.props),D.ref=To(x,E,A),D.return=x,D):(D=eu(A.type,A.key,A.props,null,x.mode,D),D.ref=To(x,E,A),D.return=x,D)}function c(x,E,A,D){return E===null||E.tag!==4||E.stateNode.containerInfo!==A.containerInfo||E.stateNode.implementation!==A.implementation?(E=kh(A,x.mode,D),E.return=x,E):(E=s(E,A.children||[]),E.return=x,E)}function d(x,E,A,D,B){return E===null||E.tag!==7?(E=ps(A,x.mode,D,B),E.return=x,E):(E=s(E,A),E.return=x,E)}function f(x,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return E=bh(""+E,x.mode,A),E.return=x,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case vl:return A=eu(E.type,E.key,E.props,null,x.mode,A),A.ref=To(x,null,E),A.return=x,A;case ti:return E=kh(E,x.mode,A),E.return=x,E;case or:var D=E._init;return f(x,D(E._payload),A)}if(Vo(E)||_o(E))return E=ps(E,x.mode,A,null),E.return=x,E;bl(x,E)}return null}function m(x,E,A,D){var B=E!==null?E.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return B!==null?null:a(x,E,""+A,D);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case vl:return A.key===B?u(x,E,A,D):null;case ti:return A.key===B?c(x,E,A,D):null;case or:return B=A._init,m(x,E,B(A._payload),D)}if(Vo(A)||_o(A))return B!==null?null:d(x,E,A,D,null);bl(x,A)}return null}function _(x,E,A,D,B){if(typeof D=="string"&&D!==""||typeof D=="number")return x=x.get(A)||null,a(E,x,""+D,B);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case vl:return x=x.get(D.key===null?A:D.key)||null,u(E,x,D,B);case ti:return x=x.get(D.key===null?A:D.key)||null,c(E,x,D,B);case or:var L=D._init;return _(x,E,A,L(D._payload),B)}if(Vo(D)||_o(D))return x=x.get(A)||null,d(E,x,D,B,null);bl(E,D)}return null}function R(x,E,A,D){for(var B=null,L=null,w=E,g=E=0,v=null;w!==null&&g<A.length;g++){w.index>g?(v=w,w=null):v=w.sibling;var I=m(x,w,A[g],D);if(I===null){w===null&&(w=v);break}n&&w&&I.alternate===null&&e(x,w),E=i(I,E,g),L===null?B=I:L.sibling=I,L=I,w=v}if(g===A.length)return t(x,w),ke&&Zr(x,g),B;if(w===null){for(;g<A.length;g++)w=f(x,A[g],D),w!==null&&(E=i(w,E,g),L===null?B=w:L.sibling=w,L=w);return ke&&Zr(x,g),B}for(w=r(x,w);g<A.length;g++)v=_(w,x,g,A[g],D),v!==null&&(n&&v.alternate!==null&&w.delete(v.key===null?g:v.key),E=i(v,E,g),L===null?B=v:L.sibling=v,L=v);return n&&w.forEach(function(S){return e(x,S)}),ke&&Zr(x,g),B}function b(x,E,A,D){var B=_o(A);if(typeof B!="function")throw Error(U(150));if(A=B.call(A),A==null)throw Error(U(151));for(var L=B=null,w=E,g=E=0,v=null,I=A.next();w!==null&&!I.done;g++,I=A.next()){w.index>g?(v=w,w=null):v=w.sibling;var S=m(x,w,I.value,D);if(S===null){w===null&&(w=v);break}n&&w&&S.alternate===null&&e(x,w),E=i(S,E,g),L===null?B=S:L.sibling=S,L=S,w=v}if(I.done)return t(x,w),ke&&Zr(x,g),B;if(w===null){for(;!I.done;g++,I=A.next())I=f(x,I.value,D),I!==null&&(E=i(I,E,g),L===null?B=I:L.sibling=I,L=I);return ke&&Zr(x,g),B}for(w=r(x,w);!I.done;g++,I=A.next())I=_(w,x,g,I.value,D),I!==null&&(n&&I.alternate!==null&&w.delete(I.key===null?g:I.key),E=i(I,E,g),L===null?B=I:L.sibling=I,L=I);return n&&w.forEach(function(P){return e(x,P)}),ke&&Zr(x,g),B}function N(x,E,A,D){if(typeof A=="object"&&A!==null&&A.type===ni&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case vl:e:{for(var B=A.key,L=E;L!==null;){if(L.key===B){if(B=A.type,B===ni){if(L.tag===7){t(x,L.sibling),E=s(L,A.props.children),E.return=x,x=E;break e}}else if(L.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===or&&ny(B)===L.type){t(x,L.sibling),E=s(L,A.props),E.ref=To(x,L,A),E.return=x,x=E;break e}t(x,L);break}else e(x,L);L=L.sibling}A.type===ni?(E=ps(A.props.children,x.mode,D,A.key),E.return=x,x=E):(D=eu(A.type,A.key,A.props,null,x.mode,D),D.ref=To(x,E,A),D.return=x,x=D)}return o(x);case ti:e:{for(L=A.key;E!==null;){if(E.key===L)if(E.tag===4&&E.stateNode.containerInfo===A.containerInfo&&E.stateNode.implementation===A.implementation){t(x,E.sibling),E=s(E,A.children||[]),E.return=x,x=E;break e}else{t(x,E);break}else e(x,E);E=E.sibling}E=kh(A,x.mode,D),E.return=x,x=E}return o(x);case or:return L=A._init,N(x,E,L(A._payload),D)}if(Vo(A))return R(x,E,A,D);if(_o(A))return b(x,E,A,D);bl(x,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,E!==null&&E.tag===6?(t(x,E.sibling),E=s(E,A),E.return=x,x=E):(t(x,E),E=bh(A,x.mode,D),E.return=x,x=E),o(x)):t(x,E)}return N}var xi=pw(!0),mw=pw(!1),Tu=Ur(null),xu=null,ci=null,Bf=null;function jf(){Bf=ci=xu=null}function Uf(n){var e=Tu.current;Ce(Tu),n._currentValue=e}function vd(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function yi(n,e){xu=n,Bf=ci=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ot=!0),n.firstContext=null)}function sn(n){var e=n._currentValue;if(Bf!==n)if(n={context:n,memoizedValue:e,next:null},ci===null){if(xu===null)throw Error(U(308));ci=n,xu.dependencies={lanes:0,firstContext:n}}else ci=ci.next=n;return e}var us=null;function zf(n){us===null?us=[n]:us.push(n)}function gw(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,zf(e)):(t.next=s.next,s.next=t),e.interleaved=t,zn(n,r)}function zn(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ar=!1;function $f(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yw(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Fn(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Er(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,de&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,zn(n,t)}return s=r.interleaved,s===null?(e.next=e,zf(r)):(e.next=s.next,s.next=e),r.interleaved=e,zn(n,t)}function Ql(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Pf(n,t)}}function ry(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Au(n,e,t,r){var s=n.updateQueue;ar=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=u))}if(i!==null){var f=s.baseState;o=0,d=c=u=null,a=i;do{var m=a.lane,_=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=n,b=a;switch(m=e,_=t,b.tag){case 1:if(R=b.payload,typeof R=="function"){f=R.call(_,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=b.payload,m=typeof R=="function"?R.call(_,f,m):R,m==null)break e;f=Fe({},f,m);break e;case 2:ar=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=_,u=f):d=d.next=_,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(u=f),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ws|=o,n.lanes=o,n.memoizedState=f}}function sy(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var Ua={},In=Ur(Ua),da=Ur(Ua),fa=Ur(Ua);function cs(n){if(n===Ua)throw Error(U(174));return n}function qf(n,e){switch(Te(fa,e),Te(da,n),Te(In,Ua),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zh(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Zh(e,n)}Ce(In),Te(In,e)}function Ai(){Ce(In),Ce(da),Ce(fa)}function _w(n){cs(fa.current);var e=cs(In.current),t=Zh(e,n.type);e!==t&&(Te(da,n),Te(In,t))}function Kf(n){da.current===n&&(Ce(In),Ce(da))}var Oe=Ur(0);function Su(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xh=[];function Gf(){for(var n=0;n<xh.length;n++)xh[n]._workInProgressVersionPrimary=null;xh.length=0}var Hl=Qn.ReactCurrentDispatcher,Ah=Qn.ReactCurrentBatchConfig,vs=0,Me=null,Xe=null,nt=null,Ru=!1,qo=!1,pa=0,MA=0;function gt(){throw Error(U(321))}function Wf(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!pn(n[t],e[t]))return!1;return!0}function Qf(n,e,t,r,s,i){if(vs=i,Me=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hl.current=n===null||n.memoizedState===null?jA:UA,n=t(r,s),qo){i=0;do{if(qo=!1,pa=0,25<=i)throw Error(U(301));i+=1,nt=Xe=null,e.updateQueue=null,Hl.current=zA,n=t(r,s)}while(qo)}if(Hl.current=Pu,e=Xe!==null&&Xe.next!==null,vs=0,nt=Xe=Me=null,Ru=!1,e)throw Error(U(300));return n}function Hf(){var n=pa!==0;return pa=0,n}function gn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nt===null?Me.memoizedState=nt=n:nt=nt.next=n,nt}function on(){if(Xe===null){var n=Me.alternate;n=n!==null?n.memoizedState:null}else n=Xe.next;var e=nt===null?Me.memoizedState:nt.next;if(e!==null)nt=e,Xe=n;else{if(n===null)throw Error(U(310));Xe=n,n={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},nt===null?Me.memoizedState=nt=n:nt=nt.next=n}return nt}function ma(n,e){return typeof e=="function"?e(n):e}function Sh(n){var e=on(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=n;var r=Xe,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,c=i;do{var d=c.lane;if((vs&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=f,o=r):u=u.next=f,Me.lanes|=d,ws|=d}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=a,pn(r,e.memoizedState)||(Ot=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,Me.lanes|=i,ws|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Rh(n){var e=on(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);pn(i,e.memoizedState)||(Ot=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function vw(){}function ww(n,e){var t=Me,r=on(),s=e(),i=!pn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ot=!0),r=r.queue,Yf(Tw.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||nt!==null&&nt.memoizedState.tag&1){if(t.flags|=2048,ga(9,Iw.bind(null,t,r,s,e),void 0,null),st===null)throw Error(U(349));vs&30||Ew(t,e,s)}return s}function Ew(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Me.updateQueue,e===null?(e={lastEffect:null,stores:null},Me.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Iw(n,e,t,r){e.value=t,e.getSnapshot=r,xw(e)&&Aw(n)}function Tw(n,e,t){return t(function(){xw(e)&&Aw(n)})}function xw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!pn(n,t)}catch{return!0}}function Aw(n){var e=zn(n,1);e!==null&&fn(e,n,1,-1)}function iy(n){var e=gn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:n},e.queue=n,n=n.dispatch=BA.bind(null,Me,n),[e.memoizedState,n]}function ga(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Me.updateQueue,e===null?(e={lastEffect:null,stores:null},Me.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function Sw(){return on().memoizedState}function Yl(n,e,t,r){var s=gn();Me.flags|=n,s.memoizedState=ga(1|e,t,void 0,r===void 0?null:r)}function ic(n,e,t,r){var s=on();r=r===void 0?null:r;var i=void 0;if(Xe!==null){var o=Xe.memoizedState;if(i=o.destroy,r!==null&&Wf(r,o.deps)){s.memoizedState=ga(e,t,i,r);return}}Me.flags|=n,s.memoizedState=ga(1|e,t,i,r)}function oy(n,e){return Yl(8390656,8,n,e)}function Yf(n,e){return ic(2048,8,n,e)}function Rw(n,e){return ic(4,2,n,e)}function Pw(n,e){return ic(4,4,n,e)}function Cw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function bw(n,e,t){return t=t!=null?t.concat([n]):null,ic(4,4,Cw.bind(null,e,n),t)}function Xf(){}function kw(n,e){var t=on();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Wf(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function Vw(n,e){var t=on();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Wf(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Nw(n,e,t){return vs&21?(pn(t,e)||(t=Fv(),Me.lanes|=t,ws|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ot=!0),n.memoizedState=t)}function LA(n,e){var t=ve;ve=t!==0&&4>t?t:4,n(!0);var r=Ah.transition;Ah.transition={};try{n(!1),e()}finally{ve=t,Ah.transition=r}}function Dw(){return on().memoizedState}function FA(n,e,t){var r=Tr(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Ow(n))Mw(e,t);else if(t=gw(n,e,t,r),t!==null){var s=Rt();fn(t,n,r,s),Lw(t,e,r)}}function BA(n,e,t){var r=Tr(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Ow(n))Mw(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,pn(a,o)){var u=e.interleaved;u===null?(s.next=s,zf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}t=gw(n,e,s,r),t!==null&&(s=Rt(),fn(t,n,r,s),Lw(t,e,r))}}function Ow(n){var e=n.alternate;return n===Me||e!==null&&e===Me}function Mw(n,e){qo=Ru=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Lw(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Pf(n,t)}}var Pu={readContext:sn,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},jA={readContext:sn,useCallback:function(n,e){return gn().memoizedState=[n,e===void 0?null:e],n},useContext:sn,useEffect:oy,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Yl(4194308,4,Cw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Yl(4194308,4,n,e)},useInsertionEffect:function(n,e){return Yl(4,2,n,e)},useMemo:function(n,e){var t=gn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=gn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=FA.bind(null,Me,n),[r.memoizedState,n]},useRef:function(n){var e=gn();return n={current:n},e.memoizedState=n},useState:iy,useDebugValue:Xf,useDeferredValue:function(n){return gn().memoizedState=n},useTransition:function(){var n=iy(!1),e=n[0];return n=LA.bind(null,n[1]),gn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Me,s=gn();if(ke){if(t===void 0)throw Error(U(407));t=t()}else{if(t=e(),st===null)throw Error(U(349));vs&30||Ew(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,oy(Tw.bind(null,r,i,n),[n]),r.flags|=2048,ga(9,Iw.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=gn(),e=st.identifierPrefix;if(ke){var t=Mn,r=On;t=(r&~(1<<32-dn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=pa++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=MA++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},UA={readContext:sn,useCallback:kw,useContext:sn,useEffect:Yf,useImperativeHandle:bw,useInsertionEffect:Rw,useLayoutEffect:Pw,useMemo:Vw,useReducer:Sh,useRef:Sw,useState:function(){return Sh(ma)},useDebugValue:Xf,useDeferredValue:function(n){var e=on();return Nw(e,Xe.memoizedState,n)},useTransition:function(){var n=Sh(ma)[0],e=on().memoizedState;return[n,e]},useMutableSource:vw,useSyncExternalStore:ww,useId:Dw,unstable_isNewReconciler:!1},zA={readContext:sn,useCallback:kw,useContext:sn,useEffect:Yf,useImperativeHandle:bw,useInsertionEffect:Rw,useLayoutEffect:Pw,useMemo:Vw,useReducer:Rh,useRef:Sw,useState:function(){return Rh(ma)},useDebugValue:Xf,useDeferredValue:function(n){var e=on();return Xe===null?e.memoizedState=n:Nw(e,Xe.memoizedState,n)},useTransition:function(){var n=Rh(ma)[0],e=on().memoizedState;return[n,e]},useMutableSource:vw,useSyncExternalStore:ww,useId:Dw,unstable_isNewReconciler:!1};function un(n,e){if(n&&n.defaultProps){e=Fe({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function wd(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Fe({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var oc={isMounted:function(n){return(n=n._reactInternals)?Ns(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Rt(),s=Tr(n),i=Fn(r,s);i.payload=e,t!=null&&(i.callback=t),e=Er(n,i,s),e!==null&&(fn(e,n,s,r),Ql(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Rt(),s=Tr(n),i=Fn(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Er(n,i,s),e!==null&&(fn(e,n,s,r),Ql(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Rt(),r=Tr(n),s=Fn(t,r);s.tag=2,e!=null&&(s.callback=e),e=Er(n,s,r),e!==null&&(fn(e,n,r,t),Ql(e,n,r))}};function ay(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!la(t,r)||!la(s,i):!0}function Fw(n,e,t){var r=!1,s=Pr,i=e.contextType;return typeof i=="object"&&i!==null?i=sn(i):(s=jt(e)?ys:wt.current,r=e.contextTypes,i=(r=r!=null)?Ii(n,s):Pr),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=oc,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function ly(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&oc.enqueueReplaceState(e,e.state,null)}function Ed(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},$f(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=sn(i):(i=jt(e)?ys:wt.current,s.context=Ii(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(wd(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&oc.enqueueReplaceState(s,s.state,null),Au(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Si(n,e){try{var t="",r=e;do t+=gx(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function Ph(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Id(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var $A=typeof WeakMap=="function"?WeakMap:Map;function Bw(n,e,t){t=Fn(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){bu||(bu=!0,Vd=r),Id(n,e)},t}function jw(n,e,t){t=Fn(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Id(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Id(n,e),typeof r!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function uy(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new $A;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=rS.bind(null,n,e,t),e.then(n,n))}function cy(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function hy(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Fn(-1,1),e.tag=2,Er(t,e,1))),t.lanes|=1),n)}var qA=Qn.ReactCurrentOwner,Ot=!1;function xt(n,e,t,r){e.child=n===null?mw(e,null,t,r):xi(e,n.child,t,r)}function dy(n,e,t,r,s){t=t.render;var i=e.ref;return yi(e,s),r=Qf(n,e,t,r,i,s),t=Hf(),n!==null&&!Ot?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,$n(n,e,s)):(ke&&t&&Mf(e),e.flags|=1,xt(n,e,r,s),e.child)}function fy(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!ip(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,Uw(n,e,i,r,s)):(n=eu(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:la,t(o,r)&&n.ref===e.ref)return $n(n,e,s)}return e.flags|=1,n=xr(i,r),n.ref=e.ref,n.return=e,e.child=n}function Uw(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(la(i,r)&&n.ref===e.ref)if(Ot=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(Ot=!0);else return e.lanes=n.lanes,$n(n,e,s)}return Td(n,e,t,r,s)}function zw(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(di,$t),$t|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Te(di,$t),$t|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Te(di,$t),$t|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Te(di,$t),$t|=r;return xt(n,e,s,t),e.child}function $w(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Td(n,e,t,r,s){var i=jt(t)?ys:wt.current;return i=Ii(e,i),yi(e,s),t=Qf(n,e,t,r,i,s),r=Hf(),n!==null&&!Ot?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,$n(n,e,s)):(ke&&r&&Mf(e),e.flags|=1,xt(n,e,t,s),e.child)}function py(n,e,t,r,s){if(jt(t)){var i=!0;wu(e)}else i=!1;if(yi(e,s),e.stateNode===null)Xl(n,e),Fw(e,t,r),Ed(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=sn(c):(c=jt(t)?ys:wt.current,c=Ii(e,c));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==c)&&ly(e,o,r,c),ar=!1;var m=e.memoizedState;o.state=m,Au(e,r,o,s),u=e.memoizedState,a!==r||m!==u||Bt.current||ar?(typeof d=="function"&&(wd(e,t,d,r),u=e.memoizedState),(a=ar||ay(e,t,a,r,m,u,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,yw(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:un(e.type,a),o.props=c,f=e.pendingProps,m=o.context,u=t.contextType,typeof u=="object"&&u!==null?u=sn(u):(u=jt(t)?ys:wt.current,u=Ii(e,u));var _=t.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==u)&&ly(e,o,r,u),ar=!1,m=e.memoizedState,o.state=m,Au(e,r,o,s);var R=e.memoizedState;a!==f||m!==R||Bt.current||ar?(typeof _=="function"&&(wd(e,t,_,r),R=e.memoizedState),(c=ar||ay(e,t,c,r,m,R,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return xd(n,e,t,r,i,s)}function xd(n,e,t,r,s,i){$w(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Zg(e,t,!1),$n(n,e,i);r=e.stateNode,qA.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=xi(e,n.child,null,i),e.child=xi(e,null,a,i)):xt(n,e,a,i),e.memoizedState=r.state,s&&Zg(e,t,!0),e.child}function qw(n){var e=n.stateNode;e.pendingContext?Jg(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Jg(n,e.context,!1),qf(n,e.containerInfo)}function my(n,e,t,r,s){return Ti(),Ff(s),e.flags|=256,xt(n,e,t,r),e.child}var Ad={dehydrated:null,treeContext:null,retryLane:0};function Sd(n){return{baseLanes:n,cachePool:null,transitions:null}}function Kw(n,e,t){var r=e.pendingProps,s=Oe.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Te(Oe,s&1),n===null)return _d(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=uc(o,r,0,null),n=ps(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Sd(t),e.memoizedState=Ad,n):Jf(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return KA(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=xr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=xr(a,i):(i=ps(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?Sd(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Ad,r}return i=n.child,n=i.sibling,r=xr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Jf(n,e){return e=uc({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function kl(n,e,t,r){return r!==null&&Ff(r),xi(e,n.child,null,t),n=Jf(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function KA(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=Ph(Error(U(422))),kl(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=uc({mode:"visible",children:r.children},s,0,null),i=ps(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&xi(e,n.child,null,o),e.child.memoizedState=Sd(o),e.memoizedState=Ad,i);if(!(e.mode&1))return kl(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(U(419)),r=Ph(i,r,void 0),kl(n,e,o,r)}if(a=(o&n.childLanes)!==0,Ot||a){if(r=st,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,zn(n,s),fn(r,n,s,-1))}return sp(),r=Ph(Error(U(421))),kl(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=sS.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,qt=wr(s.nextSibling),Kt=e,ke=!0,hn=null,n!==null&&(Jt[Zt++]=On,Jt[Zt++]=Mn,Jt[Zt++]=_s,On=n.id,Mn=n.overflow,_s=e),e=Jf(e,r.children),e.flags|=4096,e)}function gy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),vd(n.return,e,t)}function Ch(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function Gw(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(xt(n,e,r.children,t),r=Oe.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gy(n,t,e);else if(n.tag===19)gy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Te(Oe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Su(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Ch(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Su(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Ch(e,!0,t,null,i);break;case"together":Ch(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Xl(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function $n(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ws|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(U(153));if(e.child!==null){for(n=e.child,t=xr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=xr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function GA(n,e,t){switch(e.tag){case 3:qw(e),Ti();break;case 5:_w(e);break;case 1:jt(e.type)&&wu(e);break;case 4:qf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Te(Tu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(Oe,Oe.current&1),e.flags|=128,null):t&e.child.childLanes?Kw(n,e,t):(Te(Oe,Oe.current&1),n=$n(n,e,t),n!==null?n.sibling:null);Te(Oe,Oe.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Gw(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Te(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,zw(n,e,t)}return $n(n,e,t)}var Ww,Rd,Qw,Hw;Ww=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Rd=function(){};Qw=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,cs(In.current);var i=null;switch(t){case"input":s=Hh(n,s),r=Hh(n,r),i=[];break;case"select":s=Fe({},s,{value:void 0}),r=Fe({},r,{value:void 0}),i=[];break;case"textarea":s=Jh(n,s),r=Jh(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=_u)}ed(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ta.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(t||(t={}),t[o]=u[o])}else t||(i||(i=[]),i.push(c,t)),t=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ta.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Re("scroll",n),i||a===u||(i=[])):(i=i||[]).push(c,u))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};Hw=function(n,e,t,r){t!==r&&(e.flags|=4)};function xo(n,e){if(!ke)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function yt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function WA(n,e,t){var r=e.pendingProps;switch(Lf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(e),null;case 1:return jt(e.type)&&vu(),yt(e),null;case 3:return r=e.stateNode,Ai(),Ce(Bt),Ce(wt),Gf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Cl(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hn!==null&&(Od(hn),hn=null))),Rd(n,e),yt(e),null;case 5:Kf(e);var s=cs(fa.current);if(t=e.type,n!==null&&e.stateNode!=null)Qw(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return yt(e),null}if(n=cs(In.current),Cl(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[yn]=e,r[ha]=i,n=(e.mode&1)!==0,t){case"dialog":Re("cancel",r),Re("close",r);break;case"iframe":case"object":case"embed":Re("load",r);break;case"video":case"audio":for(s=0;s<Do.length;s++)Re(Do[s],r);break;case"source":Re("error",r);break;case"img":case"image":case"link":Re("error",r),Re("load",r);break;case"details":Re("toggle",r);break;case"input":Ag(r,i),Re("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Re("invalid",r);break;case"textarea":Rg(r,i),Re("invalid",r)}ed(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Pl(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Pl(r.textContent,a,n),s=["children",""+a]):ta.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Re("scroll",r)}switch(t){case"input":wl(r),Sg(r,i,!0);break;case"textarea":wl(r),Pg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=_u)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Tv(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[yn]=e,n[ha]=r,Ww(n,e,!1,!1),e.stateNode=n;e:{switch(o=td(t,r),t){case"dialog":Re("cancel",n),Re("close",n),s=r;break;case"iframe":case"object":case"embed":Re("load",n),s=r;break;case"video":case"audio":for(s=0;s<Do.length;s++)Re(Do[s],n);s=r;break;case"source":Re("error",n),s=r;break;case"img":case"image":case"link":Re("error",n),Re("load",n),s=r;break;case"details":Re("toggle",n),s=r;break;case"input":Ag(n,r),s=Hh(n,r),Re("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Fe({},r,{value:void 0}),Re("invalid",n);break;case"textarea":Rg(n,r),s=Jh(n,r),Re("invalid",n);break;default:s=r}ed(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?Sv(n,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&xv(n,u)):i==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&na(n,u):typeof u=="number"&&na(n,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ta.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Re("scroll",n):u!=null&&If(n,i,u,o))}switch(t){case"input":wl(n),Sg(n,r,!1);break;case"textarea":wl(n),Pg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Rr(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?fi(n,!!r.multiple,i,!1):r.defaultValue!=null&&fi(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=_u)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return yt(e),null;case 6:if(n&&e.stateNode!=null)Hw(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(t=cs(fa.current),cs(In.current),Cl(e)){if(r=e.stateNode,t=e.memoizedProps,r[yn]=e,(i=r.nodeValue!==t)&&(n=Kt,n!==null))switch(n.tag){case 3:Pl(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Pl(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[yn]=e,e.stateNode=r}return yt(e),null;case 13:if(Ce(Oe),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ke&&qt!==null&&e.mode&1&&!(e.flags&128))fw(),Ti(),e.flags|=98560,i=!1;else if(i=Cl(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[yn]=e}else Ti(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;yt(e),i=!1}else hn!==null&&(Od(hn),hn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Oe.current&1?Je===0&&(Je=3):sp())),e.updateQueue!==null&&(e.flags|=4),yt(e),null);case 4:return Ai(),Rd(n,e),n===null&&ua(e.stateNode.containerInfo),yt(e),null;case 10:return Uf(e.type._context),yt(e),null;case 17:return jt(e.type)&&vu(),yt(e),null;case 19:if(Ce(Oe),i=e.memoizedState,i===null)return yt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)xo(i,!1);else{if(Je!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Su(n),o!==null){for(e.flags|=128,xo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Te(Oe,Oe.current&1|2),e.child}n=n.sibling}i.tail!==null&&qe()>Ri&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304)}else{if(!r)if(n=Su(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),xo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ke)return yt(e),null}else 2*qe()-i.renderingStartTime>Ri&&t!==1073741824&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=qe(),e.sibling=null,t=Oe.current,Te(Oe,r?t&1|2:t&1),e):(yt(e),null);case 22:case 23:return rp(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?$t&1073741824&&(yt(e),e.subtreeFlags&6&&(e.flags|=8192)):yt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function QA(n,e){switch(Lf(e),e.tag){case 1:return jt(e.type)&&vu(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Ai(),Ce(Bt),Ce(wt),Gf(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Kf(e),null;case 13:if(Ce(Oe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Ti()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ce(Oe),null;case 4:return Ai(),null;case 10:return Uf(e.type._context),null;case 22:case 23:return rp(),null;case 24:return null;default:return null}}var Vl=!1,vt=!1,HA=typeof WeakSet=="function"?WeakSet:Set,Q=null;function hi(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ue(n,e,r)}else t.current=null}function Pd(n,e,t){try{t()}catch(r){Ue(n,e,r)}}var yy=!1;function YA(n,e){if(hd=mu,n=ew(),Of(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,u=-1,c=0,d=0,f=n,m=null;t:for(;;){for(var _;f!==t||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===n)break t;if(m===t&&++c===s&&(a=o),m===i&&++d===r&&(u=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}t=a===-1||u===-1?null:{start:a,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(dd={focusedElem:n,selectionRange:t},mu=!1,Q=e;Q!==null;)if(e=Q,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Q=n;else for(;Q!==null;){e=Q;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var b=R.memoizedProps,N=R.memoizedState,x=e.stateNode,E=x.getSnapshotBeforeUpdate(e.elementType===e.type?b:un(e.type,b),N);x.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(D){Ue(e,e.return,D)}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}return R=yy,yy=!1,R}function Ko(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&Pd(e,t,i)}s=s.next}while(s!==r)}}function ac(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Cd(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Yw(n){var e=n.alternate;e!==null&&(n.alternate=null,Yw(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[yn],delete e[ha],delete e[md],delete e[VA],delete e[NA])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Xw(n){return n.tag===5||n.tag===3||n.tag===4}function _y(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Xw(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function bd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=_u));else if(r!==4&&(n=n.child,n!==null))for(bd(n,e,t),n=n.sibling;n!==null;)bd(n,e,t),n=n.sibling}function kd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(kd(n,e,t),n=n.sibling;n!==null;)kd(n,e,t),n=n.sibling}var at=null,cn=!1;function tr(n,e,t){for(t=t.child;t!==null;)Jw(n,e,t),t=t.sibling}function Jw(n,e,t){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(Zu,t)}catch{}switch(t.tag){case 5:vt||hi(t,e);case 6:var r=at,s=cn;at=null,tr(n,e,t),at=r,cn=s,at!==null&&(cn?(n=at,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):at.removeChild(t.stateNode));break;case 18:at!==null&&(cn?(n=at,t=t.stateNode,n.nodeType===8?Ih(n.parentNode,t):n.nodeType===1&&Ih(n,t),oa(n)):Ih(at,t.stateNode));break;case 4:r=at,s=cn,at=t.stateNode.containerInfo,cn=!0,tr(n,e,t),at=r,cn=s;break;case 0:case 11:case 14:case 15:if(!vt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Pd(t,e,o),s=s.next}while(s!==r)}tr(n,e,t);break;case 1:if(!vt&&(hi(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Ue(t,e,a)}tr(n,e,t);break;case 21:tr(n,e,t);break;case 22:t.mode&1?(vt=(r=vt)||t.memoizedState!==null,tr(n,e,t),vt=r):tr(n,e,t);break;default:tr(n,e,t)}}function vy(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new HA),e.forEach(function(r){var s=iS.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function ln(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:at=a.stateNode,cn=!1;break e;case 3:at=a.stateNode.containerInfo,cn=!0;break e;case 4:at=a.stateNode.containerInfo,cn=!0;break e}a=a.return}if(at===null)throw Error(U(160));Jw(i,o,s),at=null,cn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Ue(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Zw(e,n),e=e.sibling}function Zw(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(ln(e,n),mn(n),r&4){try{Ko(3,n,n.return),ac(3,n)}catch(b){Ue(n,n.return,b)}try{Ko(5,n,n.return)}catch(b){Ue(n,n.return,b)}}break;case 1:ln(e,n),mn(n),r&512&&t!==null&&hi(t,t.return);break;case 5:if(ln(e,n),mn(n),r&512&&t!==null&&hi(t,t.return),n.flags&32){var s=n.stateNode;try{na(s,"")}catch(b){Ue(n,n.return,b)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Ev(s,i),td(a,o);var c=td(a,i);for(o=0;o<u.length;o+=2){var d=u[o],f=u[o+1];d==="style"?Sv(s,f):d==="dangerouslySetInnerHTML"?xv(s,f):d==="children"?na(s,f):If(s,d,f,c)}switch(a){case"input":Yh(s,i);break;case"textarea":Iv(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?fi(s,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?fi(s,!!i.multiple,i.defaultValue,!0):fi(s,!!i.multiple,i.multiple?[]:"",!1))}s[ha]=i}catch(b){Ue(n,n.return,b)}}break;case 6:if(ln(e,n),mn(n),r&4){if(n.stateNode===null)throw Error(U(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(b){Ue(n,n.return,b)}}break;case 3:if(ln(e,n),mn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{oa(e.containerInfo)}catch(b){Ue(n,n.return,b)}break;case 4:ln(e,n),mn(n);break;case 13:ln(e,n),mn(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(tp=qe())),r&4&&vy(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(vt=(c=vt)||d,ln(e,n),vt=c):ln(e,n),mn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!d&&n.mode&1)for(Q=n,d=n.child;d!==null;){for(f=Q=d;Q!==null;){switch(m=Q,_=m.child,m.tag){case 0:case 11:case 14:case 15:Ko(4,m,m.return);break;case 1:hi(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(b){Ue(r,t,b)}}break;case 5:hi(m,m.return);break;case 22:if(m.memoizedState!==null){Ey(f);continue}}_!==null?(_.return=m,Q=_):Ey(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Av("display",o))}catch(b){Ue(n,n.return,b)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(b){Ue(n,n.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ln(e,n),mn(n),r&4&&vy(n);break;case 21:break;default:ln(e,n),mn(n)}}function mn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Xw(t)){var r=t;break e}t=t.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(na(s,""),r.flags&=-33);var i=_y(n);kd(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=_y(n);bd(n,a,o);break;default:throw Error(U(161))}}catch(u){Ue(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function XA(n,e,t){Q=n,e0(n)}function e0(n,e,t){for(var r=(n.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Vl;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||vt;a=Vl;var c=vt;if(Vl=o,(vt=u)&&!c)for(Q=s;Q!==null;)o=Q,u=o.child,o.tag===22&&o.memoizedState!==null?Iy(s):u!==null?(u.return=o,Q=u):Iy(s);for(;i!==null;)Q=i,e0(i),i=i.sibling;Q=s,Vl=a,vt=c}wy(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):wy(n)}}function wy(n){for(;Q!==null;){var e=Q;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vt||ac(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vt)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:un(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&sy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}sy(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&oa(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}vt||e.flags&512&&Cd(e)}catch(m){Ue(e,e.return,m)}}if(e===n){Q=null;break}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}}function Ey(n){for(;Q!==null;){var e=Q;if(e===n){Q=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Q=t;break}Q=e.return}}function Iy(n){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{ac(4,e)}catch(u){Ue(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ue(e,s,u)}}var i=e.return;try{Cd(e)}catch(u){Ue(e,i,u)}break;case 5:var o=e.return;try{Cd(e)}catch(u){Ue(e,o,u)}}}catch(u){Ue(e,e.return,u)}if(e===n){Q=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Q=a;break}Q=e.return}}var JA=Math.ceil,Cu=Qn.ReactCurrentDispatcher,Zf=Qn.ReactCurrentOwner,nn=Qn.ReactCurrentBatchConfig,de=0,st=null,He=null,ct=0,$t=0,di=Ur(0),Je=0,ya=null,ws=0,lc=0,ep=0,Go=null,Dt=null,tp=0,Ri=1/0,Nn=null,bu=!1,Vd=null,Ir=null,Nl=!1,pr=null,ku=0,Wo=0,Nd=null,Jl=-1,Zl=0;function Rt(){return de&6?qe():Jl!==-1?Jl:Jl=qe()}function Tr(n){return n.mode&1?de&2&&ct!==0?ct&-ct:OA.transition!==null?(Zl===0&&(Zl=Fv()),Zl):(n=ve,n!==0||(n=window.event,n=n===void 0?16:Kv(n.type)),n):1}function fn(n,e,t,r){if(50<Wo)throw Wo=0,Nd=null,Error(U(185));Fa(n,t,r),(!(de&2)||n!==st)&&(n===st&&(!(de&2)&&(lc|=t),Je===4&&ur(n,ct)),Ut(n,r),t===1&&de===0&&!(e.mode&1)&&(Ri=qe()+500,sc&&zr()))}function Ut(n,e){var t=n.callbackNode;Ox(n,e);var r=pu(n,n===st?ct:0);if(r===0)t!==null&&kg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&kg(t),e===1)n.tag===0?DA(Ty.bind(null,n)):cw(Ty.bind(null,n)),bA(function(){!(de&6)&&zr()}),t=null;else{switch(Bv(r)){case 1:t=Rf;break;case 4:t=Mv;break;case 16:t=fu;break;case 536870912:t=Lv;break;default:t=fu}t=l0(t,t0.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function t0(n,e){if(Jl=-1,Zl=0,de&6)throw Error(U(327));var t=n.callbackNode;if(_i()&&n.callbackNode!==t)return null;var r=pu(n,n===st?ct:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Vu(n,r);else{e=r;var s=de;de|=2;var i=r0();(st!==n||ct!==e)&&(Nn=null,Ri=qe()+500,fs(n,e));do try{tS();break}catch(a){n0(n,a)}while(!0);jf(),Cu.current=i,de=s,He!==null?e=0:(st=null,ct=0,e=Je)}if(e!==0){if(e===2&&(s=od(n),s!==0&&(r=s,e=Dd(n,s))),e===1)throw t=ya,fs(n,0),ur(n,r),Ut(n,qe()),t;if(e===6)ur(n,r);else{if(s=n.current.alternate,!(r&30)&&!ZA(s)&&(e=Vu(n,r),e===2&&(i=od(n),i!==0&&(r=i,e=Dd(n,i))),e===1))throw t=ya,fs(n,0),ur(n,r),Ut(n,qe()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:es(n,Dt,Nn);break;case 3:if(ur(n,r),(r&130023424)===r&&(e=tp+500-qe(),10<e)){if(pu(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Rt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=pd(es.bind(null,n,Dt,Nn),e);break}es(n,Dt,Nn);break;case 4:if(ur(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-dn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*JA(r/1960))-r,10<r){n.timeoutHandle=pd(es.bind(null,n,Dt,Nn),r);break}es(n,Dt,Nn);break;case 5:es(n,Dt,Nn);break;default:throw Error(U(329))}}}return Ut(n,qe()),n.callbackNode===t?t0.bind(null,n):null}function Dd(n,e){var t=Go;return n.current.memoizedState.isDehydrated&&(fs(n,e).flags|=256),n=Vu(n,e),n!==2&&(e=Dt,Dt=t,e!==null&&Od(e)),n}function Od(n){Dt===null?Dt=n:Dt.push.apply(Dt,n)}function ZA(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!pn(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ur(n,e){for(e&=~ep,e&=~lc,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-dn(e),r=1<<t;n[t]=-1,e&=~r}}function Ty(n){if(de&6)throw Error(U(327));_i();var e=pu(n,0);if(!(e&1))return Ut(n,qe()),null;var t=Vu(n,e);if(n.tag!==0&&t===2){var r=od(n);r!==0&&(e=r,t=Dd(n,r))}if(t===1)throw t=ya,fs(n,0),ur(n,e),Ut(n,qe()),t;if(t===6)throw Error(U(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,es(n,Dt,Nn),Ut(n,qe()),null}function np(n,e){var t=de;de|=1;try{return n(e)}finally{de=t,de===0&&(Ri=qe()+500,sc&&zr())}}function Es(n){pr!==null&&pr.tag===0&&!(de&6)&&_i();var e=de;de|=1;var t=nn.transition,r=ve;try{if(nn.transition=null,ve=1,n)return n()}finally{ve=r,nn.transition=t,de=e,!(de&6)&&zr()}}function rp(){$t=di.current,Ce(di)}function fs(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,CA(t)),He!==null)for(t=He.return;t!==null;){var r=t;switch(Lf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vu();break;case 3:Ai(),Ce(Bt),Ce(wt),Gf();break;case 5:Kf(r);break;case 4:Ai();break;case 13:Ce(Oe);break;case 19:Ce(Oe);break;case 10:Uf(r.type._context);break;case 22:case 23:rp()}t=t.return}if(st=n,He=n=xr(n.current,null),ct=$t=e,Je=0,ya=null,ep=lc=ws=0,Dt=Go=null,us!==null){for(e=0;e<us.length;e++)if(t=us[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}us=null}return n}function n0(n,e){do{var t=He;try{if(jf(),Hl.current=Pu,Ru){for(var r=Me.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ru=!1}if(vs=0,nt=Xe=Me=null,qo=!1,pa=0,Zf.current=null,t===null||t.return===null){Je=1,ya=e,He=null;break}e:{var i=n,o=t.return,a=t,u=e;if(e=ct,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=cy(o);if(_!==null){_.flags&=-257,hy(_,o,a,i,e),_.mode&1&&uy(i,c,e),e=_,u=c;var R=e.updateQueue;if(R===null){var b=new Set;b.add(u),e.updateQueue=b}else R.add(u);break e}else{if(!(e&1)){uy(i,c,e),sp();break e}u=Error(U(426))}}else if(ke&&a.mode&1){var N=cy(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),hy(N,o,a,i,e),Ff(Si(u,a));break e}}i=u=Si(u,a),Je!==4&&(Je=2),Go===null?Go=[i]:Go.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=Bw(i,u,e);ry(i,x);break e;case 1:a=u;var E=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ir===null||!Ir.has(A)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=jw(i,a,e);ry(i,D);break e}}i=i.return}while(i!==null)}i0(t)}catch(B){e=B,He===t&&t!==null&&(He=t=t.return);continue}break}while(!0)}function r0(){var n=Cu.current;return Cu.current=Pu,n===null?Pu:n}function sp(){(Je===0||Je===3||Je===2)&&(Je=4),st===null||!(ws&268435455)&&!(lc&268435455)||ur(st,ct)}function Vu(n,e){var t=de;de|=2;var r=r0();(st!==n||ct!==e)&&(Nn=null,fs(n,e));do try{eS();break}catch(s){n0(n,s)}while(!0);if(jf(),de=t,Cu.current=r,He!==null)throw Error(U(261));return st=null,ct=0,Je}function eS(){for(;He!==null;)s0(He)}function tS(){for(;He!==null&&!Sx();)s0(He)}function s0(n){var e=a0(n.alternate,n,$t);n.memoizedProps=n.pendingProps,e===null?i0(n):He=e,Zf.current=null}function i0(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=QA(t,e),t!==null){t.flags&=32767,He=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Je=6,He=null;return}}else if(t=WA(t,e,$t),t!==null){He=t;return}if(e=e.sibling,e!==null){He=e;return}He=e=n}while(e!==null);Je===0&&(Je=5)}function es(n,e,t){var r=ve,s=nn.transition;try{nn.transition=null,ve=1,nS(n,e,t,r)}finally{nn.transition=s,ve=r}return null}function nS(n,e,t,r){do _i();while(pr!==null);if(de&6)throw Error(U(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(U(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(Mx(n,i),n===st&&(He=st=null,ct=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Nl||(Nl=!0,l0(fu,function(){return _i(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=nn.transition,nn.transition=null;var o=ve;ve=1;var a=de;de|=4,Zf.current=null,YA(n,t),Zw(t,n),IA(dd),mu=!!hd,dd=hd=null,n.current=t,XA(t),Rx(),de=a,ve=o,nn.transition=i}else n.current=t;if(Nl&&(Nl=!1,pr=n,ku=s),i=n.pendingLanes,i===0&&(Ir=null),bx(t.stateNode),Ut(n,qe()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(bu)throw bu=!1,n=Vd,Vd=null,n;return ku&1&&n.tag!==0&&_i(),i=n.pendingLanes,i&1?n===Nd?Wo++:(Wo=0,Nd=n):Wo=0,zr(),null}function _i(){if(pr!==null){var n=Bv(ku),e=nn.transition,t=ve;try{if(nn.transition=null,ve=16>n?16:n,pr===null)var r=!1;else{if(n=pr,pr=null,ku=0,de&6)throw Error(U(331));var s=de;for(de|=4,Q=n.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(Q=c;Q!==null;){var d=Q;switch(d.tag){case 0:case 11:case 15:Ko(8,d,i)}var f=d.child;if(f!==null)f.return=d,Q=f;else for(;Q!==null;){d=Q;var m=d.sibling,_=d.return;if(Yw(d),d===c){Q=null;break}if(m!==null){m.return=_,Q=m;break}Q=_}}}var R=i.alternate;if(R!==null){var b=R.child;if(b!==null){R.child=null;do{var N=b.sibling;b.sibling=null,b=N}while(b!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ko(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Q=x;break e}Q=i.return}}var E=n.current;for(Q=E;Q!==null;){o=Q;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,Q=A;else e:for(o=E;Q!==null;){if(a=Q,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ac(9,a)}}catch(B){Ue(a,a.return,B)}if(a===o){Q=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,Q=D;break e}Q=a.return}}if(de=s,zr(),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(Zu,n)}catch{}r=!0}return r}finally{ve=t,nn.transition=e}}return!1}function xy(n,e,t){e=Si(t,e),e=Bw(n,e,1),n=Er(n,e,1),e=Rt(),n!==null&&(Fa(n,1,e),Ut(n,e))}function Ue(n,e,t){if(n.tag===3)xy(n,n,t);else for(;e!==null;){if(e.tag===3){xy(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ir===null||!Ir.has(r))){n=Si(t,n),n=jw(e,n,1),e=Er(e,n,1),n=Rt(),e!==null&&(Fa(e,1,n),Ut(e,n));break}}e=e.return}}function rS(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Rt(),n.pingedLanes|=n.suspendedLanes&t,st===n&&(ct&t)===t&&(Je===4||Je===3&&(ct&130023424)===ct&&500>qe()-tp?fs(n,0):ep|=t),Ut(n,e)}function o0(n,e){e===0&&(n.mode&1?(e=Tl,Tl<<=1,!(Tl&130023424)&&(Tl=4194304)):e=1);var t=Rt();n=zn(n,e),n!==null&&(Fa(n,e,t),Ut(n,t))}function sS(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),o0(n,t)}function iS(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),o0(n,t)}var a0;a0=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Bt.current)Ot=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ot=!1,GA(n,e,t);Ot=!!(n.flags&131072)}else Ot=!1,ke&&e.flags&1048576&&hw(e,Iu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Xl(n,e),n=e.pendingProps;var s=Ii(e,wt.current);yi(e,t),s=Qf(null,e,r,n,s,t);var i=Hf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jt(r)?(i=!0,wu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$f(e),s.updater=oc,e.stateNode=s,s._reactInternals=e,Ed(e,r,n,t),e=xd(null,e,r,!0,i,t)):(e.tag=0,ke&&i&&Mf(e),xt(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Xl(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=aS(r),n=un(r,n),s){case 0:e=Td(null,e,r,n,t);break e;case 1:e=py(null,e,r,n,t);break e;case 11:e=dy(null,e,r,n,t);break e;case 14:e=fy(null,e,r,un(r.type,n),t);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),Td(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),py(n,e,r,s,t);case 3:e:{if(qw(e),n===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,yw(n,e),Au(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Si(Error(U(423)),e),e=my(n,e,r,t,s);break e}else if(r!==s){s=Si(Error(U(424)),e),e=my(n,e,r,t,s);break e}else for(qt=wr(e.stateNode.containerInfo.firstChild),Kt=e,ke=!0,hn=null,t=mw(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ti(),r===s){e=$n(n,e,t);break e}xt(n,e,r,t)}e=e.child}return e;case 5:return _w(e),n===null&&_d(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,fd(r,s)?o=null:i!==null&&fd(r,i)&&(e.flags|=32),$w(n,e),xt(n,e,o,t),e.child;case 6:return n===null&&_d(e),null;case 13:return Kw(n,e,t);case 4:return qf(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=xi(e,null,r,t):xt(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),dy(n,e,r,s,t);case 7:return xt(n,e,e.pendingProps,t),e.child;case 8:return xt(n,e,e.pendingProps.children,t),e.child;case 12:return xt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Te(Tu,r._currentValue),r._currentValue=o,i!==null)if(pn(i.value,o)){if(i.children===s.children&&!Bt.current){e=$n(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Fn(-1,t&-t),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=t,u=i.alternate,u!==null&&(u.lanes|=t),vd(i.return,t,e),a.lanes|=t;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),vd(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}xt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,yi(e,t),s=sn(s),r=r(s),e.flags|=1,xt(n,e,r,t),e.child;case 14:return r=e.type,s=un(r,e.pendingProps),s=un(r.type,s),fy(n,e,r,s,t);case 15:return Uw(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),Xl(n,e),e.tag=1,jt(r)?(n=!0,wu(e)):n=!1,yi(e,t),Fw(e,r,s),Ed(e,r,s,t),xd(null,e,r,!0,n,t);case 19:return Gw(n,e,t);case 22:return zw(n,e,t)}throw Error(U(156,e.tag))};function l0(n,e){return Ov(n,e)}function oS(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(n,e,t,r){return new oS(n,e,t,r)}function ip(n){return n=n.prototype,!(!n||!n.isReactComponent)}function aS(n){if(typeof n=="function")return ip(n)?1:0;if(n!=null){if(n=n.$$typeof,n===xf)return 11;if(n===Af)return 14}return 2}function xr(n,e){var t=n.alternate;return t===null?(t=en(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function eu(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")ip(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case ni:return ps(t.children,s,i,e);case Tf:o=8,s|=8;break;case Kh:return n=en(12,t,e,s|2),n.elementType=Kh,n.lanes=i,n;case Gh:return n=en(13,t,e,s),n.elementType=Gh,n.lanes=i,n;case Wh:return n=en(19,t,e,s),n.elementType=Wh,n.lanes=i,n;case _v:return uc(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case gv:o=10;break e;case yv:o=9;break e;case xf:o=11;break e;case Af:o=14;break e;case or:o=16,r=null;break e}throw Error(U(130,n==null?n:typeof n,""))}return e=en(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ps(n,e,t,r){return n=en(7,n,r,e),n.lanes=t,n}function uc(n,e,t,r){return n=en(22,n,r,e),n.elementType=_v,n.lanes=t,n.stateNode={isHidden:!1},n}function bh(n,e,t){return n=en(6,n,null,e),n.lanes=t,n}function kh(n,e,t){return e=en(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function lS(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hh(0),this.expirationTimes=hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function op(n,e,t,r,s,i,o,a,u){return n=new lS(n,e,t,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=en(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(i),n}function uS(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ti,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function u0(n){if(!n)return Pr;n=n._reactInternals;e:{if(Ns(n)!==n||n.tag!==1)throw Error(U(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(n.tag===1){var t=n.type;if(jt(t))return uw(n,t,e)}return e}function c0(n,e,t,r,s,i,o,a,u){return n=op(t,r,!0,n,s,i,o,a,u),n.context=u0(null),t=n.current,r=Rt(),s=Tr(t),i=Fn(r,s),i.callback=e??null,Er(t,i,s),n.current.lanes=s,Fa(n,s,r),Ut(n,r),n}function cc(n,e,t,r){var s=e.current,i=Rt(),o=Tr(s);return t=u0(t),e.context===null?e.context=t:e.pendingContext=t,e=Fn(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Er(s,e,o),n!==null&&(fn(n,s,o,i),Ql(n,s,o)),o}function Nu(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Ay(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function ap(n,e){Ay(n,e),(n=n.alternate)&&Ay(n,e)}function cS(){return null}var h0=typeof reportError=="function"?reportError:function(n){console.error(n)};function lp(n){this._internalRoot=n}hc.prototype.render=lp.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(U(409));cc(n,e,null,null)};hc.prototype.unmount=lp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Es(function(){cc(null,n,null,null)}),e[Un]=null}};function hc(n){this._internalRoot=n}hc.prototype.unstable_scheduleHydration=function(n){if(n){var e=zv();n={blockedOn:null,target:n,priority:e};for(var t=0;t<lr.length&&e!==0&&e<lr[t].priority;t++);lr.splice(t,0,n),t===0&&qv(n)}};function up(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function dc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Sy(){}function hS(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Nu(o);i.call(c)}}var o=c0(e,r,n,0,null,!1,!1,"",Sy);return n._reactRootContainer=o,n[Un]=o.current,ua(n.nodeType===8?n.parentNode:n),Es(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Nu(u);a.call(c)}}var u=op(n,0,!1,null,null,!1,!1,"",Sy);return n._reactRootContainer=u,n[Un]=u.current,ua(n.nodeType===8?n.parentNode:n),Es(function(){cc(e,u,t,r)}),u}function fc(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=Nu(o);a.call(u)}}cc(e,o,n,s)}else o=hS(t,e,n,s,r);return Nu(o)}jv=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=No(e.pendingLanes);t!==0&&(Pf(e,t|1),Ut(e,qe()),!(de&6)&&(Ri=qe()+500,zr()))}break;case 13:Es(function(){var r=zn(n,1);if(r!==null){var s=Rt();fn(r,n,1,s)}}),ap(n,1)}};Cf=function(n){if(n.tag===13){var e=zn(n,134217728);if(e!==null){var t=Rt();fn(e,n,134217728,t)}ap(n,134217728)}};Uv=function(n){if(n.tag===13){var e=Tr(n),t=zn(n,e);if(t!==null){var r=Rt();fn(t,n,e,r)}ap(n,e)}};zv=function(){return ve};$v=function(n,e){var t=ve;try{return ve=n,e()}finally{ve=t}};rd=function(n,e,t){switch(e){case"input":if(Yh(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=rc(r);if(!s)throw Error(U(90));wv(r),Yh(r,s)}}}break;case"textarea":Iv(n,t);break;case"select":e=t.value,e!=null&&fi(n,!!t.multiple,e,!1)}};Cv=np;bv=Es;var dS={usingClientEntryPoint:!1,Events:[ja,oi,rc,Rv,Pv,np]},Ao={findFiberByHostInstance:ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fS={bundleType:Ao.bundleType,version:Ao.version,rendererPackageName:Ao.rendererPackageName,rendererConfig:Ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Nv(n),n===null?null:n.stateNode},findFiberByHostInstance:Ao.findFiberByHostInstance||cS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dl.isDisabled&&Dl.supportsFiber)try{Zu=Dl.inject(fS),En=Dl}catch{}}Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dS;Qt.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!up(e))throw Error(U(200));return uS(n,e,null,t)};Qt.createRoot=function(n,e){if(!up(n))throw Error(U(299));var t=!1,r="",s=h0;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=op(n,1,!1,null,null,t,!1,r,s),n[Un]=e.current,ua(n.nodeType===8?n.parentNode:n),new lp(e)};Qt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(U(188)):(n=Object.keys(n).join(","),Error(U(268,n)));return n=Nv(e),n=n===null?null:n.stateNode,n};Qt.flushSync=function(n){return Es(n)};Qt.hydrate=function(n,e,t){if(!dc(e))throw Error(U(200));return fc(null,n,e,!0,t)};Qt.hydrateRoot=function(n,e,t){if(!up(n))throw Error(U(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=h0;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=c0(e,null,n,1,t??null,s,!1,i,o),n[Un]=e.current,ua(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new hc(e)};Qt.render=function(n,e,t){if(!dc(e))throw Error(U(200));return fc(null,n,e,!1,t)};Qt.unmountComponentAtNode=function(n){if(!dc(n))throw Error(U(40));return n._reactRootContainer?(Es(function(){fc(null,null,n,!1,function(){n._reactRootContainer=null,n[Un]=null})}),!0):!1};Qt.unstable_batchedUpdates=np;Qt.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!dc(t))throw Error(U(200));if(n==null||n._reactInternals===void 0)throw Error(U(38));return fc(n,e,t,!1,r)};Qt.version="18.3.1-next-f1338f8080-20240426";function d0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d0)}catch(n){console.error(n)}}d0(),dv.exports=Qt;var pS=dv.exports,Ry=pS;$h.createRoot=Ry.createRoot,$h.hydrateRoot=Ry.hydrateRoot;var G=(n=>(n.WHITE="WHITE",n.BLACK="BLACK",n))(G||{}),se=(n=>(n.WAITING="WAITING",n.ACTIVE="ACTIVE",n.FINISHED="FINISHED",n.DRAW="DRAW",n))(se||{}),Py={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},mS=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},p0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,u=s+2<n.length,c=u?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|c>>6,_=c&63;u||(_=64,o||(m=64)),r.push(t[d],t[f],t[m],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(f0(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new gS;const m=i<<2|a>>4;if(r.push(m),c!==64){const _=a<<4&240|c>>2;if(r.push(_),f!==64){const R=c<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yS=function(n){const e=f0(n);return p0.encodeByteArray(e,!0)},Du=function(n){return yS(n).replace(/\./g,"")},_S=function(n){try{return p0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ou(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!vS(t)||(n[t]=Ou(n[t],e[t]));return n}function vS(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS=()=>m0().__FIREBASE_DEFAULTS__,ES=()=>{if(typeof process>"u"||typeof Py>"u")return;const n=Py.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},IS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&_S(n[1]);return e&&JSON.parse(e)},g0=()=>{try{return wS()||ES()||IS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},y0=()=>{var n;return(n=g0())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Du(JSON.stringify(t)),Du(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AS(){var n;const e=(n=g0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function SS(){return typeof window<"u"||_0()}function _0(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function v0(){return!AS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function w0(){try{return typeof indexedDB=="object"}catch{return!1}}function RS(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="FirebaseError";class Ds extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=PS,Object.setPrototypeOf(this,Ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pc.prototype.create)}}class pc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?CS(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ds(s,a,r)}}function CS(n,e){return n.replace(bS,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const bS=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function _a(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(by(i)&&by(o)){if(!_a(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function by(n){return n!==null&&typeof n=="object"}function kS(n,e){const t=new VS(n,e);return t.subscribe.bind(t)}class VS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");NS(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Vh),s.error===void 0&&(s.error=Vh),s.complete===void 0&&(s.complete=Vh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function NS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Vh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(n){return n&&n._delegate?n._delegate:n}class Is{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new TS;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(MS(e))try{this.getOrInitializeService({instanceIdentifier:ts})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ts){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ts){return this.instances.has(e)}getOptions(e=ts){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:OS(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ts){return this.component?this.component.multipleInstances?e:ts:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function OS(n){return n===ts?void 0:n}function MS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new DS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp=[];var le;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(le||(le={}));const I0={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},LS=le.INFO,FS={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},BS=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=FS[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hp{constructor(e){this.name=e,this._logLevel=LS,this._logHandler=BS,this._userLogHandler=null,cp.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?I0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}function jS(n){cp.forEach(e=>{e.setLogLevel(n)})}function US(n,e){for(const t of cp){let r=null;e&&e.level&&(r=I0[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,i,...o)=>{const a=o.map(u=>{if(u==null)return null;if(typeof u=="string")return u;if(typeof u=="number"||typeof u=="boolean")return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");i>=(r??s.logLevel)&&n({level:le[i].toLowerCase(),message:a,args:o,type:s.name})}}}const zS=(n,e)=>e.some(t=>n instanceof t);let ky,Vy;function $S(){return ky||(ky=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qS(){return Vy||(Vy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const T0=new WeakMap,Md=new WeakMap,x0=new WeakMap,Nh=new WeakMap,dp=new WeakMap;function KS(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Ar(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&T0.set(t,n)}).catch(()=>{}),dp.set(e,n),e}function GS(n){if(Md.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Md.set(n,e)}let Ld={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Md.get(n);if(e==="objectStoreNames")return n.objectStoreNames||x0.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ar(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function WS(n){Ld=n(Ld)}function QS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Dh(this),e,...t);return x0.set(r,e.sort?e.sort():[e]),Ar(r)}:qS().includes(n)?function(...e){return n.apply(Dh(this),e),Ar(T0.get(this))}:function(...e){return Ar(n.apply(Dh(this),e))}}function HS(n){return typeof n=="function"?QS(n):(n instanceof IDBTransaction&&GS(n),zS(n,$S())?new Proxy(n,Ld):n)}function Ar(n){if(n instanceof IDBRequest)return KS(n);if(Nh.has(n))return Nh.get(n);const e=HS(n);return e!==n&&(Nh.set(n,e),dp.set(e,n)),e}const Dh=n=>dp.get(n);function YS(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Ar(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Ar(o.result),u.oldVersion,u.newVersion,Ar(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const XS=["get","getKey","getAll","getAllKeys","count"],JS=["put","add","delete","clear"],Oh=new Map;function Ny(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Oh.get(e))return Oh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=JS.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||XS.includes(t)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&u.done]))[0]};return Oh.set(e,i),i}WS(n=>({...n,get:(e,t,r)=>Ny(e,t)||n.get(e,t,r),has:(e,t)=>!!Ny(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(e1(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function e1(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Lu="@firebase/app",Fd="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=new hp("@firebase/app"),t1="@firebase/app-compat",n1="@firebase/analytics-compat",r1="@firebase/analytics",s1="@firebase/app-check-compat",i1="@firebase/app-check",o1="@firebase/auth",a1="@firebase/auth-compat",l1="@firebase/database",u1="@firebase/data-connect",c1="@firebase/database-compat",h1="@firebase/functions",d1="@firebase/functions-compat",f1="@firebase/installations",p1="@firebase/installations-compat",m1="@firebase/messaging",g1="@firebase/messaging-compat",y1="@firebase/performance",_1="@firebase/performance-compat",v1="@firebase/remote-config",w1="@firebase/remote-config-compat",E1="@firebase/storage",I1="@firebase/storage-compat",T1="@firebase/firestore",x1="@firebase/vertexai-preview",A1="@firebase/firestore-compat",S1="firebase",R1="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="[DEFAULT]",P1={[Lu]:"fire-core",[t1]:"fire-core-compat",[r1]:"fire-analytics",[n1]:"fire-analytics-compat",[i1]:"fire-app-check",[s1]:"fire-app-check-compat",[o1]:"fire-auth",[a1]:"fire-auth-compat",[l1]:"fire-rtdb",[u1]:"fire-data-connect",[c1]:"fire-rtdb-compat",[h1]:"fire-fn",[d1]:"fire-fn-compat",[f1]:"fire-iid",[p1]:"fire-iid-compat",[m1]:"fire-fcm",[g1]:"fire-fcm-compat",[y1]:"fire-perf",[_1]:"fire-perf-compat",[v1]:"fire-rc",[w1]:"fire-rc-compat",[E1]:"fire-gcs",[I1]:"fire-gcs-compat",[T1]:"fire-fst",[A1]:"fire-fst-compat",[x1]:"fire-vertex","fire-js":"fire-js",[S1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br=new Map,Pi=new Map,Ci=new Map;function va(n,e){try{n.container.addComponent(e)}catch(t){qn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function A0(n,e){n.container.addOrOverwriteComponent(e)}function bi(n){const e=n.name;if(Ci.has(e))return qn.debug(`There were multiple attempts to register component ${e}.`),!1;Ci.set(e,n);for(const t of br.values())va(t,n);for(const t of Pi.values())va(t,n);return!0}function S0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function C1(n,e,t=Cr){S0(n,e).clearInstance(t)}function R0(n){return n.options!==void 0}function b1(n){return n.settings!==void 0}function k1(){Ci.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},rn=new pc("app","Firebase",V1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P0=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Is("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw rn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1 extends P0{constructor(e,t,r,s){const i=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:i};if(e.apiKey!==void 0)super(e,o,s);else{const a=e;super(a.options,o,s)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Bn(Lu,Fd,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){mp(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw rn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp=R1;function pp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Cr,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw rn.create("bad-app-name",{appName:String(s)});if(t||(t=y0()),!t)throw rn.create("no-options");const i=br.get(s);if(i){if(_a(t,i.options)&&_a(r,i.config))return i;throw rn.create("duplicate-app",{appName:s})}const o=new E0(s);for(const u of Ci.values())o.addComponent(u);const a=new P0(t,r,o);return br.set(s,a),a}function D1(n,e){if(SS()&&!_0())throw rn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;R0(n)?t=n.options:t=n;const r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const s=c=>[...c].reduce((d,f)=>Math.imul(31,d)+f.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw rn.create("finalization-registry-not-supported",{});const i=""+s(JSON.stringify(r)),o=Pi.get(i);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new E0(i);for(const c of Ci.values())a.addComponent(c);const u=new N1(t,e,i,a);return Pi.set(i,u),u}function O1(n=Cr){const e=br.get(n);if(!e&&n===Cr&&y0())return pp();if(!e)throw rn.create("no-app",{appName:n});return e}function M1(){return Array.from(br.values())}async function mp(n){let e=!1;const t=n.name;br.has(t)?(e=!0,br.delete(t)):Pi.has(t)&&n.decRefCount()<=0&&(Pi.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function Bn(n,e,t){var r;let s=(r=P1[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qn.warn(a.join(" "));return}bi(new Is(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function C0(n,e){if(n!==null&&typeof n!="function")throw rn.create("invalid-log-argument");US(n,e)}function b0(n){jS(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1="firebase-heartbeat-database",F1=1,wa="firebase-heartbeat-store";let Mh=null;function k0(){return Mh||(Mh=YS(L1,F1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wa)}catch(t){console.warn(t)}}}}).catch(n=>{throw rn.create("idb-open",{originalErrorMessage:n.message})})),Mh}async function B1(n){try{const t=(await k0()).transaction(wa),r=await t.objectStore(wa).get(V0(n));return await t.done,r}catch(e){if(e instanceof Ds)qn.warn(e.message);else{const t=rn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qn.warn(t.message)}}}async function Dy(n,e){try{const r=(await k0()).transaction(wa,"readwrite");await r.objectStore(wa).put(e,V0(n)),await r.done}catch(t){if(t instanceof Ds)qn.warn(t.message);else{const r=rn.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});qn.warn(r.message)}}}function V0(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=1024,U1=30*24*60*60*1e3;class z1{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new q1(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Oy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=U1}),this._storage.overwrite(this._heartbeatsCache))}catch(r){qn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Oy(),{heartbeatsToSend:r,unsentEntries:s}=$1(this._heartbeatsCache.heartbeats),i=Du(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return qn.warn(t),""}}}function Oy(){return new Date().toISOString().substring(0,10)}function $1(n,e=j1){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),My(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),My(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class q1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w0()?RS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await B1(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function My(n){return Du(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n){bi(new Is("platform-logger",e=>new ZS(e),"PRIVATE")),bi(new Is("heartbeat",e=>new z1(e),"PRIVATE")),Bn(Lu,Fd,n),Bn(Lu,Fd,"esm2017"),Bn("fire-js","")}K1("");const G1=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Ds,SDK_VERSION:fp,_DEFAULT_ENTRY_NAME:Cr,_addComponent:va,_addOrOverwriteComponent:A0,_apps:br,_clearComponents:k1,_components:Ci,_getProvider:S0,_isFirebaseApp:R0,_isFirebaseServerApp:b1,_registerComponent:bi,_removeServiceInstance:C1,_serverApps:Pi,deleteApp:mp,getApp:O1,getApps:M1,initializeApp:pp,initializeServerApp:D1,onLog:C0,registerVersion:Bn,setLogLevel:b0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,t){this._delegate=e,this.firebase=t,va(e,new Is("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),mp(this._delegate)))}_getService(e,t=Cr){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=Cr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){va(this._delegate,e)}_addOrOverwriteComponent(e){A0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ly=new pc("app-compat","Firebase",Q1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(n){const e={},t={__esModule:!0,initializeApp:i,app:s,registerVersion:Bn,setLogLevel:b0,onLog:C0,apps:null,SDK_VERSION:fp,INTERNAL:{registerComponent:a,removeApp:r,useAsService:u,modularAPIs:G1}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(c){delete e[c]}function s(c){if(c=c||Cr,!Cy(e,c))throw Ly.create("no-app",{appName:c});return e[c]}s.App=n;function i(c,d={}){const f=pp(c,d);if(Cy(e,f.name))return e[f.name];const m=new n(f,t);return e[f.name]=m,m}function o(){return Object.keys(e).map(c=>e[c])}function a(c){const d=c.name,f=d.replace("-compat","");if(bi(c)&&c.type==="PUBLIC"){const m=(_=s())=>{if(typeof _[f]!="function")throw Ly.create("invalid-app-argument",{appName:d});return _[f]()};c.serviceProps!==void 0&&Ou(m,c.serviceProps),t[f]=m,n.prototype[f]=function(..._){return this._getService.bind(this,d).apply(this,c.multipleInstances?_:[])}}return c.type==="PUBLIC"?t[f]:null}function u(c,d){return d==="serverAuth"?null:d}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(){const n=H1(W1);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:N0,extendNamespace:e,createSubscribe:kS,ErrorFactory:pc,deepExtend:Ou});function e(t){Ou(n,t)}return n}const Y1=N0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=new hp("@firebase/app-compat"),X1="@firebase/app-compat",J1="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(n){Bn(X1,J1,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=m0();if(n.firebase!==void 0){Fy.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Fy.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const ki=Y1;Z1();var eR="firebase",tR="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ki.registerVersion(eR,tR,"app-compat");var By=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ms,D0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,g){function v(){}v.prototype=g.prototype,w.D=g.prototype,w.prototype=new v,w.prototype.constructor=w,w.C=function(I,S,P){for(var T=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)T[ge-2]=arguments[ge];return g.prototype[S].apply(I,T)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,g,v){v||(v=0);var I=Array(16);if(typeof g=="string")for(var S=0;16>S;++S)I[S]=g.charCodeAt(v++)|g.charCodeAt(v++)<<8|g.charCodeAt(v++)<<16|g.charCodeAt(v++)<<24;else for(S=0;16>S;++S)I[S]=g[v++]|g[v++]<<8|g[v++]<<16|g[v++]<<24;g=w.g[0],v=w.g[1],S=w.g[2];var P=w.g[3],T=g+(P^v&(S^P))+I[0]+3614090360&4294967295;g=v+(T<<7&4294967295|T>>>25),T=P+(S^g&(v^S))+I[1]+3905402710&4294967295,P=g+(T<<12&4294967295|T>>>20),T=S+(v^P&(g^v))+I[2]+606105819&4294967295,S=P+(T<<17&4294967295|T>>>15),T=v+(g^S&(P^g))+I[3]+3250441966&4294967295,v=S+(T<<22&4294967295|T>>>10),T=g+(P^v&(S^P))+I[4]+4118548399&4294967295,g=v+(T<<7&4294967295|T>>>25),T=P+(S^g&(v^S))+I[5]+1200080426&4294967295,P=g+(T<<12&4294967295|T>>>20),T=S+(v^P&(g^v))+I[6]+2821735955&4294967295,S=P+(T<<17&4294967295|T>>>15),T=v+(g^S&(P^g))+I[7]+4249261313&4294967295,v=S+(T<<22&4294967295|T>>>10),T=g+(P^v&(S^P))+I[8]+1770035416&4294967295,g=v+(T<<7&4294967295|T>>>25),T=P+(S^g&(v^S))+I[9]+2336552879&4294967295,P=g+(T<<12&4294967295|T>>>20),T=S+(v^P&(g^v))+I[10]+4294925233&4294967295,S=P+(T<<17&4294967295|T>>>15),T=v+(g^S&(P^g))+I[11]+2304563134&4294967295,v=S+(T<<22&4294967295|T>>>10),T=g+(P^v&(S^P))+I[12]+1804603682&4294967295,g=v+(T<<7&4294967295|T>>>25),T=P+(S^g&(v^S))+I[13]+4254626195&4294967295,P=g+(T<<12&4294967295|T>>>20),T=S+(v^P&(g^v))+I[14]+2792965006&4294967295,S=P+(T<<17&4294967295|T>>>15),T=v+(g^S&(P^g))+I[15]+1236535329&4294967295,v=S+(T<<22&4294967295|T>>>10),T=g+(S^P&(v^S))+I[1]+4129170786&4294967295,g=v+(T<<5&4294967295|T>>>27),T=P+(v^S&(g^v))+I[6]+3225465664&4294967295,P=g+(T<<9&4294967295|T>>>23),T=S+(g^v&(P^g))+I[11]+643717713&4294967295,S=P+(T<<14&4294967295|T>>>18),T=v+(P^g&(S^P))+I[0]+3921069994&4294967295,v=S+(T<<20&4294967295|T>>>12),T=g+(S^P&(v^S))+I[5]+3593408605&4294967295,g=v+(T<<5&4294967295|T>>>27),T=P+(v^S&(g^v))+I[10]+38016083&4294967295,P=g+(T<<9&4294967295|T>>>23),T=S+(g^v&(P^g))+I[15]+3634488961&4294967295,S=P+(T<<14&4294967295|T>>>18),T=v+(P^g&(S^P))+I[4]+3889429448&4294967295,v=S+(T<<20&4294967295|T>>>12),T=g+(S^P&(v^S))+I[9]+568446438&4294967295,g=v+(T<<5&4294967295|T>>>27),T=P+(v^S&(g^v))+I[14]+3275163606&4294967295,P=g+(T<<9&4294967295|T>>>23),T=S+(g^v&(P^g))+I[3]+4107603335&4294967295,S=P+(T<<14&4294967295|T>>>18),T=v+(P^g&(S^P))+I[8]+1163531501&4294967295,v=S+(T<<20&4294967295|T>>>12),T=g+(S^P&(v^S))+I[13]+2850285829&4294967295,g=v+(T<<5&4294967295|T>>>27),T=P+(v^S&(g^v))+I[2]+4243563512&4294967295,P=g+(T<<9&4294967295|T>>>23),T=S+(g^v&(P^g))+I[7]+1735328473&4294967295,S=P+(T<<14&4294967295|T>>>18),T=v+(P^g&(S^P))+I[12]+2368359562&4294967295,v=S+(T<<20&4294967295|T>>>12),T=g+(v^S^P)+I[5]+4294588738&4294967295,g=v+(T<<4&4294967295|T>>>28),T=P+(g^v^S)+I[8]+2272392833&4294967295,P=g+(T<<11&4294967295|T>>>21),T=S+(P^g^v)+I[11]+1839030562&4294967295,S=P+(T<<16&4294967295|T>>>16),T=v+(S^P^g)+I[14]+4259657740&4294967295,v=S+(T<<23&4294967295|T>>>9),T=g+(v^S^P)+I[1]+2763975236&4294967295,g=v+(T<<4&4294967295|T>>>28),T=P+(g^v^S)+I[4]+1272893353&4294967295,P=g+(T<<11&4294967295|T>>>21),T=S+(P^g^v)+I[7]+4139469664&4294967295,S=P+(T<<16&4294967295|T>>>16),T=v+(S^P^g)+I[10]+3200236656&4294967295,v=S+(T<<23&4294967295|T>>>9),T=g+(v^S^P)+I[13]+681279174&4294967295,g=v+(T<<4&4294967295|T>>>28),T=P+(g^v^S)+I[0]+3936430074&4294967295,P=g+(T<<11&4294967295|T>>>21),T=S+(P^g^v)+I[3]+3572445317&4294967295,S=P+(T<<16&4294967295|T>>>16),T=v+(S^P^g)+I[6]+76029189&4294967295,v=S+(T<<23&4294967295|T>>>9),T=g+(v^S^P)+I[9]+3654602809&4294967295,g=v+(T<<4&4294967295|T>>>28),T=P+(g^v^S)+I[12]+3873151461&4294967295,P=g+(T<<11&4294967295|T>>>21),T=S+(P^g^v)+I[15]+530742520&4294967295,S=P+(T<<16&4294967295|T>>>16),T=v+(S^P^g)+I[2]+3299628645&4294967295,v=S+(T<<23&4294967295|T>>>9),T=g+(S^(v|~P))+I[0]+4096336452&4294967295,g=v+(T<<6&4294967295|T>>>26),T=P+(v^(g|~S))+I[7]+1126891415&4294967295,P=g+(T<<10&4294967295|T>>>22),T=S+(g^(P|~v))+I[14]+2878612391&4294967295,S=P+(T<<15&4294967295|T>>>17),T=v+(P^(S|~g))+I[5]+4237533241&4294967295,v=S+(T<<21&4294967295|T>>>11),T=g+(S^(v|~P))+I[12]+1700485571&4294967295,g=v+(T<<6&4294967295|T>>>26),T=P+(v^(g|~S))+I[3]+2399980690&4294967295,P=g+(T<<10&4294967295|T>>>22),T=S+(g^(P|~v))+I[10]+4293915773&4294967295,S=P+(T<<15&4294967295|T>>>17),T=v+(P^(S|~g))+I[1]+2240044497&4294967295,v=S+(T<<21&4294967295|T>>>11),T=g+(S^(v|~P))+I[8]+1873313359&4294967295,g=v+(T<<6&4294967295|T>>>26),T=P+(v^(g|~S))+I[15]+4264355552&4294967295,P=g+(T<<10&4294967295|T>>>22),T=S+(g^(P|~v))+I[6]+2734768916&4294967295,S=P+(T<<15&4294967295|T>>>17),T=v+(P^(S|~g))+I[13]+1309151649&4294967295,v=S+(T<<21&4294967295|T>>>11),T=g+(S^(v|~P))+I[4]+4149444226&4294967295,g=v+(T<<6&4294967295|T>>>26),T=P+(v^(g|~S))+I[11]+3174756917&4294967295,P=g+(T<<10&4294967295|T>>>22),T=S+(g^(P|~v))+I[2]+718787259&4294967295,S=P+(T<<15&4294967295|T>>>17),T=v+(P^(S|~g))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(S+(T<<21&4294967295|T>>>11))&4294967295,w.g[2]=w.g[2]+S&4294967295,w.g[3]=w.g[3]+P&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var v=g-this.blockSize,I=this.B,S=this.h,P=0;P<g;){if(S==0)for(;P<=v;)s(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<g;)if(I[S++]=w.charCodeAt(P++),S==this.blockSize){s(this,I),S=0;break}}else for(;P<g;)if(I[S++]=w[P++],S==this.blockSize){s(this,I),S=0;break}}this.h=S,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var v=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=v&255,v/=256;for(this.u(w),w=Array(16),g=v=0;4>g;++g)for(var I=0;32>I;I+=8)w[v++]=this.g[g]>>>I&255;return w};function i(w,g){var v=a;return Object.prototype.hasOwnProperty.call(v,w)?v[w]:v[w]=g(w)}function o(w,g){this.h=g;for(var v=[],I=!0,S=w.length-1;0<=S;S--){var P=w[S]|0;I&&P==g||(v[S]=P,I=!1)}this.g=v}var a={};function u(w){return-128<=w&&128>w?i(w,function(g){return new o([g|0],0>g?-1:0)}):new o([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return f;if(0>w)return N(c(-w));for(var g=[],v=1,I=0;w>=v;I++)g[I]=w/v|0,v*=4294967296;return new o(g,0)}function d(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return N(d(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=c(Math.pow(g,8)),I=f,S=0;S<w.length;S+=8){var P=Math.min(8,w.length-S),T=parseInt(w.substring(S,S+P),g);8>P?(P=c(Math.pow(g,P)),I=I.j(P).add(c(T))):(I=I.j(v),I=I.add(c(T)))}return I}var f=u(0),m=u(1),_=u(16777216);n=o.prototype,n.m=function(){if(b(this))return-N(this).m();for(var w=0,g=1,v=0;v<this.g.length;v++){var I=this.i(v);w+=(0<=I?I:4294967296+I)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(R(this))return"0";if(b(this))return"-"+N(this).toString(w);for(var g=c(Math.pow(w,6)),v=this,I="";;){var S=D(v,g).g;v=x(v,S.j(g));var P=((0<v.g.length?v.g[0]:v.h)>>>0).toString(w);if(v=S,R(v))return P+I;for(;6>P.length;)P="0"+P;I=P+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function R(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function b(w){return w.h==-1}n.l=function(w){return w=x(this,w),b(w)?-1:R(w)?0:1};function N(w){for(var g=w.g.length,v=[],I=0;I<g;I++)v[I]=~w.g[I];return new o(v,~w.h).add(m)}n.abs=function(){return b(this)?N(this):this},n.add=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0,S=0;S<=g;S++){var P=I+(this.i(S)&65535)+(w.i(S)&65535),T=(P>>>16)+(this.i(S)>>>16)+(w.i(S)>>>16);I=T>>>16,P&=65535,T&=65535,v[S]=T<<16|P}return new o(v,v[v.length-1]&-2147483648?-1:0)};function x(w,g){return w.add(N(g))}n.j=function(w){if(R(this)||R(w))return f;if(b(this))return b(w)?N(this).j(N(w)):N(N(this).j(w));if(b(w))return N(this.j(N(w)));if(0>this.l(_)&&0>w.l(_))return c(this.m()*w.m());for(var g=this.g.length+w.g.length,v=[],I=0;I<2*g;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var S=0;S<w.g.length;S++){var P=this.i(I)>>>16,T=this.i(I)&65535,ge=w.i(S)>>>16,et=w.i(S)&65535;v[2*I+2*S]+=T*et,E(v,2*I+2*S),v[2*I+2*S+1]+=P*et,E(v,2*I+2*S+1),v[2*I+2*S+1]+=T*ge,E(v,2*I+2*S+1),v[2*I+2*S+2]+=P*ge,E(v,2*I+2*S+2)}for(I=0;I<g;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=g;I<2*g;I++)v[I]=0;return new o(v,0)};function E(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function A(w,g){this.g=w,this.h=g}function D(w,g){if(R(g))throw Error("division by zero");if(R(w))return new A(f,f);if(b(w))return g=D(N(w),g),new A(N(g.g),N(g.h));if(b(g))return g=D(w,N(g)),new A(N(g.g),g.h);if(30<w.g.length){if(b(w)||b(g))throw Error("slowDivide_ only works with positive integers.");for(var v=m,I=g;0>=I.l(w);)v=B(v),I=B(I);var S=L(v,1),P=L(I,1);for(I=L(I,2),v=L(v,2);!R(I);){var T=P.add(I);0>=T.l(w)&&(S=S.add(v),P=T),I=L(I,1),v=L(v,1)}return g=x(w,S.j(g)),new A(S,g)}for(S=f;0<=w.l(g);){for(v=Math.max(1,Math.floor(w.m()/g.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),P=c(v),T=P.j(g);b(T)||0<T.l(w);)v-=I,P=c(v),T=P.j(g);R(P)&&(P=m),S=S.add(P),w=x(w,T)}return new A(S,w)}n.A=function(w){return D(this,w).h},n.and=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0;I<g;I++)v[I]=this.i(I)&w.i(I);return new o(v,this.h&w.h)},n.or=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0;I<g;I++)v[I]=this.i(I)|w.i(I);return new o(v,this.h|w.h)},n.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),v=[],I=0;I<g;I++)v[I]=this.i(I)^w.i(I);return new o(v,this.h^w.h)};function B(w){for(var g=w.g.length+1,v=[],I=0;I<g;I++)v[I]=w.i(I)<<1|w.i(I-1)>>>31;return new o(v,w.h)}function L(w,g){var v=g>>5;g%=32;for(var I=w.g.length-v,S=[],P=0;P<I;P++)S[P]=0<g?w.i(P+v)>>>g|w.i(P+v+1)<<32-g:w.i(P+v);return new o(S,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,D0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,ms=o}).apply(typeof By<"u"?By:typeof self<"u"?self:typeof window<"u"?window:{});var Ol=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var O0,Oo,M0,tu,Bd,L0,F0,B0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ol=="object"&&Ol];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var k=l[y];if(!(k in p))break e;p=p[k]}l=l[l.length-1],y=p[l],h=h(y),h!=y&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,y=!1,k={next:function(){if(!y&&p<l.length){var M=p++;return{value:h(M,l[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,y),l.apply(h,k)}}return function(){return l.apply(h,arguments)}}function m(l,h,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function _(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function R(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(y,k,M){for(var z=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)z[Ie-2]=arguments[Ie];return h.prototype[k].apply(y,z)}}function b(l){const h=l.length;if(0<h){const p=Array(h);for(let y=0;y<h;y++)p[y]=l[y];return p}return[]}function N(l,h){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(u(y)){const k=l.length||0,M=y.length||0;l.length=k+M;for(let z=0;z<M;z++)l[k+z]=y[z]}else l.push(y)}}class x{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function E(l){return/^[\s\xa0]*$/.test(l)}function A(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function D(l){return D[" "](l),l}D[" "]=function(){};var B=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function L(l,h,p){for(const y in l)h.call(p,l[y],y,l)}function w(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function g(l){const h={};for(const p in l)h[p]=l[p];return h}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(l,h){let p,y;for(let k=1;k<arguments.length;k++){y=arguments[k];for(p in y)l[p]=y[p];for(let M=0;M<v.length;M++)p=v[M],Object.prototype.hasOwnProperty.call(y,p)&&(l[p]=y[p])}}function S(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function P(l){a.setTimeout(()=>{throw l},0)}function T(){var l=Z;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ge{constructor(){this.h=this.g=null}add(h,p){const y=et.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var et=new x(()=>new Yt,l=>l.reset());class Yt{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,q=!1,Z=new ge,ee=()=>{const l=a.Promise.resolve(void 0);Ae=()=>{l.then(ye)}};var ye=()=>{for(var l;l=T();){try{l.h.call(l.g)}catch(p){P(p)}var h=et;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}q=!1};function ue(){this.s=this.s,this.C=this.C}ue.prototype.s=!1,ue.prototype.ma=function(){this.s||(this.s=!0,this.N())},ue.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function he(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}he.prototype.h=function(){this.defaultPrevented=!0};var $e=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function it(l,h){if(he.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(B){e:{try{D(h.nodeName);var k=!0;break e}catch{}k=!1}k||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:H[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&it.aa.h.call(this)}}R(it,he);var H={2:"touch",3:"pen",4:"mouse"};it.prototype.h=function(){it.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function Be(l,h,p,y,k){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=k,this.key=++Ee,this.da=this.fa=!1}function Cn(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Xt(l){this.src=l,this.g={},this.h=0}Xt.prototype.add=function(l,h,p,y,k){var M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);var z=no(l,h,y,k);return-1<z?(h=l[z],p||(h.fa=!1)):(h=new Be(h,this.src,M,!!y,k),h.fa=p,l.push(h)),h};function js(l,h){var p=h.type;if(p in l.g){var y=l.g[p],k=Array.prototype.indexOf.call(y,h,void 0),M;(M=0<=k)&&Array.prototype.splice.call(y,k,1),M&&(Cn(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function no(l,h,p,y){for(var k=0;k<l.length;++k){var M=l[k];if(!M.da&&M.listener==h&&M.capture==!!p&&M.ha==y)return k}return-1}var ro="closure_lm_"+(1e6*Math.random()|0),jc={};function wm(l,h,p,y,k){if(Array.isArray(h)){for(var M=0;M<h.length;M++)wm(l,h[M],p,y,k);return null}return p=Tm(p),l&&l[ne]?l.K(h,p,c(y)?!!y.capture:!1,k):dT(l,h,p,!1,y,k)}function dT(l,h,p,y,k,M){if(!h)throw Error("Invalid event type");var z=c(k)?!!k.capture:!!k,Ie=zc(l);if(Ie||(l[ro]=Ie=new Xt(l)),p=Ie.add(h,p,y,z,M),p.proxy)return p;if(y=fT(),p.proxy=y,y.src=l,y.listener=p,l.addEventListener)$e||(k=z),k===void 0&&(k=!1),l.addEventListener(h.toString(),y,k);else if(l.attachEvent)l.attachEvent(Im(h.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function fT(){function l(p){return h.call(l.src,l.listener,p)}const h=pT;return l}function Em(l,h,p,y,k){if(Array.isArray(h))for(var M=0;M<h.length;M++)Em(l,h[M],p,y,k);else y=c(y)?!!y.capture:!!y,p=Tm(p),l&&l[ne]?(l=l.i,h=String(h).toString(),h in l.g&&(M=l.g[h],p=no(M,p,y,k),-1<p&&(Cn(M[p]),Array.prototype.splice.call(M,p,1),M.length==0&&(delete l.g[h],l.h--)))):l&&(l=zc(l))&&(h=l.g[h.toString()],l=-1,h&&(l=no(h,p,y,k)),(p=-1<l?h[l]:null)&&Uc(p))}function Uc(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[ne])js(h.i,l);else{var p=l.type,y=l.proxy;h.removeEventListener?h.removeEventListener(p,y,l.capture):h.detachEvent?h.detachEvent(Im(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=zc(h))?(js(p,l),p.h==0&&(p.src=null,h[ro]=null)):Cn(l)}}}function Im(l){return l in jc?jc[l]:jc[l]="on"+l}function pT(l,h){if(l.da)l=!0;else{h=new it(h,this);var p=l.listener,y=l.ha||l.src;l.fa&&Uc(l),l=p.call(y,h)}return l}function zc(l){return l=l[ro],l instanceof Xt?l:null}var $c="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tm(l){return typeof l=="function"?l:(l[$c]||(l[$c]=function(h){return l.handleEvent(h)}),l[$c])}function ft(){ue.call(this),this.i=new Xt(this),this.M=this,this.F=null}R(ft,ue),ft.prototype[ne]=!0,ft.prototype.removeEventListener=function(l,h,p,y){Em(this,l,h,p,y)};function It(l,h){var p,y=l.F;if(y)for(p=[];y;y=y.F)p.push(y);if(l=l.M,y=h.type||h,typeof h=="string")h=new he(h,l);else if(h instanceof he)h.target=h.target||l;else{var k=h;h=new he(y,l),I(h,k)}if(k=!0,p)for(var M=p.length-1;0<=M;M--){var z=h.g=p[M];k=nl(z,y,!0,h)&&k}if(z=h.g=l,k=nl(z,y,!0,h)&&k,k=nl(z,y,!1,h)&&k,p)for(M=0;M<p.length;M++)z=h.g=p[M],k=nl(z,y,!1,h)&&k}ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],y=0;y<p.length;y++)Cn(p[y]);delete l.g[h],l.h--}}this.F=null},ft.prototype.K=function(l,h,p,y){return this.i.add(String(l),h,!1,p,y)},ft.prototype.L=function(l,h,p,y){return this.i.add(String(l),h,!0,p,y)};function nl(l,h,p,y){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var k=!0,M=0;M<h.length;++M){var z=h[M];if(z&&!z.da&&z.capture==p){var Ie=z.listener,ot=z.ha||z.src;z.fa&&js(l.i,z),k=Ie.call(ot,y)!==!1&&k}}return k&&!y.defaultPrevented}function xm(l,h,p){if(typeof l=="function")p&&(l=m(l,p));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Am(l){l.g=xm(()=>{l.g=null,l.i&&(l.i=!1,Am(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class mT extends ue{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Am(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function so(l){ue.call(this),this.h=l,this.g={}}R(so,ue);var Sm=[];function Rm(l){L(l.g,function(h,p){this.g.hasOwnProperty(p)&&Uc(h)},l),l.g={}}so.prototype.N=function(){so.aa.N.call(this),Rm(this)},so.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qc=a.JSON.stringify,gT=a.JSON.parse,yT=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Kc(){}Kc.prototype.h=null;function Pm(l){return l.h||(l.h=l.i())}function Cm(){}var io={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Gc(){he.call(this,"d")}R(Gc,he);function Wc(){he.call(this,"c")}R(Wc,he);var Qr={},bm=null;function rl(){return bm=bm||new ft}Qr.La="serverreachability";function km(l){he.call(this,Qr.La,l)}R(km,he);function oo(l){const h=rl();It(h,new km(h))}Qr.STAT_EVENT="statevent";function Vm(l,h){he.call(this,Qr.STAT_EVENT,l),this.stat=h}R(Vm,he);function Tt(l){const h=rl();It(h,new Vm(h,l))}Qr.Ma="timingevent";function Nm(l,h){he.call(this,Qr.Ma,l),this.size=h}R(Nm,he);function ao(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function lo(){this.g=!0}lo.prototype.xa=function(){this.g=!1};function _T(l,h,p,y,k,M){l.info(function(){if(l.g)if(M)for(var z="",Ie=M.split("&"),ot=0;ot<Ie.length;ot++){var fe=Ie[ot].split("=");if(1<fe.length){var pt=fe[0];fe=fe[1];var mt=pt.split("_");z=2<=mt.length&&mt[1]=="type"?z+(pt+"="+fe+"&"):z+(pt+"=redacted&")}}else z=null;else z=M;return"XMLHTTP REQ ("+y+") [attempt "+k+"]: "+h+`
`+p+`
`+z})}function vT(l,h,p,y,k,M,z){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+k+"]: "+h+`
`+p+`
`+M+" "+z})}function Us(l,h,p,y){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+ET(l,p)+(y?" "+y:"")})}function wT(l,h){l.info(function(){return"TIMEOUT: "+h})}lo.prototype.info=function(){};function ET(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var y=p[l];if(!(2>y.length)){var k=y[1];if(Array.isArray(k)&&!(1>k.length)){var M=k[0];if(M!="noop"&&M!="stop"&&M!="close")for(var z=1;z<k.length;z++)k[z]=""}}}}return qc(p)}catch{return h}}var sl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Dm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Qc;function il(){}R(il,Kc),il.prototype.g=function(){return new XMLHttpRequest},il.prototype.i=function(){return{}},Qc=new il;function Jn(l,h,p,y){this.j=l,this.i=h,this.l=p,this.R=y||1,this.U=new so(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Om}function Om(){this.i=null,this.g="",this.h=!1}var Mm={},Hc={};function Yc(l,h,p){l.L=1,l.v=ul(bn(h)),l.m=p,l.P=!0,Lm(l,null)}function Lm(l,h){l.F=Date.now(),ol(l),l.A=bn(l.v);var p=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),Xm(p.i,"t",y),l.C=0,p=l.j.J,l.h=new Om,l.g=mg(l.j,p?h:null,!l.m),0<l.O&&(l.M=new mT(m(l.Y,l,l.g),l.O)),h=l.U,p=l.g,y=l.ca;var k="readystatechange";Array.isArray(k)||(k&&(Sm[0]=k.toString()),k=Sm);for(var M=0;M<k.length;M++){var z=wm(p,k[M],y||h.handleEvent,!1,h.h||h);if(!z)break;h.g[z.key]=z}h=l.H?g(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),oo(),_T(l.i,l.u,l.A,l.l,l.R,l.m)}Jn.prototype.ca=function(l){l=l.target;const h=this.M;h&&kn(l)==3?h.j():this.Y(l)},Jn.prototype.Y=function(l){try{if(l==this.g)e:{const mt=kn(this.g);var h=this.g.Ba();const qs=this.g.Z();if(!(3>mt)&&(mt!=3||this.g&&(this.h.h||this.g.oa()||sg(this.g)))){this.J||mt!=4||h==7||(h==8||0>=qs?oo(3):oo(2)),Xc(this);var p=this.g.Z();this.X=p;t:if(Fm(this)){var y=sg(this.g);l="";var k=y.length,M=kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Hr(this),uo(this);var z="";break t}this.h.i=new a.TextDecoder}for(h=0;h<k;h++)this.h.h=!0,l+=this.h.i.decode(y[h],{stream:!(M&&h==k-1)});y.length=0,this.h.g+=l,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=p==200,vT(this.i,this.u,this.A,this.l,this.R,mt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,ot=this.g;if((Ie=ot.g?ot.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(Ie)){var fe=Ie;break t}}fe=null}if(p=fe)Us(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jc(this,p);else{this.o=!1,this.s=3,Tt(12),Hr(this),uo(this);break e}}if(this.P){p=!0;let an;for(;!this.J&&this.C<z.length;)if(an=IT(this,z),an==Hc){mt==4&&(this.s=4,Tt(14),p=!1),Us(this.i,this.l,null,"[Incomplete Response]");break}else if(an==Mm){this.s=4,Tt(15),Us(this.i,this.l,z,"[Invalid Chunk]"),p=!1;break}else Us(this.i,this.l,an,null),Jc(this,an);if(Fm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||z.length!=0||this.h.h||(this.s=1,Tt(16),p=!1),this.o=this.o&&p,!p)Us(this.i,this.l,z,"[Invalid Chunked Response]"),Hr(this),uo(this);else if(0<z.length&&!this.W){this.W=!0;var pt=this.j;pt.g==this&&pt.ba&&!pt.M&&(pt.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),sh(pt),pt.M=!0,Tt(11))}}else Us(this.i,this.l,z,null),Jc(this,z);mt==4&&Hr(this),this.o&&!this.J&&(mt==4?hg(this.j,this):(this.o=!1,ol(this)))}else BT(this.g),p==400&&0<z.indexOf("Unknown SID")?(this.s=3,Tt(12)):(this.s=0,Tt(13)),Hr(this),uo(this)}}}catch{}finally{}};function Fm(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function IT(l,h){var p=l.C,y=h.indexOf(`
`,p);return y==-1?Hc:(p=Number(h.substring(p,y)),isNaN(p)?Mm:(y+=1,y+p>h.length?Hc:(h=h.slice(y,y+p),l.C=y+p,h)))}Jn.prototype.cancel=function(){this.J=!0,Hr(this)};function ol(l){l.S=Date.now()+l.I,Bm(l,l.I)}function Bm(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ao(m(l.ba,l),h)}function Xc(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Jn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(wT(this.i,this.A),this.L!=2&&(oo(),Tt(17)),Hr(this),this.s=2,uo(this)):Bm(this,this.S-l)};function uo(l){l.j.G==0||l.J||hg(l.j,l)}function Hr(l){Xc(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Rm(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Jc(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Zc(p.h,l))){if(!l.K&&Zc(p.h,l)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var k=y;if(k[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)ml(p),fl(p);else break e;rh(p),Tt(18)}}else p.za=k[1],0<p.za-p.T&&37500>k[2]&&p.F&&p.v==0&&!p.C&&(p.C=ao(m(p.Za,p),6e3));if(1>=zm(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Xr(p,11)}else if((l.K||p.g==l)&&ml(p),!E(h))for(k=p.Da.g.parse(h),h=0;h<k.length;h++){let fe=k[h];if(p.T=fe[0],fe=fe[1],p.G==2)if(fe[0]=="c"){p.K=fe[1],p.ia=fe[2];const pt=fe[3];pt!=null&&(p.la=pt,p.j.info("VER="+p.la));const mt=fe[4];mt!=null&&(p.Aa=mt,p.j.info("SVER="+p.Aa));const qs=fe[5];qs!=null&&typeof qs=="number"&&0<qs&&(y=1.5*qs,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const an=l.g;if(an){const yl=an.g?an.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yl){var M=y.h;M.g||yl.indexOf("spdy")==-1&&yl.indexOf("quic")==-1&&yl.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(eh(M,M.h),M.h=null))}if(y.D){const ih=an.g?an.g.getResponseHeader("X-HTTP-Session-Id"):null;ih&&(y.ya=ih,Se(y.I,y.D,ih))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var z=l;if(y.qa=pg(y,y.J?y.ia:null,y.W),z.K){$m(y.h,z);var Ie=z,ot=y.L;ot&&(Ie.I=ot),Ie.B&&(Xc(Ie),ol(Ie)),y.g=z}else ug(y);0<p.i.length&&pl(p)}else fe[0]!="stop"&&fe[0]!="close"||Xr(p,7);else p.G==3&&(fe[0]=="stop"||fe[0]=="close"?fe[0]=="stop"?Xr(p,7):nh(p):fe[0]!="noop"&&p.l&&p.l.ta(fe),p.v=0)}}oo(4)}catch{}}var TT=class{constructor(l,h){this.g=l,this.map=h}};function jm(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Um(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function zm(l){return l.h?1:l.g?l.g.size:0}function Zc(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function eh(l,h){l.g?l.g.add(h):l.h=h}function $m(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}jm.prototype.cancel=function(){if(this.i=qm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function qm(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return b(l.i)}function xT(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],p=l.length,y=0;y<p;y++)h.push(l[y]);return h}h=[],p=0;for(y in l)h[p++]=l[y];return h}function AT(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const y in l)h[p++]=y;return h}}}function Km(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=AT(l),y=xT(l),k=y.length,M=0;M<k;M++)h.call(void 0,y[M],p&&p[M],l)}var Gm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ST(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var y=l[p].indexOf("="),k=null;if(0<=y){var M=l[p].substring(0,y);k=l[p].substring(y+1)}else M=l[p];h(M,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function Yr(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Yr){this.h=l.h,al(this,l.j),this.o=l.o,this.g=l.g,ll(this,l.s),this.l=l.l;var h=l.i,p=new fo;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),Wm(this,p),this.m=l.m}else l&&(h=String(l).match(Gm))?(this.h=!1,al(this,h[1]||"",!0),this.o=co(h[2]||""),this.g=co(h[3]||"",!0),ll(this,h[4]),this.l=co(h[5]||"",!0),Wm(this,h[6]||"",!0),this.m=co(h[7]||"")):(this.h=!1,this.i=new fo(null,this.h))}Yr.prototype.toString=function(){var l=[],h=this.j;h&&l.push(ho(h,Qm,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(ho(h,Qm,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(ho(p,p.charAt(0)=="/"?CT:PT,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",ho(p,kT)),l.join("")};function bn(l){return new Yr(l)}function al(l,h,p){l.j=p?co(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function ll(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Wm(l,h,p){h instanceof fo?(l.i=h,VT(l.i,l.h)):(p||(h=ho(h,bT)),l.i=new fo(h,l.h))}function Se(l,h,p){l.i.set(h,p)}function ul(l){return Se(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function co(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ho(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,RT),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function RT(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Qm=/[#\/\?@]/g,PT=/[#\?:]/g,CT=/[#\?]/g,bT=/[#\?@]/g,kT=/#/g;function fo(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Zn(l){l.g||(l.g=new Map,l.h=0,l.i&&ST(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=fo.prototype,n.add=function(l,h){Zn(this),this.i=null,l=zs(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Hm(l,h){Zn(l),h=zs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Ym(l,h){return Zn(l),h=zs(l,h),l.g.has(h)}n.forEach=function(l,h){Zn(this),this.g.forEach(function(p,y){p.forEach(function(k){l.call(h,k,y,this)},this)},this)},n.na=function(){Zn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){const k=l[y];for(let M=0;M<k.length;M++)p.push(h[y])}return p},n.V=function(l){Zn(this);let h=[];if(typeof l=="string")Ym(this,l)&&(h=h.concat(this.g.get(zs(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Zn(this),this.i=null,l=zs(this,l),Ym(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Xm(l,h,p){Hm(l,h),0<p.length&&(l.i=null,l.g.set(zs(l,h),b(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];const M=encodeURIComponent(String(y)),z=this.V(y);for(y=0;y<z.length;y++){var k=M;z[y]!==""&&(k+="="+encodeURIComponent(String(z[y]))),l.push(k)}}return this.i=l.join("&")};function zs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function VT(l,h){h&&!l.j&&(Zn(l),l.i=null,l.g.forEach(function(p,y){var k=y.toLowerCase();y!=k&&(Hm(this,y),Xm(this,k,p))},l)),l.j=h}function NT(l,h){const p=new lo;if(a.Image){const y=new Image;y.onload=_(er,p,"TestLoadImage: loaded",!0,h,y),y.onerror=_(er,p,"TestLoadImage: error",!1,h,y),y.onabort=_(er,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=_(er,p,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else h(!1)}function DT(l,h){const p=new lo,y=new AbortController,k=setTimeout(()=>{y.abort(),er(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:y.signal}).then(M=>{clearTimeout(k),M.ok?er(p,"TestPingServer: ok",!0,h):er(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(k),er(p,"TestPingServer: error",!1,h)})}function er(l,h,p,y,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),y(p)}catch{}}function OT(){this.g=new yT}function MT(l,h,p){const y=p||"";try{Km(l,function(k,M){let z=k;c(k)&&(z=qc(k)),h.push(y+M+"="+encodeURIComponent(z))})}catch(k){throw h.push(y+"type="+encodeURIComponent("_badmap")),k}}function cl(l){this.l=l.Ub||null,this.j=l.eb||!1}R(cl,Kc),cl.prototype.g=function(){return new hl(this.l,this.j)},cl.prototype.i=function(l){return function(){return l}}({});function hl(l,h){ft.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(hl,ft),n=hl.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,mo(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,po(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,mo(this)),this.g&&(this.readyState=3,mo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jm(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jm(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?po(this):mo(this),this.readyState==3&&Jm(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,po(this))},n.Qa=function(l){this.g&&(this.response=l,po(this))},n.ga=function(){this.g&&po(this)};function po(l){l.readyState=4,l.l=null,l.j=null,l.v=null,mo(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function mo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Zm(l){let h="";return L(l,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function th(l,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Zm(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Se(l,h,p))}function je(l){ft.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(je,ft);var LT=/^https?$/i,FT=["POST","PUT"];n=je.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Qc.g(),this.v=this.o?Pm(this.o):Pm(Qc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(M){eg(this,M);return}if(l=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var k in y)p.set(k,y[k]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const M of y.keys())p.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),k=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(FT,h,void 0))||y||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,z]of p)this.g.setRequestHeader(M,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{rg(this),this.u=!0,this.g.send(l),this.u=!1}catch(M){eg(this,M)}};function eg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,tg(l),dl(l)}function tg(l){l.A||(l.A=!0,It(l,"complete"),It(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,It(this,"complete"),It(this,"abort"),dl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dl(this,!0)),je.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ng(this):this.bb())},n.bb=function(){ng(this)};function ng(l){if(l.h&&typeof o<"u"&&(!l.v[1]||kn(l)!=4||l.Z()!=2)){if(l.u&&kn(l)==4)xm(l.Ea,0,l);else if(It(l,"readystatechange"),kn(l)==4){l.h=!1;try{const z=l.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=z===0){var k=String(l.D).match(Gm)[1]||null;!k&&a.self&&a.self.location&&(k=a.self.location.protocol.slice(0,-1)),y=!LT.test(k?k.toLowerCase():"")}p=y}if(p)It(l,"complete"),It(l,"success");else{l.m=6;try{var M=2<kn(l)?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.Z()+"]",tg(l)}}finally{dl(l)}}}}function dl(l,h){if(l.g){rg(l);const p=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||It(l,"ready");try{p.onreadystatechange=y}catch{}}}function rg(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function kn(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<kn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),gT(h)}};function sg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function BT(l){const h={};l=(l.g&&2<=kn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(E(l[y]))continue;var p=S(l[y]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const M=h[k]||[];h[k]=M,M.push(p)}w(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function go(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function ig(l){this.Aa=0,this.i=[],this.j=new lo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=go("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=go("baseRetryDelayMs",5e3,l),this.cb=go("retryDelaySeedMs",1e4,l),this.Wa=go("forwardChannelMaxRetries",2,l),this.wa=go("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new jm(l&&l.concurrentRequestLimit),this.Da=new OT,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ig.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,y){Tt(0),this.W=l,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=pg(this,null,this.W),pl(this)};function nh(l){if(og(l),l.G==3){var h=l.U++,p=bn(l.I);if(Se(p,"SID",l.K),Se(p,"RID",h),Se(p,"TYPE","terminate"),yo(l,p),h=new Jn(l,l.j,h),h.L=2,h.v=ul(bn(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=mg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ol(h)}fg(l)}function fl(l){l.g&&(sh(l),l.g.cancel(),l.g=null)}function og(l){fl(l),l.u&&(a.clearTimeout(l.u),l.u=null),ml(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function pl(l){if(!Um(l.h)&&!l.s){l.s=!0;var h=l.Ga;Ae||ee(),q||(Ae(),q=!0),Z.add(h,l),l.B=0}}function jT(l,h){return zm(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ao(m(l.Ga,l,h),dg(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const k=new Jn(this,this.j,l);let M=this.o;if(this.S&&(M?(M=g(M),I(M,this.S)):M=this.S),this.m!==null||this.O||(k.H=M,M=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=lg(this,k,h),p=bn(this.I),Se(p,"RID",l),Se(p,"CVER",22),this.D&&Se(p,"X-HTTP-Session-Id",this.D),yo(this,p),M&&(this.O?h="headers="+encodeURIComponent(String(Zm(M)))+"&"+h:this.m&&th(p,this.m,M)),eh(this.h,k),this.Ua&&Se(p,"TYPE","init"),this.P?(Se(p,"$req",h),Se(p,"SID","null"),k.T=!0,Yc(k,p,null)):Yc(k,p,h),this.G=2}}else this.G==3&&(l?ag(this,l):this.i.length==0||Um(this.h)||ag(this))};function ag(l,h){var p;h?p=h.l:p=l.U++;const y=bn(l.I);Se(y,"SID",l.K),Se(y,"RID",p),Se(y,"AID",l.T),yo(l,y),l.m&&l.o&&th(y,l.m,l.o),p=new Jn(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=lg(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),eh(l.h,p),Yc(p,y,h)}function yo(l,h){l.H&&L(l.H,function(p,y){Se(h,y,p)}),l.l&&Km({},function(p,y){Se(h,y,p)})}function lg(l,h,p){p=Math.min(l.i.length,p);var y=l.l?m(l.l.Na,l.l,l):null;e:{var k=l.i;let M=-1;for(;;){const z=["count="+p];M==-1?0<p?(M=k[0].g,z.push("ofs="+M)):M=0:z.push("ofs="+M);let Ie=!0;for(let ot=0;ot<p;ot++){let fe=k[ot].g;const pt=k[ot].map;if(fe-=M,0>fe)M=Math.max(0,k[ot].g-100),Ie=!1;else try{MT(pt,z,"req"+fe+"_")}catch{y&&y(pt)}}if(Ie){y=z.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,y}function ug(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Ae||ee(),q||(Ae(),q=!0),Z.add(h,l),l.v=0}}function rh(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ao(m(l.Fa,l),dg(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,cg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ao(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tt(10),fl(this),cg(this))};function sh(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function cg(l){l.g=new Jn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=bn(l.qa);Se(h,"RID","rpc"),Se(h,"SID",l.K),Se(h,"AID",l.T),Se(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Se(h,"TO",l.ja),Se(h,"TYPE","xmlhttp"),yo(l,h),l.m&&l.o&&th(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=ul(bn(h)),p.m=null,p.P=!0,Lm(p,l)}n.Za=function(){this.C!=null&&(this.C=null,fl(this),rh(this),Tt(19))};function ml(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function hg(l,h){var p=null;if(l.g==h){ml(l),sh(l),l.g=null;var y=2}else if(Zc(l.h,h))p=h.D,$m(l.h,h),y=1;else return;if(l.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var k=l.B;y=rl(),It(y,new Nm(y,p)),pl(l)}else ug(l);else if(k=h.s,k==3||k==0&&0<h.X||!(y==1&&jT(l,h)||y==2&&rh(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),k){case 1:Xr(l,5);break;case 4:Xr(l,10);break;case 3:Xr(l,6);break;default:Xr(l,2)}}}function dg(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Xr(l,h){if(l.j.info("Error code "+h),h==2){var p=m(l.fb,l),y=l.Xa;const k=!y;y=new Yr(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||al(y,"https"),ul(y),k?NT(y.toString(),p):DT(y.toString(),p)}else Tt(2);l.G=0,l.l&&l.l.sa(h),fg(l),og(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Tt(2)):(this.j.info("Failed to ping google.com"),Tt(1))};function fg(l){if(l.G=0,l.ka=[],l.l){const h=qm(l.h);(h.length!=0||l.i.length!=0)&&(N(l.ka,h),N(l.ka,l.i),l.h.i.length=0,b(l.i),l.i.length=0),l.l.ra()}}function pg(l,h,p){var y=p instanceof Yr?bn(p):new Yr(p);if(y.g!="")h&&(y.g=h+"."+y.g),ll(y,y.s);else{var k=a.location;y=k.protocol,h=h?h+"."+k.hostname:k.hostname,k=+k.port;var M=new Yr(null);y&&al(M,y),h&&(M.g=h),k&&ll(M,k),p&&(M.l=p),y=M}return p=l.D,h=l.ya,p&&h&&Se(y,p,h),Se(y,"VER",l.la),yo(l,y),y}function mg(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new je(new cl({eb:p})):new je(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gg(){}n=gg.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function gl(){}gl.prototype.g=function(l,h){return new zt(l,h)};function zt(l,h){ft.call(this),this.g=new ig(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!E(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!E(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new $s(this)}R(zt,ft),zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zt.prototype.close=function(){nh(this.g)},zt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=qc(l),l=p);h.i.push(new TT(h.Ya++,l)),h.G==3&&pl(h)},zt.prototype.N=function(){this.g.l=null,delete this.j,nh(this.g),delete this.g,zt.aa.N.call(this)};function yg(l){Gc.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}R(yg,Gc);function _g(){Wc.call(this),this.status=1}R(_g,Wc);function $s(l){this.g=l}R($s,gg),$s.prototype.ua=function(){It(this.g,"a")},$s.prototype.ta=function(l){It(this.g,new yg(l))},$s.prototype.sa=function(l){It(this.g,new _g)},$s.prototype.ra=function(){It(this.g,"b")},gl.prototype.createWebChannel=gl.prototype.g,zt.prototype.send=zt.prototype.o,zt.prototype.open=zt.prototype.m,zt.prototype.close=zt.prototype.close,B0=function(){return new gl},F0=function(){return rl()},L0=Qr,Bd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},sl.NO_ERROR=0,sl.TIMEOUT=8,sl.HTTP_ERROR=6,tu=sl,Dm.COMPLETE="complete",M0=Dm,Cm.EventType=io,io.OPEN="a",io.CLOSE="b",io.ERROR="c",io.MESSAGE="d",ft.prototype.listen=ft.prototype.K,Oo=Cm,je.prototype.listenOnce=je.prototype.L,je.prototype.getLastError=je.prototype.Ka,je.prototype.getLastErrorCode=je.prototype.Ba,je.prototype.getStatus=je.prototype.Z,je.prototype.getResponseJson=je.prototype.Oa,je.prototype.getResponseText=je.prototype.oa,je.prototype.send=je.prototype.ea,je.prototype.setWithCredentials=je.prototype.Ha,O0=je}).apply(typeof Ol<"u"?Ol:typeof self<"u"?self:typeof window<"u"?window:{});const jy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rt.UNAUTHENTICATED=new rt(null),rt.GOOGLE_CREDENTIALS=new rt("google-credentials-uid"),rt.FIRST_PARTY=new rt("first-party-uid"),rt.MOCK_USER=new rt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr=new hp("@firebase/firestore");function Ys(){return kr.logLevel}function nR(n){kr.setLogLevel(n)}function j(n,...e){if(kr.logLevel<=le.DEBUG){const t=e.map(gp);kr.debug(`Firestore (${Qi}): ${n}`,...t)}}function Ke(n,...e){if(kr.logLevel<=le.ERROR){const t=e.map(gp);kr.error(`Firestore (${Qi}): ${n}`,...t)}}function An(n,...e){if(kr.logLevel<=le.WARN){const t=e.map(gp);kr.warn(`Firestore (${Qi}): ${n}`,...t)}}function gp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(n="Unexpected state"){const e=`FIRESTORE (${Qi}) INTERNAL ASSERTION FAILED: `+n;throw Ke(e),new Error(e)}function Y(n,e){n||W()}function rR(n,e){n||W()}function K(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class F extends Ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(rt.UNAUTHENTICATED))}shutdown(){}}class iR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class oR{constructor(e){this.t=e,this.currentUser=rt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new ht;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ht,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ht)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new j0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new rt(e)}}class aR{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=rt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lR{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new aR(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(rt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class uR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Y(this.o===void 0);const r=i=>{i.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string"),this.R=t.token,new uR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=hR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function te(n,e){return n<e?-1:n>e?1:0}function Vi(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function z0(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return De.fromMillis(Date.now())}static fromDate(e){return De.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new De(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?te(this.nanoseconds,e.nanoseconds):te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.timestamp=e}static fromTimestamp(e){return new J(e)}static min(){return new J(new De(0,0))}static max(){return new J(new De(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,t,r){t===void 0?t=0:t>e.length&&W(),r===void 0?r=e.length-t:r>e.length-t&&W(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ea.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ea?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class oe extends Ea{construct(e,t,r){return new oe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new oe(t)}static emptyPath(){return new oe([])}}const dR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ve extends Ea{construct(e,t,r){return new Ve(e,t,r)}static isValidIdentifier(e){return dR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ve.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ve(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new F(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new F(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new F(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ve(t)}static emptyPath(){return new Ve([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.path=e}static fromPath(e){return new $(oe.fromString(e))}static fromName(e){return new $(oe.fromString(e).popFirst(5))}static empty(){return new $(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $(new oe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function jd(n){return n.fields.find(e=>e.kind===2)}function ns(n){return n.fields.filter(e=>e.kind!==2)}Fu.UNKNOWN_ID=-1;class nu{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ia{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ia(0,Wt.min())}}function $0(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=J.fromTimestamp(r===1e9?new De(t+1,0):new De(t,r));return new Wt(s,$.empty(),e)}function q0(n){return new Wt(n.readTime,n.key,-1)}class Wt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Wt(J.min(),$.empty(),-1)}static max(){return new Wt(J.max(),$.empty(),-1)}}function yp(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(n.documentKey,e.documentKey),t!==0?t:te(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class G0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $r(n){if(n.code!==O.FAILED_PRECONDITION||n.message!==K0)throw n;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,r)=>{t(e)})}static reject(e){return new V((t,r)=>{r(e)})}static waitFor(e){return new V((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next(s=>s?V.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const c=u;t(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new V((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ht,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Qo(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=_p(r.target.error);this.V.reject(new Qo(e,s))}}static open(e,t,r,s){try{return new mc(t,e.transaction(s,r))}catch(i){throw new Qo(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(j("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new pR(t)}}class Tn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Tn.S(Mu())===12.2&&Ke("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return j("SimpleDb","Removing database:",e),rs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!w0())return!1;if(Tn.v())return!0;const e=Mu(),t=Tn.S(e),r=0<t&&t<10,s=W0(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(j("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Qo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new F(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new F(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qo(e,o))},s.onupgradeneeded=i=>{j("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{j("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=mc.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),V.reject(c))).toPromise();return u.catch(()=>{}),await a.m,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(j("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function W0(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class fR{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return rs(this.B.delete())}}class Qo extends F{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function qr(n){return n.name==="IndexedDbTransactionError"}class pR{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(j("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(j("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),rs(r)}add(e){return j("SimpleDb","ADD",this.store.name,e,e),rs(this.store.add(e))}get(e){return rs(this.store.get(e)).next(t=>(t===void 0&&(t=null),j("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return j("SimpleDb","DELETE",this.store.name,e),rs(this.store.delete(e))}count(){return j("SimpleDb","COUNT",this.store.name),rs(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){j("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new V((r,s)=>{t.onerror=i=>{const o=_p(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new fR(a),c=t(a.primaryKey,a.value,u);if(c instanceof V){const d=c.catch(f=>(u.done(),V.reject(f)));r.push(d)}u.isDone?s():u.K===null?a.continue():a.continue(u.K)}}).next(()=>V.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function rs(n){return new V((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=_p(r.target.error);t(s)}})}let Uy=!1;function _p(n){const e=Tn.S(Mu());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new F("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Uy||(Uy=!0,setTimeout(()=>{throw r},0)),r}}return n}class mR{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){j("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{j("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){qr(t)?j("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await $r(t)}await this.X(6e4)})}}class gR{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return j("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(j("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=q0(i);yp(o,r)>0&&(r=o)}),new Wt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Mt.oe=-1;function za(n){return n==null}function Ta(n){return n===0&&1/n==-1/0}function Q0(n){return typeof n=="number"&&Number.isInteger(n)&&!Ta(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=zy(e)),e=yR(n.get(t),e);return zy(e)}function yR(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function zy(n){return n+""}function _n(n){const e=n.length;if(Y(e>=2),e===2)return Y(n.charAt(0)===""&&n.charAt(1)===""),oe.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&W(),n.charAt(o+1)){case"":const a=n.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:W()}i=o+2}return new oe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(n,e){return[n,Pt(e)]}function H0(n,e,t){return[n,Pt(e),t]}const _R={},vR=["prefixPath","collectionGroup","readTime","documentId"],wR=["prefixPath","collectionGroup","documentId"],ER=["collectionGroup","readTime","prefixPath","documentId"],IR=["canonicalId","targetId"],TR=["targetId","path"],xR=["path","targetId"],AR=["collectionId","parent"],SR=["indexId","uid"],RR=["uid","sequenceNumber"],PR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],CR=["indexId","uid","orderedDocumentKey"],bR=["userId","collectionPath","documentId"],kR=["userId","collectionPath","largestBatchId"],VR=["userId","collectionGroup","largestBatchId"],Y0=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],NR=[...Y0,"documentOverlays"],X0=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],J0=X0,vp=[...J0,"indexConfiguration","indexState","indexEntries"],DR=vp,OR=[...vp,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud extends G0{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Ze(n,e){const t=K(n);return Tn.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Os(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Z0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e,t){this.comparator=e,this.root=t||lt.EMPTY}insert(e,t){return new xe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(e){return new xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ml(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ml(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ml(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ml(this.root,e,this.comparator,!0)}}class Ml{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??lt.RED,this.left=s??lt.EMPTY,this.right=i??lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new lt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return lt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return lt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();const e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}}lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1;lt.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,r,s,i){return this}insert(e,t,r){return new lt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ky(this.data.getIterator())}getIteratorFrom(e){return new Ky(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof we)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new we(this.comparator);return t.data=e,t}}class Ky{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Gs(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new Lt([])}unionWith(e){let t=new we(Ve.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Lt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Vi(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new eE("Invalid base64 string: "+i):i}}(e);return new ze(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ze(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ze.EMPTY_BYTE_STRING=new ze("");const LR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Kn(n){if(Y(!!n),typeof n=="string"){let e=0;const t=LR.exec(n);if(Y(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:be(n.seconds),nanos:be(n.nanos)}}function be(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Vr(n){return typeof n=="string"?ze.fromBase64String(n):ze.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function wp(n){const e=n.mapValue.fields.__previous_value__;return gc(e)?wp(e):e}function xa(n){const e=Kn(n.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e,t,r,s,i,o,a,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class Nr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Nr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},su={nullValue:"NULL_VALUE"};function Ts(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gc(n)?4:tE(n)?9007199254740991:yc(n)?10:11:W()}function Sn(n,e){if(n===e)return!0;const t=Ts(n);if(t!==Ts(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xa(n).isEqual(xa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Kn(s.timestampValue),a=Kn(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Vr(s.bytesValue).isEqual(Vr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return be(s.geoPointValue.latitude)===be(i.geoPointValue.latitude)&&be(s.geoPointValue.longitude)===be(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return be(s.integerValue)===be(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=be(s.doubleValue),a=be(i.doubleValue);return o===a?Ta(o)===Ta(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Vi(n.arrayValue.values||[],e.arrayValue.values||[],Sn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(qy(o)!==qy(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Sn(o[u],a[u])))return!1;return!0}(n,e);default:return W()}}function Aa(n,e){return(n.values||[]).find(t=>Sn(t,e))!==void 0}function Dr(n,e){if(n===e)return 0;const t=Ts(n),r=Ts(e);if(t!==r)return te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return te(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=be(i.integerValue||i.doubleValue),u=be(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return Gy(n.timestampValue,e.timestampValue);case 4:return Gy(xa(n),xa(e));case 5:return te(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Vr(i),u=Vr(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const d=te(a[c],u[c]);if(d!==0)return d}return te(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=te(be(i.latitude),be(o.latitude));return a!==0?a:te(be(i.longitude),be(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Wy(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,u,c,d;const f=i.fields||{},m=o.fields||{},_=(a=f.value)===null||a===void 0?void 0:a.arrayValue,R=(u=m.value)===null||u===void 0?void 0:u.arrayValue,b=te(((c=_==null?void 0:_.values)===null||c===void 0?void 0:c.length)||0,((d=R==null?void 0:R.values)===null||d===void 0?void 0:d.length)||0);return b!==0?b:Wy(_,R)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===mr.mapValue&&o===mr.mapValue)return 0;if(i===mr.mapValue)return 1;if(o===mr.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const m=te(u[f],d[f]);if(m!==0)return m;const _=Dr(a[u[f]],c[d[f]]);if(_!==0)return _}return te(u.length,d.length)}(n.mapValue,e.mapValue);default:throw W()}}function Gy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return te(n,e);const t=Kn(n),r=Kn(e),s=te(t.seconds,r.seconds);return s!==0?s:te(t.nanos,r.nanos)}function Wy(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Dr(t[s],r[s]);if(i)return i}return te(t.length,r.length)}function Ni(n){return zd(n)}function zd(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Kn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Vr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return $.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=zd(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${zd(t.fields[o])}`;return s+"}"}(n.mapValue):W()}function xs(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function $d(n){return!!n&&"integerValue"in n}function Sa(n){return!!n&&"arrayValue"in n}function Qy(n){return!!n&&"nullValue"in n}function Hy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function iu(n){return!!n&&"mapValue"in n}function yc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ho(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Os(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ho(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ho(n.arrayValue.values[t]);return e}return Object.assign({},n)}function tE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const nE={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function BR(n){return"nullValue"in n?su:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xs(Nr.empty(),$.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?yc(n)?nE:{mapValue:{}}:W()}function jR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xs(Nr.empty(),$.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?nE:"mapValue"in n?yc(n)?{mapValue:{}}:mr:W()}function Yy(n,e){const t=Dr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Xy(n,e){const t=Dr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.value=e}static empty(){return new ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!iu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ho(t)}setAll(e){let t=Ve.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Ho(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());iu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];iu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Os(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ut(Ho(this.value))}}function rE(n){const e=[];return Os(n.fields,(t,r)=>{const s=new Ve([t]);if(iu(r)){const i=rE(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Lt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Pe(e,0,J.min(),J.min(),J.min(),ut.empty(),0)}static newFoundDocument(e,t,r,s){return new Pe(e,1,t,J.min(),r,s,0)}static newNoDocument(e,t){return new Pe(e,2,t,J.min(),J.min(),ut.empty(),0)}static newUnknownDocument(e,t){return new Pe(e,3,t,J.min(),J.min(),ut.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t){this.position=e,this.inclusive=t}}function Jy(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=$.comparator($.fromName(o.referenceValue),t.key):r=Dr(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Zy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t="asc"){this.field=e,this.dir=t}}function UR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{}class ae extends sE{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new zR(e,t,r):t==="array-contains"?new KR(e,r):t==="in"?new cE(e,r):t==="not-in"?new GR(e,r):t==="array-contains-any"?new WR(e,r):new ae(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new $R(e,r):new qR(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Dr(t,this.value)):t!==null&&Ts(this.value)===Ts(t)&&this.matchesComparison(Dr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _e extends sE{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new _e(e,t)}matches(e){return Di(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Di(n){return n.op==="and"}function qd(n){return n.op==="or"}function Ep(n){return iE(n)&&Di(n)}function iE(n){for(const e of n.filters)if(e instanceof _e)return!1;return!0}function Kd(n){if(n instanceof ae)return n.field.canonicalString()+n.op.toString()+Ni(n.value);if(Ep(n))return n.filters.map(e=>Kd(e)).join(",");{const e=n.filters.map(t=>Kd(t)).join(",");return`${n.op}(${e})`}}function oE(n,e){return n instanceof ae?function(r,s){return s instanceof ae&&r.op===s.op&&r.field.isEqual(s.field)&&Sn(r.value,s.value)}(n,e):n instanceof _e?function(r,s){return s instanceof _e&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&oE(o,s.filters[a]),!0):!1}(n,e):void W()}function aE(n,e){const t=n.filters.concat(e);return _e.create(t,n.op)}function lE(n){return n instanceof ae?function(t){return`${t.field.canonicalString()} ${t.op} ${Ni(t.value)}`}(n):n instanceof _e?function(t){return t.op.toString()+" {"+t.getFilters().map(lE).join(" ,")+"}"}(n):"Filter"}class zR extends ae{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){const t=$.comparator(e.key,this.key);return this.matchesComparison(t)}}class $R extends ae{constructor(e,t){super(e,"in",t),this.keys=uE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class qR extends ae{constructor(e,t){super(e,"not-in",t),this.keys=uE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function uE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>$.fromName(r.referenceValue))}class KR extends ae{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Sa(t)&&Aa(t.arrayValue,this.value)}}class cE extends ae{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Aa(this.value.arrayValue,t)}}class GR extends ae{constructor(e,t){super(e,"not-in",t)}matches(e){if(Aa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Aa(this.value.arrayValue,t)}}class WR extends ae{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Sa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Aa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Gd(n,e=null,t=[],r=[],s=null,i=null,o=null){return new QR(n,e,t,r,s,i,o)}function As(n){const e=K(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Kd(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),za(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ni(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ni(r)).join(",")),e.ue=t}return e.ue}function $a(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!oE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Zy(n.startAt,e.startAt)&&Zy(n.endAt,e.endAt)}function Bu(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function ju(n,e){return n.filters.filter(t=>t instanceof ae&&t.field.isEqual(e))}function e_(n,e,t){let r=su,s=!0;for(const i of ju(n,e)){let o=su,a=!0;switch(i.op){case"<":case"<=":o=BR(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=su}Yy({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Yy({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function t_(n,e,t){let r=mr,s=!0;for(const i of ju(n,e)){let o=mr,a=!0;switch(i.op){case">=":case">":o=jR(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=mr}Xy({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Xy({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function hE(n,e,t,r,s,i,o,a){return new Hn(n,e,t,r,s,i,o,a)}function Hi(n){return new Hn(n)}function n_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ip(n){return n.collectionGroup!==null}function vi(n){const e=K(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new we(Ve.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Ra(i,r))}),t.has(Ve.keyField().canonicalString())||e.ce.push(new Ra(Ve.keyField(),r))}return e.ce}function Ct(n){const e=K(n);return e.le||(e.le=HR(e,vi(n))),e.le}function HR(n,e){if(n.limitType==="F")return Gd(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ra(s.field,i)});const t=n.endAt?new Or(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Or(n.startAt.position,n.startAt.inclusive):null;return Gd(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Wd(n,e){const t=n.filters.concat([e]);return new Hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Uu(n,e,t){return new Hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qa(n,e){return $a(Ct(n),Ct(e))&&n.limitType===e.limitType}function dE(n){return`${As(Ct(n))}|lt:${n.limitType}`}function Xs(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>lE(s)).join(", ")}]`),za(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Ni(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Ni(s)).join(",")),`Target(${r})`}(Ct(n))}; limitType=${n.limitType})`}function Ka(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):$.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of vi(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,u){const c=Jy(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,vi(r),s)||r.endAt&&!function(o,a,u){const c=Jy(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,vi(r),s))}(n,e)}function fE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pE(n){return(e,t)=>{let r=!1;for(const s of vi(n)){const i=YR(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function YR(n,e,t){const r=n.field.isKeyField()?$.comparator(e.key,t.key):function(i,o,a){const u=o.data.field(i),c=a.data.field(i);return u!==null&&c!==null?Dr(u,c):W()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Os(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Z0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=new xe($.comparator);function Ft(){return XR}const mE=new xe($.comparator);function Mo(...n){let e=mE;for(const t of n)e=e.insert(t.key,t);return e}function gE(n){let e=mE;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function vn(){return Yo()}function yE(){return Yo()}function Yo(){return new Kr(n=>n.toString(),(n,e)=>n.isEqual(e))}const JR=new xe($.comparator),ZR=new we($.comparator);function re(...n){let e=ZR;for(const t of n)e=e.add(t);return e}const eP=new we(te);function Tp(){return eP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ta(e)?"-0":e}}function _E(n){return{integerValue:""+n}}function vE(n,e){return Q0(e)?_E(e):xp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(){this._=void 0}}function tP(n,e,t){return n instanceof Oi?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&gc(i)&&(i=wp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Ss?EE(n,e):n instanceof Rs?IE(n,e):function(s,i){const o=wE(s,i),a=r_(o)+r_(s.Pe);return $d(o)&&$d(s.Pe)?_E(a):xp(s.serializer,a)}(n,e)}function nP(n,e,t){return n instanceof Ss?EE(n,e):n instanceof Rs?IE(n,e):t}function wE(n,e){return n instanceof Mi?function(r){return $d(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Oi extends _c{}class Ss extends _c{constructor(e){super(),this.elements=e}}function EE(n,e){const t=TE(e);for(const r of n.elements)t.some(s=>Sn(s,r))||t.push(r);return{arrayValue:{values:t}}}class Rs extends _c{constructor(e){super(),this.elements=e}}function IE(n,e){let t=TE(e);for(const r of n.elements)t=t.filter(s=>!Sn(s,r));return{arrayValue:{values:t}}}class Mi extends _c{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function r_(n){return be(n.integerValue||n.doubleValue)}function TE(n){return Sa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,t){this.field=e,this.transform=t}}function rP(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Ss&&s instanceof Ss||r instanceof Rs&&s instanceof Rs?Vi(r.elements,s.elements,Sn):r instanceof Mi&&s instanceof Mi?Sn(r.Pe,s.Pe):r instanceof Oi&&s instanceof Oi}(n.transform,e.transform)}class sP{constructor(e,t){this.version=e,this.transformResults=t}}class Ne{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ne}static exists(e){return new Ne(void 0,e)}static updateTime(e){return new Ne(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ou(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class vc{}function xE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xi(n.key,Ne.none()):new Yi(n.key,n.data,Ne.none());{const t=n.data,r=ut.empty();let s=new we(Ve.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Yn(n.key,r,new Lt(s.toArray()),Ne.none())}}function iP(n,e,t){n instanceof Yi?function(s,i,o){const a=s.value.clone(),u=i_(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Yn?function(s,i,o){if(!ou(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=i_(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(AE(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Xo(n,e,t,r){return n instanceof Yi?function(i,o,a,u){if(!ou(i.precondition,o))return a;const c=i.value.clone(),d=o_(i.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Yn?function(i,o,a,u){if(!ou(i.precondition,o))return a;const c=o_(i.fieldTransforms,u,o),d=o.data;return d.setAll(AE(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return ou(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function oP(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=wE(r.transform,s||null);i!=null&&(t===null&&(t=ut.empty()),t.set(r.field,i))}return t||null}function s_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Vi(r,s,(i,o)=>rP(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Yi extends vc{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Yn extends vc{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function AE(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function i_(n,e,t){const r=new Map;Y(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,nP(o,a,t[s]))}return r}function o_(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,tP(i,o,e))}return r}class Xi extends vc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ap extends vc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&iP(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Xo(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Xo(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=yE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const u=xE(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&Vi(this.mutations,e.mutations,(t,r)=>s_(t,r))&&Vi(this.baseMutations,e.baseMutations,(t,r)=>s_(t,r))}}class Rp{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Y(e.mutations.length===r.length);let s=function(){return JR}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Rp(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe,ce;function SE(n){switch(n){default:return W();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function RE(n){if(n===void 0)return Ke("GRPC error has no .code"),O.UNKNOWN;switch(n){case Qe.OK:return O.OK;case Qe.CANCELLED:return O.CANCELLED;case Qe.UNKNOWN:return O.UNKNOWN;case Qe.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Qe.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Qe.INTERNAL:return O.INTERNAL;case Qe.UNAVAILABLE:return O.UNAVAILABLE;case Qe.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Qe.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Qe.NOT_FOUND:return O.NOT_FOUND;case Qe.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Qe.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Qe.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Qe.ABORTED:return O.ABORTED;case Qe.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Qe.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Qe.DATA_LOSS:return O.DATA_LOSS;default:return W()}}(ce=Qe||(Qe={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP=new ms([4294967295,4294967295],0);function a_(n){const e=PE().encode(n),t=new D0;return t.update(e),new Uint8Array(t.digest())}function l_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ms([t,r],0),new ms([s,i],0)]}class Cp{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Lo(`Invalid padding: ${t}`);if(r<0)throw new Lo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Lo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Lo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ms.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(ms.fromNumber(r)));return s.compare(lP)===1&&(s=new ms([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=a_(e),[r,s]=l_(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Cp(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=a_(e),[r,s]=l_(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Lo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Qa.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Wa(J.min(),s,new xe(te),Ft(),re())}}class Qa{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Qa(r,t,re(),re(),re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class CE{constructor(e,t){this.targetId=e,this.me=t}}class bE{constructor(e,t,r=ze.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class u_{constructor(){this.fe=0,this.ge=h_(),this.pe=ze.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=re(),t=re(),r=re();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:W()}}),new Qa(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=h_()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class uP{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ft(),this.qe=c_(),this.Qe=new xe(te)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:W()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Bu(i))if(r===0){const o=new $(i.path);this.Ue(t,o,Pe.newNoDocument(o,J.min()))}else Y(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Vr(r).toUint8Array()}catch(u){if(u instanceof eE)return An("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Cp(o,s,i)}catch(u){return An(u instanceof Lo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Bu(a.target)){const u=new $(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Pe.newNoDocument(u,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=re();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Wa(e,t,this.Qe,this.ke,r);return this.ke=Ft(),this.qe=c_(),this.Qe=new xe(te),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new u_,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new we(te),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||j("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new u_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function c_(){return new xe($.comparator)}function h_(){return new xe($.comparator)}const cP={asc:"ASCENDING",desc:"DESCENDING"},hP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dP={and:"AND",or:"OR"};class fP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Qd(n,e){return n.useProto3Json||za(e)?e:{value:e}}function Li(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function pP(n,e){return Li(n,e.toTimestamp())}function Ge(n){return Y(!!n),J.fromTimestamp(function(t){const r=Kn(t);return new De(r.seconds,r.nanos)}(n))}function bp(n,e){return Hd(n,e).canonicalString()}function Hd(n,e){const t=function(s){return new oe(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function VE(n){const e=oe.fromString(n);return Y(zE(e)),e}function Pa(n,e){return bp(n.databaseId,e.path)}function xn(n,e){const t=VE(e);if(t.get(1)!==n.databaseId.projectId)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(OE(t))}function NE(n,e){return bp(n.databaseId,e)}function DE(n){const e=VE(n);return e.length===4?oe.emptyPath():OE(e)}function Yd(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function OE(n){return Y(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function d_(n,e,t){return{name:Pa(n,e),fields:t.value.mapValue.fields}}function ME(n,e,t){const r=xn(n,e.name),s=Ge(e.updateTime),i=e.createTime?Ge(e.createTime):J.min(),o=new ut({mapValue:{fields:e.fields}}),a=Pe.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function mP(n,e){return"found"in e?function(r,s){Y(!!s.found),s.found.name,s.found.updateTime;const i=xn(r,s.found.name),o=Ge(s.found.updateTime),a=s.found.createTime?Ge(s.found.createTime):J.min(),u=new ut({mapValue:{fields:s.found.fields}});return Pe.newFoundDocument(i,o,a,u)}(n,e):"missing"in e?function(r,s){Y(!!s.missing),Y(!!s.readTime);const i=xn(r,s.missing),o=Ge(s.readTime);return Pe.newNoDocument(i,o)}(n,e):W()}function gP(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Y(d===void 0||typeof d=="string"),ze.fromBase64String(d||"")):(Y(d===void 0||d instanceof Buffer||d instanceof Uint8Array),ze.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?O.UNKNOWN:RE(c.code);return new F(d,c.message||"")}(o);t=new bE(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=xn(n,r.document.name),i=Ge(r.document.updateTime),o=r.document.createTime?Ge(r.document.createTime):J.min(),a=new ut({mapValue:{fields:r.document.fields}}),u=Pe.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new au(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=xn(n,r.document),i=r.readTime?Ge(r.readTime):J.min(),o=Pe.newNoDocument(s,i),a=r.removedTargetIds||[];t=new au([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=xn(n,r.document),i=r.removedTargetIds||[];t=new au([],i,s,null)}else{if(!("filter"in e))return W();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new aP(s,i),a=r.targetId;t=new CE(a,o)}}return t}function Ca(n,e){let t;if(e instanceof Yi)t={update:d_(n,e.key,e.value)};else if(e instanceof Xi)t={delete:Pa(n,e.key)};else if(e instanceof Yn)t={update:d_(n,e.key,e.data),updateMask:IP(e.fieldMask)};else{if(!(e instanceof Ap))return W();t={verify:Pa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Oi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ss)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Rs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Mi)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw W()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:pP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:W()}(n,e.precondition)),t}function Xd(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Ne.updateTime(Ge(i.updateTime)):i.exists!==void 0?Ne.exists(i.exists):Ne.none()}(e.currentDocument):Ne.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let u=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME"),u=new Oi;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Ss(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new Rs(d)}else"increment"in a?u=new Mi(o,a.increment):W();const c=Ve.fromServerFormat(a.fieldPath);return new Ga(c,u)}(n,s)):[];if(e.update){e.update.name;const s=xn(n,e.update.name),i=new ut({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new Lt(c.map(d=>Ve.fromServerFormat(d)))}(e.updateMask);return new Yn(s,i,o,t,r)}return new Yi(s,i,t,r)}if(e.delete){const s=xn(n,e.delete);return new Xi(s,t)}if(e.verify){const s=xn(n,e.verify);return new Ap(s,t)}return W()}function yP(n,e){return n&&n.length>0?(Y(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Ge(s.updateTime):Ge(i);return o.isEqual(J.min())&&(o=Ge(i)),new sP(o,s.transformResults||[])}(t,e))):[]}function LE(n,e){return{documents:[NE(n,e.path)]}}function FE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=NE(n,s);const i=function(c){if(c.length!==0)return UE(_e.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:Js(m.field),direction:vP(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Qd(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function BE(n){let e=DE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Y(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const m=jE(f);return m instanceof _e&&Ep(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(m=>function(R){return new Ra(Zs(R.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,za(m)?null:m}(t.limit));let u=null;t.startAt&&(u=function(f){const m=!!f.before,_=f.values||[];return new Or(_,m)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const m=!f.before,_=f.values||[];return new Or(_,m)}(t.endAt)),hE(e,s,o,i,a,"F",u,c)}function _P(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function jE(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Zs(t.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Zs(t.unaryFilter.field);return ae.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Zs(t.unaryFilter.field);return ae.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Zs(t.unaryFilter.field);return ae.create(o,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(t){return ae.create(Zs(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return _e.create(t.compositeFilter.filters.map(r=>jE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(n):W()}function vP(n){return cP[n]}function wP(n){return hP[n]}function EP(n){return dP[n]}function Js(n){return{fieldPath:n.canonicalString()}}function Zs(n){return Ve.fromServerFormat(n.fieldPath)}function UE(n){return n instanceof ae?function(t){if(t.op==="=="){if(Hy(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NAN"}};if(Qy(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hy(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NOT_NAN"}};if(Qy(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Js(t.field),op:wP(t.op),value:t.value}}}(n):n instanceof _e?function(t){const r=t.getFilters().map(s=>UE(s));return r.length===1?r[0]:{compositeFilter:{op:EP(t.op),filters:r}}}(n):W()}function IP(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function zE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,t,r,s,i=J.min(),o=J.min(),a=ze.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Ln(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ln(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e){this.ct=e}}function TP(n,e){let t;if(e.document)t=ME(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=$.fromSegments(e.noDocument.path),s=Cs(e.noDocument.readTime);t=Pe.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{const r=$.fromSegments(e.unknownDocument.path),s=Cs(e.unknownDocument.version);t=Pe.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new De(s[0],s[1]);return J.fromTimestamp(i)}(e.readTime)),t}function f_(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:zu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Pa(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Li(i,o.version.toTimestamp()),createTime:Li(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ps(e.version)};else{if(!e.isUnknownDocument())return W();r.unknownDocument={path:t.path.toArray(),version:Ps(e.version)}}return r}function zu(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ps(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cs(n){const e=new De(n.seconds,n.nanoseconds);return J.fromTimestamp(e)}function ss(n,e){const t=(e.baseMutations||[]).map(i=>Xd(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Xd(n.ct,i)),s=De.fromMillis(e.localWriteTimeMs);return new Sp(e.batchId,s,t,r)}function Fo(n){const e=Cs(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cs(n.lastLimboFreeSnapshotVersion):J.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return Y(i.documents.length===1),Ct(Hi(DE(i.documents[0])))}(n.query):function(i){return Ct(BE(i))}(n.query),new Ln(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ze.fromBase64String(n.resumeToken))}function qE(n,e){const t=Ps(e.snapshotVersion),r=Ps(e.lastLimboFreeSnapshotVersion);let s;s=Bu(e.target)?LE(n.ct,e.target):FE(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:As(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function kp(n){const e=BE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Uu(e,e.limit,"L"):e}function Lh(n,e){return new Pp(e.largestBatchId,Xd(n.ct,e.overlayMutation))}function p_(n,e){const t=e.path.lastSegment();return[n,Pt(e.path.popLast()),t]}function m_(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ps(r.readTime),documentKey:Pt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{getBundleMetadata(e,t){return g_(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Cs(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return g_(e).put(function(s){return{bundleId:s.id,createTime:Ps(Ge(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return y_(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:kp(i.bundledQuery),readTime:Cs(i.readTime)}}(r)})}saveNamedQuery(e,t){return y_(e).put(function(s){return{name:s.name,readTime:Ps(Ge(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function g_(n){return Ze(n,"bundles")}function y_(n){return Ze(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new wc(e,r)}getOverlay(e,t){return So(e).get(p_(this.userId,t)).next(r=>r?Lh(this.serializer,r):null)}getOverlays(e,t){const r=vn();return V.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Pp(t,o);s.push(this.ht(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Pt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(So(e).j("collectionPathOverlayIndex",a))}),V.waitFor(i)}getOverlaysForCollection(e,t,r){const s=vn(),i=Pt(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return So(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=Lh(this.serializer,u);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=vn();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return So(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,d)=>{const f=Lh(this.serializer,c);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return So(e).put(function(s,i,o){const[a,u,c]=p_(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ca(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function So(n){return Ze(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{Pt(e){return Ze(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?ze.fromUint8Array(r):ze.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(be(e.integerValue));else if("doubleValue"in e){const r=be(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ta(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Kn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Vr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?tE(e)?this.dt(t,Number.MAX_SAFE_INTEGER):yc(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):W()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(be(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),$.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}is.vt=new is;function SP(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function __(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=SP(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class RP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=__(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=__(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class PP{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class CP{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Ro{constructor(){this.jt=new RP,this.Ht=new PP(this.jt),this.Jt=new CP(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new os(this.indexId,this.documentKey,this.arrayValue,r)}}function nr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=v_(n.arrayValue,e.arrayValue),t!==0?t:(t=v_(n.directionalValue,e.directionalValue),t!==0?t:$.comparator(n.documentKey,e.documentKey)))}function v_(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.Xt=new we((t,r)=>Ve.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Y(e.collectionGroup===this.collectionId),this.nn)return!1;const t=jd(e);if(t!==void 0&&!this.sn(t))return!1;const r=ns(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const u=r[i];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new we(Ve.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new nu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new nu(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new nu(r.field,r.dir==="asc"?0:1)));return new Fu(Fu.UNKNOWN_ID,this.collectionId,t,Ia.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(n){var e,t;if(Y(n instanceof ae||n instanceof _e),n instanceof ae){if(n instanceof cE){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>ae.create(n.field,"==",i)))||[];return _e.create(s,"or")}return n}const r=n.filters.map(s=>KE(s));return _e.create(r,n.op)}function bP(n){if(n.getFilters().length===0)return[];const e=ef(KE(n));return Y(GE(e)),Jd(e)||Zd(e)?[e]:e.getFilters()}function Jd(n){return n instanceof ae}function Zd(n){return n instanceof _e&&Ep(n)}function GE(n){return Jd(n)||Zd(n)||function(t){if(t instanceof _e&&qd(t)){for(const r of t.getFilters())if(!Jd(r)&&!Zd(r))return!1;return!0}return!1}(n)}function ef(n){if(Y(n instanceof ae||n instanceof _e),n instanceof ae)return n;if(n.filters.length===1)return ef(n.filters[0]);const e=n.filters.map(r=>ef(r));let t=_e.create(e,n.op);return t=$u(t),GE(t)?t:(Y(t instanceof _e),Y(Di(t)),Y(t.filters.length>1),t.filters.reduce((r,s)=>Vp(r,s)))}function Vp(n,e){let t;return Y(n instanceof ae||n instanceof _e),Y(e instanceof ae||e instanceof _e),t=n instanceof ae?e instanceof ae?function(s,i){return _e.create([s,i],"and")}(n,e):E_(n,e):e instanceof ae?E_(e,n):function(s,i){if(Y(s.filters.length>0&&i.filters.length>0),Di(s)&&Di(i))return aE(s,i.getFilters());const o=qd(s)?s:i,a=qd(s)?i:s,u=o.filters.map(c=>Vp(c,a));return _e.create(u,"or")}(n,e),$u(t)}function E_(n,e){if(Di(e))return aE(e,n.getFilters());{const t=e.filters.map(r=>Vp(n,r));return _e.create(t,"or")}}function $u(n){if(Y(n instanceof ae||n instanceof _e),n instanceof ae)return n;const e=n.getFilters();if(e.length===1)return $u(e[0]);if(iE(n))return n;const t=e.map(s=>$u(s)),r=[];return t.forEach(s=>{s instanceof ae?r.push(s):s instanceof _e&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:_e.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(){this.un=new Np}addToCollectionParentIndex(e,t){return this.un.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Wt.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Wt.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class Np{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new we(oe.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new we(oe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=new Uint8Array(0);class VP{constructor(e,t){this.databaseId=t,this.cn=new Np,this.ln=new Kr(r=>As(r),(r,s)=>$a(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:Pt(s)};return I_(e).put(i)}return V.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[z0(t),""],!1,!0);return I_(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(_n(o.parent))}return r})}addFieldIndex(e,t){const r=Po(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Qs(e);return i.next(a=>{o.put(m_(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Po(e),s=Qs(e),i=Ws(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Po(e),r=Ws(e),s=Qs(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return V.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new w_(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=Ws(e);let s=!0;const i=new Map;return V.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=re();const a=[];return V.forEach(i,(u,c)=>{j("IndexedDbIndexManager",`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(u)} to execute ${As(t)}`);const d=function(A,D){const B=jd(D);if(B===void 0)return null;for(const L of ju(A,B.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(c,u),f=function(A,D){const B=new Map;for(const L of ns(D))for(const w of ju(A,L.fieldPath))switch(w.op){case"==":case"in":B.set(L.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return B.set(L.fieldPath.canonicalString(),w.value),Array.from(B.values())}return null}(c,u),m=function(A,D){const B=[];let L=!0;for(const w of ns(D)){const g=w.kind===0?e_(A,w.fieldPath,A.startAt):t_(A,w.fieldPath,A.startAt);B.push(g.value),L&&(L=g.inclusive)}return new Or(B,L)}(c,u),_=function(A,D){const B=[];let L=!0;for(const w of ns(D)){const g=w.kind===0?t_(A,w.fieldPath,A.endAt):e_(A,w.fieldPath,A.endAt);B.push(g.value),L&&(L=g.inclusive)}return new Or(B,L)}(c,u),R=this.In(u,c,m),b=this.In(u,c,_),N=this.Tn(u,c,f),x=this.En(u.indexId,d,R,m.inclusive,b,_.inclusive,N);return V.forEach(x,E=>r.G(E,t.limit).next(A=>{A.forEach(D=>{const B=$.fromSegments(D.documentKey);o.has(B)||(o=o.add(B),a.push(B))})}))}).next(()=>a)}return V.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=bP(_e.create(e.filters,"and")).map(r=>Gd(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const u=(t!=null?t.length:1)*Math.max(r.length,i.length),c=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const m=t?this.dn(t[f/c]):Ll,_=this.An(e,m,r[f%c],s),R=this.Rn(e,m,i[f%c],o),b=a.map(N=>this.An(e,m,N,!0));d.push(...this.createRange(_,R,b))}return d}An(e,t,r,s){const i=new os(e,$.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new os(e,$.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new w_(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return V.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new we(Ve.comparator),d=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:c=c.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new Ro;for(const s of ns(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);is.vt.It(i,o)}return r.zt()}dn(e){const t=new Ro;return is.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Ro;return is.vt.It(xs(this.databaseId,t),r.Yt(function(i){const o=ns(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new Ro);let i=0;for(const o of ns(e)){const a=r[i++];for(const u of s)if(this.fn(t,o.fieldPath)&&Sa(a))s=this.gn(s,o,a);else{const c=u.Yt(o.kind);is.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const u=new Ro;u.seed(a.zt()),is.vt.It(o,u.Yt(t.kind)),i.push(u)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof ae&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Po(e),s=Qs(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){const m=f?new Ia(f.sequenceNumber,new Wt(Cs(f.readTime),new $(_n(f.documentKey)),f.largestBatchId)):Ia.empty(),_=d.fields.map(([R,b])=>new nu(Ve.fromServerFormat(R),b));return new Fu(d.indexId,d.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:te(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Po(e),i=Qs(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>V.forEach(a,u=>i.put(m_(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return V.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,u=>this.wn(e,s,u).next(c=>{const d=this.Sn(i,u);return c.isEqual(d)?V.resolve():this.bn(e,i,u,c,d)}))))})}Dn(e,t,r,s){return Ws(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return Ws(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=Ws(e);let i=new we(nr);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new os(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new we(nr);const s=this.Vn(t,e);if(s==null)return r;const i=jd(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Sa(o))for(const a of o.arrayValue.values||[])r=r.add(new os(t.indexId,e.key,this.dn(a),s))}else r=r.add(new os(t.indexId,e.key,Ll,s));return r}bn(e,t,r,s,i){j("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,c,d,f,m){const _=u.getIterator(),R=c.getIterator();let b=Gs(_),N=Gs(R);for(;b||N;){let x=!1,E=!1;if(b&&N){const A=d(b,N);A<0?E=!0:A>0&&(x=!0)}else b!=null?E=!0:x=!0;x?(f(N),N=Gs(R)):E?(m(b),b=Gs(_)):(b=Gs(_),N=Gs(R))}}(s,i,nr,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),V.waitFor(o)}yn(e){let t=1;return Qs(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>nr(o,a)).filter((o,a,u)=>!a||nr(o,u[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=nr(o,e),u=nr(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&u<0)s.push(o),s.push(o.Zt());else if(u>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Ll,[]],u=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Ll,[]];i.push(IDBKeyRange.bound(a,u))}return i}Cn(e,t){return nr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(T_)}getMinOffset(e,t){return V.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||W())).next(T_)}}function I_(n){return Ze(n,"collectionParents")}function Ws(n){return Ze(n,"indexEntries")}function Po(n){return Ze(n,"indexConfiguration")}function Qs(n){return Ze(n,"indexState")}function T_(n){Y(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;yp(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Wt(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Nt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Nt(e,Nt.DEFAULT_COLLECTION_PERCENTILE,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.J({range:o},(d,f,m)=>(a++,m.delete()));i.push(u.next(()=>{Y(a===1)}));const c=[];for(const d of t.mutations){const f=H0(e,d.key.path,t.batchId);i.push(s.delete(f)),c.push(d.key)}return V.waitFor(i).next(()=>c)}function qu(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw W();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nt.DEFAULT_COLLECTION_PERCENTILE=10,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nt.DEFAULT=new Nt(41943040,Nt.DEFAULT_COLLECTION_PERCENTILE,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nt.DISABLED=new Nt(-1,0,0);class Ec{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){Y(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Ec(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return rr(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=ei(e),o=rr(e);return o.add({}).next(a=>{Y(typeof a=="number");const u=new Sp(a,t,r,s),c=function(_,R,b){const N=b.baseMutations.map(E=>Ca(_.ct,E)),x=b.mutations.map(E=>Ca(_.ct,E));return{userId:R,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:N,mutations:x}}(this.serializer,this.userId,u),d=[];let f=new we((m,_)=>te(m.canonicalString(),_.canonicalString()));for(const m of s){const _=H0(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),d.push(o.put(c)),d.push(i.put(_,_R))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),V.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return rr(e).get(t).next(r=>r?(Y(r.userId===this.userId),ss(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?V.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return rr(e).J({index:"userMutationsIndex",range:s},(o,a,u)=>{a.userId===this.userId&&(Y(a.batchId>=r),i=ss(this.serializer,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return rr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return rr(e).U("userMutationsIndex",t).next(r=>r.map(s=>ss(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=ru(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return ei(e).J({range:s},(o,a,u)=>{const[c,d,f]=o,m=_n(d);if(c===this.userId&&t.path.isEqual(m))return rr(e).get(f).next(_=>{if(!_)throw W();Y(_.userId===this.userId),i.push(ss(this.serializer,_))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new we(te);const s=[];return t.forEach(i=>{const o=ru(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=ei(e).J({range:a},(c,d,f)=>{const[m,_,R]=c,b=_n(_);m===this.userId&&i.path.isEqual(b)?r=r.add(R):f.done()});s.push(u)}),V.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=ru(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new we(te);return ei(e).J({range:o},(u,c,d)=>{const[f,m,_]=u,R=_n(m);f===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(rr(e).get(i).next(o=>{if(o===null)throw W();Y(o.userId===this.userId),r.push(ss(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return WE(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ei(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=_n(i[1]);s.push(u)}else a.done()}).next(()=>{Y(s.length===0)})})}containsKey(e,t){return QE(e,this.userId,t)}Nn(e){return HE(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function QE(n,e,t){const r=ru(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ei(n).J({range:i,H:!0},(a,u,c)=>{const[d,f,m]=a;d===e&&f===s&&(o=!0),c.done()}).next(()=>o)}function rr(n){return Ze(n,"mutations")}function ei(n){return Ze(n,"documentMutations")}function HE(n){return Ze(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new bs(0)}static kn(){return new bs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new bs(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>J.fromTimestamp(new De(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Hs(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Hs(e).J((o,a)=>{const u=Fo(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Hs(e).J((r,s)=>{const i=Fo(s);t(i)})}qn(e){return A_(e).get("targetGlobalKey").next(t=>(Y(t!==null),t))}Qn(e,t){return A_(e).put("targetGlobalKey",t)}Kn(e,t){return Hs(e).put(qE(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=As(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Hs(e).J({range:s,index:"queryTargetsIndex"},(o,a,u)=>{const c=Fo(a);$a(t,c.target)&&(i=c,u.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=cr(e);return t.forEach(o=>{const a=Pt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,t,r){const s=cr(e);return V.forEach(t,i=>{const o=Pt(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=cr(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=cr(e);let i=re();return s.J({range:r,H:!0},(o,a,u)=>{const c=_n(o[1]),d=new $(c);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=Pt(t.path),s=IDBKeyRange.bound([r],[z0(r)],!1,!0);let i=0;return cr(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],u,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return Hs(e).get(t).next(r=>r?Fo(r):null)}}function Hs(n){return Ze(n,"targets")}function A_(n){return Ze(n,"targetGlobal")}function cr(n){return Ze(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_([n,e],[t,r]){const s=te(n,t);return s===0?te(e,r):s}class DP{constructor(e){this.Un=e,this.buffer=new we(S_),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();S_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class OP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){j("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){qr(t)?j("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await $r(t)}await this.Hn(3e5)})}}class MP{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return V.resolve(Mt.oe);const r=new DP(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(x_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),x_):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),Ys()<=le.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${f} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function LP(n,e){return new MP(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,t){this.db=e,this.garbageCollector=LP(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Fl(e,r)}removeReference(e,t,r){return Fl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Fl(e,t)}nr(e,t){return function(s,i){let o=!1;return HE(s).Y(a=>QE(s,a,i).next(u=>(u&&(o=!0),V.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const u=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,J.min()),cr(e).delete(function(f){return[0,Pt(f.path)]}(o))))});s.push(u)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Fl(e,t)}tr(e,t){const r=cr(e);let s,i=Mt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(i!==Mt.oe&&t(new $(_n(s)),i),i=c,s=u):i=Mt.oe}).next(()=>{i!==Mt.oe&&t(new $(_n(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Fl(n,e){return cr(n).put(function(r,s){return{targetId:0,path:Pt(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.changes=new Kr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Pe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Jr(e).put(r)}removeEntry(e,t,r){return Jr(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],zu(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Pe.newInvalidDocument(t);return Jr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Co(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:Pe.newInvalidDocument(t)};return Jr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Co(t))},(s,i)=>{r={document:this.ir(t,i),size:qu(i)}}).next(()=>r)}getEntries(e,t){let r=Ft();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=Ft(),s=new xe($.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,qu(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return V.resolve();let s=new we(C_);t.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(Co(s.first()),Co(s.last())),o=s.getIterator();let a=o.getNext();return Jr(e).J({index:"documentKeyIndex",range:i},(u,c,d)=>{const f=$.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&C_(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Co(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),zu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Jr(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=Ft();for(const f of c){const m=this.ir($.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Ka(t,m)||s.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=Ft();const o=P_(t,r),a=P_(t,Wt.max());return Jr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,d)=>{const f=this.ir($.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new jP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return R_(e).get("remoteDocumentGlobalKey").next(t=>(Y(!!t),t))}rr(e,t){return R_(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=TP(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(J.min())))return r}return Pe.newInvalidDocument(e)}}function XE(n){return new BP(n)}class jP extends YE{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Kr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new we((i,o)=>te(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=f_(this.cr.serializer,o);s=s.add(i.path.popLast());const c=qu(u);r+=c-a.size,t.push(this.cr.addEntry(e,i,u))}else if(r-=a.size,this.trackRemovals){const u=f_(this.cr.serializer,o.convertToNoDocument(J.min()));t.push(this.cr.addEntry(e,i,u))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),V.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function R_(n){return Ze(n,"remoteDocumentGlobal")}function Jr(n){return Ze(n,"remoteDocumentsV14")}function Co(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function P_(n,e){const t=e.documentKey.path.toArray();return[n,zu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function C_(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=te(t[i],r[i]),s)return s;return s=te(t.length,r.length),s||(s=te(t[t.length-2],r[r.length-2]),s||te(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Xo(r.mutation,s,Lt.empty(),De.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const s=vn();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Mo();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=vn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Ft();const o=Yo(),a=function(){return Yo()}();return t.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof Yn)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Xo(d.mutation,c,d.mutation.getFieldMask(),De.now())):o.set(c.key,Lt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var f;return a.set(c,new UP(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Yo();let s=new xe((o,a)=>o-a),i=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(c===null)return;let d=r.get(u)||Lt.empty();d=a.applyToLocalView(c,d),r.set(u,d);const f=(s.get(a.batchId)||re()).add(u);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,d=u.value,f=yE();d.forEach(m=>{if(!i.has(m)){const _=xE(t.get(m),r.get(m));_!==null&&f.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return $.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ip(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):V.resolve(vn());let a=-1,u=i;return o.next(c=>V.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,re())).next(d=>({batchId:a,changes:gE(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let s=Mo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Mo();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,u=>{const c=function(f,m){return new Hn(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Pe.newInvalidDocument(d)))});let a=Mo();return o.forEach((u,c)=>{const d=i.get(u);d!==void 0&&Xo(d.mutation,c,Lt.empty(),De.now()),Ka(t,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return V.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Ge(s.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:kp(s.bundledQuery),readTime:Ge(s.readTime)}}(t)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.overlays=new xe($.comparator),this.Ir=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=vn();return V.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),V.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const s=vn(),i=t.length+1,o=new $(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return V.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new xe((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=vn(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=vn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return V.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Pp(t,r));let i=this.Ir.get(t);i===void 0&&(i=re(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(){this.sessionToken=ze.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this.Tr=new we(tt.Er),this.dr=new we(tt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new tt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new tt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new $(new oe([])),r=new tt(t,e),s=new tt(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new $(new oe([])),r=new tt(t,e),s=new tt(t,e+1);let i=re();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new tt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class tt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return $.comparator(e.key,t.key)||te(e.wr,t.wr)}static Ar(e,t){return te(e.wr,t.wr)||$.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new we(tt.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sp(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new tt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new tt(t,0),s=new tt(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new we(te);return t.forEach(s=>{const i=new tt(s,0),o=new tt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;$.isDocumentKey(i)||(i=i.child(""));const o=new tt(new $(i),0);let a=new we(te);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(u.wr)),!0)},o),V.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Y(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(t.mutations,s=>{const i=new tt(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new tt(t,0),s=this.br.firstAfterOrEqual(r);return V.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e){this.Mr=e,this.docs=function(){return new xe($.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():Pe.newInvalidDocument(t))}getEntries(e,t){let r=Ft();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Pe.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ft();const o=t.path,a=new $(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||yp(q0(d),r)<=0||(s.has(d.key)||Ka(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,t,r,s){W()}Or(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new WP(this)}getSize(e){return V.resolve(this.size)}}class WP extends YE{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e){this.persistence=e,this.Nr=new Kr(t=>As(t),$a),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Dp,this.targetCount=0,this.kr=bs.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),V.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new bs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Kn(t),V.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Mt(0),this.Kr=!1,this.Kr=!0,this.$r=new qP,this.referenceDelegate=e(this),this.Ur=new QP(this),this.indexManager=new kP,this.remoteDocumentCache=function(s){return new GP(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new $E(t),this.Gr=new zP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $P,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new KP(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){j("MemoryPersistence","Starting transaction:",e);const s=new HP(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class HP extends G0{constructor(e){super(),this.currentSequenceNumber=e}}class Ic{constructor(e){this.persistence=e,this.Jr=new Dp,this.Yr=null}static Zr(e){return new Ic(e)}get Xr(){if(this.Yr)return this.Yr;throw W()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{const s=$.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,J.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return V.or([()=>V.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.serializer=e}O(e,t,r,s){const i=new mc("createOrUpgrade",t);r<1&&s>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$y,{unique:!0}),u.createObjectStore("documentMutations")}(e),b_(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),b_(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$y,{unique:!0});const f=c.store("mutations"),m=d.map(_=>f.put(_));return V.waitFor(m)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore("documentOverlays",{keyPath:bR});c.createIndex("collectionPathOverlayIndex",kR,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",VR,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:vR});c.createIndex("documentKeyIndex",wR),c.createIndex("collectionGroupIndex",ER)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:SR}).createIndex("sequenceNumberIndex",RR,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:PR}).createIndex("documentKeyIndex",CR,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=qu(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>V.forEach(a,u=>{Y(u.userId===i.userId);const c=ss(this.serializer,u);return WE(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const u=new oe(o),c=function(f){return[0,Pt(f)]}(u);i.push(t.get(c).next(d=>d?V.resolve():(f=>t.put({targetId:0,path:Pt(f),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>V.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:AR});const r=t.store("collectionParents"),s=new Np,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Pt(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new oe(o);return i(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],c)=>{const d=_n(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Fo(s),o=qE(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),u=function(f){return f.document?new $(oe.fromString(f.document.name).popFirst(5)):f.noDocument?$.fromSegments(f.noDocument.path):f.unknownDocument?$.fromSegments(f.unknownDocument.path):W()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>V.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=XE(this.serializer),i=new ZE(Ic.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var c;let d=(c=a.get(u.userId))!==null&&c!==void 0?c:re();ss(this.serializer,u).keys().forEach(f=>d=d.add(f)),a.set(u.userId,d)}),V.forEach(a,(u,c)=>{const d=new rt(c),f=wc.lt(this.serializer,d),m=i.getIndexManager(d),_=Ec.lt(d,this.serializer,m,i.referenceDelegate);return new JE(s,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Ud(t,Mt.oe),u).next()})})}}function b_(n){n.createObjectStore("targetDocuments",{keyPath:TR}).createIndex("documentTargetsIndex",xR,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",IR,{unique:!0}),n.createObjectStore("targetGlobal")}const Fh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Op{constructor(e,t,r,s,i,o,a,u,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!Op.D())throw new F(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FP(this,s),this.Ai=t+"main",this.serializer=new $E(u),this.Ri=new Tn(this.Ai,this.hi,new YP(this.serializer)),this.$r=new AP,this.Ur=new NP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=XE(this.serializer),this.Gr=new xP,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Ke("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,Fh);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Mt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Bl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(qr(e))return j("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return j("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return bo(e).get("owner").next(t=>V.resolve(this.vi(t)))}Ci(e){return Bl(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Ze(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?V.resolve(!0):bo(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,Fh);return!1}}return!(!this.networkEnabled||!this.inForeground)||Bl(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&j("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Ud(e,Mt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Bl(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Ec.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new VP(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return wc.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){j("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(u){return u===17?OR:u===16?DR:u===15?vp:u===14?J0:u===13?X0:u===12?NR:u===11?Y0:void W()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new Ud(a,this.Qr?this.Qr.next():Mt.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw Ke(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new F(O.FAILED_PRECONDITION,K0);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return bo(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new F(O.FAILED_PRECONDITION,Fh)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bo(e).put("owner",t)}static D(){return Tn.D()}bi(e){const t=bo(e);return t.get("owner").next(r=>this.vi(r)?(j("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ke(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;v0()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return j("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ke("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ke("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bo(n){return Ze(n,"owner")}function Bl(n){return Ze(n,"clientMetadata")}function Mp(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=re(),s=re();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Lp(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return v0()?8:W0(Mu())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new XP;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Ys()<=le.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",Xs(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(Ys()<=le.DEBUG&&j("QueryEngine","Query:",Xs(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Ys()<=le.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",Xs(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ct(t))):V.resolve())}Yi(e,t){if(n_(t))return V.resolve(null);let r=Ct(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Uu(t,null,"F"),r=Ct(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=re(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(t,a);return this.ns(t,c,o,u.readTime)?this.Yi(e,Uu(t,null,"F")):this.rs(e,c,t,u)}))})))}Zi(e,t,r,s){return n_(t)||s.isEqual(J.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?V.resolve(null):(Ys()<=le.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xs(t)),this.rs(e,o,t,$0(s,-1)).next(a=>a))})}ts(e,t){let r=new we(pE(e));return t.forEach((s,i)=>{Ka(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return Ys()<=le.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Xs(t)),this.Ji.getDocumentsMatchingQuery(e,t,Wt.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new xe(te),this._s=new Kr(i=>As(i),$a),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function tI(n,e,t,r){return new JP(n,e,t,r)}async function nI(n,e){const t=K(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=re();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function ZP(n,e){const t=K(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,c,d){const f=c.batch,m=f.keys();let _=V.resolve();return m.forEach(R=>{_=_.next(()=>d.getEntry(u,R)).next(b=>{const N=c.docVersions.get(R);Y(N!==null),b.version.compareTo(N)<0&&(f.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),d.addEntry(b)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=re();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function rI(n){const e=K(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function eC(n,e){const t=K(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const m=s.get(f);if(!m)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(ze.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(f,_),function(b,N,x){return b.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(m,_,d)&&a.push(t.Ur.updateTargetData(i,_))});let u=Ft(),c=re();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(sI(i,o,e.documentUpdates).next(d=>{u=d.Ps,c=d.Is})),!r.isEqual(J.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(t.os=s,i))}function sI(n,e,t){let r=re(),s=re();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Ft();return t.forEach((a,u)=>{const c=i.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(J.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):j("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function tC(n,e){const t=K(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Fi(n,e){const t=K(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new Ln(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Bi(n,e,t){const r=K(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!qr(o))throw o;j("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ku(n,e,t){const r=K(n);let s=J.min(),i=re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const f=K(u),m=f._s.get(d);return m!==void 0?V.resolve(f.os.get(m)):f.Ur.getTargetData(c,d)}(r,o,Ct(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:J.min(),t?i:re())).next(a=>(aI(r,fE(e),a),{documents:a,Ts:i})))}function iI(n,e){const t=K(n),r=K(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function oI(n,e){const t=K(n),r=t.us.get(e)||J.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,$0(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(aI(t,e,s),s))}function aI(n,e,t){let r=n.us.get(e)||J.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function nC(n,e,t,r){const s=K(n);let i=re(),o=Ft();for(const c of t){const d=e.Es(c.metadata.name);c.document&&(i=i.add(d));const f=e.ds(c);f.setReadTime(e.As(c.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),u=await Fi(s,function(d){return Ct(Hi(oe.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>sI(c,a,o).next(d=>(a.apply(c),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(c,u.targetId).next(()=>s.Ur.addMatchingKeys(c,i,u.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,d.Ps,d.Is)).next(()=>d.Ps)))}async function rC(n,e,t=re()){const r=await Fi(n,Ct(kp(e.bundledQuery))),s=K(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Ge(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(ze.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function k_(n,e){return`firestore_clients_${n}_${e}`}function V_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Bh(n,e){return`firestore_targets_${n}_${e}`}class Gu{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new F(s.error.code,s.error.message))),o?new Gu(e,t,s.state,i):(Ke("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Jo{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new F(r.error.code,r.error.message))),i?new Jo(e,r.state,s):(Ke("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Tp();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=Q0(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Wu(e,i):(Ke("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Fp{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Fp(t.clientId,t.onlineState):(Ke("SharedClientState",`Failed to parse online state: ${e}`),null)}}class tf{constructor(){this.activeTargetIds=Tp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jh{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new xe(te),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=k_(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new tf),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(k_(this.persistenceKey,r));if(s){const i=Wu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Bh(this.persistenceKey,e));if(s){const i=Jo.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bh(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return j("SharedClientState","READ",e,t),t}setItem(e,t){j("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){j("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(j("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Ke("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=Mt.oe;if(i!=null)try{const a=JSON.parse(i);Y(typeof a=="number"),o=a}catch(a){Ke("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Mt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new Gu(this.currentUser,e,t,r),i=V_(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=V_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=Bh(this.persistenceKey,e),i=new Jo(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Wu.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Gu.Rs(new rt(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return Jo.Rs(s,t)}Ls(e){return Fp.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);j("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(u=>{s.has(u)||o.push(u)}),s.forEach(u=>{i.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Tp();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class lI{constructor(){this.so=new tf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new tf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){j("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){j("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jl=null;function Uh(){return jl===null?jl=function(){return 268435456+Math.round(2147483648*Math.random())}():jl++,"0x"+jl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t="WebChannelConnection";class aC extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Uh(),u=this.xo(t,r.toUriEncodedString());j("RestConnection",`Sending RPC '${t}' ${a}:`,u,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,u,c,s).then(d=>(j("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw An("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Qi}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=iC[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Uh();return new Promise((o,a)=>{const u=new O0;u.setWithCredentials(!0),u.listenOnce(M0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case tu.NO_ERROR:const d=u.getResponseJson();j(_t,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case tu.TIMEOUT:j(_t,`RPC '${e}' ${i} timed out`),a(new F(O.DEADLINE_EXCEEDED,"Request time out"));break;case tu.HTTP_ERROR:const f=u.getStatus();if(j(_t,`RPC '${e}' ${i} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const R=function(N){const x=N.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(x)>=0?x:O.UNKNOWN}(_.status);a(new F(R,_.message))}else a(new F(O.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new F(O.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{j(_t,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);j(_t,`RPC '${e}' ${i} sending request:`,s),u.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=Uh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=B0(),a=F0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=i.join("");j(_t,`Creating RPC '${e}' stream ${s}: ${d}`,u);const f=o.createWebChannel(d,u);let m=!1,_=!1;const R=new oC({Io:N=>{_?j(_t,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(m||(j(_t,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),j(_t,`RPC '${e}' stream ${s} sending:`,N),f.send(N))},To:()=>f.close()}),b=(N,x,E)=>{N.listen(x,A=>{try{E(A)}catch(D){setTimeout(()=>{throw D},0)}})};return b(f,Oo.EventType.OPEN,()=>{_||(j(_t,`RPC '${e}' stream ${s} transport opened.`),R.yo())}),b(f,Oo.EventType.CLOSE,()=>{_||(_=!0,j(_t,`RPC '${e}' stream ${s} transport closed`),R.So())}),b(f,Oo.EventType.ERROR,N=>{_||(_=!0,An(_t,`RPC '${e}' stream ${s} transport errored:`,N),R.So(new F(O.UNAVAILABLE,"The operation could not be completed")))}),b(f,Oo.EventType.MESSAGE,N=>{var x;if(!_){const E=N.data[0];Y(!!E);const A=E,D=A.error||((x=A[0])===null||x===void 0?void 0:x.error);if(D){j(_t,`RPC '${e}' stream ${s} received error:`,D);const B=D.status;let L=function(v){const I=Qe[v];if(I!==void 0)return RE(I)}(B),w=D.message;L===void 0&&(L=O.INTERNAL,w="Unknown error status: "+B+" with message "+D.message),_=!0,R.So(new F(L,w)),f.close()}else j(_t,`RPC '${e}' stream ${s} received:`,E),R.bo(E)}}),b(a,L0.STAT_EVENT,N=>{N.stat===Bd.PROXY?j(_t,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Bd.NOPROXY&&j(_t,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(){return typeof window<"u"?window:null}function lu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ha(n){return new fP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&j("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e,t,r,s,i,o,a,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Bp(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(Ke(t.toString()),Ke("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new F(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return j("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(j("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lC extends cI{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=gP(this.serializer,e),r=function(i){if(!("targetChange"in i))return J.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?J.min():o.readTime?Ge(o.readTime):J.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Yd(this.serializer),t.addTarget=function(i,o){let a;const u=o.target;if(a=Bu(u)?{documents:LE(i,u)}:{query:FE(i,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=kE(i,o.resumeToken);const c=Qd(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(J.min())>0){a.readTime=Li(i,o.snapshotVersion.toTimestamp());const c=Qd(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=_P(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Yd(this.serializer),t.removeTarget=e,this.a_(t)}}class uC extends cI{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=yP(e.writeResults,e.commitTime),r=Ge(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Yd(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Ca(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Hd(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new F(O.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Hd(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(O.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class hC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ke(t),this.D_=!1):j("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Gr(this)&&(j("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=K(u);c.L_.add(4),await Ji(c),c.q_.set("Unknown"),c.L_.delete(4),await Ya(c)}(this))})}),this.q_=new hC(r,s)}}async function Ya(n){if(Gr(n))for(const e of n.B_)await e(!0)}async function Ji(n){for(const e of n.B_)await e(!1)}function Tc(n,e){const t=K(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),zp(t)?Up(t):eo(t).r_()&&jp(t,e))}function ji(n,e){const t=K(n),r=eo(t);t.N_.delete(e),r.r_()&&hI(t,e),t.N_.size===0&&(r.r_()?r.o_():Gr(t)&&t.q_.set("Unknown"))}function jp(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}eo(n).A_(e)}function hI(n,e){n.Q_.xe(e),eo(n).R_(e)}function Up(n){n.Q_=new uP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),eo(n).start(),n.q_.v_()}function zp(n){return Gr(n)&&!eo(n).n_()&&n.N_.size>0}function Gr(n){return K(n).L_.size===0}function dI(n){n.Q_=void 0}async function fC(n){n.q_.set("Online")}async function pC(n){n.N_.forEach((e,t)=>{jp(n,e)})}async function mC(n,e){dI(n),zp(n)?(n.q_.M_(e),Up(n)):n.q_.set("Unknown")}async function gC(n,e,t){if(n.q_.set("Online"),e instanceof bE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){j("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qu(n,r)}else if(e instanceof au?n.Q_.Ke(e):e instanceof CE?n.Q_.He(e):n.Q_.We(e),!t.isEqual(J.min()))try{const r=await rI(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.N_.get(c);d&&i.N_.set(c,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const d=i.N_.get(u);if(!d)return;i.N_.set(u,d.withResumeToken(ze.EMPTY_BYTE_STRING,d.snapshotVersion)),hI(i,u);const f=new Ln(d.target,u,c,d.sequenceNumber);jp(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){j("RemoteStore","Failed to raise snapshot:",r),await Qu(n,r)}}async function Qu(n,e,t){if(!qr(e))throw e;n.L_.add(1),await Ji(n),n.q_.set("Offline"),t||(t=()=>rI(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{j("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Ya(n)})}function fI(n,e){return e().catch(t=>Qu(n,t,e))}async function Zi(n){const e=K(n),t=Mr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;yC(e);)try{const s=await tC(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,_C(e,s)}catch(s){await Qu(e,s)}pI(e)&&mI(e)}function yC(n){return Gr(n)&&n.O_.length<10}function _C(n,e){n.O_.push(e);const t=Mr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function pI(n){return Gr(n)&&!Mr(n).n_()&&n.O_.length>0}function mI(n){Mr(n).start()}async function vC(n){Mr(n).p_()}async function wC(n){const e=Mr(n);for(const t of n.O_)e.m_(t.mutations)}async function EC(n,e,t){const r=n.O_.shift(),s=Rp.from(r,e,t);await fI(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Zi(n)}async function IC(n,e){e&&Mr(n).V_&&await async function(r,s){if(function(o){return SE(o)&&o!==O.ABORTED}(s.code)){const i=r.O_.shift();Mr(r).s_(),await fI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Zi(r)}}(n,e),pI(n)&&mI(n)}async function D_(n,e){const t=K(n);t.asyncQueue.verifyOperationInProgress(),j("RemoteStore","RemoteStore received new credentials");const r=Gr(t);t.L_.add(3),await Ji(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Ya(t)}async function nf(n,e){const t=K(n);e?(t.L_.delete(2),await Ya(t)):e||(t.L_.add(2),await Ji(t),t.q_.set("Unknown"))}function eo(n){return n.K_||(n.K_=function(t,r,s){const i=K(t);return i.w_(),new lC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:fC.bind(null,n),Ro:pC.bind(null,n),mo:mC.bind(null,n),d_:gC.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),zp(n)?Up(n):n.q_.set("Unknown")):(await n.K_.stop(),dI(n))})),n.K_}function Mr(n){return n.U_||(n.U_=function(t,r,s){const i=K(t);return i.w_(),new uC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:vC.bind(null,n),mo:IC.bind(null,n),f_:wC.bind(null,n),g_:EC.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Zi(n)):(await n.U_.stop(),n.O_.length>0&&(j("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ht,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new $p(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function to(n,e){if(Ke("AsyncQueue",`${e}: ${n}`),qr(n))return new F(O.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this.comparator=e?(t,r)=>e(t,r)||$.comparator(t.key,r.key):(t,r)=>$.comparator(t.key,r.key),this.keyedMap=Mo(),this.sortedSet=new xe(this.comparator)}static emptySet(e){return new wi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof wi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new wi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(){this.W_=new xe($.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):W():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ui{constructor(e,t,r,s,i,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Ui(e,t,wi.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class xC{constructor(){this.queries=M_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=K(t),i=s.queries;s.queries=M_(),i.forEach((o,a)=>{for(const u of a.j_)u.onError(r)})})(this,new F(O.ABORTED,"Firestore shutting down"))}}function M_(){return new Kr(n=>dE(n),qa)}async function qp(n,e){const t=K(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new TC,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=to(o,`Initialization of query '${Xs(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&Gp(t)}async function Kp(n,e){const t=K(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function AC(n,e){const t=K(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&Gp(t)}function SC(n,e,t){const r=K(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function Gp(n){n.Y_.forEach(e=>{e.next()})}var rf,L_;(L_=rf||(rf={})).ea="default",L_.Cache="cache";class Wp{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ui(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ui.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==rf.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e){this.serializer=e}Es(e){return xn(this.serializer,e)}ds(e){return e.metadata.exists?ME(this.serializer,e.document,!1):Pe.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ge(e)}}class PC{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=gI(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=oe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new F_(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||re()).add(i);t.set(o,a)}}return t}async complete(){const e=await nC(this.localStore,new F_(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await rC(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function gI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(e){this.key=e}}class _I{constructor(e){this.key=e}}class vI{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=re(),this.mutatedKeys=re(),this.Aa=pE(e),this.Ra=new wi(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new O_,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const m=s.get(d),_=Ka(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),b=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let N=!1;m&&_?m.data.isEqual(_.data)?R!==b&&(r.track({type:3,doc:_}),N=!0):this.ga(m,_)||(r.track({type:2,doc:_}),N=!0,(u&&this.Aa(_,u)>0||c&&this.Aa(_,c)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),N=!0):m&&!_&&(r.track({type:1,doc:m}),N=!0,(u||c)&&(a=!0)),N&&(_?(o=o.add(_),i=b?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(_,R){const b=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return b(_)-b(R)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new Ui(this.query,e.Ra,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new O_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=re(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new _I(r))}),this.da.forEach(r=>{e.has(r)||t.push(new yI(r))}),t}ba(e){this.Ta=e.Ts,this.da=re();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ui.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class CC{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class bC{constructor(e){this.key=e,this.va=!1}}class kC{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Kr(a=>dE(a),qa),this.Ma=new Map,this.xa=new Set,this.Oa=new xe($.comparator),this.Na=new Map,this.La=new Dp,this.Ba={},this.ka=new Map,this.qa=bs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function VC(n,e,t=!0){const r=xc(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await wI(r,e,t,!0),s}async function NC(n,e){const t=xc(n);await wI(t,e,!0,!1)}async function wI(n,e,t,r){const s=await Fi(n.localStore,Ct(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Qp(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Tc(n.remoteStore,s),a}async function Qp(n,e,t,r,s){n.Ka=(f,m,_)=>async function(b,N,x,E){let A=N.view.ma(x);A.ns&&(A=await Ku(b.localStore,N.query,!1).then(({documents:w})=>N.view.ma(w,A)));const D=E&&E.targetChanges.get(N.targetId),B=E&&E.targetMismatches.get(N.targetId)!=null,L=N.view.applyChanges(A,b.isPrimaryClient,D,B);return sf(b,N.targetId,L.wa),L.snapshot}(n,f,m,_);const i=await Ku(n.localStore,e,!0),o=new vI(e,i.Ts),a=o.ma(i.documents),u=Qa.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,u);sf(n,t,c.wa);const d=new CC(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function DC(n,e,t){const r=K(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!qa(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Bi(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&ji(r.remoteStore,s.targetId),zi(r,s.targetId)}).catch($r)):(zi(r,s.targetId),await Bi(r.localStore,s.targetId,!0))}async function OC(n,e){const t=K(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ji(t.remoteStore,r.targetId))}async function MC(n,e,t){const r=Jp(n);try{const s=await function(o,a){const u=K(o),c=De.now(),d=a.reduce((_,R)=>_.add(R.key),re());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let R=Ft(),b=re();return u.cs.getEntries(_,d).next(N=>{R=N,R.forEach((x,E)=>{E.isValidDocument()||(b=b.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,R)).next(N=>{f=N;const x=[];for(const E of a){const A=oP(E,f.get(E.key).overlayedDocument);A!=null&&x.push(new Yn(E.key,A,rE(A.value.mapValue),Ne.exists(!0)))}return u.mutationQueue.addMutationBatch(_,c,x,a)}).next(N=>{m=N;const x=N.applyToLocalDocumentSet(f,b);return u.documentOverlayCache.saveOverlays(_,N.batchId,x)})}).then(()=>({batchId:m.batchId,changes:gE(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new xe(te)),c=c.insert(a,u),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await Xn(r,s.changes),await Zi(r.remoteStore)}catch(s){const i=to(s,"Failed to persist write");t.reject(i)}}async function EI(n,e){const t=K(n);try{const r=await eC(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(Y(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Y(o.va):s.removedDocuments.size>0&&(Y(o.va),o.va=!1))}),await Xn(t,r,e)}catch(r){await $r(r)}}function B_(n,e,t){const r=K(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=K(o);u.onlineState=a;let c=!1;u.queries.forEach((d,f)=>{for(const m of f.j_)m.Z_(a)&&(c=!0)}),c&&Gp(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function LC(n,e,t){const r=K(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new xe($.comparator);o=o.insert(i,Pe.newNoDocument(i,J.min()));const a=re().add(i),u=new Wa(J.min(),new Map,new xe(te),o,a);await EI(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Xp(r)}else await Bi(r.localStore,e,!1).then(()=>zi(r,e,t)).catch($r)}async function FC(n,e){const t=K(n),r=e.batch.batchId;try{const s=await ZP(t.localStore,e);Yp(t,r,null),Hp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Xn(t,s)}catch(s){await $r(s)}}async function BC(n,e,t){const r=K(n);try{const s=await function(o,a){const u=K(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,a).next(f=>(Y(f!==null),d=f.keys(),u.mutationQueue.removeMutationBatch(c,f))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);Yp(r,e,t),Hp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Xn(r,s)}catch(s){await $r(s)}}async function jC(n,e){const t=K(n);Gr(t.remoteStore)||j("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=K(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=to(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Hp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Yp(n,e,t){const r=K(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function zi(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||II(n,r)})}function II(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(ji(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Xp(n))}function sf(n,e,t){for(const r of t)r instanceof yI?(n.La.addReference(r.key,e),UC(n,r)):r instanceof _I?(j("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||II(n,r.key)):W()}function UC(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(j("SyncEngine","New document in limbo: "+t),n.xa.add(r),Xp(n))}function Xp(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new $(oe.fromString(e)),r=n.qa.next();n.Na.set(r,new bC(t)),n.Oa=n.Oa.insert(t,r),Tc(n.remoteStore,new Ln(Ct(Hi(t.path)),r,"TargetPurposeLimboResolution",Mt.oe))}}async function Xn(n,e,t){const r=K(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(c){s.push(c);const f=Lp.Wi(u.targetId,c);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,c){const d=K(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>V.forEach(c,m=>V.forEach(m.$i,_=>d.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>V.forEach(m.Ui,_=>d.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!qr(f))throw f;j("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const _=d.os.get(m),R=_.snapshotVersion,b=_.withLastLimboFreeSnapshotVersion(R);d.os=d.os.insert(m,b)}}}(r.localStore,i))}async function zC(n,e){const t=K(n);if(!t.currentUser.isEqual(e)){j("SyncEngine","User change. New user:",e.toKey());const r=await nI(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(u=>{u.reject(new F(O.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Xn(t,r.hs)}}function $C(n,e){const t=K(n),r=t.Na.get(e);if(r&&r.va)return re().add(r.key);{let s=re();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function qC(n,e){const t=K(n),r=await Ku(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&sf(t,e.targetId,s.wa),s}async function KC(n,e){const t=K(n);return oI(t.localStore,e).then(r=>Xn(t,r))}async function GC(n,e,t,r){const s=K(n),i=await function(a,u){const c=K(a),d=K(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,u).next(m=>m?c.localDocuments.getDocuments(f,m):V.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await Zi(s.remoteStore):t==="acknowledged"||t==="rejected"?(Yp(s,e,r||null),Hp(s,e),function(a,u){K(K(a).mutationQueue).On(u)}(s.localStore,e)):W(),await Xn(s,i)):j("SyncEngine","Cannot apply mutation batch with id: "+e)}async function WC(n,e){const t=K(n);if(xc(t),Jp(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await j_(t,r.toArray());t.Qa=!0,await nf(t.remoteStore,!0);for(const i of s)Tc(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(zi(t,o),Bi(t.localStore,o,!0))),ji(t.remoteStore,o)}),await s,await j_(t,r),function(o){const a=K(o);a.Na.forEach((u,c)=>{ji(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new xe($.comparator)}(t),t.Qa=!1,await nf(t.remoteStore,!1)}}async function j_(n,e,t){const r=K(n),s=[],i=[];for(const o of e){let a;const u=r.Ma.get(o);if(u&&u.length!==0){a=await Fi(r.localStore,Ct(u[0]));for(const c of u){const d=r.Fa.get(c),f=await qC(r,d);f.snapshot&&i.push(f.snapshot)}}else{const c=await iI(r.localStore,o);a=await Fi(r.localStore,c),await Qp(r,TI(c),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function TI(n){return hE(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function QC(n){return function(t){return K(K(t).persistence).Qi()}(K(n).localStore)}async function HC(n,e,t,r){const s=K(n);if(s.Qa)return void j("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await oI(s.localStore,fE(i[0])),a=Wa.createSynthesizedRemoteEventForCurrentChange(e,t==="current",ze.EMPTY_BYTE_STRING);await Xn(s,o,a);break}case"rejected":await Bi(s.localStore,e,!0),zi(s,e,r);break;default:W()}}async function YC(n,e,t){const r=xc(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){j("SyncEngine","Adding an already active target "+s);continue}const i=await iI(r.localStore,s),o=await Fi(r.localStore,i);await Qp(r,TI(i),o.targetId,!1,o.resumeToken),Tc(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await Bi(r.localStore,s,!1).then(()=>{ji(r.remoteStore,s),zi(r,s)}).catch($r)}}function xc(n){const e=K(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=EI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$C.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LC.bind(null,e),e.Ca.d_=AC.bind(null,e.eventManager),e.Ca.$a=SC.bind(null,e.eventManager),e}function Jp(n){const e=K(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=FC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BC.bind(null,e),e}function XC(n,e,t){const r=K(n);(async function(i,o,a){try{const u=await o.getMetadata();if(await function(_,R){const b=K(_),N=Ge(R.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",x=>b.Gr.getBundleMetadata(x,R.id)).then(x=>!!x&&x.createTime.compareTo(N)>=0)}(i.localStore,u))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(gI(u));const c=new PC(u,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const m=await c.la(d);m&&a._updateProgress(m),d=await o.Ua()}const f=await c.complete();return await Xn(i,f.Ia,void 0),await function(_,R){const b=K(_);return b.persistence.runTransaction("Save bundle","readwrite",N=>b.Gr.saveBundleMetadata(N,R))}(i.localStore,u),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(u){return An("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class ba{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ha(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return tI(this.persistence,new eI,e.initialUser,this.serializer)}Ga(e){return new ZE(Ic.Zr,this.serializer)}Wa(e){return new lI}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ba.provider={build:()=>new ba};class xI extends ba{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Jp(this.Ja.syncEngine),await Zi(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return tI(this.persistence,new eI,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new OP(r,e.asyncQueue,t)}Ha(e,t){const r=new gR(t,this.persistence);return new mR(e.asyncQueue,r)}Ga(e){const t=Mp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Nt.withCacheSize(this.cacheSizeBytes):Nt.DEFAULT;return new Op(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,uI(),lu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new lI}}class JC extends xI{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof jh&&(this.sharedClientState.syncEngine={no:GC.bind(null,t),ro:HC.bind(null,t),io:YC.bind(null,t),Qi:QC.bind(null,t),eo:KC.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await WC(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=uI();if(!jh.D(t))throw new F(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Mp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jh(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class ka{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>B_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=zC.bind(null,this.syncEngine),await nf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new xC}()}createDatastore(e){const t=Ha(e.databaseInfo.databaseId),r=function(i){return new aC(i)}(e.databaseInfo);return function(i,o,a,u){return new cC(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new dC(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>B_(this.syncEngine,t,0),function(){return N_.D()?new N_:new sC}())}createSyncEngine(e,t){return function(s,i,o,a,u,c,d){const f=new kC(s,i,o,a,u,c);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=K(s);j("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Ji(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ka.provider={build:()=>new ka};function U_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ke("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new ht,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new RC(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e===123)}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new F(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=K(s),a={documents:i.map(f=>Pa(o.serializer,f))},u=await o.Lo("BatchGetDocuments",o.serializer.databaseId,oe.emptyPath(),a,i.length),c=new Map;u.forEach(f=>{const m=mP(o.serializer,f);c.set(m.key.toString(),m)});const d=[];return i.forEach(f=>{const m=c.get(f.toString());Y(!!m),d.push(m)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=$.fromPath(r);this.mutations.push(new Ap(s,this.precondition(s)))}),await async function(r,s){const i=K(r),o={writes:s.map(a=>Ca(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,oe.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw W();t=J.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new F(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(J.min())?Ne.exists(!1):Ne.updateTime(t):Ne.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(J.min()))throw new F(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ne.updateTime(t)}return Ne.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new Bp(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new eb(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!za(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!SE(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=rt.UNAUTHENTICATED,this.clientId=U0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{j("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ht;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=to(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function zh(n,e){n.asyncQueue.verifyOperationInProgress(),j("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await nI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function z_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Zp(n);j("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>D_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>D_(e.remoteStore,s)),n._onlineComponents=e}async function Zp(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){j("FirestoreClient","Using user provided OfflineComponentProvider");try{await zh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===O.FAILED_PRECONDITION||s.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;An("Error using user provided cache. Falling back to memory cache: "+t),await zh(n,new ba)}}else j("FirestoreClient","Using default OfflineComponentProvider"),await zh(n,new ba);return n._offlineComponents}async function Sc(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(j("FirestoreClient","Using user provided OnlineComponentProvider"),await z_(n,n._uninitializedComponentsProvider._online)):(j("FirestoreClient","Using default OnlineComponentProvider"),await z_(n,new ka))),n._onlineComponents}function AI(n){return Zp(n).then(e=>e.persistence)}function em(n){return Zp(n).then(e=>e.localStore)}function SI(n){return Sc(n).then(e=>e.remoteStore)}function tm(n){return Sc(n).then(e=>e.syncEngine)}function rb(n){return Sc(n).then(e=>e.datastore)}async function $i(n){const e=await Sc(n),t=e.eventManager;return t.onListen=VC.bind(null,e.syncEngine),t.onUnlisten=DC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=OC.bind(null,e.syncEngine),t}function sb(n){return n.asyncQueue.enqueue(async()=>{const e=await AI(n),t=await SI(n);return e.setNetworkEnabled(!0),function(s){const i=K(s);return i.L_.delete(0),Ya(i)}(t)})}function ib(n){return n.asyncQueue.enqueue(async()=>{const e=await AI(n),t=await SI(n);return e.setNetworkEnabled(!1),async function(s){const i=K(s);i.L_.add(0),await Ji(i),i.q_.set("Offline")}(t)})}function ob(n,e){const t=new ht;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,d){const f=K(c);return f.persistence.runTransaction("read document","readonly",m=>f.localDocuments.getDocument(m,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new F(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const u=to(a,`Failed to get document '${i} from cache`);o.reject(u)}}(await em(n),e,t)),t.promise}function RI(n,e,t={}){const r=new ht;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new Ac({next:m=>{d.Za(),o.enqueueAndForget(()=>Kp(i,f));const _=m.docs.has(a);!_&&m.fromCache?c.reject(new F(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&u.source==="server"?c.reject(new F(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new Wp(Hi(a.path),d,{includeMetadataChanges:!0,_a:!0});return qp(i,f)}(await $i(n),n.asyncQueue,e,t,r)),r.promise}function ab(n,e){const t=new ht;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await Ku(s,i,!0),u=new vI(i,a.Ts),c=u.ma(a.documents),d=u.applyChanges(c,!1);o.resolve(d.snapshot)}catch(a){const u=to(a,`Failed to execute query '${i} against cache`);o.reject(u)}}(await em(n),e,t)),t.promise}function PI(n,e,t={}){const r=new ht;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new Ac({next:m=>{d.Za(),o.enqueueAndForget(()=>Kp(i,f)),m.fromCache&&u.source==="server"?c.reject(new F(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new Wp(a,d,{includeMetadataChanges:!0,_a:!0});return qp(i,f)}(await $i(n),n.asyncQueue,e,t,r)),r.promise}function lb(n,e){const t=new Ac(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){K(s).Y_.add(i),i.next()}(await $i(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){K(s).Y_.delete(i)}(await $i(n),t))}}function ub(n,e,t,r){const s=function(o,a){let u;return u=typeof o=="string"?PE().encode(o):o,function(d,f){return new ZC(d,f)}(function(d,f){if(d instanceof Uint8Array)return U_(d,f);if(d instanceof ArrayBuffer)return U_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,Ha(e));n.asyncQueue.enqueueAndForget(async()=>{XC(await tm(n),s,r)})}function cb(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=K(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await em(n),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nm(n,e,t){if(!t)throw new F(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function bI(n,e,t,r){if(e===!0&&r===!0)throw new F(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function q_(n){if(!$.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function K_(n){if($.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Rc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W()}function pe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Rc(n);throw new F(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function kI(n,e){if(e<=0)throw new F(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xa{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new G_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new F(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new G_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new sR;switch(r.type){case"firstParty":return new lR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=$_.get(t);r&&(j("ComponentProvider","Removing Datastore"),$_.delete(t),r.terminate())}(this),Promise.resolve()}}function hb(n,e,t,r={}){var s;const i=(n=pe(n,Xa))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&An("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=rt.MOCK_USER;else{a=xS(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new F(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new rt(c)}n._authCredentials=new iR(new j0(a,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bt=class VI{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new VI(this.firestore,e,this._query)}},Le=class NI{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new NI(this.firestore,e,this._key)}},Sr=class DI extends bt{constructor(e,t,r){super(e,t,Hi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new $(e))}withConverter(e){return new DI(this.firestore,e,this._path)}};function OI(n,e,...t){if(n=Ye(n),nm("collection","path",e),n instanceof Xa){const r=oe.fromString(e,...t);return K_(r),new Sr(n,null,r)}{if(!(n instanceof Le||n instanceof Sr))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(oe.fromString(e,...t));return K_(r),new Sr(n.firestore,null,r)}}function db(n,e){if(n=pe(n,Xa),nm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new bt(n,null,function(r){return new Hn(oe.emptyPath(),r)}(e))}function Hu(n,e,...t){if(n=Ye(n),arguments.length===1&&(e=U0.newId()),nm("doc","path",e),n instanceof Xa){const r=oe.fromString(e,...t);return q_(r),new Le(n,null,new $(r))}{if(!(n instanceof Le||n instanceof Sr))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(oe.fromString(e,...t));return q_(r),new Le(n.firestore,n instanceof Sr?n.converter:null,new $(r))}}function MI(n,e){return n=Ye(n),e=Ye(e),(n instanceof Le||n instanceof Sr)&&(e instanceof Le||e instanceof Sr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function LI(n,e){return n=Ye(n),e=Ye(e),n instanceof bt&&e instanceof bt&&n.firestore===e.firestore&&qa(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Bp(this,"async_queue_retry"),this.Vu=()=>{const r=lu();r&&j("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=lu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=lu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new ht;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!qr(e))throw e;j("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ke("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=$p.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&W()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function of(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class fb{constructor(){this._progressObserver={},this._taskCompletionResolver=new ht,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=-1;let We=class extends Xa{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new W_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new W_(e),this._firestoreClient=void 0,await e}}};function Et(n){if(n._terminated)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||FI(n),n._firestoreClient}function FI(n){var e,t,r;const s=n._freezeSettings(),i=function(a,u,c,d){return new FR(a,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,CI(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new nb(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(n._componentsProvider))}function mb(n,e){An("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return BI(n,ka.provider,{build:r=>new xI(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function gb(n){An("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();BI(n,ka.provider,{build:t=>new JC(t,e.cacheSizeBytes)})}function BI(n,e,t){if((n=pe(n,We))._firestoreClient||n._terminated)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},FI(n)}function yb(n){if(n._initialized&&!n._terminated)throw new F(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ht;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Tn.D())return Promise.resolve();const s=r+"main";await Tn.delete(s)}(Mp(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function _b(n){return function(t){const r=new ht;return t.asyncQueue.enqueueAndForget(async()=>jC(await tm(t),r)),r.promise}(Et(n=pe(n,We)))}function vb(n){return sb(Et(n=pe(n,We)))}function wb(n){return ib(Et(n=pe(n,We)))}function Eb(n,e){const t=Et(n=pe(n,We)),r=new fb;return ub(t,n._databaseId,e,r),r}function Ib(n,e){return cb(Et(n=pe(n,We)),e).then(t=>t?new bt(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rn(ze.fromBase64String(e))}catch(t){throw new F(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Rn(ze.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ms=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return te(this._lat,e._lat)||te(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb=/^__.*__$/;class xb{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Yn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yi(e,this.data,t,this.fieldTransforms)}}class jI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Yn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function UI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}class Cc{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Cc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(UI(this.Cu)&&Tb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Ab{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ha(e)}Qu(e,t,r,s=!1){return new Cc({Cu:e,methodName:t,qu:r,path:Ve.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ls(n){const e=n._freezeSettings(),t=Ha(n._databaseId);return new Ab(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bc(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);cm("Data must be an object, but it was:",o,r);const a=qI(r,o);let u,c;if(i.merge)u=new Lt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const m=af(e,f,t);if(!o.contains(m))throw new F(O.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);GI(d,m)||d.push(m)}u=new Lt(d),c=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,c=o.fieldTransforms;return new xb(new ut(a),u,c)}class Ja extends Ms{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ja}}function zI(n,e,t){return new Cc({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class sm extends Ms{_toFieldTransform(e){return new Ga(e.path,new Oi)}isEqual(e){return e instanceof sm}}class im extends Ms{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=zI(this,e,!0),r=this.Ku.map(i=>Fs(i,t)),s=new Ss(r);return new Ga(e.path,s)}isEqual(e){return e instanceof im&&_a(this.Ku,e.Ku)}}class om extends Ms{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=zI(this,e,!0),r=this.Ku.map(i=>Fs(i,t)),s=new Rs(r);return new Ga(e.path,s)}isEqual(e){return e instanceof om&&_a(this.Ku,e.Ku)}}class am extends Ms{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Mi(e.serializer,vE(e.serializer,this.$u));return new Ga(e.path,t)}isEqual(e){return e instanceof am&&this.$u===e.$u}}function lm(n,e,t,r){const s=n.Qu(1,e,t);cm("Data must be an object, but it was:",s,r);const i=[],o=ut.empty();Os(r,(u,c)=>{const d=hm(e,u,t);c=Ye(c);const f=s.Nu(d);if(c instanceof Ja)i.push(d);else{const m=Fs(c,f);m!=null&&(i.push(d),o.set(d,m))}});const a=new Lt(i);return new jI(o,a,s.fieldTransforms)}function um(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[af(e,r,t)],u=[s];if(i.length%2!=0)throw new F(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(af(e,i[m])),u.push(i[m+1]);const c=[],d=ut.empty();for(let m=a.length-1;m>=0;--m)if(!GI(c,a[m])){const _=a[m];let R=u[m];R=Ye(R);const b=o.Nu(_);if(R instanceof Ja)c.push(_);else{const N=Fs(R,b);N!=null&&(c.push(_),d.set(_,N))}}const f=new Lt(c);return new jI(d,f,o.fieldTransforms)}function $I(n,e,t,r=!1){return Fs(t,n.Qu(r?4:3,e))}function Fs(n,e){if(KI(n=Ye(n)))return cm("Unsupported field value:",e,n),qI(n,e);if(n instanceof Ms)return function(r,s){if(!UI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let u=Fs(a,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vE(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=De.fromDate(r);return{timestampValue:Li(s.serializer,i)}}if(r instanceof De){const i=new De(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Li(s.serializer,i)}}if(r instanceof Pc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Rn)return{bytesValue:kE(s.serializer,r._byteString)};if(r instanceof Le){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof rm)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return xp(a.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Rc(r)}`)}(n,e)}function qI(n,e){const t={};return Z0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Os(n,(r,s)=>{const i=Fs(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function KI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof De||n instanceof Pc||n instanceof Rn||n instanceof Le||n instanceof Ms||n instanceof rm)}function cm(n,e,t){if(!KI(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Rc(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function af(n,e,t){if((e=Ye(e))instanceof Lr)return e._internalPath;if(typeof e=="string")return hm(n,e);throw Yu("Field path arguments must be of type string or ",n,!1,void 0,t)}const Sb=new RegExp("[~\\*/\\[\\]]");function hm(n,e,t){if(e.search(Sb)>=0)throw Yu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Lr(...e.split("."))._internalPath}catch{throw Yu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yu(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new F(O.INVALID_ARGUMENT,a+n+u)}function GI(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Rb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(kc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Rb extends Va{data(){return super.data()}}function kc(n,e){return typeof e=="string"?hm(n,e):e instanceof Lr?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dm{}class Za extends dm{}function sr(n,e,...t){let r=[];e instanceof dm&&r.push(e),r=r.concat(t),function(i){const o=i.filter(u=>u instanceof fm).length,a=i.filter(u=>u instanceof Vc).length;if(o>1||o>0&&a>0)throw new F(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class Vc extends Za{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Vc(e,t,r)}_apply(e){const t=this._parse(e);return HI(e._query,t),new bt(e.firestore,e.converter,Wd(e._query,t))}_parse(e){const t=Ls(e.firestore);return function(i,o,a,u,c,d,f){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new F(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){H_(f,d);const _=[];for(const R of f)_.push(Q_(u,i,R));m={arrayValue:{values:_}}}else m=Q_(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||H_(f,d),m=$I(a,o,f,d==="in"||d==="not-in");return ae.create(c,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Pb(n,e,t){const r=e,s=kc("where",n);return Vc._create(s,r,t)}class fm extends dm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fm(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:_e.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const u of a)HI(o,u),o=Wd(o,u)}(e._query,t),new bt(e.firestore,e.converter,Wd(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class pm extends Za{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new pm(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ra(i,o)}(e._query,this._field,this._direction);return new bt(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Hn(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function Cb(n,e="asc"){const t=e,r=kc("orderBy",n);return pm._create(r,t)}class Nc extends Za{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Nc(e,t,r)}_apply(e){return new bt(e.firestore,e.converter,Uu(e._query,this._limit,this._limitType))}}function bb(n){return kI("limit",n),Nc._create("limit",n,"F")}function kb(n){return kI("limitToLast",n),Nc._create("limitToLast",n,"L")}class Dc extends Za{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Dc(e,t,r)}_apply(e){const t=QI(e,this.type,this._docOrFields,this._inclusive);return new bt(e.firestore,e.converter,function(s,i){return new Hn(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function Vb(...n){return Dc._create("startAt",n,!0)}function Nb(...n){return Dc._create("startAfter",n,!1)}class Oc extends Za{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Oc(e,t,r)}_apply(e){const t=QI(e,this.type,this._docOrFields,this._inclusive);return new bt(e.firestore,e.converter,function(s,i){return new Hn(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function Db(...n){return Oc._create("endBefore",n,!1)}function Ob(...n){return Oc._create("endAt",n,!0)}function QI(n,e,t,r){if(t[0]=Ye(t[0]),t[0]instanceof Va)return function(i,o,a,u,c){if(!u)throw new F(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of vi(i))if(f.field.isKeyField())d.push(xs(o,u.key));else{const m=u.data.field(f.field);if(gc(m))throw new F(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=f.field.canonicalString();throw new F(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new Or(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Ls(n.firestore);return function(o,a,u,c,d,f){const m=o.explicitOrderBy;if(d.length>m.length)throw new F(O.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let R=0;R<d.length;R++){const b=d[R];if(m[R].field.isKeyField()){if(typeof b!="string")throw new F(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof b}`);if(!Ip(o)&&b.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${b}' contains a slash.`);const N=o.path.child(oe.fromString(b));if(!$.isDocumentKey(N))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const x=new $(N);_.push(xs(a,x))}else{const N=$I(u,c,b);_.push(N)}}return new Or(_,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function Q_(n,e,t){if(typeof(t=Ye(t))=="string"){if(t==="")throw new F(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ip(e)&&t.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(oe.fromString(t));if(!$.isDocumentKey(r))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xs(n,new $(r))}if(t instanceof Le)return xs(n,t._key);throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rc(t)}.`)}function H_(n,e){if(!Array.isArray(n)||n.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function HI(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class mm{convertValue(e,t="none"){switch(Ts(e)){case 0:return null;case 1:return e.booleanValue;case 2:return be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Vr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Os(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>be(o.doubleValue));return new rm(i)}convertGeoPoint(e){return new Pc(be(e.latitude),be(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=wp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(xa(e));default:return null}}convertTimestamp(e){const t=Kn(e);return new De(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=oe.fromString(e);Y(zE(r));const s=new Nr(r.get(1),r.get(3)),i=new $(r.popFirst(5));return s.isEqual(t)||Ke(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Mb extends mm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Gn=class extends Va{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Zo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(kc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Zo=class extends Gn{data(e={}){return super.data(e)}},Fr=class{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new hs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Zo(this._firestore,this._userDataWriter,r.key,r,new hs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const u=new Zo(s._firestore,s._userDataWriter,a.doc.key,a.doc,new hs(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new Zo(s._firestore,s._userDataWriter,a.doc.key,a.doc,new hs(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Lb(a.type),doc:u,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Lb(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function YI(n,e){return n instanceof Gn&&e instanceof Gn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Fr&&e instanceof Fr&&n._firestore===e._firestore&&LI(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(n){n=pe(n,Le);const e=pe(n.firestore,We);return RI(Et(e),n._key).then(t=>gm(e,n,t))}class Bs extends mm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}}function Bb(n){n=pe(n,Le);const e=pe(n.firestore,We),t=Et(e),r=new Bs(e);return ob(t,n._key).then(s=>new Gn(e,r,n._key,s,new hs(s!==null&&s.hasLocalMutations,!0),n.converter))}function jb(n){n=pe(n,Le);const e=pe(n.firestore,We);return RI(Et(e),n._key,{source:"server"}).then(t=>gm(e,n,t))}function Ub(n){n=pe(n,bt);const e=pe(n.firestore,We),t=Et(e),r=new Bs(e);return WI(n._query),PI(t,n._query).then(s=>new Fr(e,r,n,s))}function zb(n){n=pe(n,bt);const e=pe(n.firestore,We),t=Et(e),r=new Bs(e);return ab(t,n._query).then(s=>new Fr(e,r,n,s))}function $b(n){n=pe(n,bt);const e=pe(n.firestore,We),t=Et(e),r=new Bs(e);return PI(t,n._query,{source:"server"}).then(s=>new Fr(e,r,n,s))}function Y_(n,e,t){n=pe(n,Le);const r=pe(n.firestore,We),s=Mc(n.converter,e,t);return el(r,[bc(Ls(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Ne.none())])}function X_(n,e,t,...r){n=pe(n,Le);const s=pe(n.firestore,We),i=Ls(s);let o;return o=typeof(e=Ye(e))=="string"||e instanceof Lr?um(i,"updateDoc",n._key,e,t,r):lm(i,"updateDoc",n._key,e),el(s,[o.toMutation(n._key,Ne.exists(!0))])}function qb(n){return el(pe(n.firestore,We),[new Xi(n._key,Ne.none())])}function Kb(n,e){const t=pe(n.firestore,We),r=Hu(n),s=Mc(n.converter,e);return el(t,[bc(Ls(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Ne.exists(!1))]).then(()=>r)}function XI(n,...e){var t,r,s;n=Ye(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||of(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(of(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let u,c,d;if(n instanceof Le)c=pe(n.firestore,We),d=Hi(n._key.path),u={next:f=>{e[o]&&e[o](gm(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=pe(n,bt);c=pe(f.firestore,We),d=f._query;const m=new Bs(c);u={next:_=>{e[o]&&e[o](new Fr(c,m,f,_))},error:e[o+1],complete:e[o+2]},WI(n._query)}return function(m,_,R,b){const N=new Ac(b),x=new Wp(_,N,R);return m.asyncQueue.enqueueAndForget(async()=>qp(await $i(m),x)),()=>{N.Za(),m.asyncQueue.enqueueAndForget(async()=>Kp(await $i(m),x))}}(Et(c),d,a,u)}function Gb(n,e){return lb(Et(n=pe(n,We)),of(e)?e:{next:e})}function el(n,e){return function(r,s){const i=new ht;return r.asyncQueue.enqueueAndForget(async()=>MC(await tm(r),s,i)),i.promise}(Et(n),e)}function gm(n,e,t){const r=t.docs.get(e._key),s=new Bs(n);return new Gn(n,s,e._key,r,new hs(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qb=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ls(e)}set(e,t,r){this._verifyNotCommitted();const s=hr(e,this._firestore),i=Mc(s.converter,t,r),o=bc(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Ne.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=hr(e,this._firestore);let o;return o=typeof(t=Ye(t))=="string"||t instanceof Lr?um(this._dataReader,"WriteBatch.update",i._key,t,r,s):lm(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Ne.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hr(e,this._firestore);return this._mutations=this._mutations.concat(new Xi(t._key,Ne.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new F(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function hr(n,e){if((n=Ye(n)).firestore!==e)throw new F(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hb=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ls(t)}get(t){const r=hr(t,this._firestore),s=new Mb(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return W();const o=i[0];if(o.isFoundDocument())return new Va(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new Va(this._firestore,s,r._key,null,r.converter);throw W()})}set(t,r,s){const i=hr(t,this._firestore),o=Mc(i.converter,r,s),a=bc(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=hr(t,this._firestore);let a;return a=typeof(r=Ye(r))=="string"||r instanceof Lr?um(this._dataReader,"Transaction.update",o._key,r,s,i):lm(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=hr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=hr(e,this._firestore),r=new Bs(this._firestore);return super.get(e).then(s=>new Gn(this._firestore,r,t._key,s._document,new hs(!1,!1),t.converter))}};function Yb(n,e,t){n=pe(n,We);const r=Object.assign(Object.assign({},Wb),t);return function(i){if(i.maxAttempts<1)throw new F(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const u=new ht;return i.asyncQueue.enqueueAndForget(async()=>{const c=await rb(i);new tb(i.asyncQueue,c,a,o,u).au()}),u.promise}(Et(n),s=>e(new Hb(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(){return new Ja("deleteField")}function Jb(){return new sm("serverTimestamp")}function Zb(...n){return new im("arrayUnion",n)}function ek(...n){return new om("arrayRemove",n)}function tk(n){return new am("increment",n)}(function(e,t=!0){(function(s){Qi=s})(fp),bi(new Is("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new We(new oR(r.getProvider("auth-internal")),new cR(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new F(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nr(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Bn(jy,"4.7.3",e),Bn(jy,"4.7.3","esm2017")})();const nk="@firebase/firestore-compat",rk="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ym(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new F("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(){if(typeof Uint8Array>"u")throw new F("unimplemented","Uint8Arrays are not available in this environment.")}function Z_(){if(!MR())throw new F("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Na{constructor(e){this._delegate=e}static fromBase64String(e){return Z_(),new Na(Rn.fromBase64String(e))}static fromUint8Array(e){return J_(),new Na(Rn.fromUint8Array(e))}toBase64(){return Z_(),this._delegate.toBase64()}toUint8Array(){return J_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(n){return sk(n,["next","error","complete"])}function sk(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{enableIndexedDbPersistence(e,t){return mb(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return gb(e._delegate)}clearIndexedDbPersistence(e){return yb(e._delegate)}}class JI{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Nr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&An("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){hb(this._delegate,e,t,r)}enableNetwork(){return vb(this._delegate)}disableNetwork(){return wb(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,bI("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return _b(this._delegate)}onSnapshotsInSync(e){return Gb(this._delegate,e)}get app(){if(!this._appCompat)throw new F("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new qi(this,OI(this._delegate,e))}catch(t){throw St(t,"collection()","Firestore.collection()")}}doc(e){try{return new tn(this,Hu(this._delegate,e))}catch(t){throw St(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new At(this,db(this._delegate,e))}catch(t){throw St(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Yb(this._delegate,t=>e(new ZI(this,t)))}batch(){return Et(this._delegate),new eT(new Qb(this._delegate,e=>el(this._delegate,e)))}loadBundle(e){return Eb(this._delegate,e)}namedQuery(e){return Ib(this._delegate,e).then(t=>t?new At(this,t):null)}}class Lc extends mm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Na(new Rn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return tn.forKey(t,this.firestore,null)}}function ok(n){nR(n)}class ZI{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Lc(e)}get(e){const t=ds(e);return this._delegate.get(t).then(r=>new Da(this._firestore,new Gn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=ds(e);return r?(ym("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=ds(e);return arguments.length===2?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=ds(e);return this._delegate.delete(t),this}}class eT{constructor(e){this._delegate=e}set(e,t,r){const s=ds(e);return r?(ym("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=ds(e);return arguments.length===2?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=ds(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ks{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Zo(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Oa(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=ks.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(t);return i||(i=new ks(e,new Lc(e),t),s.set(t,i)),i}}ks.INSTANCES=new WeakMap;class tn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Lc(e)}static forPath(e,t,r){if(e.length%2!==0)throw new F("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new tn(t,new Le(t._delegate,r,new $(e)))}static forKey(e,t,r){return new tn(t,new Le(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new qi(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new qi(this.firestore,OI(this._delegate,e))}catch(t){throw St(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ye(e),e instanceof Le?MI(this._delegate,e):!1}set(e,t){t=ym("DocumentReference.set",t);try{return t?Y_(this._delegate,e,t):Y_(this._delegate,e)}catch(r){throw St(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?X_(this._delegate,e):X_(this._delegate,e,t,...r)}catch(s){throw St(s,"updateDoc()","DocumentReference.update()")}}delete(){return qb(this._delegate)}onSnapshot(...e){const t=tT(e),r=nT(e,s=>new Da(this.firestore,new Gn(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return XI(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Bb(this._delegate):(e==null?void 0:e.source)==="server"?t=jb(this._delegate):t=Fb(this._delegate),t.then(r=>new Da(this.firestore,new Gn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new tn(this.firestore,e?this._delegate.withConverter(ks.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function St(n,e,t){return n.message=n.message.replace(e,t),n}function tT(n){for(const e of n)if(typeof e=="object"&&!lf(e))return e;return{}}function nT(n,e){var t,r;let s;return lf(n[0])?s=n[0]:lf(n[1])?s=n[1]:typeof n[0]=="function"?s={next:n[0],error:n[1],complete:n[2]}:s={next:n[1],error:n[2],complete:n[3]},{next:i=>{s.next&&s.next(e(i))},error:(t=s.error)===null||t===void 0?void 0:t.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class Da{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new tn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return YI(this._delegate,e._delegate)}}class Oa extends Da{data(e){const t=this._delegate.data(e);return this._delegate._converter||rR(t!==void 0),t}}class At{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Lc(e)}where(e,t,r){try{return new At(this.firestore,sr(this._delegate,Pb(e,t,r)))}catch(s){throw St(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new At(this.firestore,sr(this._delegate,Cb(e,t)))}catch(r){throw St(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new At(this.firestore,sr(this._delegate,bb(e)))}catch(t){throw St(t,"limit()","Query.limit()")}}limitToLast(e){try{return new At(this.firestore,sr(this._delegate,kb(e)))}catch(t){throw St(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new At(this.firestore,sr(this._delegate,Vb(...e)))}catch(t){throw St(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new At(this.firestore,sr(this._delegate,Nb(...e)))}catch(t){throw St(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new At(this.firestore,sr(this._delegate,Db(...e)))}catch(t){throw St(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new At(this.firestore,sr(this._delegate,Ob(...e)))}catch(t){throw St(t,"endAt()","Query.endAt()")}}isEqual(e){return LI(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=zb(this._delegate):(e==null?void 0:e.source)==="server"?t=$b(this._delegate):t=Ub(this._delegate),t.then(r=>new uf(this.firestore,new Fr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=tT(e),r=nT(e,s=>new uf(this.firestore,new Fr(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return XI(this._delegate,t,r)}withConverter(e){return new At(this.firestore,e?this._delegate.withConverter(ks.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class ak{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Oa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class uf{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new At(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Oa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new ak(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Oa(this._firestore,r))})}isEqual(e){return YI(this._delegate,e._delegate)}}class qi extends At{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new tn(this.firestore,e):null}doc(e){try{return e===void 0?new tn(this.firestore,Hu(this._delegate)):new tn(this.firestore,Hu(this._delegate,e))}catch(t){throw St(t,"doc()","CollectionReference.doc()")}}add(e){return Kb(this._delegate,e).then(t=>new tn(this.firestore,t))}isEqual(e){return MI(this._delegate,e._delegate)}withConverter(e){return new qi(this.firestore,e?this._delegate.withConverter(ks.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ds(n){return pe(n,Le)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(...e){this._delegate=new Lr(...e)}static documentId(){return new _m(Ve.keyField().canonicalString())}isEqual(e){return e=Ye(e),e instanceof Lr?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this._delegate=e}static serverTimestamp(){const e=Jb();return e._methodName="FieldValue.serverTimestamp",new as(e)}static delete(){const e=Xb();return e._methodName="FieldValue.delete",new as(e)}static arrayUnion(...e){const t=Zb(...e);return t._methodName="FieldValue.arrayUnion",new as(t)}static arrayRemove(...e){const t=ek(...e);return t._methodName="FieldValue.arrayRemove",new as(t)}static increment(e){const t=tk(e);return t._methodName="FieldValue.increment",new as(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk={Firestore:JI,GeoPoint:Pc,Timestamp:De,Blob:Na,Transaction:ZI,WriteBatch:eT,DocumentReference:tn,DocumentSnapshot:Da,Query:At,QueryDocumentSnapshot:Oa,QuerySnapshot:uf,CollectionReference:qi,FieldPath:_m,FieldValue:as,setLogLevel:ok,CACHE_SIZE_UNLIMITED:pb};function uk(n,e){n.INTERNAL.registerComponent(new Is("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},lk)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(n){uk(n,(e,t)=>new JI(e,t,new ik)),n.registerVersion(nk,rk)}ck(ki);const hk={apiKey:"AIzaSyCEvN1NTncNhRxERbFMKrNGg6h5pUxoW5U",authDomain:"shashki-a6b99.firebaseapp.com",projectId:"shashki-a6b99",storageBucket:"shashki-a6b99.firebasestorage.app",messagingSenderId:"160125139960",appId:"1:160125139960:web:e1973baf30fe245ad6f40d"};ki.apps.length||ki.initializeApp(hk);const Pn=ki.firestore(),gr=8,cf=()=>{const n=Array(gr).fill(null).map(()=>Array(gr).fill(null));for(let e=0;e<gr;e++)for(let t=0;t<gr;t++)(e+t)%2===1&&(e<3?n[e][t]={color:G.BLACK,isKing:!1}:e>4&&(n[e][t]={color:G.WHITE,isKing:!1}));return n},ea=(n,e)=>n>=0&&n<gr&&e>=0&&e<gr,dk=n=>n.map(e=>e.map(t=>t?{...t}:null)),Ma=(n,e)=>{let t=[],r=!1;for(let s=0;s<gr;s++)for(let i=0;i<gr;i++){const o=n[s][i];if(!o||o.color!==e)continue;const a={row:s,col:i},u=hf(n,a,o,[],[],[],a),c=fk(n,a,o);u.length>0?(r=!0,t.push(...u)):t.push(...c)}return r?t.filter(s=>s.captures.length>0):t},fk=(n,e,t)=>{const r=[],s=t.isKing?[[-1,-1],[-1,1],[1,-1],[1,1]]:t.color===G.WHITE?[[-1,-1],[-1,1]]:[[1,-1],[1,1]];for(const[i,o]of s){let a=e.row+i,u=e.col+o;if(t.isKing)for(;ea(a,u)&&n[a][u]===null;)r.push({from:e,to:{row:a,col:u},captures:[],path:[{row:a,col:u}],becomesKing:!1}),a+=i,u+=o;else if(ea(a,u)&&n[a][u]===null){const c=t.color===G.WHITE&&a===0||t.color===G.BLACK&&a===7;r.push({from:e,to:{row:a,col:u},captures:[],path:[{row:a,col:u}],becomesKing:c})}}return r},hf=(n,e,t,r,s,i,o)=>{const a=[],u=[[-1,-1],[-1,1],[1,-1],[1,1]];for(const[c,d]of u)if(t.isKing){let f=e.row+c,m=e.col+d;for(;ea(f,m);){const _=n[f][m];if(_){const R=_.color!==t.color,b=s.some(E=>E.row===f&&E.col===m);if(!R||b)break;let N=f+c,x=m+d;for(;ea(N,x);){const E=n[N][x],A=N===o.row&&x===o.col;if(E!==null&&!A)break;const D=[...r,{row:f,col:m}],B=[...s,{row:f,col:m}],L=[...i,{row:N,col:x}],w=hf(n,{row:N,col:x},t,D,B,L,o);w.length>0?a.push(...w):a.push({from:o,to:{row:N,col:x},captures:D,path:L,becomesKing:!0}),N+=c,x+=d}break}f+=c,m+=d}}else{const f=e.row+c,m=e.col+d,_=e.row+2*c,R=e.col+2*d;if(ea(_,R)){const b=n[f][m],N=n[_][R],x=b&&b.color!==t.color,E=s.some(B=>B.row===f&&B.col===m),A=_===o.row&&R===o.col;if(x&&!E&&(N===null||A)){const B=[...r,{row:f,col:m}],L=[...s,{row:f,col:m}],w=[...i,{row:_,col:R}],g=t.color===G.WHITE&&_===0||t.color===G.BLACK&&_===7;let v={...t};g&&(v.isKing=!0);const I=hf(n,{row:_,col:R},v,B,L,w,o);I.length>0?a.push(...I):a.push({from:o,to:{row:_,col:R},captures:B,path:w,becomesKing:g||t.isKing})}}}return a},Br=(n,e)=>{const t=dk(n),r=t[e.from.row][e.from.col];return r&&(t[e.from.row][e.from.col]=null,t[e.to.row][e.to.col]={color:r.color,isKing:r.isKing||e.becomesKing},e.captures.forEach(s=>{t[s.row][s.col]=null})),t},pk=()=>Math.random().toString(36).substring(2,9),mk=()=>{let n=localStorage.getItem("checkers_player_id");return n||(typeof crypto<"u"&&crypto.randomUUID?n=crypto.randomUUID():n=Math.random().toString(36).substring(2)+Date.now().toString(36),localStorage.setItem("checkers_player_id",n)),{id:n,name:`Player ${n.substring(0,4)}`}},rT=async(n,e,t=!1)=>{const r=pk(),s=cf(),i=24*60*60*1e3,o=new Date(Date.now()+i),a={board:JSON.stringify(s),turn:G.WHITE,players:{white:e===G.WHITE?n:null,black:e===G.BLACK?n:null},status:se.WAITING,winner:null,version:0,halfMoveClock:0,createdAt:Date.now(),expireAt:o.getTime(),metadata:{isRandomColor:t}};return await Pn.collection("games").doc(r).set(a),r},gk=async(n,e)=>{const t=Pn.collection("games").doc(n);await Pn.runTransaction(async r=>{const s=await r.get(t);if(!s.exists)throw new Error("Game not found");const i=s.data();if(!(i.players.white===e||i.players.black===e))if(i.players.black===null&&i.players.white!==null)r.update(t,{"players.black":e,status:se.ACTIVE,version:i.version+1});else if(i.players.white===null&&i.players.black!==null)r.update(t,{"players.white":e,status:se.ACTIVE,version:i.version+1});else throw new Error("Game is full")})},yk=(n,e)=>Pn.collection("games").doc(n).onSnapshot(t=>{t.exists&&e(t.data())}),_k=async(n,e,t,r)=>{const s=Pn.collection("games").doc(n),i=JSON.parse(e.board),o=i[t.from.row][t.from.col],a=o&&!o.isKing,u=t.captures.length>0,c=Br(i,t);await Pn.runTransaction(async d=>{const f=await d.get(s);if(!f.exists)throw new Error("Game missing");const m=f.data();if(m.version!==e.version)throw new Error("Game state has changed, reload recommended");let _=m.halfMoveClock+1;(a||u)&&(_=0);let R=m.status;_>=60&&(R=se.DRAW);const b=24*60*60*1e3,N=Date.now()+b;d.update(s,{board:JSON.stringify(c),turn:r,lastMove:{from:t.from,to:t.to,ts:Date.now()},halfMoveClock:_,status:R,version:m.version+1,expireAt:N})})},vk=async(n,e)=>{const t=Pn.collection("games").doc(n);await Pn.runTransaction(async r=>{const s=await r.get(t);if(!s.exists)return;const i=s.data();let o=null;i.players.white===e&&(o=G.BLACK),i.players.black===e&&(o=G.WHITE),o&&r.update(t,{status:se.FINISHED,winner:o,version:i.version+1})})},wk=async(n,e)=>{await Pn.collection("games").doc(n).update({status:se.FINISHED,winner:e,version:ki.firestore.FieldValue.increment(1)})},Ek=async(n,e,t,r)=>{const s=t===G.WHITE?G.BLACK:G.WHITE,i=await rT(e,s,r);return await Pn.collection("games").doc(n).update({rematchId:i}),i},Ik=3,Tk=4,gs=1e6,ir={WIN:1e5,KING:800,PIECE:100,BACK_ROW:40,CENTER:15,ADVANCE:8},xk=(n,e)=>{let t=0;for(let r=0;r<8;r++)for(let s=0;s<8;s++){const i=n[r][s];if(!i)continue;let o=0;o+=i.isKing?ir.KING:ir.PIECE,s>=2&&s<=5&&r>=2&&r<=5&&(o+=ir.CENTER),i.isKing||(i.color===G.WHITE?o+=(7-r)*ir.ADVANCE:o+=r*ir.ADVANCE),i.color===G.WHITE&&r===7&&!i.isKing&&(o+=ir.BACK_ROW),i.color===G.BLACK&&r===0&&!i.isKing&&(o+=ir.BACK_ROW),i.color===e?t+=o:t-=o}return t},df=(n,e,t,r,s,i)=>{const o=r?s:s===G.WHITE?G.BLACK:G.WHITE,a=Ma(n,o);if(!(a.length>0&&a[0].captures.length>0)||i===0)return xk(n,s);if(r){let c=-gs;a.sort((d,f)=>f.captures.length-d.captures.length);for(const d of a){const f=Br(n,d),m=df(f,e,t,!1,s,i-1);if(c=Math.max(c,m),e=Math.max(e,m),t<=e)break}return c}else{let c=gs;a.sort((d,f)=>f.captures.length-d.captures.length);for(const d of a){const f=Br(n,d),m=df(f,e,t,!0,s,i-1);if(c=Math.min(c,m),t=Math.min(t,m),t<=e)break}return c}},ff=(n,e,t,r,s,i)=>{if(e===0)return df(n,t,r,s,i,Tk);const o=s?i:i===G.WHITE?G.BLACK:G.WHITE,a=Ma(n,o);if(a.length===0)return s?-1e5+e:ir.WIN-e;if(s){let u=-gs;a.sort((c,d)=>d.captures.length-c.captures.length);for(const c of a){const d=Br(n,c),f=ff(d,e-1,t,r,!1,i);if(u=Math.max(u,f),t=Math.max(t,f),r<=t)break}return u}else{let u=gs;a.sort((c,d)=>d.captures.length-c.captures.length);for(const c of a){const d=Br(n,c),f=ff(d,e-1,t,r,!0,i);if(u=Math.min(u,f),r=Math.min(r,f),r<=t)break}return u}},Ak=(n,e)=>{const t=Ma(n,e);if(t.length===0)return null;if(t.length===1)return t[0];let r=null,s=-gs;t.sort(()=>Math.random()-.5),t.sort((i,o)=>o.captures.length-i.captures.length);for(const i of t){const o=Br(n,i),a=ff(o,Ik-1,-gs,gs,!1,e);a>s&&(s=a,r=i)}return r||t[0]},Sk=({board:n,validMoves:e,selectedPos:t,onSquareClick:r,onMovePiece:s,lastMove:i,rotated:o=!1})=>{const a=X.useRef(null),[u,c]=X.useState({isDragging:!1,startPos:null,currentX:0,currentY:0}),[d,f]=X.useState(null),m=(L,w)=>{if(!a.current)return null;const g=a.current.getBoundingClientRect(),v=L-g.left,I=w-g.top;if(v<0||v>g.width||I<0||I>g.height)return null;const S=Math.floor(v/g.width*8),P=Math.floor(I/g.height*8),T=Math.max(0,Math.min(7,S)),ge=Math.max(0,Math.min(7,P));return o?{row:7-ge,col:7-T}:{row:ge,col:T}};X.useEffect(()=>{const L=g=>{if(!u.isDragging)return;g.preventDefault();const v=g.clientX-_.current,I=g.clientY-R.current;c(P=>({...P,currentX:v,currentY:I}));const S=m(g.clientX,g.clientY);if(S&&u.startPos){const P=e.find(T=>T.from.row===u.startPos.row&&T.from.col===u.startPos.col&&T.to.row===S.row&&T.to.col===S.col);f(P||null)}else f(null)},w=g=>{if(!u.isDragging||!u.startPos)return;const v=m(g.clientX,g.clientY),I=Math.sqrt(u.currentX**2+u.currentY**2);let S=!1;v&&(v.row!==u.startPos.row||v.col!==u.startPos.col)&&e.find(T=>T.from.row===u.startPos.row&&T.from.col===u.startPos.col&&T.to.row===v.row&&T.to.col===v.col)&&(s(u.startPos,v),S=!0),S||(I<5||v&&v.row===u.startPos.row&&v.col===u.startPos.col)&&r(u.startPos),c({isDragging:!1,startPos:null,currentX:0,currentY:0}),f(null)};return u.isDragging&&(window.addEventListener("pointermove",L),window.addEventListener("pointerup",w)),()=>{window.removeEventListener("pointermove",L),window.removeEventListener("pointerup",w)}},[u.isDragging,s,r,u.startPos,e]);const _=X.useRef(0),R=X.useRef(0),b=(L,w,g)=>{L.button===0&&(L.preventDefault(),L.stopPropagation(),_.current=L.clientX,R.current=L.clientY,c({isDragging:!0,startPos:{row:w,col:g},currentX:0,currentY:0}))},N=(L,w)=>{if(!u.isDragging&&t){const g=e.find(v=>v.from.row===t.row&&v.from.col===t.col&&v.to.row===L&&v.to.col===w);f(g||null)}},x=()=>{u.isDragging||f(null)},E=(L,w)=>o?{top:`${(7-L)*12.5}%`,left:`${(7-w)*12.5}%`}:{top:`${L*12.5}%`,left:`${w*12.5}%`},A=(L,w)=>(L+w)%2===1,D=()=>{const L=[],w=u.isDragging&&u.startPos?u.startPos.row:t==null?void 0:t.row,g=u.isDragging&&u.startPos?u.startPos.col:t==null?void 0:t.col,v=w!==void 0&&g!==void 0?n[w][g]:null;for(let I=0;I<8;I++)for(let S=0;S<8;S++){const P=A(I,S),T=(t==null?void 0:t.row)===I&&(t==null?void 0:t.col)===S,ge=(i==null?void 0:i.from.row)===I&&(i==null?void 0:i.from.col)===S,et=(i==null?void 0:i.to.row)===I&&(i==null?void 0:i.to.col)===S;let Yt=!1,Ae=!1,q=!1;if(v){const he=e.filter($e=>$e.from.row===w&&$e.from.col===g);for(const $e of he)$e.to.row===I&&$e.to.col===S?(Ae=!0,$e.becomesKing&&!v.isKing&&(q=!0)):$e.path.some(it=>it.row===I&&it.col===S)&&(Yt=!0)}let Z=P?"bg-[#8B5A2B]":"bg-[#E3C193]";const ee=ge||et?"bg-yellow-500/40":"",ye=T?"bg-[#5e4b35]/60 ring-inset ring-4 ring-[#ffff00]/50":"",ue=E(I,S);L.push(C.jsxs("div",{"data-pos":`${I}-${S}`,className:`absolute w-[12.5%] h-[12.5%] box-border ${Z} ${ee} ${ye} flex items-center justify-center`,style:ue,onPointerEnter:()=>N(I,S),onPointerLeave:x,onClick:()=>{!u.isDragging&&t&&r({row:I,col:S})},children:[(o?I===0:I===7)&&S===0&&C.jsx("span",{className:"absolute bottom-0.5 left-1 text-[10px] font-bold opacity-50 text-[#3d2b1f] pointer-events-none",children:"A"}),Yt&&!Ae&&C.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500 shadow-[0_0_5px_rgba(34,197,94,0.8)] pointer-events-none"}),Ae&&C.jsx(C.Fragment,{children:q?C.jsx("div",{className:"absolute w-[85%] h-[85%] flex items-center justify-center opacity-60 animate-pulse pointer-events-none",children:(()=>{const he=(v==null?void 0:v.color)===G.WHITE,$e=he?"bg-gradient-to-br from-[#f0e4cc] via-[#e6dcc0] to-[#d6c4a8]":"bg-gradient-to-br from-[#383838] via-[#242424] to-[#121212]",it=he?"border-[#bcaaa4]":"border-gray-700";return C.jsxs("div",{className:`w-full h-full rounded-full ${$e} flex items-center justify-center relative shadow-xl border-[1px] ${he?"border-[#f5f0e1]":"border-[#444]"}`,children:[C.jsx("div",{className:`w-[75%] h-[75%] rounded-full border-[3px] opacity-40 ${it} absolute`}),C.jsx("svg",{viewBox:"0 0 24 24",className:"w-[65%] h-[65%] drop-shadow-md z-10",fill:"url(#goldGradient)",children:C.jsx("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z"})})]})})()}):C.jsx("div",{className:`rounded-full shadow-lg pointer-events-none transition-all duration-200
                      ${d&&d.to.row===I&&d.to.col===S?"w-7 h-7 bg-green-400 shadow-[0_0_15px_rgba(74,222,128,1)]":"w-5 h-5 bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.8)]"}
                   `})})]},`sq-${I}-${S}`))}return L},B=()=>{var w,g;const L=[];for(let v=0;v<8;v++)for(let I=0;I<8;I++){const S=n[v][I];if(!S)continue;const P=S.color===G.WHITE,T=E(v,I),ge=u.isDragging&&((w=u.startPos)==null?void 0:w.row)===v&&((g=u.startPos)==null?void 0:g.col)===I,et=(t==null?void 0:t.row)===v&&(t==null?void 0:t.col)===I,Yt=ge||et,Ae=S.isKing||Yt&&(d==null?void 0:d.becomesKing),q=P?"bg-gradient-to-br from-[#f0e4cc] via-[#e6dcc0] to-[#d6c4a8]":"bg-gradient-to-br from-[#383838] via-[#242424] to-[#121212]",Z=P?"border-[#bcaaa4]":"border-gray-700",ee="shadow-[0_4px_8px_rgba(0,0,0,0.5),_0_8px_16px_rgba(0,0,0,0.3)]",ye=ge?{transform:`translate(${u.currentX}px, ${u.currentY}px)`,zIndex:50,cursor:"grabbing",pointerEvents:"none"}:{zIndex:10,cursor:"grab",touchAction:"none"},ue=ge?"scale-110 shadow-2xl":"transition-transform duration-100 ease-out hover:scale-105";L.push(C.jsx("div",{className:"absolute w-[12.5%] h-[12.5%] flex items-center justify-center will-change-transform",style:{...T,...ye},onPointerDown:he=>b(he,v,I),onPointerEnter:()=>N(v,I),children:C.jsxs("div",{className:`
              w-[85%] h-[85%] rounded-full ${q} ${ee}
              flex items-center justify-center relative
              border-[1px] ${P?"border-[#f5f0e1]":"border-[#444]"}
              ${ue}
            `,children:[C.jsx("div",{className:`w-[75%] h-[75%] rounded-full border-[3px] opacity-20 ${Z} shadow-inner absolute`}),Ae&&C.jsxs("div",{className:"absolute inset-0 flex items-center justify-center animate-fade-in",children:[!S.isKing&&C.jsx("div",{className:"absolute w-full h-full rounded-full bg-yellow-400/20 animate-pulse"}),C.jsxs("svg",{viewBox:"0 0 24 24",className:"w-[60%] h-[60%] drop-shadow-md",fill:"url(#goldGradient)",children:[C.jsx("defs",{children:C.jsxs("linearGradient",{id:"goldGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[C.jsx("stop",{offset:"0%",stopColor:"#FFD700"}),C.jsx("stop",{offset:"50%",stopColor:"#FDB931"}),C.jsx("stop",{offset:"100%",stopColor:"#DAA520"})]})}),C.jsx("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z"})]})]})]})},`p-${v}-${I}`))}return L};return C.jsx("div",{className:"relative w-full h-full shadow-[0_20px_50px_rgba(0,0,0,0.7)] border-[16px] border-[#3e2723] rounded-md bg-[#3e2723] select-none",style:{touchAction:"none"},children:C.jsxs("div",{ref:a,className:"w-full h-full relative overflow-hidden bg-[#E3C193]",children:[D(),B()]})})};let Rk={data:""},Pk=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||Rk},Ck=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,bk=/\/\*[^]*?\*\/|  +/g,ev=/\n+/g,dr=(n,e)=>{let t="",r="",s="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":r+=i[1]=="f"?dr(o,i):i+"{"+dr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=dr(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,a):a?a+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=dr.p?dr.p(i,o):i+":"+o+";")}return t+(e&&s?e+"{"+s+"}":s)+r},Vn={},sT=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+sT(n[t]);return e}return n},kk=(n,e,t,r,s)=>{let i=sT(n),o=Vn[i]||(Vn[i]=(u=>{let c=0,d=11;for(;c<u.length;)d=101*d+u.charCodeAt(c++)>>>0;return"go"+d})(i));if(!Vn[o]){let u=i!==n?n:(c=>{let d,f,m=[{}];for(;d=Ck.exec(c.replace(bk,""));)d[4]?m.shift():d[3]?(f=d[3].replace(ev," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][d[1]]=d[2].replace(ev," ").trim();return m[0]})(n);Vn[o]=dr(s?{["@keyframes "+o]:u}:u,t?"":"."+o)}let a=t&&Vn.g?Vn.g:null;return t&&(Vn.g=Vn[o]),((u,c,d,f)=>{f?c.data=c.data.replace(f,u):c.data.indexOf(u)===-1&&(c.data=d?u+c.data:c.data+u)})(Vn[o],e,r,a),o},Vk=(n,e,t)=>n.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(t),u=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=u?"."+u:a&&typeof a=="object"?a.props?"":dr(a,""):a===!1?"":a}return r+s+(o??"")},"");function Fc(n){let e=this||{},t=n.call?n(e.p):n;return kk(t.unshift?t.raw?Vk(t,[].slice.call(arguments,1),e.p):t.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):t,Pk(e.target),e.g,e.o,e.k)}let iT,pf,mf;Fc.bind({g:1});let Wn=Fc.bind({k:1});function Nk(n,e,t,r){dr.p=e,iT=n,pf=t,mf=r}function Wr(n,e){let t=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),u=a.className||s.className;t.p=Object.assign({theme:pf&&pf()},a),t.o=/ *go\d+/.test(u),a.className=Fc.apply(t,r)+(u?" "+u:"");let c=n;return n[0]&&(c=a.as||n,delete a.as),mf&&c[0]&&mf(a),iT(c,a)}return s}}var Dk=n=>typeof n=="function",Xu=(n,e)=>Dk(n)?n(e):n,Ok=(()=>{let n=0;return()=>(++n).toString()})(),oT=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),Mk=20,vm="default",aT=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return aT(n,{type:n.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...n,toasts:n.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},uu=[],lT={toasts:[],pausedAt:void 0,settings:{toastLimit:Mk}},wn={},uT=(n,e=vm)=>{wn[e]=aT(wn[e]||lT,n),uu.forEach(([t,r])=>{t===e&&r(wn[e])})},cT=n=>Object.keys(wn).forEach(e=>uT(n,e)),Lk=n=>Object.keys(wn).find(e=>wn[e].toasts.some(t=>t.id===n)),Bc=(n=vm)=>e=>{uT(e,n)},Fk={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Bk=(n={},e=vm)=>{let[t,r]=X.useState(wn[e]||lT),s=X.useRef(wn[e]);X.useEffect(()=>(s.current!==wn[e]&&r(wn[e]),uu.push([e,r]),()=>{let o=uu.findIndex(([a])=>a===e);o>-1&&uu.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var a,u,c;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((a=n[o.type])==null?void 0:a.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||Fk[o.type],style:{...n.style,...(c=n[o.type])==null?void 0:c.style,...o.style}}});return{...t,toasts:i}},jk=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Ok()}),tl=n=>(e,t)=>{let r=jk(e,n,t);return Bc(r.toasterId||Lk(r.id))({type:2,toast:r}),r.id},me=(n,e)=>tl("blank")(n,e);me.error=tl("error");me.success=tl("success");me.loading=tl("loading");me.custom=tl("custom");me.dismiss=(n,e)=>{let t={type:3,toastId:n};e?Bc(e)(t):cT(t)};me.dismissAll=n=>me.dismiss(void 0,n);me.remove=(n,e)=>{let t={type:4,toastId:n};e?Bc(e)(t):cT(t)};me.removeAll=n=>me.remove(void 0,n);me.promise=(n,e,t)=>{let r=me.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(s=>{let i=e.success?Xu(e.success,s):void 0;return i?me.success(i,{id:r,...t,...t==null?void 0:t.success}):me.dismiss(r),s}).catch(s=>{let i=e.error?Xu(e.error,s):void 0;i?me.error(i,{id:r,...t,...t==null?void 0:t.error}):me.dismiss(r)}),n};var Uk=1e3,zk=(n,e="default")=>{let{toasts:t,pausedAt:r}=Bk(n,e),s=X.useRef(new Map).current,i=X.useCallback((f,m=Uk)=>{if(s.has(f))return;let _=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},m);s.set(f,_)},[]);X.useEffect(()=>{if(r)return;let f=Date.now(),m=t.map(_=>{if(_.duration===1/0)return;let R=(_.duration||0)+_.pauseDuration-(f-_.createdAt);if(R<0){_.visible&&me.dismiss(_.id);return}return setTimeout(()=>me.dismiss(_.id,e),R)});return()=>{m.forEach(_=>_&&clearTimeout(_))}},[t,r,e]);let o=X.useCallback(Bc(e),[e]),a=X.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=X.useCallback((f,m)=>{o({type:1,toast:{id:f,height:m}})},[o]),c=X.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),d=X.useCallback((f,m)=>{let{reverseOrder:_=!1,gutter:R=8,defaultPosition:b}=m||{},N=t.filter(A=>(A.position||b)===(f.position||b)&&A.height),x=N.findIndex(A=>A.id===f.id),E=N.filter((A,D)=>D<x&&A.visible).length;return N.filter(A=>A.visible).slice(..._?[E+1]:[0,E]).reduce((A,D)=>A+(D.height||0)+R,0)},[t]);return X.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let m=s.get(f.id);m&&(clearTimeout(m),s.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:a,endPause:c,calculateOffset:d}}},$k=Wn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,qk=Wn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Kk=Wn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Gk=Wr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${$k} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${qk} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Kk} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Wk=Wn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Qk=Wr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${Wk} 1s linear infinite;
`,Hk=Wn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Yk=Wn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Xk=Wr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Hk} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Yk} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Jk=Wr("div")`
  position: absolute;
`,Zk=Wr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,eV=Wn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,tV=Wr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${eV} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,nV=({toast:n})=>{let{icon:e,type:t,iconTheme:r}=n;return e!==void 0?typeof e=="string"?X.createElement(tV,null,e):e:t==="blank"?null:X.createElement(Zk,null,X.createElement(Qk,{...r}),t!=="loading"&&X.createElement(Jk,null,t==="error"?X.createElement(Gk,{...r}):X.createElement(Xk,{...r})))},rV=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,sV=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,iV="0%{opacity:0;} 100%{opacity:1;}",oV="0%{opacity:1;} 100%{opacity:0;}",aV=Wr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,lV=Wr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,uV=(n,e)=>{let t=n.includes("top")?1:-1,[r,s]=oT()?[iV,oV]:[rV(t),sV(t)];return{animation:e?`${Wn(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Wn(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},cV=X.memo(({toast:n,position:e,style:t,children:r})=>{let s=n.height?uV(n.position||e||"top-center",n.visible):{opacity:0},i=X.createElement(nV,{toast:n}),o=X.createElement(lV,{...n.ariaProps},Xu(n.message,n));return X.createElement(aV,{className:n.className,style:{...s,...t,...n.style}},typeof r=="function"?r({icon:i,message:o}):X.createElement(X.Fragment,null,i,o))});Nk(X.createElement);var hV=({id:n,className:e,style:t,onHeightUpdate:r,children:s})=>{let i=X.useCallback(o=>{if(o){let a=()=>{let u=o.getBoundingClientRect().height;r(n,u)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,r]);return X.createElement("div",{ref:i,className:e,style:t},s)},dV=(n,e)=>{let t=n.includes("top"),r=t?{top:0}:{bottom:0},s=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:oT()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...s}},fV=Fc`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ul=16,zl=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:u,handlers:c}=zk(t,i);return X.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ul,left:Ul,right:Ul,bottom:Ul,pointerEvents:"none",...o},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},u.map(d=>{let f=d.position||e,m=c.calculateOffset(d,{reverseOrder:n,gutter:r,defaultPosition:e}),_=dV(f,m);return X.createElement(hV,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?fV:"",style:_},d.type==="custom"?Xu(d.message,d):s?s(d):X.createElement(cV,{toast:d,position:f}))}))};const pV=({gameId:n,gameData:e,playerId:t,onCancel:r})=>{var _;const s=`${window.location.origin}${window.location.pathname}`,i=`${s}${s.includes("?")?"&":"?"}game=${n}`,o=`https://api.qrserver.com/v1/create-qr-code/?size=250x250&color=e3c193&bgcolor=2a2622&data=${encodeURIComponent(i)}`,a=()=>{navigator.clipboard.writeText(i),me.success(" !")},u=(_=e.metadata)==null?void 0:_.isRandomColor,d=(e.players.white===t?G.WHITE:G.BLACK)===G.WHITE,f=u?" ":d?"":"",m=u?"":d?"":"";return C.jsx("div",{className:"flex flex-col items-center justify-center w-full max-w-4xl px-4 animate-fade-in",children:C.jsxs("div",{className:"w-full bg-[#2a2622] rounded-xl shadow-2xl border border-stone-700 overflow-hidden",children:[C.jsxs("div",{className:"bg-[#3d3632] p-6 border-b border-stone-600 flex flex-col md:flex-row justify-between items-center gap-4",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-[#e3c193] mb-1",children:" "}),C.jsx("p",{className:"text-stone-400 text-sm uppercase tracking-wider",children:"   8x8"})]}),C.jsxs("div",{className:"flex items-center gap-2 bg-[#2a2622] px-3 py-1.5 rounded-full border border-stone-700",children:[C.jsx("span",{className:"animate-pulse w-2.5 h-2.5 rounded-full bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)]"}),C.jsx("span",{className:"text-stone-300 text-xs font-bold uppercase tracking-wider",children:" ..."})]})]}),C.jsxs("div",{className:"p-6 lg:p-10 grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-start",children:[C.jsxs("div",{className:"space-y-6",children:[C.jsxs("div",{className:"bg-[#1e1b18] rounded-lg border border-stone-700/50 overflow-hidden",children:[C.jsxs("div",{className:"p-4 flex items-center gap-4 border-b border-stone-700/50 bg-[#25211d]",children:[u?C.jsx("div",{className:"w-12 h-12 rounded-full shadow-lg border-2 border-stone-500 bg-gradient-to-br from-[#f0e4cc] to-[#383838] flex items-center justify-center relative overflow-hidden",children:C.jsx("span",{className:"text-stone-800 font-bold text-lg mix-blend-difference z-10",children:"?"})}):C.jsx("div",{className:`w-12 h-12 rounded-full shadow-lg border-2 flex items-center justify-center ${d?"bg-[#f0e4cc] border-[#e6dcc0]":"bg-[#383838] border-[#555]"}`,children:C.jsx("div",{className:`w-8 h-8 rounded-full border-2 opacity-50 ${d?"border-[#bcaaa4]":"border-gray-600"}`})}),C.jsxs("div",{children:[C.jsx("div",{className:"text-[#e3c193] font-bold text-lg leading-tight",children:u?" ":`  ${f}`}),C.jsx("div",{className:"text-stone-500 text-xs font-bold uppercase tracking-wider mt-0.5",children:u?"  ":" "})]})]}),C.jsx("div",{className:"p-3 bg-[#1e1b18] text-center",children:C.jsxs("span",{className:"text-stone-400 text-sm",children:["  ",m,"..."]})})]}),C.jsxs("div",{className:"space-y-2",children:[C.jsx("label",{className:"text-stone-500 text-xs font-bold uppercase tracking-widest",children:"  "}),C.jsxs("div",{className:"flex gap-0 shadow-lg rounded-lg overflow-hidden group",children:[C.jsx("input",{readOnly:!0,value:i,className:"bg-[#1e1b18] text-stone-300 px-4 py-4 w-full outline-none font-mono text-xs md:text-sm border-y border-l border-stone-700 group-hover:border-stone-500 transition-colors",onClick:R=>R.target.select()}),C.jsx("button",{onClick:a,className:"bg-[#3d3632] hover:bg-stone-600 text-stone-200 px-6 font-bold border border-stone-700 border-l-0 transition-colors",title:"",children:""})]})]})]}),C.jsxs("div",{className:"flex flex-col items-center justify-center space-y-6 h-full",children:[C.jsx("div",{className:"p-4 bg-white rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-300",children:C.jsx("img",{src:o,alt:"Scan to Join",className:"w-40 h-40 lg:w-48 lg:h-48 mix-blend-multiply opacity-90"})}),C.jsx("p",{className:"text-stone-500 text-xs text-center uppercase tracking-widest max-w-[200px]",children:",    "})]})]}),C.jsx("div",{className:"bg-[#1e1b18] p-6 border-t border-stone-700 flex justify-center",children:C.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-8 py-3 rounded-lg bg-red-900/10 hover:bg-red-900/20 text-red-400/80 border border-red-900/20 transition-all font-bold uppercase text-xs tracking-wider hover:scale-105",children:[C.jsx("span",{children:""}),"  "]})})]})})},mV=({gameData:n,onJoin:e})=>{var i;const t=(i=n.metadata)==null?void 0:i.isRandomColor,s=!!n.players.white?G.BLACK:G.WHITE;return C.jsx("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center p-4",children:C.jsxs("div",{className:"w-full max-w-lg bg-[#2a2622] rounded-xl shadow-2xl border border-stone-700 overflow-hidden animate-fade-in",children:[C.jsxs("div",{className:"bg-[#3d3632] p-5 border-b border-stone-600 flex justify-between items-center",children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)] animate-pulse"}),C.jsx("span",{className:"text-[#e3c193] font-bold text-sm uppercase tracking-wider",children:"  "})]}),C.jsx("div",{className:"text-stone-500 text-xs font-bold uppercase",children:" "})]}),C.jsxs("div",{className:"p-8 lg:p-10 flex flex-col items-center gap-8",children:[C.jsxs("div",{className:"text-center space-y-2",children:[C.jsx("h2",{className:"text-stone-300 text-2xl lg:text-3xl font-bold",children:""}),C.jsx("p",{className:"text-stone-500 text-sm font-medium uppercase tracking-widest",children:"  "})]}),C.jsxs("div",{className:"w-full bg-[#1e1b18] border border-stone-700/50 rounded-xl flex items-center p-5 gap-5 shadow-inner",children:[t?C.jsx("div",{className:"w-16 h-16 rounded-full flex-shrink-0 flex items-center justify-center shadow-lg border-2 border-stone-600 bg-gradient-to-br from-[#f0e4cc] to-[#383838]",children:C.jsx("span",{className:"text-2xl font-black text-stone-400 mix-blend-difference",children:"?"})}):C.jsx("div",{className:`w-16 h-16 rounded-full flex-shrink-0 flex items-center justify-center shadow-lg border-2 ${s===G.WHITE?"bg-[#f0e4cc] border-[#e6dcc0]":"bg-[#1e1e1e] border-[#555]"}`,children:C.jsx("div",{className:`w-12 h-12 rounded-full border-4 opacity-30 ${s===G.WHITE?"border-[#a18e6e]":"border-[#888]"}`})}),C.jsxs("div",{className:"flex-1 space-y-1",children:[C.jsx("div",{className:"text-[#e3c193] font-bold text-xl",children:t?" ":s===G.WHITE?"  ":"  "}),C.jsxs("div",{className:"text-stone-500 text-sm flex flex-col gap-1",children:[C.jsx("span",{children:t?"   ":"  "}),C.jsx("div",{className:"flex items-center gap-2 mt-1",children:C.jsx("span",{className:"text-xs font-bold bg-stone-800 px-2 py-0.5 rounded border border-stone-700",children:"  "})})]})]})]})]}),C.jsx("div",{className:"p-6 bg-[#1e1b18] flex justify-center border-t border-stone-700",children:C.jsx("button",{onClick:e,className:"w-full py-4 bg-gradient-to-r from-amber-700 to-orange-800 hover:from-amber-600 hover:to-orange-700 active:scale-[0.98] transition-all text-white font-bold text-lg rounded-xl shadow-lg border border-amber-600/30 uppercase tracking-wider",children:"  "})})]})})},gV=()=>{const[n,e]=X.useState(null),[t,r]=X.useState(null),[s,i]=X.useState(!1),[o,a]=X.useState(!1),[u,c]=X.useState(null),[d]=X.useState(()=>mk().id),[f,m]=X.useState(!1),[_,R]=X.useState(!1),[b,N]=X.useState(G.WHITE),[x,E]=X.useState(!1),A=X.useRef(!1),D=H=>{try{window.history.pushState({},"",H)}catch(ne){console.warn("URL update failed:",ne)}};X.useEffect(()=>{const H=()=>{const Ee=new URLSearchParams(window.location.search).get("game");Ee!==n&&(Ee?(e(Ee),r(null)):(e(null),r(null),i(!1)))};return window.addEventListener("popstate",H),()=>window.removeEventListener("popstate",H)},[n]),X.useEffect(()=>{const ne=new URLSearchParams(window.location.search).get("game");ne&&!n&&e(ne)},[]),X.useEffect(()=>{if(!n||n==="local_bot")return;const H=yk(n,ne=>{A.current?ne.version>((t==null?void 0:t.version)||0)&&(A.current=!1,r(ne)):r(ne)});return()=>H()},[n,t==null?void 0:t.version]);const B=async()=>{if(n){m(!0);try{await gk(n,d),a(!1),me.success("   !")}catch(H){H.message==="Game is full"?(a(!0),me(" .    .",{icon:""})):me.error(" ")}finally{m(!1)}}},L=(H,ne)=>{const Ee=cf(),Be=24*60*60*1e3;return{board:JSON.stringify(Ee),turn:G.WHITE,players:{white:H===G.WHITE?d:null,black:H===G.BLACK?d:null},status:se.WAITING,winner:null,version:0,halfMoveClock:0,createdAt:Date.now(),expireAt:Date.now()+Be,metadata:{isRandomColor:ne}}},w=(H,ne)=>{E(!1),R(!1),c(null),i(!1),a(!1),r(ne||null),e(H),D(`${window.location.pathname}?game=${H}`)},g=()=>{const H=cf(),ne=24*60*60*1e3,Ee={board:JSON.stringify(H),turn:G.WHITE,players:{white:"local",black:"bot"},status:se.ACTIVE,winner:null,version:0,halfMoveClock:0,createdAt:Date.now(),expireAt:Date.now()+ne};r(Ee),i(!0),e("local_bot"),E(!1),D(window.location.pathname)},v=async()=>{m(!0);try{const H=b==="RANDOM",ne=H?Math.random()<.5?G.WHITE:G.BLACK:b,Ee=await rT(d,ne,H),Be=L(ne,H);w(Ee,Be),me.success(" !")}catch(H){console.error(H),me.error("  .")}finally{m(!1)}},I=async()=>{var H;if(!_)if(R(!0),t!=null&&t.rematchId)w(t.rematchId,void 0);else try{const ne=T===G.WHITE?G.BLACK:G.WHITE,Ee=!!((H=t==null?void 0:t.metadata)!=null&&H.isRandomColor);E(!0);const Be=await Ek(n,d,T,Ee),Cn=L(ne,Ee);w(Be,Cn),me.success(" !")}catch(ne){console.error(ne),me.error("   "),R(!1),E(!1)}},S=()=>{D(window.location.pathname),e(null),r(null),i(!1),a(!1),E(!1),R(!1)},P=X.useMemo(()=>{if(!t||!t.board)return[];try{return JSON.parse(t.board)}catch{return[]}},[t]),T=X.useMemo(()=>t?s||t.players.white===d?G.WHITE:t.players.black===d?G.BLACK:null:null,[t,d,s]),ge=o||t&&T===null&&!s,et=(t==null?void 0:t.status)===se.ACTIVE&&(t==null?void 0:t.turn)===T&&!ge,Yt=T===G.BLACK,Ae=X.useMemo(()=>!t||!T||P.length===0||ge?[]:t.status!==se.ACTIVE?[]:Ma(P,t.turn),[P,t==null?void 0:t.turn,t==null?void 0:t.status,T,ge]),q=X.useMemo(()=>Ae.length===0?0:Math.max(...Ae.map(H=>H.captures.length)),[Ae]);X.useEffect(()=>{if(!(!t||s||ge)&&t.status===se.ACTIVE&&et&&Ae.length===0){const H=T===G.WHITE?G.BLACK:G.WHITE;wk(n,H),me.error("  .  .")}},[t==null?void 0:t.status,et,Ae.length,s]),X.useEffect(()=>{if(!s||!t||t.status!==se.ACTIVE||t.turn===G.WHITE)return;const H=setTimeout(()=>{const ne=Ak(P,G.BLACK);if(!ne){r(Xt=>Xt?{...Xt,status:se.FINISHED,winner:G.WHITE}:null),me.success(" !");return}const Ee=Br(P,ne),Be={...t,board:JSON.stringify(Ee),turn:G.WHITE,version:t.version+1,lastMove:{from:ne.from,to:ne.to,ts:Date.now()},halfMoveClock:0};r(Be),Ma(Ee,G.WHITE).length===0&&(r(Xt=>Xt?{...Xt,status:se.FINISHED,winner:G.BLACK}:null),me.error(" !"))},600);return()=>clearTimeout(H)},[t,s,P]);const Z=()=>{let H=window.location.href;n&&!H.includes(n)&&(H=`${H}${H.includes("?")?"&":"?"}game=${n}`),navigator.clipboard.writeText(H),me.success(" !")},ee=async(H,ne)=>{if(!t||!et)return;const Ee=Ae.find(Be=>Be.from.row===H.row&&Be.from.col===H.col&&Be.to.row===ne.row&&Be.to.col===ne.col);if(Ee){const Be=t.turn===G.WHITE?G.BLACK:G.WHITE,Cn=Br(P,Ee),Xt=t.version+1;A.current=!0;const js={...t},no={...t,board:JSON.stringify(Cn),turn:Be,lastMove:{from:Ee.from,to:Ee.to,ts:Date.now()},version:Xt};if(r(no),c(null),s){A.current=!1;return}try{await _k(n,js,Ee,Be)}catch(ro){console.error(ro),me.error(" ."),A.current=!1,r(js)}}else c(null)},ye=async H=>{if(u){if(u.row===H.row&&u.col===H.col){c(null);return}if(Ae.find(Be=>Be.from.row===u.row&&Be.from.col===u.col&&Be.to.row===H.row&&Be.to.col===H.col)){await ee(u,H);return}}Ae.filter(Ee=>Ee.from.row===H.row&&Ee.from.col===H.col).length>0?c(H):c(null)};if(!n)return C.jsxs("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center p-4",children:[C.jsxs("div",{className:"max-w-xl w-full bg-[#2a2622] p-6 lg:p-8 rounded-3xl shadow-2xl border border-stone-700 space-y-6 lg:space-y-8 animate-fade-in",children:[C.jsxs("div",{className:"text-center",children:[C.jsx("h1",{className:"text-5xl lg:text-6xl font-black text-[#e3c193] tracking-widest uppercase drop-shadow-lg mb-2",children:""}),C.jsx("p",{className:"text-stone-500 tracking-wider text-sm uppercase",children:" "})]}),C.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[C.jsxs("button",{onClick:g,className:"w-full py-4 lg:py-5 rounded-2xl bg-stone-700 hover:bg-stone-600 active:scale-95 border border-stone-500 transition-all shadow-xl group flex items-center justify-center gap-3",children:[C.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""}),C.jsx("span",{className:"text-white font-bold text-lg",children:"  "})]}),C.jsxs("div",{className:"relative flex items-center justify-center",children:[C.jsx("div",{className:"absolute w-full border-t border-stone-600"}),C.jsx("span",{className:"relative bg-[#2a2622] px-4 text-stone-500 text-xs font-bold uppercase tracking-wider",children:"  "})]}),C.jsxs("div",{className:"grid grid-cols-3 gap-3 lg:gap-4",children:[C.jsxs("button",{onClick:()=>N(G.WHITE),className:`relative overflow-hidden h-24 lg:h-32 rounded-2xl border-2 transition-all duration-200 group ${b===G.WHITE?"border-[#e3c193] ring-2 ring-[#e3c193]/30 scale-105":"border-stone-700 bg-stone-800/50 hover:border-stone-500"}`,children:[C.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#f8f8f8] to-[#d0d0d0] opacity-90"}),C.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 z-10",children:[C.jsx("div",{className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full bg-white shadow-lg border-2 border-gray-200"}),C.jsx("span",{className:"font-bold text-black text-xs lg:text-sm",children:""})]})]}),C.jsxs("button",{onClick:()=>N("RANDOM"),className:`relative overflow-hidden h-24 lg:h-32 rounded-2xl border-2 transition-all duration-200 group ${b==="RANDOM"?"border-purple-500 ring-2 ring-purple-500/30 scale-105":"border-stone-700 bg-stone-800/50 hover:border-stone-500"}`,children:[C.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900 to-indigo-900 opacity-90"}),C.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 z-10",children:[C.jsx("span",{className:"text-xl lg:text-2xl",children:""}),C.jsx("span",{className:"font-bold text-white text-xs lg:text-sm",children:""})]})]}),C.jsxs("button",{onClick:()=>N(G.BLACK),className:`relative overflow-hidden h-24 lg:h-32 rounded-2xl border-2 transition-all duration-200 group ${b===G.BLACK?"border-gray-500 ring-2 ring-gray-500/30 scale-105":"border-stone-700 bg-stone-800/50 hover:border-stone-500"}`,children:[C.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#303030] to-[#101010] opacity-90"}),C.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 z-10",children:[C.jsx("div",{className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full bg-black shadow-lg border-2 border-gray-700"}),C.jsx("span",{className:"font-bold text-white text-xs lg:text-sm",children:""})]})]})]}),C.jsx("button",{onClick:v,disabled:f,className:`w-full py-4 lg:py-5 font-bold rounded-2xl text-lg lg:text-xl transition-all shadow-xl ${f?"bg-stone-700 cursor-not-allowed text-stone-500":"bg-gradient-to-r from-amber-600 to-orange-700 text-white hover:brightness-110 active:scale-95"}`,children:f?"...":" "})]})]}),C.jsx(zl,{})]});if(n&&!t)return C.jsx("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center",children:C.jsxs("div",{className:"flex flex-col items-center gap-4 animate-pulse",children:[C.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-stone-700 border-t-amber-600 animate-spin"}),C.jsx("span",{className:"text-stone-500 text-xs uppercase tracking-widest",children:"..."})]})});const ue=(t==null?void 0:t.players.white)===d||(t==null?void 0:t.players.black)===d;if((t==null?void 0:t.status)===se.WAITING&&!ue&&!s)return C.jsxs(C.Fragment,{children:[C.jsx(mV,{gameData:t,onJoin:B}),f&&C.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:C.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-white border-t-transparent rounded-full"})}),C.jsx(zl,{position:"top-center"})]});if((t==null?void 0:t.status)===se.WAITING&&!s&&ue)return C.jsxs("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center",children:[C.jsx(pV,{gameId:n,gameData:t,playerId:d,onCancel:S}),C.jsx(zl,{position:"top-center",toastOptions:{style:{background:"#2a2622",color:"#e3c193",border:"1px solid #444"}}})]});const he={[se.WAITING]:"...",[se.ACTIVE]:s?"  ":"",[se.FINISHED]:"",[se.DRAW]:""},$e=et?" ":(t==null?void 0:t.turn)===G.WHITE?" ":" ",it=ge?"":s?"":T===G.WHITE?"":"";return C.jsxs("div",{className:"h-[100dvh] w-screen bg-[#1e1b18] overflow-hidden relative pt-safe flex items-center justify-center",children:[C.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-center gap-0 lg:max-w-[1250px] lg:w-full",children:[C.jsxs("div",{className:"lg:hidden w-full flex justify-between items-center px-4 py-2 mb-2 bg-[#2a2622] border-y border-stone-700/50",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:`w-2 h-2 rounded-full ${(t==null?void 0:t.status)===se.ACTIVE?"bg-green-500 animate-pulse":"bg-yellow-500"}`}),C.jsx("span",{className:"text-stone-400 text-xs font-bold uppercase",children:he[(t==null?void 0:t.status)||se.WAITING]})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("span",{className:"text-stone-500 text-xs",children:":"}),C.jsx("span",{className:"text-[#e3c193] font-bold text-sm",children:it})]})]}),C.jsx("div",{className:"flex items-center justify-center relative z-10",children:C.jsx("div",{className:`relative aspect-square 
                w-[min(95vw,60vh)] h-[min(95vw,60vh)]
                lg:w-[min(82vh,82vh)] lg:h-[min(82vh,82vh)] 
                max-w-[800px] max-h-[800px] shadow-2xl`,children:t&&P.length>0?C.jsxs(C.Fragment,{children:[C.jsx(Sk,{board:P,validMoves:Ae,selectedPos:u,onSquareClick:ye,onMovePiece:ee,lastMove:t==null?void 0:t.lastMove,rotated:Yt}),q>0&&et&&!u&&C.jsx("div",{className:"absolute -top-8 lg:-top-12 left-0 w-full text-center pointer-events-none z-20",children:C.jsx("span",{className:"bg-amber-600/95 text-white px-3 py-1 lg:px-4 lg:py-1 rounded-full text-xs lg:text-sm font-bold shadow-lg animate-bounce inline-block border border-amber-400/30",children:"  "})})]}):C.jsx("div",{className:"w-full h-full bg-[#3e2723] rounded-md border-[16px] border-[#3e2723] shadow-[0_20px_50px_rgba(0,0,0,0.7)]",children:C.jsxs("div",{className:"w-full h-full bg-[#2a2622] animate-pulse flex flex-col items-center justify-center text-stone-600 gap-4",children:[C.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-stone-700 border-t-amber-600 animate-spin"}),C.jsx("span",{className:"text-xs font-bold tracking-widest uppercase",children:" ..."})]})})})}),C.jsx("div",{className:"w-full lg:w-[420px] flex flex-col gap-2 lg:gap-6 z-20 shrink-0 mt-4 lg:mt-0 lg:h-[min(82vh,82vh)] bg-[#1e1b18] lg:bg-transparent lg:pl-0",children:C.jsxs("div",{className:"flex flex-col h-full gap-4 lg:bg-[#1e1b18] lg:border-l lg:border-[#3d3632] lg:pl-6 lg:justify-center",children:[C.jsx("div",{className:"hidden lg:block bg-[#2a2622] p-6 rounded-3xl shadow-xl border border-stone-700 min-h-[140px]",children:t?C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("div",{className:`w-3 h-3 rounded-full ${(t==null?void 0:t.status)===se.ACTIVE?"bg-green-500 animate-pulse":"bg-yellow-500"}`}),C.jsx("span",{className:"text-stone-300 font-bold text-sm uppercase tracking-wider",children:he[(t==null?void 0:t.status)||se.WAITING]})]}),!s&&C.jsxs("span",{className:"font-mono text-xs text-stone-500 border border-stone-800 bg-[#1e1b18] px-2 py-1 rounded select-all",children:["#",n]})]}),C.jsx("div",{className:"flex items-center justify-between",children:C.jsxs("div",{children:[C.jsx("p",{className:"text-xs font-bold text-stone-500 uppercase tracking-widest mb-2",children:"  "}),C.jsxs("div",{className:"flex items-center gap-3",children:[ge?C.jsx("span",{className:"text-3xl",children:""}):C.jsx("div",{className:`w-8 h-8 rounded-full border-2 shadow-sm ${T===G.WHITE?"bg-[#f2e8d5] border-[#e6e0d0]":"bg-black border-gray-600"}`}),C.jsx("span",{className:"font-black text-3xl text-[#e3c193]",children:it})]})]})})]}):C.jsx("div",{className:"h-full flex items-center justify-center",children:C.jsx("span",{className:"text-stone-600 text-xs animate-pulse",children:"..."})})}),((t==null?void 0:t.status)===se.ACTIVE||(t==null?void 0:t.status)===se.FINISHED||(t==null?void 0:t.status)===se.DRAW)&&C.jsx("div",{className:`mx-4 lg:mx-0 p-3 lg:p-6 rounded-xl lg:rounded-2xl border-2 transition-all duration-300 shadow-lg ${et?"bg-gradient-to-br from-green-900/90 to-green-800/90 border-green-500/50":"bg-[#2a2622] border-stone-700"}`,children:C.jsx("h3",{className:"text-lg lg:text-2xl font-black text-center text-white tracking-widest uppercase leading-tight",children:t.status===se.FINISHED?C.jsxs("span",{className:"text-yellow-400",children:[" ",t.winner===G.WHITE?" ":" "]}):t.status===se.DRAW?C.jsx("span",{className:"text-stone-400",children:"  (50 )"}):$e})}),(t==null?void 0:t.status)===se.ACTIVE&&!s&&C.jsx("div",{className:"flex justify-center",children:C.jsxs("button",{onClick:Z,className:"text-stone-500 text-xs hover:text-stone-300 flex items-center gap-1 uppercase font-bold tracking-widest",children:[C.jsx("span",{children:""}),"    "]})}),C.jsxs("div",{className:"grid grid-cols-2 gap-3 lg:gap-4 px-4 lg:px-0 mt-auto pb-4 lg:pb-0",children:[C.jsx("button",{onClick:S,disabled:_,className:"py-3 lg:py-6 px-4 bg-[#3d3632] hover:bg-[#4a423d] rounded-xl lg:rounded-2xl text-stone-300 font-bold text-xs lg:text-xl uppercase tracking-wider transition shadow-lg border-2 border-stone-700/50 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),(t==null?void 0:t.status)===se.ACTIVE&&!t.winner&&!ge&&C.jsx("button",{onClick:()=>{s?r(H=>H?{...H,status:se.FINISHED,winner:G.BLACK}:null):vk(n,d)},className:"py-3 lg:py-6 px-4 bg-red-900/30 hover:bg-red-900/50 border-2 border-red-900/30 rounded-xl lg:rounded-2xl text-red-200 font-bold text-xs lg:text-xl uppercase tracking-wider transition shadow-lg",children:""}),((t==null?void 0:t.status)===se.FINISHED||(t==null?void 0:t.status)===se.DRAW)&&!ge&&!s&&C.jsx("button",{onClick:I,disabled:x&&!!t.rematchId||_,className:`py-3 lg:py-6 px-4 rounded-xl lg:rounded-2xl font-bold text-xs lg:text-xl uppercase tracking-wider transition shadow-lg border-2 
                        ${_?"bg-stone-800 border-stone-700 text-stone-500 cursor-wait":t.rematchId&&!x?"bg-green-700 hover:bg-green-600 text-white border-green-600/50 animate-pulse":x&&t.rematchId?"bg-stone-700 text-stone-400 border-stone-600 cursor-default":"bg-amber-700 hover:bg-amber-600 text-white border-amber-600/50"}`,children:_?t.rematchId?"...":"...":t.rematchId?x?" ":" !":" "}),((t==null?void 0:t.status)===se.FINISHED||(t==null?void 0:t.status)===se.DRAW)&&s&&C.jsx("button",{onClick:g,className:"py-3 lg:py-6 px-4 bg-amber-700 hover:bg-amber-600 rounded-xl lg:rounded-2xl text-white font-bold text-xs lg:text-xl uppercase tracking-wider transition shadow-lg border-2 border-amber-600/50",children:" "})]})]})})]}),C.jsx(zl,{position:"top-center",toastOptions:{style:{background:"#2a2622",color:"#e3c193",border:"1px solid #444"}}})]})},hT=document.getElementById("root");if(!hT)throw new Error("Could not find root element to mount to");const yV=$h.createRoot(hT);yV.render(C.jsx(rx.StrictMode,{children:C.jsx(gV,{})}));
