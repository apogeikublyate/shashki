(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function zT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var uv={exports:{}},Tc={},cv={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ll=Symbol.for("react.element"),qT=Symbol.for("react.portal"),KT=Symbol.for("react.fragment"),GT=Symbol.for("react.strict_mode"),WT=Symbol.for("react.profiler"),QT=Symbol.for("react.provider"),HT=Symbol.for("react.context"),YT=Symbol.for("react.forward_ref"),XT=Symbol.for("react.suspense"),JT=Symbol.for("react.memo"),ZT=Symbol.for("react.lazy"),Rg=Symbol.iterator;function ex(n){return n===null||typeof n!="object"?null:(n=Rg&&n[Rg]||n["@@iterator"],typeof n=="function"?n:null)}var hv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dv=Object.assign,fv={};function Io(n,e,t){this.props=n,this.context=e,this.refs=fv,this.updater=t||hv}Io.prototype.isReactComponent={};Io.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Io.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function pv(){}pv.prototype=Io.prototype;function Vf(n,e,t){this.props=n,this.context=e,this.refs=fv,this.updater=t||hv}var Df=Vf.prototype=new pv;Df.constructor=Vf;dv(Df,Io.prototype);Df.isPureReactComponent=!0;var Pg=Array.isArray,mv=Object.prototype.hasOwnProperty,Of={current:null},gv={key:!0,ref:!0,__self:!0,__source:!0};function yv(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)mv.call(e,r)&&!gv.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];s.children=u}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:ll,type:n,key:i,ref:o,props:s,_owner:Of.current}}function tx(n,e){return{$$typeof:ll,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Lf(n){return typeof n=="object"&&n!==null&&n.$$typeof===ll}function nx(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Cg=/\/+/g;function Th(n,e){return typeof n=="object"&&n!==null&&n.key!=null?nx(""+n.key):e.toString(36)}function fu(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case ll:case qT:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Th(o,0):r,Pg(s)?(t="",n!=null&&(t=n.replace(Cg,"$&/")+"/"),fu(s,e,t,"",function(c){return c})):s!=null&&(Lf(s)&&(s=tx(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Cg,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Pg(n))for(var a=0;a<n.length;a++){i=n[a];var u=r+Th(i,a);o+=fu(i,e,t,u,s)}else if(u=ex(n),typeof u=="function")for(n=u.call(n),a=0;!(i=n.next()).done;)i=i.value,u=r+Th(i,a++),o+=fu(i,e,t,u,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $l(n,e,t){if(n==null)return n;var r=[],s=0;return fu(n,r,"","",function(i){return e.call(t,i,s++)}),r}function rx(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Ut={current:null},pu={transition:null},sx={ReactCurrentDispatcher:Ut,ReactCurrentBatchConfig:pu,ReactCurrentOwner:Of};function _v(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:$l,forEach:function(n,e,t){$l(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return $l(n,function(){e++}),e},toArray:function(n){return $l(n,function(e){return e})||[]},only:function(n){if(!Lf(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};de.Component=Io;de.Fragment=KT;de.Profiler=WT;de.PureComponent=Vf;de.StrictMode=GT;de.Suspense=XT;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sx;de.act=_v;de.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=dv({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Of.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(u in e)mv.call(e,u)&&!gv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ll,type:n.type,key:s,ref:i,props:r,_owner:o}};de.createContext=function(n){return n={$$typeof:HT,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:QT,_context:n},n.Consumer=n};de.createElement=yv;de.createFactory=function(n){var e=yv.bind(null,n);return e.type=n,e};de.createRef=function(){return{current:null}};de.forwardRef=function(n){return{$$typeof:YT,render:n}};de.isValidElement=Lf;de.lazy=function(n){return{$$typeof:ZT,_payload:{_status:-1,_result:n},_init:rx}};de.memo=function(n,e){return{$$typeof:JT,type:n,compare:e===void 0?null:e}};de.startTransition=function(n){var e=pu.transition;pu.transition={};try{n()}finally{pu.transition=e}};de.unstable_act=_v;de.useCallback=function(n,e){return Ut.current.useCallback(n,e)};de.useContext=function(n){return Ut.current.useContext(n)};de.useDebugValue=function(){};de.useDeferredValue=function(n){return Ut.current.useDeferredValue(n)};de.useEffect=function(n,e){return Ut.current.useEffect(n,e)};de.useId=function(){return Ut.current.useId()};de.useImperativeHandle=function(n,e,t){return Ut.current.useImperativeHandle(n,e,t)};de.useInsertionEffect=function(n,e){return Ut.current.useInsertionEffect(n,e)};de.useLayoutEffect=function(n,e){return Ut.current.useLayoutEffect(n,e)};de.useMemo=function(n,e){return Ut.current.useMemo(n,e)};de.useReducer=function(n,e,t){return Ut.current.useReducer(n,e,t)};de.useRef=function(n){return Ut.current.useRef(n)};de.useState=function(n){return Ut.current.useState(n)};de.useSyncExternalStore=function(n,e,t){return Ut.current.useSyncExternalStore(n,e,t)};de.useTransition=function(){return Ut.current.useTransition()};de.version="18.3.1";cv.exports=de;var H=cv.exports;const ix=zT(H);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ox=H,ax=Symbol.for("react.element"),lx=Symbol.for("react.fragment"),ux=Object.prototype.hasOwnProperty,cx=ox.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hx={key:!0,ref:!0,__self:!0,__source:!0};function vv(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ux.call(e,r)&&!hx.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ax,type:n,key:i,ref:o,props:s,_owner:cx.current}}Tc.Fragment=lx;Tc.jsx=vv;Tc.jsxs=vv;uv.exports=Tc;var R=uv.exports,od={},wv={exports:{}},ln={},Ev={exports:{}},Iv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(M,q){var Z=M.length;M.push(q);e:for(;0<Z;){var oe=Z-1>>>1,ie=M[oe];if(0<s(ie,q))M[oe]=q,M[Z]=ie,Z=oe;else break e}}function t(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var q=M[0],Z=M.pop();if(Z!==q){M[0]=Z;e:for(var oe=0,ie=M.length,ne=ie>>>1;oe<ne;){var ce=2*(oe+1)-1,Ue=M[ce],At=ce+1,Rt=M[At];if(0>s(Ue,Z))At<ie&&0>s(Rt,Ue)?(M[oe]=Rt,M[At]=Z,oe=At):(M[oe]=Ue,M[ce]=Z,oe=ce);else if(At<ie&&0>s(Rt,Z))M[oe]=Rt,M[At]=Z,oe=At;else break e}}return q}function s(M,q){var Z=M.sortIndex-q.sortIndex;return Z!==0?Z:M.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],c=[],d=1,f=null,m=3,_=!1,A=!1,C=!1,V=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(M){for(var q=t(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=M)r(c),q.sortIndex=q.expirationTime,e(u,q);else break;q=t(c)}}function D(M){if(C=!1,w(M),!A)if(t(u)!==null)A=!0,te(F);else{var q=t(c);q!==null&&X(D,q.startTime-M)}}function F(M,q){A=!1,C&&(C=!1,I(y),y=-1),_=!0;var Z=m;try{for(w(q),f=t(u);f!==null&&(!(f.expirationTime>q)||M&&!P());){var oe=f.callback;if(typeof oe=="function"){f.callback=null,m=f.priorityLevel;var ie=oe(f.expirationTime<=q);q=n.unstable_now(),typeof ie=="function"?f.callback=ie:f===t(u)&&r(u),w(q)}else r(u);f=t(u)}if(f!==null)var ne=!0;else{var ce=t(c);ce!==null&&X(D,ce.startTime-q),ne=!1}return ne}finally{f=null,m=Z,_=!1}}var j=!1,E=null,y=-1,T=5,x=-1;function P(){return!(n.unstable_now()-x<T)}function b(){if(E!==null){var M=n.unstable_now();x=M;var q=!0;try{q=E(!0,M)}finally{q?S():(j=!1,E=null)}}else j=!1}var S;if(typeof v=="function")S=function(){v(b)};else if(typeof MessageChannel<"u"){var Ye=new MessageChannel,se=Ye.port2;Ye.port1.onmessage=b,S=function(){se.postMessage(null)}}else S=function(){V(b,0)};function te(M){E=M,j||(j=!0,S())}function X(M,q){y=V(function(){M(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(M){M.callback=null},n.unstable_continueExecution=function(){A||_||(A=!0,te(F))},n.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<M?Math.floor(1e3/M):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(M){switch(m){case 1:case 2:case 3:var q=3;break;default:q=m}var Z=m;m=q;try{return M()}finally{m=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(M,q){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var Z=m;m=M;try{return q()}finally{m=Z}},n.unstable_scheduleCallback=function(M,q,Z){var oe=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?oe+Z:oe):Z=oe,M){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=Z+ie,M={id:d++,callback:q,priorityLevel:M,startTime:Z,expirationTime:ie,sortIndex:-1},Z>oe?(M.sortIndex=Z,e(c,M),t(u)===null&&M===t(c)&&(C?(I(y),y=-1):C=!0,X(D,Z-oe))):(M.sortIndex=ie,e(u,M),A||_||(A=!0,te(F))),M},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(M){var q=m;return function(){var Z=m;m=q;try{return M.apply(this,arguments)}finally{m=Z}}}})(Iv);Ev.exports=Iv;var dx=Ev.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fx=H,sn=dx;function $(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tv=new Set,Ra={};function si(n,e){Ji(n,e),Ji(n+"Capture",e)}function Ji(n,e){for(Ra[n]=e,n=0;n<e.length;n++)Tv.add(e[n])}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ad=Object.prototype.hasOwnProperty,px=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bg={},kg={};function mx(n){return ad.call(kg,n)?!0:ad.call(bg,n)?!1:px.test(n)?kg[n]=!0:(bg[n]=!0,!1)}function gx(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function yx(n,e,t,r){if(e===null||typeof e>"u"||gx(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $t(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){gt[n]=new $t(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];gt[e]=new $t(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){gt[n]=new $t(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){gt[n]=new $t(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){gt[n]=new $t(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){gt[n]=new $t(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){gt[n]=new $t(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){gt[n]=new $t(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){gt[n]=new $t(n,5,!1,n.toLowerCase(),null,!1,!1)});var Mf=/[\-:]([a-z])/g;function Ff(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Mf,Ff);gt[e]=new $t(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Mf,Ff);gt[e]=new $t(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Mf,Ff);gt[e]=new $t(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){gt[n]=new $t(n,1,!1,n.toLowerCase(),null,!1,!1)});gt.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){gt[n]=new $t(n,1,!1,n.toLowerCase(),null,!0,!0)});function jf(n,e,t,r){var s=gt.hasOwnProperty(e)?gt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yx(e,t,s,r)&&(t=null),r||s===null?mx(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var hr=fx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zl=Symbol.for("react.element"),Ni=Symbol.for("react.portal"),Vi=Symbol.for("react.fragment"),Bf=Symbol.for("react.strict_mode"),ld=Symbol.for("react.profiler"),xv=Symbol.for("react.provider"),Sv=Symbol.for("react.context"),Uf=Symbol.for("react.forward_ref"),ud=Symbol.for("react.suspense"),cd=Symbol.for("react.suspense_list"),$f=Symbol.for("react.memo"),Sr=Symbol.for("react.lazy"),Av=Symbol.for("react.offscreen"),Ng=Symbol.iterator;function Ko(n){return n===null||typeof n!="object"?null:(n=Ng&&n[Ng]||n["@@iterator"],typeof n=="function"?n:null)}var Be=Object.assign,xh;function sa(n){if(xh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);xh=e&&e[1]||""}return`
`+xh+n}var Sh=!1;function Ah(n,e){if(!n||Sh)return"";Sh=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=o&&0<=a);break}}}finally{Sh=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?sa(n):""}function _x(n){switch(n.tag){case 5:return sa(n.type);case 16:return sa("Lazy");case 13:return sa("Suspense");case 19:return sa("SuspenseList");case 0:case 2:case 15:return n=Ah(n.type,!1),n;case 11:return n=Ah(n.type.render,!1),n;case 1:return n=Ah(n.type,!0),n;default:return""}}function hd(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Vi:return"Fragment";case Ni:return"Portal";case ld:return"Profiler";case Bf:return"StrictMode";case ud:return"Suspense";case cd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Sv:return(n.displayName||"Context")+".Consumer";case xv:return(n._context.displayName||"Context")+".Provider";case Uf:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case $f:return e=n.displayName||null,e!==null?e:hd(n.type)||"Memo";case Sr:e=n._payload,n=n._init;try{return hd(n(e))}catch{}}return null}function vx(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hd(e);case 8:return e===Bf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Kr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Rv(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wx(n){var e=Rv(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ql(n){n._valueTracker||(n._valueTracker=wx(n))}function Pv(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Rv(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Du(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function dd(n,e){var t=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Vg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Kr(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cv(n,e){e=e.checked,e!=null&&jf(n,"checked",e,!1)}function fd(n,e){Cv(n,e);var t=Kr(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?pd(n,e.type,t):e.hasOwnProperty("defaultValue")&&pd(n,e.type,Kr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Dg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function pd(n,e,t){(e!=="number"||Du(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ia=Array.isArray;function qi(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Kr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function md(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Og(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error($(92));if(ia(t)){if(1<t.length)throw Error($(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Kr(t)}}function bv(n,e){var t=Kr(e.value),r=Kr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Lg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function kv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gd(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?kv(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Kl,Nv=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Kl=Kl||document.createElement("div"),Kl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Kl.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Pa(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var da={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ex=["Webkit","ms","Moz","O"];Object.keys(da).forEach(function(n){Ex.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),da[e]=da[n]})});function Vv(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||da.hasOwnProperty(n)&&da[n]?(""+e).trim():e+"px"}function Dv(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=Vv(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var Ix=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yd(n,e){if(e){if(Ix[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function _d(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vd=null;function zf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var wd=null,Ki=null,Gi=null;function Mg(n){if(n=hl(n)){if(typeof wd!="function")throw Error($(280));var e=n.stateNode;e&&(e=Pc(e),wd(n.stateNode,n.type,e))}}function Ov(n){Ki?Gi?Gi.push(n):Gi=[n]:Ki=n}function Lv(){if(Ki){var n=Ki,e=Gi;if(Gi=Ki=null,Mg(n),e)for(n=0;n<e.length;n++)Mg(e[n])}}function Mv(n,e){return n(e)}function Fv(){}var Rh=!1;function jv(n,e,t){if(Rh)return n(e,t);Rh=!0;try{return Mv(n,e,t)}finally{Rh=!1,(Ki!==null||Gi!==null)&&(Fv(),Lv())}}function Ca(n,e){var t=n.stateNode;if(t===null)return null;var r=Pc(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error($(231,e,typeof t));return t}var Ed=!1;if(rr)try{var Go={};Object.defineProperty(Go,"passive",{get:function(){Ed=!0}}),window.addEventListener("test",Go,Go),window.removeEventListener("test",Go,Go)}catch{Ed=!1}function Tx(n,e,t,r,s,i,o,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(d){this.onError(d)}}var fa=!1,Ou=null,Lu=!1,Id=null,xx={onError:function(n){fa=!0,Ou=n}};function Sx(n,e,t,r,s,i,o,a,u){fa=!1,Ou=null,Tx.apply(xx,arguments)}function Ax(n,e,t,r,s,i,o,a,u){if(Sx.apply(this,arguments),fa){if(fa){var c=Ou;fa=!1,Ou=null}else throw Error($(198));Lu||(Lu=!0,Id=c)}}function ii(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Bv(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Fg(n){if(ii(n)!==n)throw Error($(188))}function Rx(n){var e=n.alternate;if(!e){if(e=ii(n),e===null)throw Error($(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return Fg(s),n;if(i===r)return Fg(s),e;i=i.sibling}throw Error($(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error($(189))}}if(t.alternate!==r)throw Error($(190))}if(t.tag!==3)throw Error($(188));return t.stateNode.current===t?n:e}function Uv(n){return n=Rx(n),n!==null?$v(n):null}function $v(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=$v(n);if(e!==null)return e;n=n.sibling}return null}var zv=sn.unstable_scheduleCallback,jg=sn.unstable_cancelCallback,Px=sn.unstable_shouldYield,Cx=sn.unstable_requestPaint,Ge=sn.unstable_now,bx=sn.unstable_getCurrentPriorityLevel,qf=sn.unstable_ImmediatePriority,qv=sn.unstable_UserBlockingPriority,Mu=sn.unstable_NormalPriority,kx=sn.unstable_LowPriority,Kv=sn.unstable_IdlePriority,xc=null,Ln=null;function Nx(n){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(xc,n,void 0,(n.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:Ox,Vx=Math.log,Dx=Math.LN2;function Ox(n){return n>>>=0,n===0?32:31-(Vx(n)/Dx|0)|0}var Gl=64,Wl=4194304;function oa(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Fu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=oa(a):(i&=o,i!==0&&(r=oa(i)))}else o=t&~s,o!==0?r=oa(o):i!==0&&(r=oa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Sn(e),s=1<<t,r|=n[t],e&=~s;return r}function Lx(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mx(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Sn(i),a=1<<o,u=s[o];u===-1?(!(a&t)||a&r)&&(s[o]=Lx(a,e)):u<=e&&(n.expiredLanes|=a),i&=~a}}function Td(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Gv(){var n=Gl;return Gl<<=1,!(Gl&4194240)&&(Gl=64),n}function Ph(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ul(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Sn(e),n[e]=t}function Fx(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Sn(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function Kf(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Sn(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Te=0;function Wv(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Qv,Gf,Hv,Yv,Xv,xd=!1,Ql=[],Or=null,Lr=null,Mr=null,ba=new Map,ka=new Map,Rr=[],jx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bg(n,e){switch(n){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":Mr=null;break;case"pointerover":case"pointerout":ba.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ka.delete(e.pointerId)}}function Wo(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=hl(e),e!==null&&Gf(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function Bx(n,e,t,r,s){switch(e){case"focusin":return Or=Wo(Or,n,e,t,r,s),!0;case"dragenter":return Lr=Wo(Lr,n,e,t,r,s),!0;case"mouseover":return Mr=Wo(Mr,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return ba.set(i,Wo(ba.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ka.set(i,Wo(ka.get(i)||null,n,e,t,r,s)),!0}return!1}function Jv(n){var e=Ns(n.target);if(e!==null){var t=ii(e);if(t!==null){if(e=t.tag,e===13){if(e=Bv(t),e!==null){n.blockedOn=e,Xv(n.priority,function(){Hv(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function mu(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Sd(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);vd=r,t.target.dispatchEvent(r),vd=null}else return e=hl(t),e!==null&&Gf(e),n.blockedOn=t,!1;e.shift()}return!0}function Ug(n,e,t){mu(n)&&t.delete(e)}function Ux(){xd=!1,Or!==null&&mu(Or)&&(Or=null),Lr!==null&&mu(Lr)&&(Lr=null),Mr!==null&&mu(Mr)&&(Mr=null),ba.forEach(Ug),ka.forEach(Ug)}function Qo(n,e){n.blockedOn===e&&(n.blockedOn=null,xd||(xd=!0,sn.unstable_scheduleCallback(sn.unstable_NormalPriority,Ux)))}function Na(n){function e(s){return Qo(s,n)}if(0<Ql.length){Qo(Ql[0],n);for(var t=1;t<Ql.length;t++){var r=Ql[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Or!==null&&Qo(Or,n),Lr!==null&&Qo(Lr,n),Mr!==null&&Qo(Mr,n),ba.forEach(e),ka.forEach(e),t=0;t<Rr.length;t++)r=Rr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Rr.length&&(t=Rr[0],t.blockedOn===null);)Jv(t),t.blockedOn===null&&Rr.shift()}var Wi=hr.ReactCurrentBatchConfig,ju=!0;function $x(n,e,t,r){var s=Te,i=Wi.transition;Wi.transition=null;try{Te=1,Wf(n,e,t,r)}finally{Te=s,Wi.transition=i}}function zx(n,e,t,r){var s=Te,i=Wi.transition;Wi.transition=null;try{Te=4,Wf(n,e,t,r)}finally{Te=s,Wi.transition=i}}function Wf(n,e,t,r){if(ju){var s=Sd(n,e,t,r);if(s===null)Fh(n,e,r,Bu,t),Bg(n,r);else if(Bx(s,n,e,t,r))r.stopPropagation();else if(Bg(n,r),e&4&&-1<jx.indexOf(n)){for(;s!==null;){var i=hl(s);if(i!==null&&Qv(i),i=Sd(n,e,t,r),i===null&&Fh(n,e,r,Bu,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else Fh(n,e,r,null,t)}}var Bu=null;function Sd(n,e,t,r){if(Bu=null,n=zf(r),n=Ns(n),n!==null)if(e=ii(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Bv(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Bu=n,null}function Zv(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bx()){case qf:return 1;case qv:return 4;case Mu:case kx:return 16;case Kv:return 536870912;default:return 16}default:return 16}}var Nr=null,Qf=null,gu=null;function ew(){if(gu)return gu;var n,e=Qf,t=e.length,r,s="value"in Nr?Nr.value:Nr.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return gu=s.slice(n,1<r?1-r:void 0)}function yu(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Hl(){return!0}function $g(){return!1}function un(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Hl:$g,this.isPropagationStopped=$g,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Hl)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Hl)},persist:function(){},isPersistent:Hl}),e}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hf=un(To),cl=Be({},To,{view:0,detail:0}),qx=un(cl),Ch,bh,Ho,Sc=Be({},cl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ho&&(Ho&&n.type==="mousemove"?(Ch=n.screenX-Ho.screenX,bh=n.screenY-Ho.screenY):bh=Ch=0,Ho=n),Ch)},movementY:function(n){return"movementY"in n?n.movementY:bh}}),zg=un(Sc),Kx=Be({},Sc,{dataTransfer:0}),Gx=un(Kx),Wx=Be({},cl,{relatedTarget:0}),kh=un(Wx),Qx=Be({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),Hx=un(Qx),Yx=Be({},To,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Xx=un(Yx),Jx=Be({},To,{data:0}),qg=un(Jx),Zx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nS(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=tS[n])?!!e[n]:!1}function Yf(){return nS}var rS=Be({},cl,{key:function(n){if(n.key){var e=Zx[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=yu(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?eS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yf,charCode:function(n){return n.type==="keypress"?yu(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?yu(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),sS=un(rS),iS=Be({},Sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kg=un(iS),oS=Be({},cl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yf}),aS=un(oS),lS=Be({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),uS=un(lS),cS=Be({},Sc,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),hS=un(cS),dS=[9,13,27,32],Xf=rr&&"CompositionEvent"in window,pa=null;rr&&"documentMode"in document&&(pa=document.documentMode);var fS=rr&&"TextEvent"in window&&!pa,tw=rr&&(!Xf||pa&&8<pa&&11>=pa),Gg=" ",Wg=!1;function nw(n,e){switch(n){case"keyup":return dS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rw(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Di=!1;function pS(n,e){switch(n){case"compositionend":return rw(e);case"keypress":return e.which!==32?null:(Wg=!0,Gg);case"textInput":return n=e.data,n===Gg&&Wg?null:n;default:return null}}function mS(n,e){if(Di)return n==="compositionend"||!Xf&&nw(n,e)?(n=ew(),gu=Qf=Nr=null,Di=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tw&&e.locale!=="ko"?null:e.data;default:return null}}var gS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qg(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!gS[n.type]:e==="textarea"}function sw(n,e,t,r){Ov(r),e=Uu(e,"onChange"),0<e.length&&(t=new Hf("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ma=null,Va=null;function yS(n){mw(n,0)}function Ac(n){var e=Mi(n);if(Pv(e))return n}function _S(n,e){if(n==="change")return e}var iw=!1;if(rr){var Nh;if(rr){var Vh="oninput"in document;if(!Vh){var Hg=document.createElement("div");Hg.setAttribute("oninput","return;"),Vh=typeof Hg.oninput=="function"}Nh=Vh}else Nh=!1;iw=Nh&&(!document.documentMode||9<document.documentMode)}function Yg(){ma&&(ma.detachEvent("onpropertychange",ow),Va=ma=null)}function ow(n){if(n.propertyName==="value"&&Ac(Va)){var e=[];sw(e,Va,n,zf(n)),jv(yS,e)}}function vS(n,e,t){n==="focusin"?(Yg(),ma=e,Va=t,ma.attachEvent("onpropertychange",ow)):n==="focusout"&&Yg()}function wS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ac(Va)}function ES(n,e){if(n==="click")return Ac(e)}function IS(n,e){if(n==="input"||n==="change")return Ac(e)}function TS(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Rn=typeof Object.is=="function"?Object.is:TS;function Da(n,e){if(Rn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!ad.call(e,s)||!Rn(n[s],e[s]))return!1}return!0}function Xg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Jg(n,e){var t=Xg(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Xg(t)}}function aw(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?aw(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function lw(){for(var n=window,e=Du();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Du(n.document)}return e}function Jf(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function xS(n){var e=lw(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&aw(t.ownerDocument.documentElement,t)){if(r!==null&&Jf(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=Jg(t,i);var o=Jg(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var SS=rr&&"documentMode"in document&&11>=document.documentMode,Oi=null,Ad=null,ga=null,Rd=!1;function Zg(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Rd||Oi==null||Oi!==Du(r)||(r=Oi,"selectionStart"in r&&Jf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ga&&Da(ga,r)||(ga=r,r=Uu(Ad,"onSelect"),0<r.length&&(e=new Hf("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Oi)))}function Yl(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Li={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},Dh={},uw={};rr&&(uw=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function Rc(n){if(Dh[n])return Dh[n];if(!Li[n])return n;var e=Li[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in uw)return Dh[n]=e[t];return n}var cw=Rc("animationend"),hw=Rc("animationiteration"),dw=Rc("animationstart"),fw=Rc("transitionend"),pw=new Map,ey="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ss(n,e){pw.set(n,e),si(e,[n])}for(var Oh=0;Oh<ey.length;Oh++){var Lh=ey[Oh],AS=Lh.toLowerCase(),RS=Lh[0].toUpperCase()+Lh.slice(1);ss(AS,"on"+RS)}ss(cw,"onAnimationEnd");ss(hw,"onAnimationIteration");ss(dw,"onAnimationStart");ss("dblclick","onDoubleClick");ss("focusin","onFocus");ss("focusout","onBlur");ss(fw,"onTransitionEnd");Ji("onMouseEnter",["mouseout","mouseover"]);Ji("onMouseLeave",["mouseout","mouseover"]);Ji("onPointerEnter",["pointerout","pointerover"]);Ji("onPointerLeave",["pointerout","pointerover"]);si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));si("onBeforeInput",["compositionend","keypress","textInput","paste"]);si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var aa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PS=new Set("cancel close invalid load scroll toggle".split(" ").concat(aa));function ty(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,Ax(r,e,void 0,n),n.currentTarget=null}function mw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;ty(s,a,c),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,c=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;ty(s,a,c),i=u}}}if(Lu)throw n=Id,Lu=!1,Id=null,n}function Ce(n,e){var t=e[Nd];t===void 0&&(t=e[Nd]=new Set);var r=n+"__bubble";t.has(r)||(gw(e,n,2,!1),t.add(r))}function Mh(n,e,t){var r=0;e&&(r|=4),gw(t,n,r,e)}var Xl="_reactListening"+Math.random().toString(36).slice(2);function Oa(n){if(!n[Xl]){n[Xl]=!0,Tv.forEach(function(t){t!=="selectionchange"&&(PS.has(t)||Mh(t,!1,n),Mh(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Xl]||(e[Xl]=!0,Mh("selectionchange",!1,e))}}function gw(n,e,t,r){switch(Zv(e)){case 1:var s=$x;break;case 4:s=zx;break;default:s=Wf}t=s.bind(null,e,t,n),s=void 0,!Ed||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Fh(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ns(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}jv(function(){var c=i,d=zf(t),f=[];e:{var m=pw.get(n);if(m!==void 0){var _=Hf,A=n;switch(n){case"keypress":if(yu(t)===0)break e;case"keydown":case"keyup":_=sS;break;case"focusin":A="focus",_=kh;break;case"focusout":A="blur",_=kh;break;case"beforeblur":case"afterblur":_=kh;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=zg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=Gx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=aS;break;case cw:case hw:case dw:_=Hx;break;case fw:_=uS;break;case"scroll":_=qx;break;case"wheel":_=hS;break;case"copy":case"cut":case"paste":_=Xx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Kg}var C=(e&4)!==0,V=!C&&n==="scroll",I=C?m!==null?m+"Capture":null:m;C=[];for(var v=c,w;v!==null;){w=v;var D=w.stateNode;if(w.tag===5&&D!==null&&(w=D,I!==null&&(D=Ca(v,I),D!=null&&C.push(La(v,D,w)))),V)break;v=v.return}0<C.length&&(m=new _(m,A,null,t,d),f.push({event:m,listeners:C}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",m&&t!==vd&&(A=t.relatedTarget||t.fromElement)&&(Ns(A)||A[sr]))break e;if((_||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,_?(A=t.relatedTarget||t.toElement,_=c,A=A?Ns(A):null,A!==null&&(V=ii(A),A!==V||A.tag!==5&&A.tag!==6)&&(A=null)):(_=null,A=c),_!==A)){if(C=zg,D="onMouseLeave",I="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(C=Kg,D="onPointerLeave",I="onPointerEnter",v="pointer"),V=_==null?m:Mi(_),w=A==null?m:Mi(A),m=new C(D,v+"leave",_,t,d),m.target=V,m.relatedTarget=w,D=null,Ns(d)===c&&(C=new C(I,v+"enter",A,t,d),C.target=w,C.relatedTarget=V,D=C),V=D,_&&A)t:{for(C=_,I=A,v=0,w=C;w;w=Ei(w))v++;for(w=0,D=I;D;D=Ei(D))w++;for(;0<v-w;)C=Ei(C),v--;for(;0<w-v;)I=Ei(I),w--;for(;v--;){if(C===I||I!==null&&C===I.alternate)break t;C=Ei(C),I=Ei(I)}C=null}else C=null;_!==null&&ny(f,m,_,C,!1),A!==null&&V!==null&&ny(f,V,A,C,!0)}}e:{if(m=c?Mi(c):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var F=_S;else if(Qg(m))if(iw)F=IS;else{F=wS;var j=vS}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=ES);if(F&&(F=F(n,c))){sw(f,F,t,d);break e}j&&j(n,m,c),n==="focusout"&&(j=m._wrapperState)&&j.controlled&&m.type==="number"&&pd(m,"number",m.value)}switch(j=c?Mi(c):window,n){case"focusin":(Qg(j)||j.contentEditable==="true")&&(Oi=j,Ad=c,ga=null);break;case"focusout":ga=Ad=Oi=null;break;case"mousedown":Rd=!0;break;case"contextmenu":case"mouseup":case"dragend":Rd=!1,Zg(f,t,d);break;case"selectionchange":if(SS)break;case"keydown":case"keyup":Zg(f,t,d)}var E;if(Xf)e:{switch(n){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Di?nw(n,t)&&(y="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(y="onCompositionStart");y&&(tw&&t.locale!=="ko"&&(Di||y!=="onCompositionStart"?y==="onCompositionEnd"&&Di&&(E=ew()):(Nr=d,Qf="value"in Nr?Nr.value:Nr.textContent,Di=!0)),j=Uu(c,y),0<j.length&&(y=new qg(y,n,null,t,d),f.push({event:y,listeners:j}),E?y.data=E:(E=rw(t),E!==null&&(y.data=E)))),(E=fS?pS(n,t):mS(n,t))&&(c=Uu(c,"onBeforeInput"),0<c.length&&(d=new qg("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:c}),d.data=E))}mw(f,e)})}function La(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Uu(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ca(n,t),i!=null&&r.unshift(La(n,i,s)),i=Ca(n,e),i!=null&&r.push(La(n,i,s))),n=n.return}return r}function Ei(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function ny(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,s?(u=Ca(t,i),u!=null&&o.unshift(La(t,u,a))):s||(u=Ca(t,i),u!=null&&o.push(La(t,u,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var CS=/\r\n?/g,bS=/\u0000|\uFFFD/g;function ry(n){return(typeof n=="string"?n:""+n).replace(CS,`
`).replace(bS,"")}function Jl(n,e,t){if(e=ry(e),ry(n)!==e&&t)throw Error($(425))}function $u(){}var Pd=null,Cd=null;function bd(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var kd=typeof setTimeout=="function"?setTimeout:void 0,kS=typeof clearTimeout=="function"?clearTimeout:void 0,sy=typeof Promise=="function"?Promise:void 0,NS=typeof queueMicrotask=="function"?queueMicrotask:typeof sy<"u"?function(n){return sy.resolve(null).then(n).catch(VS)}:kd;function VS(n){setTimeout(function(){throw n})}function jh(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Na(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Na(e)}function Fr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function iy(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var xo=Math.random().toString(36).slice(2),Nn="__reactFiber$"+xo,Ma="__reactProps$"+xo,sr="__reactContainer$"+xo,Nd="__reactEvents$"+xo,DS="__reactListeners$"+xo,OS="__reactHandles$"+xo;function Ns(n){var e=n[Nn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[sr]||t[Nn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=iy(n);n!==null;){if(t=n[Nn])return t;n=iy(n)}return e}n=t,t=n.parentNode}return null}function hl(n){return n=n[Nn]||n[sr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Mi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error($(33))}function Pc(n){return n[Ma]||null}var Vd=[],Fi=-1;function is(n){return{current:n}}function ke(n){0>Fi||(n.current=Vd[Fi],Vd[Fi]=null,Fi--)}function Ae(n,e){Fi++,Vd[Fi]=n.current,n.current=e}var Gr={},xt=is(Gr),Yt=is(!1),$s=Gr;function Zi(n,e){var t=n.type.contextTypes;if(!t)return Gr;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function Xt(n){return n=n.childContextTypes,n!=null}function zu(){ke(Yt),ke(xt)}function oy(n,e,t){if(xt.current!==Gr)throw Error($(168));Ae(xt,e),Ae(Yt,t)}function yw(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,vx(n)||"Unknown",s));return Be({},t,r)}function qu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Gr,$s=xt.current,Ae(xt,n),Ae(Yt,Yt.current),!0}function ay(n,e,t){var r=n.stateNode;if(!r)throw Error($(169));t?(n=yw(n,e,$s),r.__reactInternalMemoizedMergedChildContext=n,ke(Yt),ke(xt),Ae(xt,n)):ke(Yt),Ae(Yt,t)}var Xn=null,Cc=!1,Bh=!1;function _w(n){Xn===null?Xn=[n]:Xn.push(n)}function LS(n){Cc=!0,_w(n)}function os(){if(!Bh&&Xn!==null){Bh=!0;var n=0,e=Te;try{var t=Xn;for(Te=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Xn=null,Cc=!1}catch(s){throw Xn!==null&&(Xn=Xn.slice(n+1)),zv(qf,os),s}finally{Te=e,Bh=!1}}return null}var ji=[],Bi=0,Ku=null,Gu=0,cn=[],hn=0,zs=null,Jn=1,Zn="";function Ts(n,e){ji[Bi++]=Gu,ji[Bi++]=Ku,Ku=n,Gu=e}function vw(n,e,t){cn[hn++]=Jn,cn[hn++]=Zn,cn[hn++]=zs,zs=n;var r=Jn;n=Zn;var s=32-Sn(r)-1;r&=~(1<<s),t+=1;var i=32-Sn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Jn=1<<32-Sn(e)+s|t<<s|r,Zn=i+n}else Jn=1<<i|t<<s|r,Zn=n}function Zf(n){n.return!==null&&(Ts(n,1),vw(n,1,0))}function ep(n){for(;n===Ku;)Ku=ji[--Bi],ji[Bi]=null,Gu=ji[--Bi],ji[Bi]=null;for(;n===zs;)zs=cn[--hn],cn[hn]=null,Zn=cn[--hn],cn[hn]=null,Jn=cn[--hn],cn[hn]=null}var rn=null,nn=null,Ve=!1,xn=null;function ww(n,e){var t=dn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function ly(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,rn=n,nn=Fr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,rn=n,nn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=zs!==null?{id:Jn,overflow:Zn}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=dn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,rn=n,nn=null,!0):!1;default:return!1}}function Dd(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Od(n){if(Ve){var e=nn;if(e){var t=e;if(!ly(n,e)){if(Dd(n))throw Error($(418));e=Fr(t.nextSibling);var r=rn;e&&ly(n,e)?ww(r,t):(n.flags=n.flags&-4097|2,Ve=!1,rn=n)}}else{if(Dd(n))throw Error($(418));n.flags=n.flags&-4097|2,Ve=!1,rn=n}}}function uy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;rn=n}function Zl(n){if(n!==rn)return!1;if(!Ve)return uy(n),Ve=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!bd(n.type,n.memoizedProps)),e&&(e=nn)){if(Dd(n))throw Ew(),Error($(418));for(;e;)ww(n,e),e=Fr(e.nextSibling)}if(uy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error($(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){nn=Fr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}nn=null}}else nn=rn?Fr(n.stateNode.nextSibling):null;return!0}function Ew(){for(var n=nn;n;)n=Fr(n.nextSibling)}function eo(){nn=rn=null,Ve=!1}function tp(n){xn===null?xn=[n]:xn.push(n)}var MS=hr.ReactCurrentBatchConfig;function Yo(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error($(309));var r=t.stateNode}if(!r)throw Error($(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error($(284));if(!t._owner)throw Error($(290,n))}return n}function eu(n,e){throw n=Object.prototype.toString.call(e),Error($(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function cy(n){var e=n._init;return e(n._payload)}function Iw(n){function e(I,v){if(n){var w=I.deletions;w===null?(I.deletions=[v],I.flags|=16):w.push(v)}}function t(I,v){if(!n)return null;for(;v!==null;)e(I,v),v=v.sibling;return null}function r(I,v){for(I=new Map;v!==null;)v.key!==null?I.set(v.key,v):I.set(v.index,v),v=v.sibling;return I}function s(I,v){return I=$r(I,v),I.index=0,I.sibling=null,I}function i(I,v,w){return I.index=w,n?(w=I.alternate,w!==null?(w=w.index,w<v?(I.flags|=2,v):w):(I.flags|=2,v)):(I.flags|=1048576,v)}function o(I){return n&&I.alternate===null&&(I.flags|=2),I}function a(I,v,w,D){return v===null||v.tag!==6?(v=Wh(w,I.mode,D),v.return=I,v):(v=s(v,w),v.return=I,v)}function u(I,v,w,D){var F=w.type;return F===Vi?d(I,v,w.props.children,D,w.key):v!==null&&(v.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Sr&&cy(F)===v.type)?(D=s(v,w.props),D.ref=Yo(I,v,w),D.return=I,D):(D=xu(w.type,w.key,w.props,null,I.mode,D),D.ref=Yo(I,v,w),D.return=I,D)}function c(I,v,w,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Qh(w,I.mode,D),v.return=I,v):(v=s(v,w.children||[]),v.return=I,v)}function d(I,v,w,D,F){return v===null||v.tag!==7?(v=Fs(w,I.mode,D,F),v.return=I,v):(v=s(v,w),v.return=I,v)}function f(I,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Wh(""+v,I.mode,w),v.return=I,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zl:return w=xu(v.type,v.key,v.props,null,I.mode,w),w.ref=Yo(I,null,v),w.return=I,w;case Ni:return v=Qh(v,I.mode,w),v.return=I,v;case Sr:var D=v._init;return f(I,D(v._payload),w)}if(ia(v)||Ko(v))return v=Fs(v,I.mode,w,null),v.return=I,v;eu(I,v)}return null}function m(I,v,w,D){var F=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return F!==null?null:a(I,v,""+w,D);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case zl:return w.key===F?u(I,v,w,D):null;case Ni:return w.key===F?c(I,v,w,D):null;case Sr:return F=w._init,m(I,v,F(w._payload),D)}if(ia(w)||Ko(w))return F!==null?null:d(I,v,w,D,null);eu(I,w)}return null}function _(I,v,w,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return I=I.get(w)||null,a(v,I,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case zl:return I=I.get(D.key===null?w:D.key)||null,u(v,I,D,F);case Ni:return I=I.get(D.key===null?w:D.key)||null,c(v,I,D,F);case Sr:var j=D._init;return _(I,v,w,j(D._payload),F)}if(ia(D)||Ko(D))return I=I.get(w)||null,d(v,I,D,F,null);eu(v,D)}return null}function A(I,v,w,D){for(var F=null,j=null,E=v,y=v=0,T=null;E!==null&&y<w.length;y++){E.index>y?(T=E,E=null):T=E.sibling;var x=m(I,E,w[y],D);if(x===null){E===null&&(E=T);break}n&&E&&x.alternate===null&&e(I,E),v=i(x,v,y),j===null?F=x:j.sibling=x,j=x,E=T}if(y===w.length)return t(I,E),Ve&&Ts(I,y),F;if(E===null){for(;y<w.length;y++)E=f(I,w[y],D),E!==null&&(v=i(E,v,y),j===null?F=E:j.sibling=E,j=E);return Ve&&Ts(I,y),F}for(E=r(I,E);y<w.length;y++)T=_(E,I,y,w[y],D),T!==null&&(n&&T.alternate!==null&&E.delete(T.key===null?y:T.key),v=i(T,v,y),j===null?F=T:j.sibling=T,j=T);return n&&E.forEach(function(P){return e(I,P)}),Ve&&Ts(I,y),F}function C(I,v,w,D){var F=Ko(w);if(typeof F!="function")throw Error($(150));if(w=F.call(w),w==null)throw Error($(151));for(var j=F=null,E=v,y=v=0,T=null,x=w.next();E!==null&&!x.done;y++,x=w.next()){E.index>y?(T=E,E=null):T=E.sibling;var P=m(I,E,x.value,D);if(P===null){E===null&&(E=T);break}n&&E&&P.alternate===null&&e(I,E),v=i(P,v,y),j===null?F=P:j.sibling=P,j=P,E=T}if(x.done)return t(I,E),Ve&&Ts(I,y),F;if(E===null){for(;!x.done;y++,x=w.next())x=f(I,x.value,D),x!==null&&(v=i(x,v,y),j===null?F=x:j.sibling=x,j=x);return Ve&&Ts(I,y),F}for(E=r(I,E);!x.done;y++,x=w.next())x=_(E,I,y,x.value,D),x!==null&&(n&&x.alternate!==null&&E.delete(x.key===null?y:x.key),v=i(x,v,y),j===null?F=x:j.sibling=x,j=x);return n&&E.forEach(function(b){return e(I,b)}),Ve&&Ts(I,y),F}function V(I,v,w,D){if(typeof w=="object"&&w!==null&&w.type===Vi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case zl:e:{for(var F=w.key,j=v;j!==null;){if(j.key===F){if(F=w.type,F===Vi){if(j.tag===7){t(I,j.sibling),v=s(j,w.props.children),v.return=I,I=v;break e}}else if(j.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Sr&&cy(F)===j.type){t(I,j.sibling),v=s(j,w.props),v.ref=Yo(I,j,w),v.return=I,I=v;break e}t(I,j);break}else e(I,j);j=j.sibling}w.type===Vi?(v=Fs(w.props.children,I.mode,D,w.key),v.return=I,I=v):(D=xu(w.type,w.key,w.props,null,I.mode,D),D.ref=Yo(I,v,w),D.return=I,I=D)}return o(I);case Ni:e:{for(j=w.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){t(I,v.sibling),v=s(v,w.children||[]),v.return=I,I=v;break e}else{t(I,v);break}else e(I,v);v=v.sibling}v=Qh(w,I.mode,D),v.return=I,I=v}return o(I);case Sr:return j=w._init,V(I,v,j(w._payload),D)}if(ia(w))return A(I,v,w,D);if(Ko(w))return C(I,v,w,D);eu(I,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(t(I,v.sibling),v=s(v,w),v.return=I,I=v):(t(I,v),v=Wh(w,I.mode,D),v.return=I,I=v),o(I)):t(I,v)}return V}var to=Iw(!0),Tw=Iw(!1),Wu=is(null),Qu=null,Ui=null,np=null;function rp(){np=Ui=Qu=null}function sp(n){var e=Wu.current;ke(Wu),n._currentValue=e}function Ld(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Qi(n,e){Qu=n,np=Ui=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Gt=!0),n.firstContext=null)}function gn(n){var e=n._currentValue;if(np!==n)if(n={context:n,memoizedValue:e,next:null},Ui===null){if(Qu===null)throw Error($(308));Ui=n,Qu.dependencies={lanes:0,firstContext:n}}else Ui=Ui.next=n;return e}var Vs=null;function ip(n){Vs===null?Vs=[n]:Vs.push(n)}function xw(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,ip(e)):(t.next=s.next,s.next=t),e.interleaved=t,ir(n,r)}function ir(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ar=!1;function op(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sw(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function tr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function jr(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,_e&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ir(n,t)}return s=r.interleaved,s===null?(e.next=e,ip(r)):(e.next=s.next,s.next=e),r.interleaved=e,ir(n,t)}function _u(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Kf(n,t)}}function hy(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Hu(n,e,t,r){var s=n.updateQueue;Ar=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=u))}if(i!==null){var f=s.baseState;o=0,d=c=u=null,a=i;do{var m=a.lane,_=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=n,C=a;switch(m=e,_=t,C.tag){case 1:if(A=C.payload,typeof A=="function"){f=A.call(_,f,m);break e}f=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=C.payload,m=typeof A=="function"?A.call(_,f,m):A,m==null)break e;f=Be({},f,m);break e;case 2:Ar=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=_,u=f):d=d.next=_,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(u=f),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ks|=o,n.lanes=o,n.memoizedState=f}}function dy(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error($(191,s));s.call(r)}}}var dl={},Mn=is(dl),Fa=is(dl),ja=is(dl);function Ds(n){if(n===dl)throw Error($(174));return n}function ap(n,e){switch(Ae(ja,e),Ae(Fa,n),Ae(Mn,dl),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gd(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=gd(e,n)}ke(Mn),Ae(Mn,e)}function no(){ke(Mn),ke(Fa),ke(ja)}function Aw(n){Ds(ja.current);var e=Ds(Mn.current),t=gd(e,n.type);e!==t&&(Ae(Fa,n),Ae(Mn,t))}function lp(n){Fa.current===n&&(ke(Mn),ke(Fa))}var Me=is(0);function Yu(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Uh=[];function up(){for(var n=0;n<Uh.length;n++)Uh[n]._workInProgressVersionPrimary=null;Uh.length=0}var vu=hr.ReactCurrentDispatcher,$h=hr.ReactCurrentBatchConfig,qs=0,Fe=null,tt=null,at=null,Xu=!1,ya=!1,Ba=0,FS=0;function vt(){throw Error($(321))}function cp(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Rn(n[t],e[t]))return!1;return!0}function hp(n,e,t,r,s,i){if(qs=i,Fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vu.current=n===null||n.memoizedState===null?$S:zS,n=t(r,s),ya){i=0;do{if(ya=!1,Ba=0,25<=i)throw Error($(301));i+=1,at=tt=null,e.updateQueue=null,vu.current=qS,n=t(r,s)}while(ya)}if(vu.current=Ju,e=tt!==null&&tt.next!==null,qs=0,at=tt=Fe=null,Xu=!1,e)throw Error($(300));return n}function dp(){var n=Ba!==0;return Ba=0,n}function kn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?Fe.memoizedState=at=n:at=at.next=n,at}function yn(){if(tt===null){var n=Fe.alternate;n=n!==null?n.memoizedState:null}else n=tt.next;var e=at===null?Fe.memoizedState:at.next;if(e!==null)at=e,tt=n;else{if(n===null)throw Error($(310));tt=n,n={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},at===null?Fe.memoizedState=at=n:at=at.next=n}return at}function Ua(n,e){return typeof e=="function"?e(n):e}function zh(n){var e=yn(),t=e.queue;if(t===null)throw Error($(311));t.lastRenderedReducer=n;var r=tt,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,c=i;do{var d=c.lane;if((qs&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=f,o=r):u=u.next=f,Fe.lanes|=d,Ks|=d}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=a,Rn(r,e.memoizedState)||(Gt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,Fe.lanes|=i,Ks|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function qh(n){var e=yn(),t=e.queue;if(t===null)throw Error($(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);Rn(i,e.memoizedState)||(Gt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function Rw(){}function Pw(n,e){var t=Fe,r=yn(),s=e(),i=!Rn(r.memoizedState,s);if(i&&(r.memoizedState=s,Gt=!0),r=r.queue,fp(kw.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||at!==null&&at.memoizedState.tag&1){if(t.flags|=2048,$a(9,bw.bind(null,t,r,s,e),void 0,null),ut===null)throw Error($(349));qs&30||Cw(t,e,s)}return s}function Cw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function bw(n,e,t,r){e.value=t,e.getSnapshot=r,Nw(e)&&Vw(n)}function kw(n,e,t){return t(function(){Nw(e)&&Vw(n)})}function Nw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Rn(n,t)}catch{return!0}}function Vw(n){var e=ir(n,1);e!==null&&An(e,n,1,-1)}function fy(n){var e=kn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:n},e.queue=n,n=n.dispatch=US.bind(null,Fe,n),[e.memoizedState,n]}function $a(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function Dw(){return yn().memoizedState}function wu(n,e,t,r){var s=kn();Fe.flags|=n,s.memoizedState=$a(1|e,t,void 0,r===void 0?null:r)}function bc(n,e,t,r){var s=yn();r=r===void 0?null:r;var i=void 0;if(tt!==null){var o=tt.memoizedState;if(i=o.destroy,r!==null&&cp(r,o.deps)){s.memoizedState=$a(e,t,i,r);return}}Fe.flags|=n,s.memoizedState=$a(1|e,t,i,r)}function py(n,e){return wu(8390656,8,n,e)}function fp(n,e){return bc(2048,8,n,e)}function Ow(n,e){return bc(4,2,n,e)}function Lw(n,e){return bc(4,4,n,e)}function Mw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Fw(n,e,t){return t=t!=null?t.concat([n]):null,bc(4,4,Mw.bind(null,e,n),t)}function pp(){}function jw(n,e){var t=yn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&cp(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function Bw(n,e){var t=yn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&cp(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Uw(n,e,t){return qs&21?(Rn(t,e)||(t=Gv(),Fe.lanes|=t,Ks|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Gt=!0),n.memoizedState=t)}function jS(n,e){var t=Te;Te=t!==0&&4>t?t:4,n(!0);var r=$h.transition;$h.transition={};try{n(!1),e()}finally{Te=t,$h.transition=r}}function $w(){return yn().memoizedState}function BS(n,e,t){var r=Ur(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},zw(n))qw(e,t);else if(t=xw(n,e,t,r),t!==null){var s=Mt();An(t,n,r,s),Kw(t,e,r)}}function US(n,e,t){var r=Ur(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(zw(n))qw(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,Rn(a,o)){var u=e.interleaved;u===null?(s.next=s,ip(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}t=xw(n,e,s,r),t!==null&&(s=Mt(),An(t,n,r,s),Kw(t,e,r))}}function zw(n){var e=n.alternate;return n===Fe||e!==null&&e===Fe}function qw(n,e){ya=Xu=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Kw(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Kf(n,t)}}var Ju={readContext:gn,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useInsertionEffect:vt,useLayoutEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useMutableSource:vt,useSyncExternalStore:vt,useId:vt,unstable_isNewReconciler:!1},$S={readContext:gn,useCallback:function(n,e){return kn().memoizedState=[n,e===void 0?null:e],n},useContext:gn,useEffect:py,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,wu(4194308,4,Mw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return wu(4194308,4,n,e)},useInsertionEffect:function(n,e){return wu(4,2,n,e)},useMemo:function(n,e){var t=kn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=kn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=BS.bind(null,Fe,n),[r.memoizedState,n]},useRef:function(n){var e=kn();return n={current:n},e.memoizedState=n},useState:fy,useDebugValue:pp,useDeferredValue:function(n){return kn().memoizedState=n},useTransition:function(){var n=fy(!1),e=n[0];return n=jS.bind(null,n[1]),kn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Fe,s=kn();if(Ve){if(t===void 0)throw Error($(407));t=t()}else{if(t=e(),ut===null)throw Error($(349));qs&30||Cw(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,py(kw.bind(null,r,i,n),[n]),r.flags|=2048,$a(9,bw.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=kn(),e=ut.identifierPrefix;if(Ve){var t=Zn,r=Jn;t=(r&~(1<<32-Sn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ba++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=FS++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},zS={readContext:gn,useCallback:jw,useContext:gn,useEffect:fp,useImperativeHandle:Fw,useInsertionEffect:Ow,useLayoutEffect:Lw,useMemo:Bw,useReducer:zh,useRef:Dw,useState:function(){return zh(Ua)},useDebugValue:pp,useDeferredValue:function(n){var e=yn();return Uw(e,tt.memoizedState,n)},useTransition:function(){var n=zh(Ua)[0],e=yn().memoizedState;return[n,e]},useMutableSource:Rw,useSyncExternalStore:Pw,useId:$w,unstable_isNewReconciler:!1},qS={readContext:gn,useCallback:jw,useContext:gn,useEffect:fp,useImperativeHandle:Fw,useInsertionEffect:Ow,useLayoutEffect:Lw,useMemo:Bw,useReducer:qh,useRef:Dw,useState:function(){return qh(Ua)},useDebugValue:pp,useDeferredValue:function(n){var e=yn();return tt===null?e.memoizedState=n:Uw(e,tt.memoizedState,n)},useTransition:function(){var n=qh(Ua)[0],e=yn().memoizedState;return[n,e]},useMutableSource:Rw,useSyncExternalStore:Pw,useId:$w,unstable_isNewReconciler:!1};function In(n,e){if(n&&n.defaultProps){e=Be({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Md(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Be({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var kc={isMounted:function(n){return(n=n._reactInternals)?ii(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Mt(),s=Ur(n),i=tr(r,s);i.payload=e,t!=null&&(i.callback=t),e=jr(n,i,s),e!==null&&(An(e,n,s,r),_u(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Mt(),s=Ur(n),i=tr(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=jr(n,i,s),e!==null&&(An(e,n,s,r),_u(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Mt(),r=Ur(n),s=tr(t,r);s.tag=2,e!=null&&(s.callback=e),e=jr(n,s,r),e!==null&&(An(e,n,r,t),_u(e,n,r))}};function my(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Da(t,r)||!Da(s,i):!0}function Gw(n,e,t){var r=!1,s=Gr,i=e.contextType;return typeof i=="object"&&i!==null?i=gn(i):(s=Xt(e)?$s:xt.current,r=e.contextTypes,i=(r=r!=null)?Zi(n,s):Gr),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kc,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function gy(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&kc.enqueueReplaceState(e,e.state,null)}function Fd(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},op(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=gn(i):(i=Xt(e)?$s:xt.current,s.context=Zi(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Md(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&kc.enqueueReplaceState(s,s.state,null),Hu(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function ro(n,e){try{var t="",r=e;do t+=_x(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function Kh(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function jd(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var KS=typeof WeakMap=="function"?WeakMap:Map;function Ww(n,e,t){t=tr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){ec||(ec=!0,Hd=r),jd(n,e)},t}function Qw(n,e,t){t=tr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){jd(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){jd(n,e),typeof r!="function"&&(Br===null?Br=new Set([this]):Br.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function yy(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new KS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=iA.bind(null,n,e,t),e.then(n,n))}function _y(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function vy(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=tr(-1,1),e.tag=2,jr(t,e,1))),t.lanes|=1),n)}var GS=hr.ReactCurrentOwner,Gt=!1;function Dt(n,e,t,r){e.child=n===null?Tw(e,null,t,r):to(e,n.child,t,r)}function wy(n,e,t,r,s){t=t.render;var i=e.ref;return Qi(e,s),r=hp(n,e,t,r,i,s),t=dp(),n!==null&&!Gt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,or(n,e,s)):(Ve&&t&&Zf(e),e.flags|=1,Dt(n,e,r,s),e.child)}function Ey(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!Ip(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,Hw(n,e,i,r,s)):(n=xu(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Da,t(o,r)&&n.ref===e.ref)return or(n,e,s)}return e.flags|=1,n=$r(i,r),n.ref=e.ref,n.return=e,e.child=n}function Hw(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(Da(i,r)&&n.ref===e.ref)if(Gt=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(Gt=!0);else return e.lanes=n.lanes,or(n,e,s)}return Bd(n,e,t,r,s)}function Yw(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(zi,tn),tn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ae(zi,tn),tn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Ae(zi,tn),tn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Ae(zi,tn),tn|=r;return Dt(n,e,s,t),e.child}function Xw(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Bd(n,e,t,r,s){var i=Xt(t)?$s:xt.current;return i=Zi(e,i),Qi(e,s),t=hp(n,e,t,r,i,s),r=dp(),n!==null&&!Gt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,or(n,e,s)):(Ve&&r&&Zf(e),e.flags|=1,Dt(n,e,t,s),e.child)}function Iy(n,e,t,r,s){if(Xt(t)){var i=!0;qu(e)}else i=!1;if(Qi(e,s),e.stateNode===null)Eu(n,e),Gw(e,t,r),Fd(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=gn(c):(c=Xt(t)?$s:xt.current,c=Zi(e,c));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==c)&&gy(e,o,r,c),Ar=!1;var m=e.memoizedState;o.state=m,Hu(e,r,o,s),u=e.memoizedState,a!==r||m!==u||Yt.current||Ar?(typeof d=="function"&&(Md(e,t,d,r),u=e.memoizedState),(a=Ar||my(e,t,a,r,m,u,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Sw(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:In(e.type,a),o.props=c,f=e.pendingProps,m=o.context,u=t.contextType,typeof u=="object"&&u!==null?u=gn(u):(u=Xt(t)?$s:xt.current,u=Zi(e,u));var _=t.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==u)&&gy(e,o,r,u),Ar=!1,m=e.memoizedState,o.state=m,Hu(e,r,o,s);var A=e.memoizedState;a!==f||m!==A||Yt.current||Ar?(typeof _=="function"&&(Md(e,t,_,r),A=e.memoizedState),(c=Ar||my(e,t,c,r,m,A,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return Ud(n,e,t,r,i,s)}function Ud(n,e,t,r,s,i){Xw(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ay(e,t,!1),or(n,e,i);r=e.stateNode,GS.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=to(e,n.child,null,i),e.child=to(e,null,a,i)):Dt(n,e,a,i),e.memoizedState=r.state,s&&ay(e,t,!0),e.child}function Jw(n){var e=n.stateNode;e.pendingContext?oy(n,e.pendingContext,e.pendingContext!==e.context):e.context&&oy(n,e.context,!1),ap(n,e.containerInfo)}function Ty(n,e,t,r,s){return eo(),tp(s),e.flags|=256,Dt(n,e,t,r),e.child}var $d={dehydrated:null,treeContext:null,retryLane:0};function zd(n){return{baseLanes:n,cachePool:null,transitions:null}}function Zw(n,e,t){var r=e.pendingProps,s=Me.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Ae(Me,s&1),n===null)return Od(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Dc(o,r,0,null),n=Fs(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=zd(t),e.memoizedState=$d,n):mp(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return WS(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=$r(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=$r(a,i):(i=Fs(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?zd(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=$d,r}return i=n.child,n=i.sibling,r=$r(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function mp(n,e){return e=Dc({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function tu(n,e,t,r){return r!==null&&tp(r),to(e,n.child,null,t),n=mp(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function WS(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=Kh(Error($(422))),tu(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Dc({mode:"visible",children:r.children},s,0,null),i=Fs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&to(e,n.child,null,o),e.child.memoizedState=zd(o),e.memoizedState=$d,i);if(!(e.mode&1))return tu(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error($(419)),r=Kh(i,r,void 0),tu(n,e,o,r)}if(a=(o&n.childLanes)!==0,Gt||a){if(r=ut,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ir(n,s),An(r,n,s,-1))}return Ep(),r=Kh(Error($(421))),tu(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=oA.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,nn=Fr(s.nextSibling),rn=e,Ve=!0,xn=null,n!==null&&(cn[hn++]=Jn,cn[hn++]=Zn,cn[hn++]=zs,Jn=n.id,Zn=n.overflow,zs=e),e=mp(e,r.children),e.flags|=4096,e)}function xy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Ld(n.return,e,t)}function Gh(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function e0(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Dt(n,e,r.children,t),r=Me.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&xy(n,t,e);else if(n.tag===19)xy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Ae(Me,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Yu(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Gh(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Yu(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Gh(e,!0,t,null,i);break;case"together":Gh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Eu(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function or(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ks|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error($(153));if(e.child!==null){for(n=e.child,t=$r(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=$r(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function QS(n,e,t){switch(e.tag){case 3:Jw(e),eo();break;case 5:Aw(e);break;case 1:Xt(e.type)&&qu(e);break;case 4:ap(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ae(Wu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ae(Me,Me.current&1),e.flags|=128,null):t&e.child.childLanes?Zw(n,e,t):(Ae(Me,Me.current&1),n=or(n,e,t),n!==null?n.sibling:null);Ae(Me,Me.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return e0(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ae(Me,Me.current),r)break;return null;case 22:case 23:return e.lanes=0,Yw(n,e,t)}return or(n,e,t)}var t0,qd,n0,r0;t0=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};qd=function(){};n0=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,Ds(Mn.current);var i=null;switch(t){case"input":s=dd(n,s),r=dd(n,r),i=[];break;case"select":s=Be({},s,{value:void 0}),r=Be({},r,{value:void 0}),i=[];break;case"textarea":s=md(n,s),r=md(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=$u)}yd(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ra.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(t||(t={}),t[o]=u[o])}else t||(i||(i=[]),i.push(c,t)),t=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ra.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ce("scroll",n),i||a===u||(i=[])):(i=i||[]).push(c,u))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};r0=function(n,e,t,r){t!==r&&(e.flags|=4)};function Xo(n,e){if(!Ve)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function wt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function HS(n,e,t){var r=e.pendingProps;switch(ep(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(e),null;case 1:return Xt(e.type)&&zu(),wt(e),null;case 3:return r=e.stateNode,no(),ke(Yt),ke(xt),up(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Zl(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xn!==null&&(Jd(xn),xn=null))),qd(n,e),wt(e),null;case 5:lp(e);var s=Ds(ja.current);if(t=e.type,n!==null&&e.stateNode!=null)n0(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return wt(e),null}if(n=Ds(Mn.current),Zl(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Nn]=e,r[Ma]=i,n=(e.mode&1)!==0,t){case"dialog":Ce("cancel",r),Ce("close",r);break;case"iframe":case"object":case"embed":Ce("load",r);break;case"video":case"audio":for(s=0;s<aa.length;s++)Ce(aa[s],r);break;case"source":Ce("error",r);break;case"img":case"image":case"link":Ce("error",r),Ce("load",r);break;case"details":Ce("toggle",r);break;case"input":Vg(r,i),Ce("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ce("invalid",r);break;case"textarea":Og(r,i),Ce("invalid",r)}yd(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Jl(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Jl(r.textContent,a,n),s=["children",""+a]):Ra.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ce("scroll",r)}switch(t){case"input":ql(r),Dg(r,i,!0);break;case"textarea":ql(r),Lg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=$u)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=kv(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Nn]=e,n[Ma]=r,t0(n,e,!1,!1),e.stateNode=n;e:{switch(o=_d(t,r),t){case"dialog":Ce("cancel",n),Ce("close",n),s=r;break;case"iframe":case"object":case"embed":Ce("load",n),s=r;break;case"video":case"audio":for(s=0;s<aa.length;s++)Ce(aa[s],n);s=r;break;case"source":Ce("error",n),s=r;break;case"img":case"image":case"link":Ce("error",n),Ce("load",n),s=r;break;case"details":Ce("toggle",n),s=r;break;case"input":Vg(n,r),s=dd(n,r),Ce("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Be({},r,{value:void 0}),Ce("invalid",n);break;case"textarea":Og(n,r),s=md(n,r),Ce("invalid",n);break;default:s=r}yd(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?Dv(n,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Nv(n,u)):i==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&Pa(n,u):typeof u=="number"&&Pa(n,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ra.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ce("scroll",n):u!=null&&jf(n,i,u,o))}switch(t){case"input":ql(n),Dg(n,r,!1);break;case"textarea":ql(n),Lg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Kr(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?qi(n,!!r.multiple,i,!1):r.defaultValue!=null&&qi(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=$u)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wt(e),null;case 6:if(n&&e.stateNode!=null)r0(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(t=Ds(ja.current),Ds(Mn.current),Zl(e)){if(r=e.stateNode,t=e.memoizedProps,r[Nn]=e,(i=r.nodeValue!==t)&&(n=rn,n!==null))switch(n.tag){case 3:Jl(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Jl(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Nn]=e,e.stateNode=r}return wt(e),null;case 13:if(ke(Me),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ve&&nn!==null&&e.mode&1&&!(e.flags&128))Ew(),eo(),e.flags|=98560,i=!1;else if(i=Zl(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[Nn]=e}else eo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wt(e),i=!1}else xn!==null&&(Jd(xn),xn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Me.current&1?nt===0&&(nt=3):Ep())),e.updateQueue!==null&&(e.flags|=4),wt(e),null);case 4:return no(),qd(n,e),n===null&&Oa(e.stateNode.containerInfo),wt(e),null;case 10:return sp(e.type._context),wt(e),null;case 17:return Xt(e.type)&&zu(),wt(e),null;case 19:if(ke(Me),i=e.memoizedState,i===null)return wt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Xo(i,!1);else{if(nt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Yu(n),o!==null){for(e.flags|=128,Xo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ae(Me,Me.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ge()>so&&(e.flags|=128,r=!0,Xo(i,!1),e.lanes=4194304)}else{if(!r)if(n=Yu(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Xo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ve)return wt(e),null}else 2*Ge()-i.renderingStartTime>so&&t!==1073741824&&(e.flags|=128,r=!0,Xo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ge(),e.sibling=null,t=Me.current,Ae(Me,r?t&1|2:t&1),e):(wt(e),null);case 22:case 23:return wp(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?tn&1073741824&&(wt(e),e.subtreeFlags&6&&(e.flags|=8192)):wt(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function YS(n,e){switch(ep(e),e.tag){case 1:return Xt(e.type)&&zu(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return no(),ke(Yt),ke(xt),up(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return lp(e),null;case 13:if(ke(Me),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error($(340));eo()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return ke(Me),null;case 4:return no(),null;case 10:return sp(e.type._context),null;case 22:case 23:return wp(),null;case 24:return null;default:return null}}var nu=!1,It=!1,XS=typeof WeakSet=="function"?WeakSet:Set,J=null;function $i(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){qe(n,e,r)}else t.current=null}function Kd(n,e,t){try{t()}catch(r){qe(n,e,r)}}var Sy=!1;function JS(n,e){if(Pd=ju,n=lw(),Jf(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,u=-1,c=0,d=0,f=n,m=null;t:for(;;){for(var _;f!==t||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===n)break t;if(m===t&&++c===s&&(a=o),m===i&&++d===r&&(u=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}t=a===-1||u===-1?null:{start:a,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(Cd={focusedElem:n,selectionRange:t},ju=!1,J=e;J!==null;)if(e=J,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,J=n;else for(;J!==null;){e=J;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var C=A.memoizedProps,V=A.memoizedState,I=e.stateNode,v=I.getSnapshotBeforeUpdate(e.elementType===e.type?C:In(e.type,C),V);I.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(D){qe(e,e.return,D)}if(n=e.sibling,n!==null){n.return=e.return,J=n;break}J=e.return}return A=Sy,Sy=!1,A}function _a(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&Kd(e,t,i)}s=s.next}while(s!==r)}}function Nc(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Gd(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function s0(n){var e=n.alternate;e!==null&&(n.alternate=null,s0(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Nn],delete e[Ma],delete e[Nd],delete e[DS],delete e[OS])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function i0(n){return n.tag===5||n.tag===3||n.tag===4}function Ay(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||i0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Wd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=$u));else if(r!==4&&(n=n.child,n!==null))for(Wd(n,e,t),n=n.sibling;n!==null;)Wd(n,e,t),n=n.sibling}function Qd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Qd(n,e,t),n=n.sibling;n!==null;)Qd(n,e,t),n=n.sibling}var ht=null,Tn=!1;function wr(n,e,t){for(t=t.child;t!==null;)o0(n,e,t),t=t.sibling}function o0(n,e,t){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(xc,t)}catch{}switch(t.tag){case 5:It||$i(t,e);case 6:var r=ht,s=Tn;ht=null,wr(n,e,t),ht=r,Tn=s,ht!==null&&(Tn?(n=ht,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ht.removeChild(t.stateNode));break;case 18:ht!==null&&(Tn?(n=ht,t=t.stateNode,n.nodeType===8?jh(n.parentNode,t):n.nodeType===1&&jh(n,t),Na(n)):jh(ht,t.stateNode));break;case 4:r=ht,s=Tn,ht=t.stateNode.containerInfo,Tn=!0,wr(n,e,t),ht=r,Tn=s;break;case 0:case 11:case 14:case 15:if(!It&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Kd(t,e,o),s=s.next}while(s!==r)}wr(n,e,t);break;case 1:if(!It&&($i(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){qe(t,e,a)}wr(n,e,t);break;case 21:wr(n,e,t);break;case 22:t.mode&1?(It=(r=It)||t.memoizedState!==null,wr(n,e,t),It=r):wr(n,e,t);break;default:wr(n,e,t)}}function Ry(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new XS),e.forEach(function(r){var s=aA.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function En(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ht=a.stateNode,Tn=!1;break e;case 3:ht=a.stateNode.containerInfo,Tn=!0;break e;case 4:ht=a.stateNode.containerInfo,Tn=!0;break e}a=a.return}if(ht===null)throw Error($(160));o0(i,o,s),ht=null,Tn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){qe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)a0(e,n),e=e.sibling}function a0(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(En(e,n),bn(n),r&4){try{_a(3,n,n.return),Nc(3,n)}catch(C){qe(n,n.return,C)}try{_a(5,n,n.return)}catch(C){qe(n,n.return,C)}}break;case 1:En(e,n),bn(n),r&512&&t!==null&&$i(t,t.return);break;case 5:if(En(e,n),bn(n),r&512&&t!==null&&$i(t,t.return),n.flags&32){var s=n.stateNode;try{Pa(s,"")}catch(C){qe(n,n.return,C)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Cv(s,i),_d(a,o);var c=_d(a,i);for(o=0;o<u.length;o+=2){var d=u[o],f=u[o+1];d==="style"?Dv(s,f):d==="dangerouslySetInnerHTML"?Nv(s,f):d==="children"?Pa(s,f):jf(s,d,f,c)}switch(a){case"input":fd(s,i);break;case"textarea":bv(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?qi(s,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?qi(s,!!i.multiple,i.defaultValue,!0):qi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ma]=i}catch(C){qe(n,n.return,C)}}break;case 6:if(En(e,n),bn(n),r&4){if(n.stateNode===null)throw Error($(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(C){qe(n,n.return,C)}}break;case 3:if(En(e,n),bn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Na(e.containerInfo)}catch(C){qe(n,n.return,C)}break;case 4:En(e,n),bn(n);break;case 13:En(e,n),bn(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(_p=Ge())),r&4&&Ry(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(It=(c=It)||d,En(e,n),It=c):En(e,n),bn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!d&&n.mode&1)for(J=n,d=n.child;d!==null;){for(f=J=d;J!==null;){switch(m=J,_=m.child,m.tag){case 0:case 11:case 14:case 15:_a(4,m,m.return);break;case 1:$i(m,m.return);var A=m.stateNode;if(typeof A.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(C){qe(r,t,C)}}break;case 5:$i(m,m.return);break;case 22:if(m.memoizedState!==null){Cy(f);continue}}_!==null?(_.return=m,J=_):Cy(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Vv("display",o))}catch(C){qe(n,n.return,C)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(C){qe(n,n.return,C)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:En(e,n),bn(n),r&4&&Ry(n);break;case 21:break;default:En(e,n),bn(n)}}function bn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(i0(t)){var r=t;break e}t=t.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Pa(s,""),r.flags&=-33);var i=Ay(n);Qd(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Ay(n);Wd(n,a,o);break;default:throw Error($(161))}}catch(u){qe(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function ZS(n,e,t){J=n,l0(n)}function l0(n,e,t){for(var r=(n.mode&1)!==0;J!==null;){var s=J,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||nu;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||It;a=nu;var c=It;if(nu=o,(It=u)&&!c)for(J=s;J!==null;)o=J,u=o.child,o.tag===22&&o.memoizedState!==null?by(s):u!==null?(u.return=o,J=u):by(s);for(;i!==null;)J=i,l0(i),i=i.sibling;J=s,nu=a,It=c}Py(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,J=i):Py(n)}}function Py(n){for(;J!==null;){var e=J;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:It||Nc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!It)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:In(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&dy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}dy(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Na(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}It||e.flags&512&&Gd(e)}catch(m){qe(e,e.return,m)}}if(e===n){J=null;break}if(t=e.sibling,t!==null){t.return=e.return,J=t;break}J=e.return}}function Cy(n){for(;J!==null;){var e=J;if(e===n){J=null;break}var t=e.sibling;if(t!==null){t.return=e.return,J=t;break}J=e.return}}function by(n){for(;J!==null;){var e=J;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Nc(4,e)}catch(u){qe(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){qe(e,s,u)}}var i=e.return;try{Gd(e)}catch(u){qe(e,i,u)}break;case 5:var o=e.return;try{Gd(e)}catch(u){qe(e,o,u)}}}catch(u){qe(e,e.return,u)}if(e===n){J=null;break}var a=e.sibling;if(a!==null){a.return=e.return,J=a;break}J=e.return}}var eA=Math.ceil,Zu=hr.ReactCurrentDispatcher,gp=hr.ReactCurrentOwner,pn=hr.ReactCurrentBatchConfig,_e=0,ut=null,Je=null,pt=0,tn=0,zi=is(0),nt=0,za=null,Ks=0,Vc=0,yp=0,va=null,Kt=null,_p=0,so=1/0,Yn=null,ec=!1,Hd=null,Br=null,ru=!1,Vr=null,tc=0,wa=0,Yd=null,Iu=-1,Tu=0;function Mt(){return _e&6?Ge():Iu!==-1?Iu:Iu=Ge()}function Ur(n){return n.mode&1?_e&2&&pt!==0?pt&-pt:MS.transition!==null?(Tu===0&&(Tu=Gv()),Tu):(n=Te,n!==0||(n=window.event,n=n===void 0?16:Zv(n.type)),n):1}function An(n,e,t,r){if(50<wa)throw wa=0,Yd=null,Error($(185));ul(n,t,r),(!(_e&2)||n!==ut)&&(n===ut&&(!(_e&2)&&(Vc|=t),nt===4&&Pr(n,pt)),Jt(n,r),t===1&&_e===0&&!(e.mode&1)&&(so=Ge()+500,Cc&&os()))}function Jt(n,e){var t=n.callbackNode;Mx(n,e);var r=Fu(n,n===ut?pt:0);if(r===0)t!==null&&jg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&jg(t),e===1)n.tag===0?LS(ky.bind(null,n)):_w(ky.bind(null,n)),NS(function(){!(_e&6)&&os()}),t=null;else{switch(Wv(r)){case 1:t=qf;break;case 4:t=qv;break;case 16:t=Mu;break;case 536870912:t=Kv;break;default:t=Mu}t=g0(t,u0.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function u0(n,e){if(Iu=-1,Tu=0,_e&6)throw Error($(327));var t=n.callbackNode;if(Hi()&&n.callbackNode!==t)return null;var r=Fu(n,n===ut?pt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=nc(n,r);else{e=r;var s=_e;_e|=2;var i=h0();(ut!==n||pt!==e)&&(Yn=null,so=Ge()+500,Ms(n,e));do try{rA();break}catch(a){c0(n,a)}while(!0);rp(),Zu.current=i,_e=s,Je!==null?e=0:(ut=null,pt=0,e=nt)}if(e!==0){if(e===2&&(s=Td(n),s!==0&&(r=s,e=Xd(n,s))),e===1)throw t=za,Ms(n,0),Pr(n,r),Jt(n,Ge()),t;if(e===6)Pr(n,r);else{if(s=n.current.alternate,!(r&30)&&!tA(s)&&(e=nc(n,r),e===2&&(i=Td(n),i!==0&&(r=i,e=Xd(n,i))),e===1))throw t=za,Ms(n,0),Pr(n,r),Jt(n,Ge()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:xs(n,Kt,Yn);break;case 3:if(Pr(n,r),(r&130023424)===r&&(e=_p+500-Ge(),10<e)){if(Fu(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Mt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=kd(xs.bind(null,n,Kt,Yn),e);break}xs(n,Kt,Yn);break;case 4:if(Pr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Sn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eA(r/1960))-r,10<r){n.timeoutHandle=kd(xs.bind(null,n,Kt,Yn),r);break}xs(n,Kt,Yn);break;case 5:xs(n,Kt,Yn);break;default:throw Error($(329))}}}return Jt(n,Ge()),n.callbackNode===t?u0.bind(null,n):null}function Xd(n,e){var t=va;return n.current.memoizedState.isDehydrated&&(Ms(n,e).flags|=256),n=nc(n,e),n!==2&&(e=Kt,Kt=t,e!==null&&Jd(e)),n}function Jd(n){Kt===null?Kt=n:Kt.push.apply(Kt,n)}function tA(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Rn(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pr(n,e){for(e&=~yp,e&=~Vc,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Sn(e),r=1<<t;n[t]=-1,e&=~r}}function ky(n){if(_e&6)throw Error($(327));Hi();var e=Fu(n,0);if(!(e&1))return Jt(n,Ge()),null;var t=nc(n,e);if(n.tag!==0&&t===2){var r=Td(n);r!==0&&(e=r,t=Xd(n,r))}if(t===1)throw t=za,Ms(n,0),Pr(n,e),Jt(n,Ge()),t;if(t===6)throw Error($(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,xs(n,Kt,Yn),Jt(n,Ge()),null}function vp(n,e){var t=_e;_e|=1;try{return n(e)}finally{_e=t,_e===0&&(so=Ge()+500,Cc&&os())}}function Gs(n){Vr!==null&&Vr.tag===0&&!(_e&6)&&Hi();var e=_e;_e|=1;var t=pn.transition,r=Te;try{if(pn.transition=null,Te=1,n)return n()}finally{Te=r,pn.transition=t,_e=e,!(_e&6)&&os()}}function wp(){tn=zi.current,ke(zi)}function Ms(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,kS(t)),Je!==null)for(t=Je.return;t!==null;){var r=t;switch(ep(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zu();break;case 3:no(),ke(Yt),ke(xt),up();break;case 5:lp(r);break;case 4:no();break;case 13:ke(Me);break;case 19:ke(Me);break;case 10:sp(r.type._context);break;case 22:case 23:wp()}t=t.return}if(ut=n,Je=n=$r(n.current,null),pt=tn=e,nt=0,za=null,yp=Vc=Ks=0,Kt=va=null,Vs!==null){for(e=0;e<Vs.length;e++)if(t=Vs[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}Vs=null}return n}function c0(n,e){do{var t=Je;try{if(rp(),vu.current=Ju,Xu){for(var r=Fe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Xu=!1}if(qs=0,at=tt=Fe=null,ya=!1,Ba=0,gp.current=null,t===null||t.return===null){nt=1,za=e,Je=null;break}e:{var i=n,o=t.return,a=t,u=e;if(e=pt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=_y(o);if(_!==null){_.flags&=-257,vy(_,o,a,i,e),_.mode&1&&yy(i,c,e),e=_,u=c;var A=e.updateQueue;if(A===null){var C=new Set;C.add(u),e.updateQueue=C}else A.add(u);break e}else{if(!(e&1)){yy(i,c,e),Ep();break e}u=Error($(426))}}else if(Ve&&a.mode&1){var V=_y(o);if(V!==null){!(V.flags&65536)&&(V.flags|=256),vy(V,o,a,i,e),tp(ro(u,a));break e}}i=u=ro(u,a),nt!==4&&(nt=2),va===null?va=[i]:va.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=Ww(i,u,e);hy(i,I);break e;case 1:a=u;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Br===null||!Br.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=Qw(i,a,e);hy(i,D);break e}}i=i.return}while(i!==null)}f0(t)}catch(F){e=F,Je===t&&t!==null&&(Je=t=t.return);continue}break}while(!0)}function h0(){var n=Zu.current;return Zu.current=Ju,n===null?Ju:n}function Ep(){(nt===0||nt===3||nt===2)&&(nt=4),ut===null||!(Ks&268435455)&&!(Vc&268435455)||Pr(ut,pt)}function nc(n,e){var t=_e;_e|=2;var r=h0();(ut!==n||pt!==e)&&(Yn=null,Ms(n,e));do try{nA();break}catch(s){c0(n,s)}while(!0);if(rp(),_e=t,Zu.current=r,Je!==null)throw Error($(261));return ut=null,pt=0,nt}function nA(){for(;Je!==null;)d0(Je)}function rA(){for(;Je!==null&&!Px();)d0(Je)}function d0(n){var e=m0(n.alternate,n,tn);n.memoizedProps=n.pendingProps,e===null?f0(n):Je=e,gp.current=null}function f0(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=YS(t,e),t!==null){t.flags&=32767,Je=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{nt=6,Je=null;return}}else if(t=HS(t,e,tn),t!==null){Je=t;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=n}while(e!==null);nt===0&&(nt=5)}function xs(n,e,t){var r=Te,s=pn.transition;try{pn.transition=null,Te=1,sA(n,e,t,r)}finally{pn.transition=s,Te=r}return null}function sA(n,e,t,r){do Hi();while(Vr!==null);if(_e&6)throw Error($(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error($(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(Fx(n,i),n===ut&&(Je=ut=null,pt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ru||(ru=!0,g0(Mu,function(){return Hi(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=pn.transition,pn.transition=null;var o=Te;Te=1;var a=_e;_e|=4,gp.current=null,JS(n,t),a0(t,n),xS(Cd),ju=!!Pd,Cd=Pd=null,n.current=t,ZS(t),Cx(),_e=a,Te=o,pn.transition=i}else n.current=t;if(ru&&(ru=!1,Vr=n,tc=s),i=n.pendingLanes,i===0&&(Br=null),Nx(t.stateNode),Jt(n,Ge()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(ec)throw ec=!1,n=Hd,Hd=null,n;return tc&1&&n.tag!==0&&Hi(),i=n.pendingLanes,i&1?n===Yd?wa++:(wa=0,Yd=n):wa=0,os(),null}function Hi(){if(Vr!==null){var n=Wv(tc),e=pn.transition,t=Te;try{if(pn.transition=null,Te=16>n?16:n,Vr===null)var r=!1;else{if(n=Vr,Vr=null,tc=0,_e&6)throw Error($(331));var s=_e;for(_e|=4,J=n.current;J!==null;){var i=J,o=i.child;if(J.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(J=c;J!==null;){var d=J;switch(d.tag){case 0:case 11:case 15:_a(8,d,i)}var f=d.child;if(f!==null)f.return=d,J=f;else for(;J!==null;){d=J;var m=d.sibling,_=d.return;if(s0(d),d===c){J=null;break}if(m!==null){m.return=_,J=m;break}J=_}}}var A=i.alternate;if(A!==null){var C=A.child;if(C!==null){A.child=null;do{var V=C.sibling;C.sibling=null,C=V}while(C!==null)}}J=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,J=o;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:_a(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,J=I;break e}J=i.return}}var v=n.current;for(J=v;J!==null;){o=J;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,J=w;else e:for(o=v;J!==null;){if(a=J,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Nc(9,a)}}catch(F){qe(a,a.return,F)}if(a===o){J=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,J=D;break e}J=a.return}}if(_e=s,os(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(xc,n)}catch{}r=!0}return r}finally{Te=t,pn.transition=e}}return!1}function Ny(n,e,t){e=ro(t,e),e=Ww(n,e,1),n=jr(n,e,1),e=Mt(),n!==null&&(ul(n,1,e),Jt(n,e))}function qe(n,e,t){if(n.tag===3)Ny(n,n,t);else for(;e!==null;){if(e.tag===3){Ny(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Br===null||!Br.has(r))){n=ro(t,n),n=Qw(e,n,1),e=jr(e,n,1),n=Mt(),e!==null&&(ul(e,1,n),Jt(e,n));break}}e=e.return}}function iA(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Mt(),n.pingedLanes|=n.suspendedLanes&t,ut===n&&(pt&t)===t&&(nt===4||nt===3&&(pt&130023424)===pt&&500>Ge()-_p?Ms(n,0):yp|=t),Jt(n,e)}function p0(n,e){e===0&&(n.mode&1?(e=Wl,Wl<<=1,!(Wl&130023424)&&(Wl=4194304)):e=1);var t=Mt();n=ir(n,e),n!==null&&(ul(n,e,t),Jt(n,t))}function oA(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),p0(n,t)}function aA(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),p0(n,t)}var m0;m0=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Yt.current)Gt=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Gt=!1,QS(n,e,t);Gt=!!(n.flags&131072)}else Gt=!1,Ve&&e.flags&1048576&&vw(e,Gu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Eu(n,e),n=e.pendingProps;var s=Zi(e,xt.current);Qi(e,t),s=hp(null,e,r,n,s,t);var i=dp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Xt(r)?(i=!0,qu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,op(e),s.updater=kc,e.stateNode=s,s._reactInternals=e,Fd(e,r,n,t),e=Ud(null,e,r,!0,i,t)):(e.tag=0,Ve&&i&&Zf(e),Dt(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Eu(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=uA(r),n=In(r,n),s){case 0:e=Bd(null,e,r,n,t);break e;case 1:e=Iy(null,e,r,n,t);break e;case 11:e=wy(null,e,r,n,t);break e;case 14:e=Ey(null,e,r,In(r.type,n),t);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:In(r,s),Bd(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:In(r,s),Iy(n,e,r,s,t);case 3:e:{if(Jw(e),n===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Sw(n,e),Hu(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ro(Error($(423)),e),e=Ty(n,e,r,t,s);break e}else if(r!==s){s=ro(Error($(424)),e),e=Ty(n,e,r,t,s);break e}else for(nn=Fr(e.stateNode.containerInfo.firstChild),rn=e,Ve=!0,xn=null,t=Tw(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(eo(),r===s){e=or(n,e,t);break e}Dt(n,e,r,t)}e=e.child}return e;case 5:return Aw(e),n===null&&Od(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,bd(r,s)?o=null:i!==null&&bd(r,i)&&(e.flags|=32),Xw(n,e),Dt(n,e,o,t),e.child;case 6:return n===null&&Od(e),null;case 13:return Zw(n,e,t);case 4:return ap(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=to(e,null,r,t):Dt(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:In(r,s),wy(n,e,r,s,t);case 7:return Dt(n,e,e.pendingProps,t),e.child;case 8:return Dt(n,e,e.pendingProps.children,t),e.child;case 12:return Dt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ae(Wu,r._currentValue),r._currentValue=o,i!==null)if(Rn(i.value,o)){if(i.children===s.children&&!Yt.current){e=or(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=tr(-1,t&-t),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=t,u=i.alternate,u!==null&&(u.lanes|=t),Ld(i.return,t,e),a.lanes|=t;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Ld(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Dt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Qi(e,t),s=gn(s),r=r(s),e.flags|=1,Dt(n,e,r,t),e.child;case 14:return r=e.type,s=In(r,e.pendingProps),s=In(r.type,s),Ey(n,e,r,s,t);case 15:return Hw(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:In(r,s),Eu(n,e),e.tag=1,Xt(r)?(n=!0,qu(e)):n=!1,Qi(e,t),Gw(e,r,s),Fd(e,r,s,t),Ud(null,e,r,!0,n,t);case 19:return e0(n,e,t);case 22:return Yw(n,e,t)}throw Error($(156,e.tag))};function g0(n,e){return zv(n,e)}function lA(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(n,e,t,r){return new lA(n,e,t,r)}function Ip(n){return n=n.prototype,!(!n||!n.isReactComponent)}function uA(n){if(typeof n=="function")return Ip(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Uf)return 11;if(n===$f)return 14}return 2}function $r(n,e){var t=n.alternate;return t===null?(t=dn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function xu(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")Ip(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Vi:return Fs(t.children,s,i,e);case Bf:o=8,s|=8;break;case ld:return n=dn(12,t,e,s|2),n.elementType=ld,n.lanes=i,n;case ud:return n=dn(13,t,e,s),n.elementType=ud,n.lanes=i,n;case cd:return n=dn(19,t,e,s),n.elementType=cd,n.lanes=i,n;case Av:return Dc(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case xv:o=10;break e;case Sv:o=9;break e;case Uf:o=11;break e;case $f:o=14;break e;case Sr:o=16,r=null;break e}throw Error($(130,n==null?n:typeof n,""))}return e=dn(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function Fs(n,e,t,r){return n=dn(7,n,r,e),n.lanes=t,n}function Dc(n,e,t,r){return n=dn(22,n,r,e),n.elementType=Av,n.lanes=t,n.stateNode={isHidden:!1},n}function Wh(n,e,t){return n=dn(6,n,null,e),n.lanes=t,n}function Qh(n,e,t){return e=dn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function cA(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ph(0),this.expirationTimes=Ph(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ph(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Tp(n,e,t,r,s,i,o,a,u){return n=new cA(n,e,t,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=dn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},op(i),n}function hA(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ni,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function y0(n){if(!n)return Gr;n=n._reactInternals;e:{if(ii(n)!==n||n.tag!==1)throw Error($(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Xt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(n.tag===1){var t=n.type;if(Xt(t))return yw(n,t,e)}return e}function _0(n,e,t,r,s,i,o,a,u){return n=Tp(t,r,!0,n,s,i,o,a,u),n.context=y0(null),t=n.current,r=Mt(),s=Ur(t),i=tr(r,s),i.callback=e??null,jr(t,i,s),n.current.lanes=s,ul(n,s,r),Jt(n,r),n}function Oc(n,e,t,r){var s=e.current,i=Mt(),o=Ur(s);return t=y0(t),e.context===null?e.context=t:e.pendingContext=t,e=tr(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=jr(s,e,o),n!==null&&(An(n,s,o,i),_u(n,s,o)),o}function rc(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Vy(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function xp(n,e){Vy(n,e),(n=n.alternate)&&Vy(n,e)}function dA(){return null}var v0=typeof reportError=="function"?reportError:function(n){console.error(n)};function Sp(n){this._internalRoot=n}Lc.prototype.render=Sp.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error($(409));Oc(n,e,null,null)};Lc.prototype.unmount=Sp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Gs(function(){Oc(null,n,null,null)}),e[sr]=null}};function Lc(n){this._internalRoot=n}Lc.prototype.unstable_scheduleHydration=function(n){if(n){var e=Yv();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Rr.length&&e!==0&&e<Rr[t].priority;t++);Rr.splice(t,0,n),t===0&&Jv(n)}};function Ap(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Mc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Dy(){}function fA(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=rc(o);i.call(c)}}var o=_0(e,r,n,0,null,!1,!1,"",Dy);return n._reactRootContainer=o,n[sr]=o.current,Oa(n.nodeType===8?n.parentNode:n),Gs(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=rc(u);a.call(c)}}var u=Tp(n,0,!1,null,null,!1,!1,"",Dy);return n._reactRootContainer=u,n[sr]=u.current,Oa(n.nodeType===8?n.parentNode:n),Gs(function(){Oc(e,u,t,r)}),u}function Fc(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=rc(o);a.call(u)}}Oc(e,o,n,s)}else o=fA(t,e,n,s,r);return rc(o)}Qv=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=oa(e.pendingLanes);t!==0&&(Kf(e,t|1),Jt(e,Ge()),!(_e&6)&&(so=Ge()+500,os()))}break;case 13:Gs(function(){var r=ir(n,1);if(r!==null){var s=Mt();An(r,n,1,s)}}),xp(n,1)}};Gf=function(n){if(n.tag===13){var e=ir(n,134217728);if(e!==null){var t=Mt();An(e,n,134217728,t)}xp(n,134217728)}};Hv=function(n){if(n.tag===13){var e=Ur(n),t=ir(n,e);if(t!==null){var r=Mt();An(t,n,e,r)}xp(n,e)}};Yv=function(){return Te};Xv=function(n,e){var t=Te;try{return Te=n,e()}finally{Te=t}};wd=function(n,e,t){switch(e){case"input":if(fd(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=Pc(r);if(!s)throw Error($(90));Pv(r),fd(r,s)}}}break;case"textarea":bv(n,t);break;case"select":e=t.value,e!=null&&qi(n,!!t.multiple,e,!1)}};Mv=vp;Fv=Gs;var pA={usingClientEntryPoint:!1,Events:[hl,Mi,Pc,Ov,Lv,vp]},Jo={findFiberByHostInstance:Ns,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mA={bundleType:Jo.bundleType,version:Jo.version,rendererPackageName:Jo.rendererPackageName,rendererConfig:Jo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Uv(n),n===null?null:n.stateNode},findFiberByHostInstance:Jo.findFiberByHostInstance||dA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{xc=su.inject(mA),Ln=su}catch{}}ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pA;ln.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ap(e))throw Error($(200));return hA(n,e,null,t)};ln.createRoot=function(n,e){if(!Ap(n))throw Error($(299));var t=!1,r="",s=v0;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Tp(n,1,!1,null,null,t,!1,r,s),n[sr]=e.current,Oa(n.nodeType===8?n.parentNode:n),new Sp(e)};ln.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error($(188)):(n=Object.keys(n).join(","),Error($(268,n)));return n=Uv(e),n=n===null?null:n.stateNode,n};ln.flushSync=function(n){return Gs(n)};ln.hydrate=function(n,e,t){if(!Mc(e))throw Error($(200));return Fc(null,n,e,!0,t)};ln.hydrateRoot=function(n,e,t){if(!Ap(n))throw Error($(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=v0;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=_0(e,null,n,1,t??null,s,!1,i,o),n[sr]=e.current,Oa(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Lc(e)};ln.render=function(n,e,t){if(!Mc(e))throw Error($(200));return Fc(null,n,e,!1,t)};ln.unmountComponentAtNode=function(n){if(!Mc(n))throw Error($(40));return n._reactRootContainer?(Gs(function(){Fc(null,null,n,!1,function(){n._reactRootContainer=null,n[sr]=null})}),!0):!1};ln.unstable_batchedUpdates=vp;ln.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Mc(t))throw Error($(200));if(n==null||n._reactInternals===void 0)throw Error($(38));return Fc(n,e,t,!1,r)};ln.version="18.3.1-next-f1338f8080-20240426";function w0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(w0)}catch(n){console.error(n)}}w0(),wv.exports=ln;var gA=wv.exports,Oy=gA;od.createRoot=Oy.createRoot,od.hydrateRoot=Oy.hydrateRoot;var Q=(n=>(n.WHITE="WHITE",n.BLACK="BLACK",n))(Q||{}),ae=(n=>(n.WAITING="WAITING",n.ACTIVE="ACTIVE",n.FINISHED="FINISHED",n.DRAW="DRAW",n))(ae||{}),Ly={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},yA=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},I0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,u=s+2<n.length,c=u?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|c>>6,_=c&63;u||(_=64,o||(m=64)),r.push(t[d],t[f],t[m],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(E0(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new _A;const m=i<<2|a>>4;if(r.push(m),c!==64){const _=a<<4&240|c>>2;if(r.push(_),f!==64){const A=c<<6&192|f;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class _A extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vA=function(n){const e=E0(n);return I0.encodeByteArray(e,!0)},sc=function(n){return vA(n).replace(/\./g,"")},wA=function(n){try{return I0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ic(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!EA(t)||(n[t]=ic(n[t],e[t]));return n}function EA(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=()=>T0().__FIREBASE_DEFAULTS__,TA=()=>{if(typeof process>"u"||typeof Ly>"u")return;const n=Ly.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wA(n[1]);return e&&JSON.parse(e)},x0=()=>{try{return IA()||TA()||xA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},S0=()=>{var n;return(n=x0())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[sc(JSON.stringify(t)),sc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RA(){var n;const e=(n=x0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function PA(){return typeof window<"u"||A0()}function A0(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function R0(){return!RA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function P0(){try{return typeof indexedDB=="object"}catch{return!1}}function CA(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="FirebaseError";class oi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=bA,Object.setPrototypeOf(this,oi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jc.prototype.create)}}class jc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?kA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new oi(s,a,r)}}function kA(n,e){return n.replace(NA,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const NA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function qa(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Fy(i)&&Fy(o)){if(!qa(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Fy(n){return n!==null&&typeof n=="object"}function VA(n,e){const t=new DA(n,e);return t.subscribe.bind(t)}class DA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");OA(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Hh),s.error===void 0&&(s.error=Hh),s.complete===void 0&&(s.complete=Hh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function OA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Hh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(n){return n&&n._delegate?n._delegate:n}class Ws{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new SA;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FA(e))try{this.getOrInitializeService({instanceIdentifier:Ss})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ss){return this.instances.has(e)}getOptions(e=Ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:MA(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ss){return this.component?this.component.multipleInstances?e:Ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MA(n){return n===Ss?void 0:n}function FA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new LA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp=[];var ge;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ge||(ge={}));const b0={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},jA=ge.INFO,BA={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},UA=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=BA[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pp{constructor(e){this.name=e,this._logLevel=jA,this._logHandler=UA,this._userLogHandler=null,Rp.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?b0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}function $A(n){Rp.forEach(e=>{e.setLogLevel(n)})}function zA(n,e){for(const t of Rp){let r=null;e&&e.level&&(r=b0[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,i,...o)=>{const a=o.map(u=>{if(u==null)return null;if(typeof u=="string")return u;if(typeof u=="number"||typeof u=="boolean")return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");i>=(r??s.logLevel)&&n({level:ge[i].toLowerCase(),message:a,args:o,type:s.name})}}}const qA=(n,e)=>e.some(t=>n instanceof t);let jy,By;function KA(){return jy||(jy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GA(){return By||(By=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const k0=new WeakMap,Zd=new WeakMap,N0=new WeakMap,Yh=new WeakMap,Cp=new WeakMap;function WA(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(zr(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&k0.set(t,n)}).catch(()=>{}),Cp.set(e,n),e}function QA(n){if(Zd.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Zd.set(n,e)}let ef={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Zd.get(n);if(e==="objectStoreNames")return n.objectStoreNames||N0.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return zr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HA(n){ef=n(ef)}function YA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Xh(this),e,...t);return N0.set(r,e.sort?e.sort():[e]),zr(r)}:GA().includes(n)?function(...e){return n.apply(Xh(this),e),zr(k0.get(this))}:function(...e){return zr(n.apply(Xh(this),e))}}function XA(n){return typeof n=="function"?YA(n):(n instanceof IDBTransaction&&QA(n),qA(n,KA())?new Proxy(n,ef):n)}function zr(n){if(n instanceof IDBRequest)return WA(n);if(Yh.has(n))return Yh.get(n);const e=XA(n);return e!==n&&(Yh.set(n,e),Cp.set(e,n)),e}const Xh=n=>Cp.get(n);function JA(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=zr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(zr(o.result),u.oldVersion,u.newVersion,zr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const ZA=["get","getKey","getAll","getAllKeys","count"],e1=["put","add","delete","clear"],Jh=new Map;function Uy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Jh.get(e))return Jh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=e1.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ZA.includes(t)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&u.done]))[0]};return Jh.set(e,i),i}HA(n=>({...n,get:(e,t,r)=>Uy(e,t)||n.get(e,t,r),has:(e,t)=>!!Uy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(n1(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function n1(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ac="@firebase/app",tf="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar=new Pp("@firebase/app"),r1="@firebase/app-compat",s1="@firebase/analytics-compat",i1="@firebase/analytics",o1="@firebase/app-check-compat",a1="@firebase/app-check",l1="@firebase/auth",u1="@firebase/auth-compat",c1="@firebase/database",h1="@firebase/data-connect",d1="@firebase/database-compat",f1="@firebase/functions",p1="@firebase/functions-compat",m1="@firebase/installations",g1="@firebase/installations-compat",y1="@firebase/messaging",_1="@firebase/messaging-compat",v1="@firebase/performance",w1="@firebase/performance-compat",E1="@firebase/remote-config",I1="@firebase/remote-config-compat",T1="@firebase/storage",x1="@firebase/storage-compat",S1="@firebase/firestore",A1="@firebase/vertexai-preview",R1="@firebase/firestore-compat",P1="firebase",C1="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="[DEFAULT]",b1={[ac]:"fire-core",[r1]:"fire-core-compat",[i1]:"fire-analytics",[s1]:"fire-analytics-compat",[a1]:"fire-app-check",[o1]:"fire-app-check-compat",[l1]:"fire-auth",[u1]:"fire-auth-compat",[c1]:"fire-rtdb",[h1]:"fire-data-connect",[d1]:"fire-rtdb-compat",[f1]:"fire-fn",[p1]:"fire-fn-compat",[m1]:"fire-iid",[g1]:"fire-iid-compat",[y1]:"fire-fcm",[_1]:"fire-fcm-compat",[v1]:"fire-perf",[w1]:"fire-perf-compat",[E1]:"fire-rc",[I1]:"fire-rc-compat",[T1]:"fire-gcs",[x1]:"fire-gcs-compat",[S1]:"fire-fst",[R1]:"fire-fst-compat",[A1]:"fire-vertex","fire-js":"fire-js",[P1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new Map,io=new Map,oo=new Map;function Ka(n,e){try{n.container.addComponent(e)}catch(t){ar.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function V0(n,e){n.container.addOrOverwriteComponent(e)}function ao(n){const e=n.name;if(oo.has(e))return ar.debug(`There were multiple attempts to register component ${e}.`),!1;oo.set(e,n);for(const t of Qr.values())Ka(t,n);for(const t of io.values())Ka(t,n);return!0}function D0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function k1(n,e,t=Wr){D0(n,e).clearInstance(t)}function O0(n){return n.options!==void 0}function N1(n){return n.settings!==void 0}function V1(){oo.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},mn=new jc("app","Firebase",D1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let L0=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ws("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw mn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1 extends L0{constructor(e,t,r,s){const i=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:i};if(e.apiKey!==void 0)super(e,o,s);else{const a=e;super(a.options,o,s)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,nr(ac,tf,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Np(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw mn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=C1;function kp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Wr,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw mn.create("bad-app-name",{appName:String(s)});if(t||(t=S0()),!t)throw mn.create("no-options");const i=Qr.get(s);if(i){if(qa(t,i.options)&&qa(r,i.config))return i;throw mn.create("duplicate-app",{appName:s})}const o=new C0(s);for(const u of oo.values())o.addComponent(u);const a=new L0(t,r,o);return Qr.set(s,a),a}function L1(n,e){if(PA()&&!A0())throw mn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;O0(n)?t=n.options:t=n;const r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const s=c=>[...c].reduce((d,f)=>Math.imul(31,d)+f.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw mn.create("finalization-registry-not-supported",{});const i=""+s(JSON.stringify(r)),o=io.get(i);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new C0(i);for(const c of oo.values())a.addComponent(c);const u=new O1(t,e,i,a);return io.set(i,u),u}function M1(n=Wr){const e=Qr.get(n);if(!e&&n===Wr&&S0())return kp();if(!e)throw mn.create("no-app",{appName:n});return e}function F1(){return Array.from(Qr.values())}async function Np(n){let e=!1;const t=n.name;Qr.has(t)?(e=!0,Qr.delete(t)):io.has(t)&&n.decRefCount()<=0&&(io.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function nr(n,e,t){var r;let s=(r=b1[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ar.warn(a.join(" "));return}ao(new Ws(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function M0(n,e){if(n!==null&&typeof n!="function")throw mn.create("invalid-log-argument");zA(n,e)}function F0(n){$A(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1="firebase-heartbeat-database",B1=1,Ga="firebase-heartbeat-store";let Zh=null;function j0(){return Zh||(Zh=JA(j1,B1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ga)}catch(t){console.warn(t)}}}}).catch(n=>{throw mn.create("idb-open",{originalErrorMessage:n.message})})),Zh}async function U1(n){try{const t=(await j0()).transaction(Ga),r=await t.objectStore(Ga).get(B0(n));return await t.done,r}catch(e){if(e instanceof oi)ar.warn(e.message);else{const t=mn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ar.warn(t.message)}}}async function $y(n,e){try{const r=(await j0()).transaction(Ga,"readwrite");await r.objectStore(Ga).put(e,B0(n)),await r.done}catch(t){if(t instanceof oi)ar.warn(t.message);else{const r=mn.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ar.warn(r.message)}}}function B0(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1=1024,z1=30*24*60*60*1e3;class q1{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new G1(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=zy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=z1}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ar.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=zy(),{heartbeatsToSend:r,unsentEntries:s}=K1(this._heartbeatsCache.heartbeats),i=sc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ar.warn(t),""}}}function zy(){return new Date().toISOString().substring(0,10)}function K1(n,e=$1){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),qy(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),qy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class G1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return P0()?CA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await U1(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return $y(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return $y(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function qy(n){return sc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W1(n){ao(new Ws("platform-logger",e=>new t1(e),"PRIVATE")),ao(new Ws("heartbeat",e=>new q1(e),"PRIVATE")),nr(ac,tf,n),nr(ac,tf,"esm2017"),nr("fire-js","")}W1("");const Q1=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:oi,SDK_VERSION:bp,_DEFAULT_ENTRY_NAME:Wr,_addComponent:Ka,_addOrOverwriteComponent:V0,_apps:Qr,_clearComponents:V1,_components:oo,_getProvider:D0,_isFirebaseApp:O0,_isFirebaseServerApp:N1,_registerComponent:ao,_removeServiceInstance:k1,_serverApps:io,deleteApp:Np,getApp:M1,getApps:F1,initializeApp:kp,initializeServerApp:L1,onLog:M0,registerVersion:nr,setLogLevel:F0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e,t){this._delegate=e,this.firebase=t,Ka(e,new Ws("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Np(this._delegate)))}_getService(e,t=Wr){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=Wr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ka(this._delegate,e)}_addOrOverwriteComponent(e){V0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ky=new jc("app-compat","Firebase",Y1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(n){const e={},t={__esModule:!0,initializeApp:i,app:s,registerVersion:nr,setLogLevel:F0,onLog:M0,apps:null,SDK_VERSION:bp,INTERNAL:{registerComponent:a,removeApp:r,useAsService:u,modularAPIs:Q1}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(c){delete e[c]}function s(c){if(c=c||Wr,!My(e,c))throw Ky.create("no-app",{appName:c});return e[c]}s.App=n;function i(c,d={}){const f=kp(c,d);if(My(e,f.name))return e[f.name];const m=new n(f,t);return e[f.name]=m,m}function o(){return Object.keys(e).map(c=>e[c])}function a(c){const d=c.name,f=d.replace("-compat","");if(ao(c)&&c.type==="PUBLIC"){const m=(_=s())=>{if(typeof _[f]!="function")throw Ky.create("invalid-app-argument",{appName:d});return _[f]()};c.serviceProps!==void 0&&ic(m,c.serviceProps),t[f]=m,n.prototype[f]=function(..._){return this._getService.bind(this,d).apply(this,c.multipleInstances?_:[])}}return c.type==="PUBLIC"?t[f]:null}function u(c,d){return d==="serverAuth"?null:d}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(){const n=X1(H1);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:U0,extendNamespace:e,createSubscribe:VA,ErrorFactory:jc,deepExtend:ic});function e(t){ic(n,t)}return n}const J1=U0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new Pp("@firebase/app-compat"),Z1="@firebase/app-compat",eR="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(n){nr(Z1,eR,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=T0();if(n.firebase!==void 0){Gy.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Gy.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Qs=J1;tR();var nR="firebase",rR="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qs.registerVersion(nR,rR,"app-compat");var Wy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var js,$0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,y){function T(){}T.prototype=y.prototype,E.D=y.prototype,E.prototype=new T,E.prototype.constructor=E,E.C=function(x,P,b){for(var S=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)S[Ye-2]=arguments[Ye];return y.prototype[P].apply(x,S)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,y,T){T||(T=0);var x=Array(16);if(typeof y=="string")for(var P=0;16>P;++P)x[P]=y.charCodeAt(T++)|y.charCodeAt(T++)<<8|y.charCodeAt(T++)<<16|y.charCodeAt(T++)<<24;else for(P=0;16>P;++P)x[P]=y[T++]|y[T++]<<8|y[T++]<<16|y[T++]<<24;y=E.g[0],T=E.g[1],P=E.g[2];var b=E.g[3],S=y+(b^T&(P^b))+x[0]+3614090360&4294967295;y=T+(S<<7&4294967295|S>>>25),S=b+(P^y&(T^P))+x[1]+3905402710&4294967295,b=y+(S<<12&4294967295|S>>>20),S=P+(T^b&(y^T))+x[2]+606105819&4294967295,P=b+(S<<17&4294967295|S>>>15),S=T+(y^P&(b^y))+x[3]+3250441966&4294967295,T=P+(S<<22&4294967295|S>>>10),S=y+(b^T&(P^b))+x[4]+4118548399&4294967295,y=T+(S<<7&4294967295|S>>>25),S=b+(P^y&(T^P))+x[5]+1200080426&4294967295,b=y+(S<<12&4294967295|S>>>20),S=P+(T^b&(y^T))+x[6]+2821735955&4294967295,P=b+(S<<17&4294967295|S>>>15),S=T+(y^P&(b^y))+x[7]+4249261313&4294967295,T=P+(S<<22&4294967295|S>>>10),S=y+(b^T&(P^b))+x[8]+1770035416&4294967295,y=T+(S<<7&4294967295|S>>>25),S=b+(P^y&(T^P))+x[9]+2336552879&4294967295,b=y+(S<<12&4294967295|S>>>20),S=P+(T^b&(y^T))+x[10]+4294925233&4294967295,P=b+(S<<17&4294967295|S>>>15),S=T+(y^P&(b^y))+x[11]+2304563134&4294967295,T=P+(S<<22&4294967295|S>>>10),S=y+(b^T&(P^b))+x[12]+1804603682&4294967295,y=T+(S<<7&4294967295|S>>>25),S=b+(P^y&(T^P))+x[13]+4254626195&4294967295,b=y+(S<<12&4294967295|S>>>20),S=P+(T^b&(y^T))+x[14]+2792965006&4294967295,P=b+(S<<17&4294967295|S>>>15),S=T+(y^P&(b^y))+x[15]+1236535329&4294967295,T=P+(S<<22&4294967295|S>>>10),S=y+(P^b&(T^P))+x[1]+4129170786&4294967295,y=T+(S<<5&4294967295|S>>>27),S=b+(T^P&(y^T))+x[6]+3225465664&4294967295,b=y+(S<<9&4294967295|S>>>23),S=P+(y^T&(b^y))+x[11]+643717713&4294967295,P=b+(S<<14&4294967295|S>>>18),S=T+(b^y&(P^b))+x[0]+3921069994&4294967295,T=P+(S<<20&4294967295|S>>>12),S=y+(P^b&(T^P))+x[5]+3593408605&4294967295,y=T+(S<<5&4294967295|S>>>27),S=b+(T^P&(y^T))+x[10]+38016083&4294967295,b=y+(S<<9&4294967295|S>>>23),S=P+(y^T&(b^y))+x[15]+3634488961&4294967295,P=b+(S<<14&4294967295|S>>>18),S=T+(b^y&(P^b))+x[4]+3889429448&4294967295,T=P+(S<<20&4294967295|S>>>12),S=y+(P^b&(T^P))+x[9]+568446438&4294967295,y=T+(S<<5&4294967295|S>>>27),S=b+(T^P&(y^T))+x[14]+3275163606&4294967295,b=y+(S<<9&4294967295|S>>>23),S=P+(y^T&(b^y))+x[3]+4107603335&4294967295,P=b+(S<<14&4294967295|S>>>18),S=T+(b^y&(P^b))+x[8]+1163531501&4294967295,T=P+(S<<20&4294967295|S>>>12),S=y+(P^b&(T^P))+x[13]+2850285829&4294967295,y=T+(S<<5&4294967295|S>>>27),S=b+(T^P&(y^T))+x[2]+4243563512&4294967295,b=y+(S<<9&4294967295|S>>>23),S=P+(y^T&(b^y))+x[7]+1735328473&4294967295,P=b+(S<<14&4294967295|S>>>18),S=T+(b^y&(P^b))+x[12]+2368359562&4294967295,T=P+(S<<20&4294967295|S>>>12),S=y+(T^P^b)+x[5]+4294588738&4294967295,y=T+(S<<4&4294967295|S>>>28),S=b+(y^T^P)+x[8]+2272392833&4294967295,b=y+(S<<11&4294967295|S>>>21),S=P+(b^y^T)+x[11]+1839030562&4294967295,P=b+(S<<16&4294967295|S>>>16),S=T+(P^b^y)+x[14]+4259657740&4294967295,T=P+(S<<23&4294967295|S>>>9),S=y+(T^P^b)+x[1]+2763975236&4294967295,y=T+(S<<4&4294967295|S>>>28),S=b+(y^T^P)+x[4]+1272893353&4294967295,b=y+(S<<11&4294967295|S>>>21),S=P+(b^y^T)+x[7]+4139469664&4294967295,P=b+(S<<16&4294967295|S>>>16),S=T+(P^b^y)+x[10]+3200236656&4294967295,T=P+(S<<23&4294967295|S>>>9),S=y+(T^P^b)+x[13]+681279174&4294967295,y=T+(S<<4&4294967295|S>>>28),S=b+(y^T^P)+x[0]+3936430074&4294967295,b=y+(S<<11&4294967295|S>>>21),S=P+(b^y^T)+x[3]+3572445317&4294967295,P=b+(S<<16&4294967295|S>>>16),S=T+(P^b^y)+x[6]+76029189&4294967295,T=P+(S<<23&4294967295|S>>>9),S=y+(T^P^b)+x[9]+3654602809&4294967295,y=T+(S<<4&4294967295|S>>>28),S=b+(y^T^P)+x[12]+3873151461&4294967295,b=y+(S<<11&4294967295|S>>>21),S=P+(b^y^T)+x[15]+530742520&4294967295,P=b+(S<<16&4294967295|S>>>16),S=T+(P^b^y)+x[2]+3299628645&4294967295,T=P+(S<<23&4294967295|S>>>9),S=y+(P^(T|~b))+x[0]+4096336452&4294967295,y=T+(S<<6&4294967295|S>>>26),S=b+(T^(y|~P))+x[7]+1126891415&4294967295,b=y+(S<<10&4294967295|S>>>22),S=P+(y^(b|~T))+x[14]+2878612391&4294967295,P=b+(S<<15&4294967295|S>>>17),S=T+(b^(P|~y))+x[5]+4237533241&4294967295,T=P+(S<<21&4294967295|S>>>11),S=y+(P^(T|~b))+x[12]+1700485571&4294967295,y=T+(S<<6&4294967295|S>>>26),S=b+(T^(y|~P))+x[3]+2399980690&4294967295,b=y+(S<<10&4294967295|S>>>22),S=P+(y^(b|~T))+x[10]+4293915773&4294967295,P=b+(S<<15&4294967295|S>>>17),S=T+(b^(P|~y))+x[1]+2240044497&4294967295,T=P+(S<<21&4294967295|S>>>11),S=y+(P^(T|~b))+x[8]+1873313359&4294967295,y=T+(S<<6&4294967295|S>>>26),S=b+(T^(y|~P))+x[15]+4264355552&4294967295,b=y+(S<<10&4294967295|S>>>22),S=P+(y^(b|~T))+x[6]+2734768916&4294967295,P=b+(S<<15&4294967295|S>>>17),S=T+(b^(P|~y))+x[13]+1309151649&4294967295,T=P+(S<<21&4294967295|S>>>11),S=y+(P^(T|~b))+x[4]+4149444226&4294967295,y=T+(S<<6&4294967295|S>>>26),S=b+(T^(y|~P))+x[11]+3174756917&4294967295,b=y+(S<<10&4294967295|S>>>22),S=P+(y^(b|~T))+x[2]+718787259&4294967295,P=b+(S<<15&4294967295|S>>>17),S=T+(b^(P|~y))+x[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(P+(S<<21&4294967295|S>>>11))&4294967295,E.g[2]=E.g[2]+P&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var T=y-this.blockSize,x=this.B,P=this.h,b=0;b<y;){if(P==0)for(;b<=T;)s(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<y;)if(x[P++]=E.charCodeAt(b++),P==this.blockSize){s(this,x),P=0;break}}else for(;b<y;)if(x[P++]=E[b++],P==this.blockSize){s(this,x),P=0;break}}this.h=P,this.o+=y},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var T=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=T&255,T/=256;for(this.u(E),E=Array(16),y=T=0;4>y;++y)for(var x=0;32>x;x+=8)E[T++]=this.g[y]>>>x&255;return E};function i(E,y){var T=a;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=y(E)}function o(E,y){this.h=y;for(var T=[],x=!0,P=E.length-1;0<=P;P--){var b=E[P]|0;x&&b==y||(T[P]=b,x=!1)}this.g=T}var a={};function u(E){return-128<=E&&128>E?i(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return f;if(0>E)return V(c(-E));for(var y=[],T=1,x=0;E>=T;x++)y[x]=E/T|0,T*=4294967296;return new o(y,0)}function d(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return V(d(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(y,8)),x=f,P=0;P<E.length;P+=8){var b=Math.min(8,E.length-P),S=parseInt(E.substring(P,P+b),y);8>b?(b=c(Math.pow(y,b)),x=x.j(b).add(c(S))):(x=x.j(T),x=x.add(c(S)))}return x}var f=u(0),m=u(1),_=u(16777216);n=o.prototype,n.m=function(){if(C(this))return-V(this).m();for(var E=0,y=1,T=0;T<this.g.length;T++){var x=this.i(T);E+=(0<=x?x:4294967296+x)*y,y*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(A(this))return"0";if(C(this))return"-"+V(this).toString(E);for(var y=c(Math.pow(E,6)),T=this,x="";;){var P=D(T,y).g;T=I(T,P.j(y));var b=((0<T.g.length?T.g[0]:T.h)>>>0).toString(E);if(T=P,A(T))return b+x;for(;6>b.length;)b="0"+b;x=b+x}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function A(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function C(E){return E.h==-1}n.l=function(E){return E=I(this,E),C(E)?-1:A(E)?0:1};function V(E){for(var y=E.g.length,T=[],x=0;x<y;x++)T[x]=~E.g[x];return new o(T,~E.h).add(m)}n.abs=function(){return C(this)?V(this):this},n.add=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],x=0,P=0;P<=y;P++){var b=x+(this.i(P)&65535)+(E.i(P)&65535),S=(b>>>16)+(this.i(P)>>>16)+(E.i(P)>>>16);x=S>>>16,b&=65535,S&=65535,T[P]=S<<16|b}return new o(T,T[T.length-1]&-2147483648?-1:0)};function I(E,y){return E.add(V(y))}n.j=function(E){if(A(this)||A(E))return f;if(C(this))return C(E)?V(this).j(V(E)):V(V(this).j(E));if(C(E))return V(this.j(V(E)));if(0>this.l(_)&&0>E.l(_))return c(this.m()*E.m());for(var y=this.g.length+E.g.length,T=[],x=0;x<2*y;x++)T[x]=0;for(x=0;x<this.g.length;x++)for(var P=0;P<E.g.length;P++){var b=this.i(x)>>>16,S=this.i(x)&65535,Ye=E.i(P)>>>16,se=E.i(P)&65535;T[2*x+2*P]+=S*se,v(T,2*x+2*P),T[2*x+2*P+1]+=b*se,v(T,2*x+2*P+1),T[2*x+2*P+1]+=S*Ye,v(T,2*x+2*P+1),T[2*x+2*P+2]+=b*Ye,v(T,2*x+2*P+2)}for(x=0;x<y;x++)T[x]=T[2*x+1]<<16|T[2*x];for(x=y;x<2*y;x++)T[x]=0;return new o(T,0)};function v(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function w(E,y){this.g=E,this.h=y}function D(E,y){if(A(y))throw Error("division by zero");if(A(E))return new w(f,f);if(C(E))return y=D(V(E),y),new w(V(y.g),V(y.h));if(C(y))return y=D(E,V(y)),new w(V(y.g),y.h);if(30<E.g.length){if(C(E)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var T=m,x=y;0>=x.l(E);)T=F(T),x=F(x);var P=j(T,1),b=j(x,1);for(x=j(x,2),T=j(T,2);!A(x);){var S=b.add(x);0>=S.l(E)&&(P=P.add(T),b=S),x=j(x,1),T=j(T,1)}return y=I(E,P.j(y)),new w(P,y)}for(P=f;0<=E.l(y);){for(T=Math.max(1,Math.floor(E.m()/y.m())),x=Math.ceil(Math.log(T)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),b=c(T),S=b.j(y);C(S)||0<S.l(E);)T-=x,b=c(T),S=b.j(y);A(b)&&(b=m),P=P.add(b),E=I(E,S)}return new w(P,E)}n.A=function(E){return D(this,E).h},n.and=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],x=0;x<y;x++)T[x]=this.i(x)&E.i(x);return new o(T,this.h&E.h)},n.or=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],x=0;x<y;x++)T[x]=this.i(x)|E.i(x);return new o(T,this.h|E.h)},n.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],x=0;x<y;x++)T[x]=this.i(x)^E.i(x);return new o(T,this.h^E.h)};function F(E){for(var y=E.g.length+1,T=[],x=0;x<y;x++)T[x]=E.i(x)<<1|E.i(x-1)>>>31;return new o(T,E.h)}function j(E,y){var T=y>>5;y%=32;for(var x=E.g.length-T,P=[],b=0;b<x;b++)P[b]=0<y?E.i(b+T)>>>y|E.i(b+T+1)<<32-y:E.i(b+T);return new o(P,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,$0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,js=o}).apply(typeof Wy<"u"?Wy:typeof self<"u"?self:typeof window<"u"?window:{});var iu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var z0,la,q0,Su,nf,K0,G0,W0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof iu=="object"&&iu];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var g=0;g<l.length-1;g++){var k=l[g];if(!(k in p))break e;p=p[k]}l=l[l.length-1],g=p[l],h=h(g),h!=g&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,g=!1,k={next:function(){if(!g&&p<l.length){var L=p++;return{value:h(L,l[L]),done:!1}}return g=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,g),l.apply(h,k)}}return function(){return l.apply(h,arguments)}}function m(l,h,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function _(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var g=p.slice();return g.push.apply(g,arguments),l.apply(this,g)}}function A(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(g,k,L){for(var z=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)z[Se-2]=arguments[Se];return h.prototype[k].apply(g,z)}}function C(l){const h=l.length;if(0<h){const p=Array(h);for(let g=0;g<h;g++)p[g]=l[g];return p}return[]}function V(l,h){for(let p=1;p<arguments.length;p++){const g=arguments[p];if(u(g)){const k=l.length||0,L=g.length||0;l.length=k+L;for(let z=0;z<L;z++)l[k+z]=g[z]}else l.push(g)}}class I{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(l){return/^[\s\xa0]*$/.test(l)}function w(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function D(l){return D[" "](l),l}D[" "]=function(){};var F=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function j(l,h,p){for(const g in l)h.call(p,l[g],g,l)}function E(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function y(l){const h={};for(const p in l)h[p]=l[p];return h}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(l,h){let p,g;for(let k=1;k<arguments.length;k++){g=arguments[k];for(p in g)l[p]=g[p];for(let L=0;L<T.length;L++)p=T[L],Object.prototype.hasOwnProperty.call(g,p)&&(l[p]=g[p])}}function P(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function b(l){a.setTimeout(()=>{throw l},0)}function S(){var l=q;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class Ye{constructor(){this.h=this.g=null}add(h,p){const g=se.get();g.set(h,p),this.h?this.h.next=g:this.g=g,this.h=g}}var se=new I(()=>new te,l=>l.reset());class te{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let X,M=!1,q=new Ye,Z=()=>{const l=a.Promise.resolve(void 0);X=()=>{l.then(oe)}};var oe=()=>{for(var l;l=S();){try{l.h.call(l.g)}catch(p){b(p)}var h=se;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}M=!1};function ie(){this.s=this.s,this.C=this.C}ie.prototype.s=!1,ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var ce=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function Ue(l,h){if(ne.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,g=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(F){e:{try{D(h.nodeName);var k=!0;break e}catch{}k=!1}k||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:At[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Ue.aa.h.call(this)}}A(Ue,ne);var At={2:"touch",3:"pen",4:"mouse"};Ue.prototype.h=function(){Ue.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Rt="closure_listenable_"+(1e6*Math.random()|0),Pt=0;function Ct(l,h,p,g,k){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!g,this.ha=k,this.key=++Pt,this.da=this.fa=!1}function st(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function bt(l){this.src=l,this.g={},this.h=0}bt.prototype.add=function(l,h,p,g,k){var L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);var z=kt(l,h,g,k);return-1<z?(h=l[z],p||(h.fa=!1)):(h=new Ct(h,this.src,L,!!g,k),h.fa=p,l.push(h)),h};function _n(l,h){var p=h.type;if(p in l.g){var g=l.g[p],k=Array.prototype.indexOf.call(g,h,void 0),L;(L=0<=k)&&Array.prototype.splice.call(g,k,1),L&&(st(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function kt(l,h,p,g){for(var k=0;k<l.length;++k){var L=l[k];if(!L.da&&L.listener==h&&L.capture==!!p&&L.ha==g)return k}return-1}var ds="closure_lm_"+(1e6*Math.random()|0),mr={};function fs(l,h,p,g,k){if(Array.isArray(h)){for(var L=0;L<h.length;L++)fs(l,h[L],p,g,k);return null}return p=mi(p),l&&l[Rt]?l.K(h,p,c(g)?!!g.capture:!1,k):di(l,h,p,!1,g,k)}function di(l,h,p,g,k,L){if(!h)throw Error("Invalid event type");var z=c(k)?!!k.capture:!!k,Se=Vo(l);if(Se||(l[ds]=Se=new bt(l)),p=Se.add(h,p,g,z,L),p.proxy)return p;if(g=fi(),p.proxy=g,g.src=l,g.listener=p,l.addEventListener)ce||(k=z),k===void 0&&(k=!1),l.addEventListener(h.toString(),g,k);else if(l.attachEvent)l.attachEvent(vn(h.toString()),g);else if(l.addListener&&l.removeListener)l.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return p}function fi(){function l(p){return h.call(l.src,l.listener,p)}const h=zn;return l}function ps(l,h,p,g,k){if(Array.isArray(h))for(var L=0;L<h.length;L++)ps(l,h[L],p,g,k);else g=c(g)?!!g.capture:!!g,p=mi(p),l&&l[Rt]?(l=l.i,h=String(h).toString(),h in l.g&&(L=l.g[h],p=kt(L,p,g,k),-1<p&&(st(L[p]),Array.prototype.splice.call(L,p,1),L.length==0&&(delete l.g[h],l.h--)))):l&&(l=Vo(l))&&(h=l.g[h.toString()],l=-1,h&&(l=kt(h,p,g,k)),(p=-1<l?h[l]:null)&&zt(p))}function zt(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Rt])_n(h.i,l);else{var p=l.type,g=l.proxy;h.removeEventListener?h.removeEventListener(p,g,l.capture):h.detachEvent?h.detachEvent(vn(p),g):h.addListener&&h.removeListener&&h.removeListener(g),(p=Vo(h))?(_n(p,l),p.h==0&&(p.src=null,h[ds]=null)):st(l)}}}function vn(l){return l in mr?mr[l]:mr[l]="on"+l}function zn(l,h){if(l.da)l=!0;else{h=new Ue(h,this);var p=l.listener,g=l.ha||l.src;l.fa&&zt(l),l=p.call(g,h)}return l}function Vo(l){return l=l[ds],l instanceof bt?l:null}var pi="__closure_events_fn_"+(1e9*Math.random()>>>0);function mi(l){return typeof l=="function"?l:(l[pi]||(l[pi]=function(h){return l.handleEvent(h)}),l[pi])}function et(){ie.call(this),this.i=new bt(this),this.M=this,this.F=null}A(et,ie),et.prototype[Rt]=!0,et.prototype.removeEventListener=function(l,h,p,g){ps(this,l,h,p,g)};function it(l,h){var p,g=l.F;if(g)for(p=[];g;g=g.F)p.push(g);if(l=l.M,g=h.type||h,typeof h=="string")h=new ne(h,l);else if(h instanceof ne)h.target=h.target||l;else{var k=h;h=new ne(g,l),x(h,k)}if(k=!0,p)for(var L=p.length-1;0<=L;L--){var z=h.g=p[L];k=W(z,g,!0,h)&&k}if(z=h.g=l,k=W(z,g,!0,h)&&k,k=W(z,g,!1,h)&&k,p)for(L=0;L<p.length;L++)z=h.g=p[L],k=W(z,g,!1,h)&&k}et.prototype.N=function(){if(et.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],g=0;g<p.length;g++)st(p[g]);delete l.g[h],l.h--}}this.F=null},et.prototype.K=function(l,h,p,g){return this.i.add(String(l),h,!1,p,g)},et.prototype.L=function(l,h,p,g){return this.i.add(String(l),h,!0,p,g)};function W(l,h,p,g){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var k=!0,L=0;L<h.length;++L){var z=h[L];if(z&&!z.da&&z.capture==p){var Se=z.listener,ct=z.ha||z.src;z.fa&&_n(l.i,z),k=Se.call(ct,g)!==!1&&k}}return k&&!g.defaultPrevented}function he(l,h,p){if(typeof l=="function")p&&(l=m(l,p));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function ve(l){l.g=he(()=>{l.g=null,l.i&&(l.i=!1,ve(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class $e extends ie{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nt(l){ie.call(this),this.h=l,this.g={}}A(Nt,ie);var ms=[];function qn(l){j(l.g,function(h,p){this.g.hasOwnProperty(p)&&zt(h)},l),l.g={}}Nt.prototype.N=function(){Nt.aa.N.call(this),qn(this)},Nt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pn=a.JSON.stringify,gs=a.JSON.parse,gi=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Zt(){}Zt.prototype.h=null;function Kn(l){return l.h||(l.h=l.i())}function Cn(){}var Gn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ys(){ne.call(this,"d")}A(ys,ne);function gr(){ne.call(this,"c")}A(gr,ne);var _s={},Fm=null;function Rl(){return Fm=Fm||new et}_s.La="serverreachability";function jm(l){ne.call(this,_s.La,l)}A(jm,ne);function Do(l){const h=Rl();it(h,new jm(h))}_s.STAT_EVENT="statevent";function Bm(l,h){ne.call(this,_s.STAT_EVENT,l),this.stat=h}A(Bm,ne);function Vt(l){const h=Rl();it(h,new Bm(h,l))}_s.Ma="timingevent";function Um(l,h){ne.call(this,_s.Ma,l),this.size=h}A(Um,ne);function Oo(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Lo(){this.g=!0}Lo.prototype.xa=function(){this.g=!1};function wT(l,h,p,g,k,L){l.info(function(){if(l.g)if(L)for(var z="",Se=L.split("&"),ct=0;ct<Se.length;ct++){var we=Se[ct].split("=");if(1<we.length){var yt=we[0];we=we[1];var _t=yt.split("_");z=2<=_t.length&&_t[1]=="type"?z+(yt+"="+we+"&"):z+(yt+"=redacted&")}}else z=null;else z=L;return"XMLHTTP REQ ("+g+") [attempt "+k+"]: "+h+`
`+p+`
`+z})}function ET(l,h,p,g,k,L,z){l.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+k+"]: "+h+`
`+p+`
`+L+" "+z})}function yi(l,h,p,g){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+TT(l,p)+(g?" "+g:"")})}function IT(l,h){l.info(function(){return"TIMEOUT: "+h})}Lo.prototype.info=function(){};function TT(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var g=p[l];if(!(2>g.length)){var k=g[1];if(Array.isArray(k)&&!(1>k.length)){var L=k[0];if(L!="noop"&&L!="stop"&&L!="close")for(var z=1;z<k.length;z++)k[z]=""}}}}return Pn(p)}catch{return h}}var Pl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$m={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},hh;function Cl(){}A(Cl,Zt),Cl.prototype.g=function(){return new XMLHttpRequest},Cl.prototype.i=function(){return{}},hh=new Cl;function yr(l,h,p,g){this.j=l,this.i=h,this.l=p,this.R=g||1,this.U=new Nt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zm}function zm(){this.i=null,this.g="",this.h=!1}var qm={},dh={};function fh(l,h,p){l.L=1,l.v=Vl(Wn(h)),l.m=p,l.P=!0,Km(l,null)}function Km(l,h){l.F=Date.now(),bl(l),l.A=Wn(l.v);var p=l.A,g=l.R;Array.isArray(g)||(g=[String(g)]),ig(p.i,"t",g),l.C=0,p=l.j.J,l.h=new zm,l.g=Tg(l.j,p?h:null,!l.m),0<l.O&&(l.M=new $e(m(l.Y,l,l.g),l.O)),h=l.U,p=l.g,g=l.ca;var k="readystatechange";Array.isArray(k)||(k&&(ms[0]=k.toString()),k=ms);for(var L=0;L<k.length;L++){var z=fs(p,k[L],g||h.handleEvent,!1,h.h||h);if(!z)break;h.g[z.key]=z}h=l.H?y(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Do(),wT(l.i,l.u,l.A,l.l,l.R,l.m)}yr.prototype.ca=function(l){l=l.target;const h=this.M;h&&Qn(l)==3?h.j():this.Y(l)},yr.prototype.Y=function(l){try{if(l==this.g)e:{const _t=Qn(this.g);var h=this.g.Ba();const wi=this.g.Z();if(!(3>_t)&&(_t!=3||this.g&&(this.h.h||this.g.oa()||dg(this.g)))){this.J||_t!=4||h==7||(h==8||0>=wi?Do(3):Do(2)),ph(this);var p=this.g.Z();this.X=p;t:if(Gm(this)){var g=dg(this.g);l="";var k=g.length,L=Qn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){vs(this),Mo(this);var z="";break t}this.h.i=new a.TextDecoder}for(h=0;h<k;h++)this.h.h=!0,l+=this.h.i.decode(g[h],{stream:!(L&&h==k-1)});g.length=0,this.h.g+=l,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=p==200,ET(this.i,this.u,this.A,this.l,this.R,_t,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Se,ct=this.g;if((Se=ct.g?ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Se)){var we=Se;break t}}we=null}if(p=we)yi(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mh(this,p);else{this.o=!1,this.s=3,Vt(12),vs(this),Mo(this);break e}}if(this.P){p=!0;let wn;for(;!this.J&&this.C<z.length;)if(wn=xT(this,z),wn==dh){_t==4&&(this.s=4,Vt(14),p=!1),yi(this.i,this.l,null,"[Incomplete Response]");break}else if(wn==qm){this.s=4,Vt(15),yi(this.i,this.l,z,"[Invalid Chunk]"),p=!1;break}else yi(this.i,this.l,wn,null),mh(this,wn);if(Gm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_t!=4||z.length!=0||this.h.h||(this.s=1,Vt(16),p=!1),this.o=this.o&&p,!p)yi(this.i,this.l,z,"[Invalid Chunked Response]"),vs(this),Mo(this);else if(0<z.length&&!this.W){this.W=!0;var yt=this.j;yt.g==this&&yt.ba&&!yt.M&&(yt.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),Eh(yt),yt.M=!0,Vt(11))}}else yi(this.i,this.l,z,null),mh(this,z);_t==4&&vs(this),this.o&&!this.J&&(_t==4?vg(this.j,this):(this.o=!1,bl(this)))}else UT(this.g),p==400&&0<z.indexOf("Unknown SID")?(this.s=3,Vt(12)):(this.s=0,Vt(13)),vs(this),Mo(this)}}}catch{}finally{}};function Gm(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function xT(l,h){var p=l.C,g=h.indexOf(`
`,p);return g==-1?dh:(p=Number(h.substring(p,g)),isNaN(p)?qm:(g+=1,g+p>h.length?dh:(h=h.slice(g,g+p),l.C=g+p,h)))}yr.prototype.cancel=function(){this.J=!0,vs(this)};function bl(l){l.S=Date.now()+l.I,Wm(l,l.I)}function Wm(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Oo(m(l.ba,l),h)}function ph(l){l.B&&(a.clearTimeout(l.B),l.B=null)}yr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(IT(this.i,this.A),this.L!=2&&(Do(),Vt(17)),vs(this),this.s=2,Mo(this)):Wm(this,this.S-l)};function Mo(l){l.j.G==0||l.J||vg(l.j,l)}function vs(l){ph(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,qn(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function mh(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||gh(p.h,l))){if(!l.K&&gh(p.h,l)&&p.G==3){try{var g=p.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var k=g;if(k[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)jl(p),Ml(p);else break e;wh(p),Vt(18)}}else p.za=k[1],0<p.za-p.T&&37500>k[2]&&p.F&&p.v==0&&!p.C&&(p.C=Oo(m(p.Za,p),6e3));if(1>=Ym(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Es(p,11)}else if((l.K||p.g==l)&&jl(p),!v(h))for(k=p.Da.g.parse(h),h=0;h<k.length;h++){let we=k[h];if(p.T=we[0],we=we[1],p.G==2)if(we[0]=="c"){p.K=we[1],p.ia=we[2];const yt=we[3];yt!=null&&(p.la=yt,p.j.info("VER="+p.la));const _t=we[4];_t!=null&&(p.Aa=_t,p.j.info("SVER="+p.Aa));const wi=we[5];wi!=null&&typeof wi=="number"&&0<wi&&(g=1.5*wi,p.L=g,p.j.info("backChannelRequestTimeoutMs_="+g)),g=p;const wn=l.g;if(wn){const Ul=wn.g?wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ul){var L=g.h;L.g||Ul.indexOf("spdy")==-1&&Ul.indexOf("quic")==-1&&Ul.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(yh(L,L.h),L.h=null))}if(g.D){const Ih=wn.g?wn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ih&&(g.ya=Ih,Pe(g.I,g.D,Ih))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),g=p;var z=l;if(g.qa=Ig(g,g.J?g.ia:null,g.W),z.K){Xm(g.h,z);var Se=z,ct=g.L;ct&&(Se.I=ct),Se.B&&(ph(Se),bl(Se)),g.g=z}else yg(g);0<p.i.length&&Fl(p)}else we[0]!="stop"&&we[0]!="close"||Es(p,7);else p.G==3&&(we[0]=="stop"||we[0]=="close"?we[0]=="stop"?Es(p,7):vh(p):we[0]!="noop"&&p.l&&p.l.ta(we),p.v=0)}}Do(4)}catch{}}var ST=class{constructor(l,h){this.g=l,this.map=h}};function Qm(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hm(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ym(l){return l.h?1:l.g?l.g.size:0}function gh(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function yh(l,h){l.g?l.g.add(h):l.h=h}function Xm(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Qm.prototype.cancel=function(){if(this.i=Jm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Jm(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return C(l.i)}function AT(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],p=l.length,g=0;g<p;g++)h.push(l[g]);return h}h=[],p=0;for(g in l)h[p++]=l[g];return h}function RT(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const g in l)h[p++]=g;return h}}}function Zm(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=RT(l),g=AT(l),k=g.length,L=0;L<k;L++)h.call(void 0,g[L],p&&p[L],l)}var eg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PT(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var g=l[p].indexOf("="),k=null;if(0<=g){var L=l[p].substring(0,g);k=l[p].substring(g+1)}else L=l[p];h(L,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function ws(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof ws){this.h=l.h,kl(this,l.j),this.o=l.o,this.g=l.g,Nl(this,l.s),this.l=l.l;var h=l.i,p=new Bo;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),tg(this,p),this.m=l.m}else l&&(h=String(l).match(eg))?(this.h=!1,kl(this,h[1]||"",!0),this.o=Fo(h[2]||""),this.g=Fo(h[3]||"",!0),Nl(this,h[4]),this.l=Fo(h[5]||"",!0),tg(this,h[6]||"",!0),this.m=Fo(h[7]||"")):(this.h=!1,this.i=new Bo(null,this.h))}ws.prototype.toString=function(){var l=[],h=this.j;h&&l.push(jo(h,ng,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(jo(h,ng,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(jo(p,p.charAt(0)=="/"?kT:bT,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",jo(p,VT)),l.join("")};function Wn(l){return new ws(l)}function kl(l,h,p){l.j=p?Fo(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Nl(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function tg(l,h,p){h instanceof Bo?(l.i=h,DT(l.i,l.h)):(p||(h=jo(h,NT)),l.i=new Bo(h,l.h))}function Pe(l,h,p){l.i.set(h,p)}function Vl(l){return Pe(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Fo(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function jo(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,CT),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function CT(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ng=/[#\/\?@]/g,bT=/[#\?:]/g,kT=/[#\?]/g,NT=/[#\?@]/g,VT=/#/g;function Bo(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function _r(l){l.g||(l.g=new Map,l.h=0,l.i&&PT(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Bo.prototype,n.add=function(l,h){_r(this),this.i=null,l=_i(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function rg(l,h){_r(l),h=_i(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function sg(l,h){return _r(l),h=_i(l,h),l.g.has(h)}n.forEach=function(l,h){_r(this),this.g.forEach(function(p,g){p.forEach(function(k){l.call(h,k,g,this)},this)},this)},n.na=function(){_r(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let g=0;g<h.length;g++){const k=l[g];for(let L=0;L<k.length;L++)p.push(h[g])}return p},n.V=function(l){_r(this);let h=[];if(typeof l=="string")sg(this,l)&&(h=h.concat(this.g.get(_i(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return _r(this),this.i=null,l=_i(this,l),sg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function ig(l,h,p){rg(l,h),0<p.length&&(l.i=null,l.g.set(_i(l,h),C(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var g=h[p];const L=encodeURIComponent(String(g)),z=this.V(g);for(g=0;g<z.length;g++){var k=L;z[g]!==""&&(k+="="+encodeURIComponent(String(z[g]))),l.push(k)}}return this.i=l.join("&")};function _i(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function DT(l,h){h&&!l.j&&(_r(l),l.i=null,l.g.forEach(function(p,g){var k=g.toLowerCase();g!=k&&(rg(this,g),ig(this,k,p))},l)),l.j=h}function OT(l,h){const p=new Lo;if(a.Image){const g=new Image;g.onload=_(vr,p,"TestLoadImage: loaded",!0,h,g),g.onerror=_(vr,p,"TestLoadImage: error",!1,h,g),g.onabort=_(vr,p,"TestLoadImage: abort",!1,h,g),g.ontimeout=_(vr,p,"TestLoadImage: timeout",!1,h,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=l}else h(!1)}function LT(l,h){const p=new Lo,g=new AbortController,k=setTimeout(()=>{g.abort(),vr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:g.signal}).then(L=>{clearTimeout(k),L.ok?vr(p,"TestPingServer: ok",!0,h):vr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(k),vr(p,"TestPingServer: error",!1,h)})}function vr(l,h,p,g,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),g(p)}catch{}}function MT(){this.g=new gi}function FT(l,h,p){const g=p||"";try{Zm(l,function(k,L){let z=k;c(k)&&(z=Pn(k)),h.push(g+L+"="+encodeURIComponent(z))})}catch(k){throw h.push(g+"type="+encodeURIComponent("_badmap")),k}}function Dl(l){this.l=l.Ub||null,this.j=l.eb||!1}A(Dl,Zt),Dl.prototype.g=function(){return new Ol(this.l,this.j)},Dl.prototype.i=function(l){return function(){return l}}({});function Ol(l,h){et.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Ol,et),n=Ol.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,$o(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Uo(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,$o(this)),this.g&&(this.readyState=3,$o(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;og(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function og(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Uo(this):$o(this),this.readyState==3&&og(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Uo(this))},n.Qa=function(l){this.g&&(this.response=l,Uo(this))},n.ga=function(){this.g&&Uo(this)};function Uo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,$o(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function $o(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Ol.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function ag(l){let h="";return j(l,function(p,g){h+=g,h+=":",h+=p,h+=`\r
`}),h}function _h(l,h,p){e:{for(g in p){var g=!1;break e}g=!0}g||(p=ag(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Pe(l,h,p))}function ze(l){et.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(ze,et);var jT=/^https?$/i,BT=["POST","PUT"];n=ze.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():hh.g(),this.v=this.o?Kn(this.o):Kn(hh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(L){lg(this,L);return}if(l=p||"",p=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var k in g)p.set(k,g[k]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const L of g.keys())p.set(L,g.get(L));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(p.keys()).find(L=>L.toLowerCase()=="content-type"),k=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(BT,h,void 0))||g||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,z]of p)this.g.setRequestHeader(L,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{hg(this),this.u=!0,this.g.send(l),this.u=!1}catch(L){lg(this,L)}};function lg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,ug(l),Ll(l)}function ug(l){l.A||(l.A=!0,it(l,"complete"),it(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,it(this,"complete"),it(this,"abort"),Ll(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ll(this,!0)),ze.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?cg(this):this.bb())},n.bb=function(){cg(this)};function cg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Qn(l)!=4||l.Z()!=2)){if(l.u&&Qn(l)==4)he(l.Ea,0,l);else if(it(l,"readystatechange"),Qn(l)==4){l.h=!1;try{const z=l.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var g;if(g=z===0){var k=String(l.D).match(eg)[1]||null;!k&&a.self&&a.self.location&&(k=a.self.location.protocol.slice(0,-1)),g=!jT.test(k?k.toLowerCase():"")}p=g}if(p)it(l,"complete"),it(l,"success");else{l.m=6;try{var L=2<Qn(l)?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.Z()+"]",ug(l)}}finally{Ll(l)}}}}function Ll(l,h){if(l.g){hg(l);const p=l.g,g=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||it(l,"ready");try{p.onreadystatechange=g}catch{}}}function hg(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function Qn(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<Qn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),gs(h)}};function dg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function UT(l){const h={};l=(l.g&&2<=Qn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<l.length;g++){if(v(l[g]))continue;var p=P(l[g]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const L=h[k]||[];h[k]=L,L.push(p)}E(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zo(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function fg(l){this.Aa=0,this.i=[],this.j=new Lo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zo("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zo("baseRetryDelayMs",5e3,l),this.cb=zo("retryDelaySeedMs",1e4,l),this.Wa=zo("forwardChannelMaxRetries",2,l),this.wa=zo("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Qm(l&&l.concurrentRequestLimit),this.Da=new MT,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=fg.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,g){Vt(0),this.W=l,this.H=h||{},p&&g!==void 0&&(this.H.OSID=p,this.H.OAID=g),this.F=this.X,this.I=Ig(this,null,this.W),Fl(this)};function vh(l){if(pg(l),l.G==3){var h=l.U++,p=Wn(l.I);if(Pe(p,"SID",l.K),Pe(p,"RID",h),Pe(p,"TYPE","terminate"),qo(l,p),h=new yr(l,l.j,h),h.L=2,h.v=Vl(Wn(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Tg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),bl(h)}Eg(l)}function Ml(l){l.g&&(Eh(l),l.g.cancel(),l.g=null)}function pg(l){Ml(l),l.u&&(a.clearTimeout(l.u),l.u=null),jl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Fl(l){if(!Hm(l.h)&&!l.s){l.s=!0;var h=l.Ga;X||Z(),M||(X(),M=!0),q.add(h,l),l.B=0}}function $T(l,h){return Ym(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Oo(m(l.Ga,l,h),wg(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const k=new yr(this,this.j,l);let L=this.o;if(this.S&&(L?(L=y(L),x(L,this.S)):L=this.S),this.m!==null||this.O||(k.H=L,L=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var g=this.i[p];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=gg(this,k,h),p=Wn(this.I),Pe(p,"RID",l),Pe(p,"CVER",22),this.D&&Pe(p,"X-HTTP-Session-Id",this.D),qo(this,p),L&&(this.O?h="headers="+encodeURIComponent(String(ag(L)))+"&"+h:this.m&&_h(p,this.m,L)),yh(this.h,k),this.Ua&&Pe(p,"TYPE","init"),this.P?(Pe(p,"$req",h),Pe(p,"SID","null"),k.T=!0,fh(k,p,null)):fh(k,p,h),this.G=2}}else this.G==3&&(l?mg(this,l):this.i.length==0||Hm(this.h)||mg(this))};function mg(l,h){var p;h?p=h.l:p=l.U++;const g=Wn(l.I);Pe(g,"SID",l.K),Pe(g,"RID",p),Pe(g,"AID",l.T),qo(l,g),l.m&&l.o&&_h(g,l.m,l.o),p=new yr(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=gg(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),yh(l.h,p),fh(p,g,h)}function qo(l,h){l.H&&j(l.H,function(p,g){Pe(h,g,p)}),l.l&&Zm({},function(p,g){Pe(h,g,p)})}function gg(l,h,p){p=Math.min(l.i.length,p);var g=l.l?m(l.l.Na,l.l,l):null;e:{var k=l.i;let L=-1;for(;;){const z=["count="+p];L==-1?0<p?(L=k[0].g,z.push("ofs="+L)):L=0:z.push("ofs="+L);let Se=!0;for(let ct=0;ct<p;ct++){let we=k[ct].g;const yt=k[ct].map;if(we-=L,0>we)L=Math.max(0,k[ct].g-100),Se=!1;else try{FT(yt,z,"req"+we+"_")}catch{g&&g(yt)}}if(Se){g=z.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,g}function yg(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;X||Z(),M||(X(),M=!0),q.add(h,l),l.v=0}}function wh(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Oo(m(l.Fa,l),wg(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,_g(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Oo(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vt(10),Ml(this),_g(this))};function Eh(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function _g(l){l.g=new yr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Wn(l.qa);Pe(h,"RID","rpc"),Pe(h,"SID",l.K),Pe(h,"AID",l.T),Pe(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Pe(h,"TO",l.ja),Pe(h,"TYPE","xmlhttp"),qo(l,h),l.m&&l.o&&_h(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=Vl(Wn(h)),p.m=null,p.P=!0,Km(p,l)}n.Za=function(){this.C!=null&&(this.C=null,Ml(this),wh(this),Vt(19))};function jl(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function vg(l,h){var p=null;if(l.g==h){jl(l),Eh(l),l.g=null;var g=2}else if(gh(l.h,h))p=h.D,Xm(l.h,h),g=1;else return;if(l.G!=0){if(h.o)if(g==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var k=l.B;g=Rl(),it(g,new Um(g,p)),Fl(l)}else yg(l);else if(k=h.s,k==3||k==0&&0<h.X||!(g==1&&$T(l,h)||g==2&&wh(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),k){case 1:Es(l,5);break;case 4:Es(l,10);break;case 3:Es(l,6);break;default:Es(l,2)}}}function wg(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Es(l,h){if(l.j.info("Error code "+h),h==2){var p=m(l.fb,l),g=l.Xa;const k=!g;g=new ws(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||kl(g,"https"),Vl(g),k?OT(g.toString(),p):LT(g.toString(),p)}else Vt(2);l.G=0,l.l&&l.l.sa(h),Eg(l),pg(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function Eg(l){if(l.G=0,l.ka=[],l.l){const h=Jm(l.h);(h.length!=0||l.i.length!=0)&&(V(l.ka,h),V(l.ka,l.i),l.h.i.length=0,C(l.i),l.i.length=0),l.l.ra()}}function Ig(l,h,p){var g=p instanceof ws?Wn(p):new ws(p);if(g.g!="")h&&(g.g=h+"."+g.g),Nl(g,g.s);else{var k=a.location;g=k.protocol,h=h?h+"."+k.hostname:k.hostname,k=+k.port;var L=new ws(null);g&&kl(L,g),h&&(L.g=h),k&&Nl(L,k),p&&(L.l=p),g=L}return p=l.D,h=l.ya,p&&h&&Pe(g,p,h),Pe(g,"VER",l.la),qo(l,g),g}function Tg(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new ze(new Dl({eb:p})):new ze(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function xg(){}n=xg.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Bl(){}Bl.prototype.g=function(l,h){return new en(l,h)};function en(l,h){et.call(this),this.g=new fg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!v(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new vi(this)}A(en,et),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){vh(this.g)},en.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Pn(l),l=p);h.i.push(new ST(h.Ya++,l)),h.G==3&&Fl(h)},en.prototype.N=function(){this.g.l=null,delete this.j,vh(this.g),delete this.g,en.aa.N.call(this)};function Sg(l){ys.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}A(Sg,ys);function Ag(){gr.call(this),this.status=1}A(Ag,gr);function vi(l){this.g=l}A(vi,xg),vi.prototype.ua=function(){it(this.g,"a")},vi.prototype.ta=function(l){it(this.g,new Sg(l))},vi.prototype.sa=function(l){it(this.g,new Ag)},vi.prototype.ra=function(){it(this.g,"b")},Bl.prototype.createWebChannel=Bl.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,W0=function(){return new Bl},G0=function(){return Rl()},K0=_s,nf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pl.NO_ERROR=0,Pl.TIMEOUT=8,Pl.HTTP_ERROR=6,Su=Pl,$m.COMPLETE="complete",q0=$m,Cn.EventType=Gn,Gn.OPEN="a",Gn.CLOSE="b",Gn.ERROR="c",Gn.MESSAGE="d",et.prototype.listen=et.prototype.K,la=Cn,ze.prototype.listenOnce=ze.prototype.L,ze.prototype.getLastError=ze.prototype.Ka,ze.prototype.getLastErrorCode=ze.prototype.Ba,ze.prototype.getStatus=ze.prototype.Z,ze.prototype.getResponseJson=ze.prototype.Oa,ze.prototype.getResponseText=ze.prototype.oa,ze.prototype.send=ze.prototype.ea,ze.prototype.setWithCredentials=ze.prototype.Ha,z0=ze}).apply(typeof iu<"u"?iu:typeof self<"u"?self:typeof window<"u"?window:{});const Qy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lt.UNAUTHENTICATED=new lt(null),lt.GOOGLE_CREDENTIALS=new lt("google-credentials-uid"),lt.FIRST_PARTY=new lt("first-party-uid"),lt.MOCK_USER=new lt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let So="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr=new Pp("@firebase/firestore");function Ai(){return Hr.logLevel}function sR(n){Hr.setLogLevel(n)}function U(n,...e){if(Hr.logLevel<=ge.DEBUG){const t=e.map(Vp);Hr.debug(`Firestore (${So}): ${n}`,...t)}}function We(n,...e){if(Hr.logLevel<=ge.ERROR){const t=e.map(Vp);Hr.error(`Firestore (${So}): ${n}`,...t)}}function Bn(n,...e){if(Hr.logLevel<=ge.WARN){const t=e.map(Vp);Hr.warn(`Firestore (${So}): ${n}`,...t)}}function Vp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(n="Unexpected state"){const e=`FIRESTORE (${So}) INTERNAL ASSERTION FAILED: `+n;throw We(e),new Error(e)}function ee(n,e){n||Y()}function iR(n,e){n||Y()}function G(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class B extends oi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lt.UNAUTHENTICATED))}shutdown(){}}class aR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class lR{constructor(e){this.t=e,this.currentUser=lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new mt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new mt,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new mt)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string"),new Q0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string"),new lt(e)}}class uR{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class cR{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new uR(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ee(this.o===void 0);const r=i=>{i.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string"),this.R=t.token,new hR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=fR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function le(n,e){return n<e?-1:n>e?1:0}function lo(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Y0(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Le(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new Le(0,0))}static max(){return new re(new Le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(),r===void 0?r=e.length-t:r>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Wa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Wa?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class fe extends Wa{construct(e,t,r){return new fe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new B(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new fe(t)}static emptyPath(){return new fe([])}}const pR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class De extends Wa{construct(e,t,r){return new De(e,t,r)}static isValidIdentifier(e){return pR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),De.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new De(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new B(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new B(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new B(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new De(t)}static emptyPath(){return new De([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.path=e}static fromPath(e){return new K(fe.fromString(e))}static fromName(e){return new K(fe.fromString(e).popFirst(5))}static empty(){return new K(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new K(new fe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function rf(n){return n.fields.find(e=>e.kind===2)}function As(n){return n.fields.filter(e=>e.kind!==2)}lc.UNKNOWN_ID=-1;class Au{constructor(e,t){this.fieldPath=e,this.kind=t}}class Qa{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Qa(0,on.min())}}function X0(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=re.fromTimestamp(r===1e9?new Le(t+1,0):new Le(t,r));return new on(s,K.empty(),e)}function J0(n){return new on(n.readTime,n.key,-1)}class on{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new on(re.min(),K.empty(),-1)}static max(){return new on(re.max(),K.empty(),-1)}}function Dp(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=K.comparator(n.documentKey,e.documentKey),t!==0?t:le(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function as(n){if(n.code!==O.FAILED_PRECONDITION||n.message!==Z0)throw n;U("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new N((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof N?t:N.resolve(t)}catch(t){return N.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):N.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):N.reject(t)}static resolve(e){return new N((t,r)=>{t(e)})}static reject(e){return new N((t,r)=>{r(e)})}static waitFor(e){return new N((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=N.resolve(!1);for(const r of e)t=t.next(s=>s?N.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new N((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const c=u;t(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new N((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new mt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ea(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=Op(r.target.error);this.V.reject(new Ea(e,s))}}static open(e,t,r,s){try{return new Bc(t,e.transaction(s,r))}catch(i){throw new Ea(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new gR(t)}}class Fn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Fn.S(oc())===12.2&&We("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),Rs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!P0())return!1;if(Fn.v())return!0;const e=oc(),t=Fn.S(e),r=0<t&&t<10,s=tE(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(U("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Ea(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new B(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new B(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ea(e,o))},s.onupgradeneeded=i=>{U("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{U("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Bc.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),N.reject(c))).toPromise();return u.catch(()=>{}),await a.m,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(U("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tE(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class mR{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Rs(this.B.delete())}}class Ea extends B{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ls(n){return n.name==="IndexedDbTransactionError"}class gR{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Rs(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),Rs(this.store.add(e))}get(e){return Rs(this.store.get(e)).next(t=>(t===void 0&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),Rs(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),Rs(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new N((o,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new N((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){U("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new N((r,s)=>{t.onerror=i=>{const o=Op(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new N((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new mR(a),c=t(a.primaryKey,a.value,u);if(c instanceof N){const d=c.catch(f=>(u.done(),N.reject(f)));r.push(d)}u.isDone?s():u.K===null?a.continue():a.continue(u.K)}}).next(()=>N.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Rs(n){return new N((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=Op(r.target.error);t(s)}})}let Hy=!1;function Op(n){const e=Fn.S(oc());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new B("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Hy||(Hy=!0,setTimeout(()=>{throw r},0)),r}}return n}class yR{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){U("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{U("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){ls(t)?U("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await as(t)}await this.X(6e4)})}}class _R{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return N.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return U("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(U("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=J0(i);Dp(o,r)>0&&(r=o)}),new on(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wt.oe=-1;function fl(n){return n==null}function Ha(n){return n===0&&1/n==-1/0}function nE(n){return typeof n=="number"&&Number.isInteger(n)&&!Ha(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ft(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Yy(e)),e=vR(n.get(t),e);return Yy(e)}function vR(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function Yy(n){return n+""}function Vn(n){const e=n.length;if(ee(e>=2),e===2)return ee(n.charAt(0)===""&&n.charAt(1)===""),fe.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&Y(),n.charAt(o+1)){case"":const a=n.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:Y()}i=o+2}return new fe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(n,e){return[n,Ft(e)]}function rE(n,e,t){return[n,Ft(e),t]}const wR={},ER=["prefixPath","collectionGroup","readTime","documentId"],IR=["prefixPath","collectionGroup","documentId"],TR=["collectionGroup","readTime","prefixPath","documentId"],xR=["canonicalId","targetId"],SR=["targetId","path"],AR=["path","targetId"],RR=["collectionId","parent"],PR=["indexId","uid"],CR=["uid","sequenceNumber"],bR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kR=["indexId","uid","orderedDocumentKey"],NR=["userId","collectionPath","documentId"],VR=["userId","collectionPath","largestBatchId"],DR=["userId","collectionGroup","largestBatchId"],sE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],OR=[...sE,"documentOverlays"],iE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],oE=iE,Lp=[...oE,"indexConfiguration","indexState","indexEntries"],LR=Lp,MR=[...Lp,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf extends eE{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function rt(n,e){const t=G(n);return Fn.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ai(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,t){this.comparator=e,this.root=t||dt.EMPTY}insert(e,t){return new Re(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dt.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ou(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ou(this.root,e,this.comparator,!1)}getReverseIterator(){return new ou(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ou(this.root,e,this.comparator,!0)}}class ou{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??dt.RED,this.left=s??dt.EMPTY,this.right=i??dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new dt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return dt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return dt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();const e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}}dt.EMPTY=null,dt.RED=!0,dt.BLACK=!1;dt.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,r,s,i){return this}insert(e,t,r){return new dt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zy(this.data.getIterator())}getIteratorFrom(e){return new Zy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof xe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new xe(this.comparator);return t.data=e,t}}class Zy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ii(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.fields=e,e.sort(De.comparator)}static empty(){return new Qt([])}unionWith(e){let t=new xe(De.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Qt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lo(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new lE("Invalid base64 string: "+i):i}}(e);return new Ke(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ke(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ke.EMPTY_BYTE_STRING=new Ke("");const jR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lr(n){if(ee(!!n),typeof n=="string"){let e=0;const t=jR.exec(n);if(ee(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ne(n.seconds),nanos:Ne(n.nanos)}}function Ne(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Yr(n){return typeof n=="string"?Ke.fromBase64String(n):Ke.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Mp(n){const e=n.mapValue.fields.__previous_value__;return Uc(e)?Mp(e):e}function Ya(n){const e=lr(n.mapValue.fields.__local_write_time__.timestampValue);return new Le(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,t,r,s,i,o,a,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class Xr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Xr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Pu={nullValue:"NULL_VALUE"};function Hs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Uc(n)?4:uE(n)?9007199254740991:$c(n)?10:11:Y()}function Un(n,e){if(n===e)return!0;const t=Hs(n);if(t!==Hs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ya(n).isEqual(Ya(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=lr(s.timestampValue),a=lr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Yr(s.bytesValue).isEqual(Yr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Ne(s.geoPointValue.latitude)===Ne(i.geoPointValue.latitude)&&Ne(s.geoPointValue.longitude)===Ne(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ne(s.integerValue)===Ne(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ne(s.doubleValue),a=Ne(i.doubleValue);return o===a?Ha(o)===Ha(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return lo(n.arrayValue.values||[],e.arrayValue.values||[],Un);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Jy(o)!==Jy(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Un(o[u],a[u])))return!1;return!0}(n,e);default:return Y()}}function Xa(n,e){return(n.values||[]).find(t=>Un(t,e))!==void 0}function Jr(n,e){if(n===e)return 0;const t=Hs(n),r=Hs(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ne(i.integerValue||i.doubleValue),u=Ne(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return e_(n.timestampValue,e.timestampValue);case 4:return e_(Ya(n),Ya(e));case 5:return le(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Yr(i),u=Yr(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const d=le(a[c],u[c]);if(d!==0)return d}return le(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=le(Ne(i.latitude),Ne(o.latitude));return a!==0?a:le(Ne(i.longitude),Ne(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return t_(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,u,c,d;const f=i.fields||{},m=o.fields||{},_=(a=f.value)===null||a===void 0?void 0:a.arrayValue,A=(u=m.value)===null||u===void 0?void 0:u.arrayValue,C=le(((c=_==null?void 0:_.values)===null||c===void 0?void 0:c.length)||0,((d=A==null?void 0:A.values)===null||d===void 0?void 0:d.length)||0);return C!==0?C:t_(_,A)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Dr.mapValue&&o===Dr.mapValue)return 0;if(i===Dr.mapValue)return 1;if(o===Dr.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const m=le(u[f],d[f]);if(m!==0)return m;const _=Jr(a[u[f]],c[d[f]]);if(_!==0)return _}return le(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Y()}}function e_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return le(n,e);const t=lr(n),r=lr(e),s=le(t.seconds,r.seconds);return s!==0?s:le(t.nanos,r.nanos)}function t_(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Jr(t[s],r[s]);if(i)return i}return le(t.length,r.length)}function uo(n){return of(n)}function of(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=lr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Yr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return K.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=of(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${of(t.fields[o])}`;return s+"}"}(n.mapValue):Y()}function Ys(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function af(n){return!!n&&"integerValue"in n}function Ja(n){return!!n&&"arrayValue"in n}function n_(n){return!!n&&"nullValue"in n}function r_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cu(n){return!!n&&"mapValue"in n}function $c(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ia(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ai(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ia(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ia(n.arrayValue.values[t]);return e}return Object.assign({},n)}function uE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const cE={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function UR(n){return"nullValue"in n?Pu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ys(Xr.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?$c(n)?cE:{mapValue:{}}:Y()}function $R(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ys(Xr.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?cE:"mapValue"in n?$c(n)?{mapValue:{}}:Dr:Y()}function s_(n,e){const t=Jr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function i_(n,e){const t=Jr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.value=e}static empty(){return new ft({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Cu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ia(t)}setAll(e){let t=De.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Ia(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Cu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Un(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Cu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){ai(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ft(Ia(this.value))}}function hE(n){const e=[];return ai(n.fields,(t,r)=>{const s=new De([t]);if(Cu(r)){const i=hE(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Qt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new be(e,0,re.min(),re.min(),re.min(),ft.empty(),0)}static newFoundDocument(e,t,r,s){return new be(e,1,t,re.min(),r,s,0)}static newNoDocument(e,t){return new be(e,2,t,re.min(),re.min(),ft.empty(),0)}static newUnknownDocument(e,t){return new be(e,3,t,re.min(),re.min(),ft.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new be(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t){this.position=e,this.inclusive=t}}function o_(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=K.comparator(K.fromName(o.referenceValue),t.key):r=Jr(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function a_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Un(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,t="asc"){this.field=e,this.dir=t}}function zR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{}class pe extends dE{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new qR(e,t,r):t==="array-contains"?new WR(e,r):t==="in"?new _E(e,r):t==="not-in"?new QR(e,r):t==="array-contains-any"?new HR(e,r):new pe(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new KR(e,r):new GR(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Jr(t,this.value)):t!==null&&Hs(this.value)===Hs(t)&&this.matchesComparison(Jr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ie extends dE{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ie(e,t)}matches(e){return co(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function co(n){return n.op==="and"}function lf(n){return n.op==="or"}function Fp(n){return fE(n)&&co(n)}function fE(n){for(const e of n.filters)if(e instanceof Ie)return!1;return!0}function uf(n){if(n instanceof pe)return n.field.canonicalString()+n.op.toString()+uo(n.value);if(Fp(n))return n.filters.map(e=>uf(e)).join(",");{const e=n.filters.map(t=>uf(t)).join(",");return`${n.op}(${e})`}}function pE(n,e){return n instanceof pe?function(r,s){return s instanceof pe&&r.op===s.op&&r.field.isEqual(s.field)&&Un(r.value,s.value)}(n,e):n instanceof Ie?function(r,s){return s instanceof Ie&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&pE(o,s.filters[a]),!0):!1}(n,e):void Y()}function mE(n,e){const t=n.filters.concat(e);return Ie.create(t,n.op)}function gE(n){return n instanceof pe?function(t){return`${t.field.canonicalString()} ${t.op} ${uo(t.value)}`}(n):n instanceof Ie?function(t){return t.op.toString()+" {"+t.getFilters().map(gE).join(" ,")+"}"}(n):"Filter"}class qR extends pe{constructor(e,t,r){super(e,t,r),this.key=K.fromName(r.referenceValue)}matches(e){const t=K.comparator(e.key,this.key);return this.matchesComparison(t)}}class KR extends pe{constructor(e,t){super(e,"in",t),this.keys=yE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class GR extends pe{constructor(e,t){super(e,"not-in",t),this.keys=yE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function yE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>K.fromName(r.referenceValue))}class WR extends pe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ja(t)&&Xa(t.arrayValue,this.value)}}class _E extends pe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xa(this.value.arrayValue,t)}}class QR extends pe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Xa(this.value.arrayValue,t)}}class HR extends pe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ja(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Xa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function cf(n,e=null,t=[],r=[],s=null,i=null,o=null){return new YR(n,e,t,r,s,i,o)}function Xs(n){const e=G(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>uf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),fl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>uo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>uo(r)).join(",")),e.ue=t}return e.ue}function pl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!pE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!a_(n.startAt,e.startAt)&&a_(n.endAt,e.endAt)}function uc(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function cc(n,e){return n.filters.filter(t=>t instanceof pe&&t.field.isEqual(e))}function l_(n,e,t){let r=Pu,s=!0;for(const i of cc(n,e)){let o=Pu,a=!0;switch(i.op){case"<":case"<=":o=UR(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Pu}s_({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];s_({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function u_(n,e,t){let r=Dr,s=!0;for(const i of cc(n,e)){let o=Dr,a=!0;switch(i.op){case">=":case">":o=$R(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Dr}i_({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];i_({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function vE(n,e,t,r,s,i,o,a){return new dr(n,e,t,r,s,i,o,a)}function Ao(n){return new dr(n)}function c_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function jp(n){return n.collectionGroup!==null}function Yi(n){const e=G(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xe(De.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Za(i,r))}),t.has(De.keyField().canonicalString())||e.ce.push(new Za(De.keyField(),r))}return e.ce}function jt(n){const e=G(n);return e.le||(e.le=XR(e,Yi(n))),e.le}function XR(n,e){if(n.limitType==="F")return cf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Za(s.field,i)});const t=n.endAt?new Zr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Zr(n.startAt.position,n.startAt.inclusive):null;return cf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function hf(n,e){const t=n.filters.concat([e]);return new dr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function hc(n,e,t){return new dr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ml(n,e){return pl(jt(n),jt(e))&&n.limitType===e.limitType}function wE(n){return`${Xs(jt(n))}|lt:${n.limitType}`}function Ri(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>gE(s)).join(", ")}]`),fl(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>uo(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>uo(s)).join(",")),`Target(${r})`}(jt(n))}; limitType=${n.limitType})`}function gl(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):K.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Yi(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,u){const c=o_(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Yi(r),s)||r.endAt&&!function(o,a,u){const c=o_(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Yi(r),s))}(n,e)}function EE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function IE(n){return(e,t)=>{let r=!1;for(const s of Yi(n)){const i=JR(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function JR(n,e,t){const r=n.field.isKeyField()?K.comparator(e.key,t.key):function(i,o,a){const u=o.data.field(i),c=a.data.field(i);return u!==null&&c!==null?Jr(u,c):Y()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ai(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return aE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new Re(K.comparator);function Ht(){return ZR}const TE=new Re(K.comparator);function ua(...n){let e=TE;for(const t of n)e=e.insert(t.key,t);return e}function xE(n){let e=TE;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Dn(){return Ta()}function SE(){return Ta()}function Ta(){return new us(n=>n.toString(),(n,e)=>n.isEqual(e))}const eP=new Re(K.comparator),tP=new xe(K.comparator);function ue(...n){let e=tP;for(const t of n)e=e.add(t);return e}const nP=new xe(le);function Bp(){return nP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ha(e)?"-0":e}}function AE(n){return{integerValue:""+n}}function RE(n,e){return nE(e)?AE(e):Up(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(){this._=void 0}}function rP(n,e,t){return n instanceof ho?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Uc(i)&&(i=Mp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Js?CE(n,e):n instanceof Zs?bE(n,e):function(s,i){const o=PE(s,i),a=h_(o)+h_(s.Pe);return af(o)&&af(s.Pe)?AE(a):Up(s.serializer,a)}(n,e)}function sP(n,e,t){return n instanceof Js?CE(n,e):n instanceof Zs?bE(n,e):t}function PE(n,e){return n instanceof fo?function(r){return af(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ho extends zc{}class Js extends zc{constructor(e){super(),this.elements=e}}function CE(n,e){const t=kE(e);for(const r of n.elements)t.some(s=>Un(s,r))||t.push(r);return{arrayValue:{values:t}}}class Zs extends zc{constructor(e){super(),this.elements=e}}function bE(n,e){let t=kE(e);for(const r of n.elements)t=t.filter(s=>!Un(s,r));return{arrayValue:{values:t}}}class fo extends zc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function h_(n){return Ne(n.integerValue||n.doubleValue)}function kE(n){return Ja(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,t){this.field=e,this.transform=t}}function iP(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Js&&s instanceof Js||r instanceof Zs&&s instanceof Zs?lo(r.elements,s.elements,Un):r instanceof fo&&s instanceof fo?Un(r.Pe,s.Pe):r instanceof ho&&s instanceof ho}(n.transform,e.transform)}class oP{constructor(e,t){this.version=e,this.transformResults=t}}class Oe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class qc{}function NE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Po(n.key,Oe.none()):new Ro(n.key,n.data,Oe.none());{const t=n.data,r=ft.empty();let s=new xe(De.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new fr(n.key,r,new Qt(s.toArray()),Oe.none())}}function aP(n,e,t){n instanceof Ro?function(s,i,o){const a=s.value.clone(),u=f_(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof fr?function(s,i,o){if(!bu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=f_(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(VE(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function xa(n,e,t,r){return n instanceof Ro?function(i,o,a,u){if(!bu(i.precondition,o))return a;const c=i.value.clone(),d=p_(i.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof fr?function(i,o,a,u){if(!bu(i.precondition,o))return a;const c=p_(i.fieldTransforms,u,o),d=o.data;return d.setAll(VE(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return bu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function lP(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=PE(r.transform,s||null);i!=null&&(t===null&&(t=ft.empty()),t.set(r.field,i))}return t||null}function d_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&lo(r,s,(i,o)=>iP(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ro extends qc{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class fr extends qc{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function VE(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function f_(n,e,t){const r=new Map;ee(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,sP(o,a,t[s]))}return r}function p_(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,rP(i,o,e))}return r}class Po extends qc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $p extends qc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&aP(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=xa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=xa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=SE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const u=NE(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ue())}isEqual(e){return this.batchId===e.batchId&&lo(this.mutations,e.mutations,(t,r)=>d_(t,r))&&lo(this.baseMutations,e.baseMutations,(t,r)=>d_(t,r))}}class qp{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ee(e.mutations.length===r.length);let s=function(){return eP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new qp(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,ye;function DE(n){switch(n){default:return Y();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function OE(n){if(n===void 0)return We("GRPC error has no .code"),O.UNKNOWN;switch(n){case Xe.OK:return O.OK;case Xe.CANCELLED:return O.CANCELLED;case Xe.UNKNOWN:return O.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return O.INTERNAL;case Xe.UNAVAILABLE:return O.UNAVAILABLE;case Xe.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Xe.NOT_FOUND:return O.NOT_FOUND;case Xe.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Xe.ABORTED:return O.ABORTED;case Xe.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Xe.DATA_LOSS:return O.DATA_LOSS;default:return Y()}}(ye=Xe||(Xe={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP=new js([4294967295,4294967295],0);function m_(n){const e=LE().encode(n),t=new $0;return t.update(e),new Uint8Array(t.digest())}function g_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new js([t,r],0),new js([s,i],0)]}class Gp{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ca(`Invalid padding: ${t}`);if(r<0)throw new ca(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ca(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ca(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=js.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(js.fromNumber(r)));return s.compare(cP)===1&&(s=new js([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=m_(e),[r,s]=g_(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Gp(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=m_(e),[r,s]=g_(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ca extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,vl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new _l(re.min(),s,new Re(le),Ht(),ue())}}class vl{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new vl(r,t,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class ME{constructor(e,t){this.targetId=e,this.me=t}}class FE{constructor(e,t,r=Ke.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class y_{constructor(){this.fe=0,this.ge=v_(),this.pe=Ke.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ue(),t=ue(),r=ue();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Y()}}),new vl(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=v_()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ee(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class hP{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ht(),this.qe=__(),this.Qe=new Re(le)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(uc(i))if(r===0){const o=new K(i.path);this.Ue(t,o,be.newNoDocument(o,re.min()))}else ee(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Yr(r).toUint8Array()}catch(u){if(u instanceof lE)return Bn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Gp(o,s,i)}catch(u){return Bn(u instanceof ca?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&uc(a.target)){const u=new K(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,be.newNoDocument(u,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=ue();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new _l(e,t,this.Qe,this.ke,r);return this.ke=Ht(),this.qe=__(),this.Qe=new Re(le),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new y_,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new xe(le),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new y_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function __(){return new Re(K.comparator)}function v_(){return new Re(K.comparator)}const dP={asc:"ASCENDING",desc:"DESCENDING"},fP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pP={and:"AND",or:"OR"};class mP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function df(n,e){return n.useProto3Json||fl(e)?e:{value:e}}function po(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gP(n,e){return po(n,e.toTimestamp())}function Qe(n){return ee(!!n),re.fromTimestamp(function(t){const r=lr(t);return new Le(r.seconds,r.nanos)}(n))}function Wp(n,e){return ff(n,e).canonicalString()}function ff(n,e){const t=function(s){return new fe(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function BE(n){const e=fe.fromString(n);return ee(YE(e)),e}function el(n,e){return Wp(n.databaseId,e.path)}function jn(n,e){const t=BE(e);if(t.get(1)!==n.databaseId.projectId)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(zE(t))}function UE(n,e){return Wp(n.databaseId,e)}function $E(n){const e=BE(n);return e.length===4?fe.emptyPath():zE(e)}function pf(n){return new fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function zE(n){return ee(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function w_(n,e,t){return{name:el(n,e),fields:t.value.mapValue.fields}}function qE(n,e,t){const r=jn(n,e.name),s=Qe(e.updateTime),i=e.createTime?Qe(e.createTime):re.min(),o=new ft({mapValue:{fields:e.fields}}),a=be.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function yP(n,e){return"found"in e?function(r,s){ee(!!s.found),s.found.name,s.found.updateTime;const i=jn(r,s.found.name),o=Qe(s.found.updateTime),a=s.found.createTime?Qe(s.found.createTime):re.min(),u=new ft({mapValue:{fields:s.found.fields}});return be.newFoundDocument(i,o,a,u)}(n,e):"missing"in e?function(r,s){ee(!!s.missing),ee(!!s.readTime);const i=jn(r,s.missing),o=Qe(s.readTime);return be.newNoDocument(i,o)}(n,e):Y()}function _P(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(ee(d===void 0||typeof d=="string"),Ke.fromBase64String(d||"")):(ee(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ke.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?O.UNKNOWN:OE(c.code);return new B(d,c.message||"")}(o);t=new FE(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=jn(n,r.document.name),i=Qe(r.document.updateTime),o=r.document.createTime?Qe(r.document.createTime):re.min(),a=new ft({mapValue:{fields:r.document.fields}}),u=be.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new ku(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=jn(n,r.document),i=r.readTime?Qe(r.readTime):re.min(),o=be.newNoDocument(s,i),a=r.removedTargetIds||[];t=new ku([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=jn(n,r.document),i=r.removedTargetIds||[];t=new ku([],i,s,null)}else{if(!("filter"in e))return Y();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new uP(s,i),a=r.targetId;t=new ME(a,o)}}return t}function tl(n,e){let t;if(e instanceof Ro)t={update:w_(n,e.key,e.value)};else if(e instanceof Po)t={delete:el(n,e.key)};else if(e instanceof fr)t={update:w_(n,e.key,e.data),updateMask:xP(e.fieldMask)};else{if(!(e instanceof $p))return Y();t={verify:el(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ho)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Js)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Zs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof fo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Y()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:gP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Y()}(n,e.precondition)),t}function mf(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Oe.updateTime(Qe(i.updateTime)):i.exists!==void 0?Oe.exists(i.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let u=null;if("setToServerValue"in a)ee(a.setToServerValue==="REQUEST_TIME"),u=new ho;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Js(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new Zs(d)}else"increment"in a?u=new fo(o,a.increment):Y();const c=De.fromServerFormat(a.fieldPath);return new yl(c,u)}(n,s)):[];if(e.update){e.update.name;const s=jn(n,e.update.name),i=new ft({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new Qt(c.map(d=>De.fromServerFormat(d)))}(e.updateMask);return new fr(s,i,o,t,r)}return new Ro(s,i,t,r)}if(e.delete){const s=jn(n,e.delete);return new Po(s,t)}if(e.verify){const s=jn(n,e.verify);return new $p(s,t)}return Y()}function vP(n,e){return n&&n.length>0?(ee(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Qe(s.updateTime):Qe(i);return o.isEqual(re.min())&&(o=Qe(i)),new oP(o,s.transformResults||[])}(t,e))):[]}function KE(n,e){return{documents:[UE(n,e.path)]}}function GE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=UE(n,s);const i=function(c){if(c.length!==0)return HE(Ie.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:Pi(m.field),direction:EP(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=df(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function WE(n){let e=$E(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ee(r===1);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const m=QE(f);return m instanceof Ie&&Fp(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(m=>function(A){return new Za(Ci(A.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,fl(m)?null:m}(t.limit));let u=null;t.startAt&&(u=function(f){const m=!!f.before,_=f.values||[];return new Zr(_,m)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const m=!f.before,_=f.values||[];return new Zr(_,m)}(t.endAt)),vE(e,s,o,i,a,"F",u,c)}function wP(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function QE(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ci(t.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ci(t.unaryFilter.field);return pe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ci(t.unaryFilter.field);return pe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ci(t.unaryFilter.field);return pe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):n.fieldFilter!==void 0?function(t){return pe.create(Ci(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ie.create(t.compositeFilter.filters.map(r=>QE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Y()}}(t.compositeFilter.op))}(n):Y()}function EP(n){return dP[n]}function IP(n){return fP[n]}function TP(n){return pP[n]}function Pi(n){return{fieldPath:n.canonicalString()}}function Ci(n){return De.fromServerFormat(n.fieldPath)}function HE(n){return n instanceof pe?function(t){if(t.op==="=="){if(r_(t.value))return{unaryFilter:{field:Pi(t.field),op:"IS_NAN"}};if(n_(t.value))return{unaryFilter:{field:Pi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(r_(t.value))return{unaryFilter:{field:Pi(t.field),op:"IS_NOT_NAN"}};if(n_(t.value))return{unaryFilter:{field:Pi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pi(t.field),op:IP(t.op),value:t.value}}}(n):n instanceof Ie?function(t){const r=t.getFilters().map(s=>HE(s));return r.length===1?r[0]:{compositeFilter:{op:TP(t.op),filters:r}}}(n):Y()}function xP(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function YE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,t,r,s,i=re.min(),o=re.min(),a=Ke.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new er(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new er(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e){this.ct=e}}function SP(n,e){let t;if(e.document)t=qE(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=K.fromSegments(e.noDocument.path),s=ti(e.noDocument.readTime);t=be.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{const r=K.fromSegments(e.unknownDocument.path),s=ti(e.unknownDocument.version);t=be.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Le(s[0],s[1]);return re.fromTimestamp(i)}(e.readTime)),t}function E_(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:dc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:el(i,o.key),fields:o.data.value.mapValue.fields,updateTime:po(i,o.version.toTimestamp()),createTime:po(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ei(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:t.path.toArray(),version:ei(e.version)}}return r}function dc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ei(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ti(n){const e=new Le(n.seconds,n.nanoseconds);return re.fromTimestamp(e)}function Ps(n,e){const t=(e.baseMutations||[]).map(i=>mf(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>mf(n.ct,i)),s=Le.fromMillis(e.localWriteTimeMs);return new zp(e.batchId,s,t,r)}function ha(n){const e=ti(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ti(n.lastLimboFreeSnapshotVersion):re.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return ee(i.documents.length===1),jt(Ao($E(i.documents[0])))}(n.query):function(i){return jt(WE(i))}(n.query),new er(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ke.fromBase64String(n.resumeToken))}function JE(n,e){const t=ei(e.snapshotVersion),r=ei(e.lastLimboFreeSnapshotVersion);let s;s=uc(e.target)?KE(n.ct,e.target):GE(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Xs(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Qp(n){const e=WE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?hc(e,e.limit,"L"):e}function ed(n,e){return new Kp(e.largestBatchId,mf(n.ct,e.overlayMutation))}function I_(n,e){const t=e.path.lastSegment();return[n,Ft(e.path.popLast()),t]}function T_(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ei(r.readTime),documentKey:Ft(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{getBundleMetadata(e,t){return x_(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:ti(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return x_(e).put(function(s){return{bundleId:s.id,createTime:ei(Qe(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return S_(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:Qp(i.bundledQuery),readTime:ti(i.readTime)}}(r)})}saveNamedQuery(e,t){return S_(e).put(function(s){return{name:s.name,readTime:ei(Qe(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function x_(n){return rt(n,"bundles")}function S_(n){return rt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Kc(e,r)}getOverlay(e,t){return Zo(e).get(I_(this.userId,t)).next(r=>r?ed(this.serializer,r):null)}getOverlays(e,t){const r=Dn();return N.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Kp(t,o);s.push(this.ht(e,a))}),N.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Ft(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Zo(e).j("collectionPathOverlayIndex",a))}),N.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Dn(),i=Ft(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Zo(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=ed(this.serializer,u);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Dn();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Zo(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,d)=>{const f=ed(this.serializer,c);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,t){return Zo(e).put(function(s,i,o){const[a,u,c]=I_(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:tl(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Zo(n){return rt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{Pt(e){return rt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Ke.fromUint8Array(r):Ke.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ne(e.integerValue));else if("doubleValue"in e){const r=Ne(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ha(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=lr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Yr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?uE(e)?this.dt(t,Number.MAX_SAFE_INTEGER):$c(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Y()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Ne(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),K.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Cs.vt=new Cs;function PP(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function A_(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=PP(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class CP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=A_(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=A_(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class bP{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class kP{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ea{constructor(){this.jt=new CP,this.Ht=new bP(this.jt),this.Jt=new kP(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new bs(this.indexId,this.documentKey,this.arrayValue,r)}}function Er(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=R_(n.arrayValue,e.arrayValue),t!==0?t:(t=R_(n.directionalValue,e.directionalValue),t!==0?t:K.comparator(n.documentKey,e.documentKey)))}function R_(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this.Xt=new xe((t,r)=>De.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ee(e.collectionGroup===this.collectionId),this.nn)return!1;const t=rf(e);if(t!==void 0&&!this.sn(t))return!1;const r=As(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const u=r[i];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new xe(De.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Au(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Au(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Au(r.field,r.dir==="asc"?0:1)));return new lc(lc.UNKNOWN_ID,this.collectionId,t,Qa.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(n){var e,t;if(ee(n instanceof pe||n instanceof Ie),n instanceof pe){if(n instanceof _E){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>pe.create(n.field,"==",i)))||[];return Ie.create(s,"or")}return n}const r=n.filters.map(s=>ZE(s));return Ie.create(r,n.op)}function NP(n){if(n.getFilters().length===0)return[];const e=_f(ZE(n));return ee(eI(e)),gf(e)||yf(e)?[e]:e.getFilters()}function gf(n){return n instanceof pe}function yf(n){return n instanceof Ie&&Fp(n)}function eI(n){return gf(n)||yf(n)||function(t){if(t instanceof Ie&&lf(t)){for(const r of t.getFilters())if(!gf(r)&&!yf(r))return!1;return!0}return!1}(n)}function _f(n){if(ee(n instanceof pe||n instanceof Ie),n instanceof pe)return n;if(n.filters.length===1)return _f(n.filters[0]);const e=n.filters.map(r=>_f(r));let t=Ie.create(e,n.op);return t=fc(t),eI(t)?t:(ee(t instanceof Ie),ee(co(t)),ee(t.filters.length>1),t.filters.reduce((r,s)=>Hp(r,s)))}function Hp(n,e){let t;return ee(n instanceof pe||n instanceof Ie),ee(e instanceof pe||e instanceof Ie),t=n instanceof pe?e instanceof pe?function(s,i){return Ie.create([s,i],"and")}(n,e):C_(n,e):e instanceof pe?C_(e,n):function(s,i){if(ee(s.filters.length>0&&i.filters.length>0),co(s)&&co(i))return mE(s,i.getFilters());const o=lf(s)?s:i,a=lf(s)?i:s,u=o.filters.map(c=>Hp(c,a));return Ie.create(u,"or")}(n,e),fc(t)}function C_(n,e){if(co(e))return mE(e,n.getFilters());{const t=e.filters.map(r=>Hp(n,r));return Ie.create(t,"or")}}function fc(n){if(ee(n instanceof pe||n instanceof Ie),n instanceof pe)return n;const e=n.getFilters();if(e.length===1)return fc(e[0]);if(fE(n))return n;const t=e.map(s=>fc(s)),r=[];return t.forEach(s=>{s instanceof pe?r.push(s):s instanceof Ie&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ie.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.un=new Yp}addToCollectionParentIndex(e,t){return this.un.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(on.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(on.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}}class Yp{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new xe(fe.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new xe(fe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=new Uint8Array(0);class DP{constructor(e,t){this.databaseId=t,this.cn=new Yp,this.ln=new us(r=>Xs(r),(r,s)=>pl(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:Ft(s)};return b_(e).put(i)}return N.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Y0(t),""],!1,!0);return b_(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Vn(o.parent))}return r})}addFieldIndex(e,t){const r=ta(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=xi(e);return i.next(a=>{o.put(T_(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=ta(e),s=xi(e),i=Ti(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ta(e),r=Ti(e),s=xi(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return N.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new P_(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=Ti(e);let s=!0;const i=new Map;return N.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ue();const a=[];return N.forEach(i,(u,c)=>{U("IndexedDbIndexManager",`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(u)} to execute ${Xs(t)}`);const d=function(w,D){const F=rf(D);if(F===void 0)return null;for(const j of cc(w,F.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(c,u),f=function(w,D){const F=new Map;for(const j of As(D))for(const E of cc(w,j.fieldPath))switch(E.op){case"==":case"in":F.set(j.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return F.set(j.fieldPath.canonicalString(),E.value),Array.from(F.values())}return null}(c,u),m=function(w,D){const F=[];let j=!0;for(const E of As(D)){const y=E.kind===0?l_(w,E.fieldPath,w.startAt):u_(w,E.fieldPath,w.startAt);F.push(y.value),j&&(j=y.inclusive)}return new Zr(F,j)}(c,u),_=function(w,D){const F=[];let j=!0;for(const E of As(D)){const y=E.kind===0?u_(w,E.fieldPath,w.endAt):l_(w,E.fieldPath,w.endAt);F.push(y.value),j&&(j=y.inclusive)}return new Zr(F,j)}(c,u),A=this.In(u,c,m),C=this.In(u,c,_),V=this.Tn(u,c,f),I=this.En(u.indexId,d,A,m.inclusive,C,_.inclusive,V);return N.forEach(I,v=>r.G(v,t.limit).next(w=>{w.forEach(D=>{const F=K.fromSegments(D.documentKey);o.has(F)||(o=o.add(F),a.push(F))})}))}).next(()=>a)}return N.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=NP(Ie.create(e.filters,"and")).map(r=>cf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const u=(t!=null?t.length:1)*Math.max(r.length,i.length),c=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const m=t?this.dn(t[f/c]):au,_=this.An(e,m,r[f%c],s),A=this.Rn(e,m,i[f%c],o),C=a.map(V=>this.An(e,m,V,!0));d.push(...this.createRange(_,A,C))}return d}An(e,t,r,s){const i=new bs(e,K.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new bs(e,K.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new P_(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return N.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new xe(De.comparator),d=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:c=c.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new ea;for(const s of As(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);Cs.vt.It(i,o)}return r.zt()}dn(e){const t=new ea;return Cs.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new ea;return Cs.vt.It(Ys(this.databaseId,t),r.Yt(function(i){const o=As(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new ea);let i=0;for(const o of As(e)){const a=r[i++];for(const u of s)if(this.fn(t,o.fieldPath)&&Ja(a))s=this.gn(s,o,a);else{const c=u.Yt(o.kind);Cs.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const u=new ea;u.seed(a.zt()),Cs.vt.It(o,u.Yt(t.kind)),i.push(u)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof pe&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=ta(e),s=xi(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return N.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){const m=f?new Qa(f.sequenceNumber,new on(ti(f.readTime),new K(Vn(f.documentKey)),f.largestBatchId)):Qa.empty(),_=d.fields.map(([A,C])=>new Au(De.fromServerFormat(A),C));return new lc(d.indexId,d.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:le(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=ta(e),i=xi(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>N.forEach(a,u=>i.put(T_(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return N.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),N.forEach(a,u=>this.wn(e,s,u).next(c=>{const d=this.Sn(i,u);return c.isEqual(d)?N.resolve():this.bn(e,i,u,c,d)}))))})}Dn(e,t,r,s){return Ti(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return Ti(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=Ti(e);let i=new xe(Er);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new bs(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new xe(Er);const s=this.Vn(t,e);if(s==null)return r;const i=rf(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Ja(o))for(const a of o.arrayValue.values||[])r=r.add(new bs(t.indexId,e.key,this.dn(a),s))}else r=r.add(new bs(t.indexId,e.key,au,s));return r}bn(e,t,r,s,i){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,c,d,f,m){const _=u.getIterator(),A=c.getIterator();let C=Ii(_),V=Ii(A);for(;C||V;){let I=!1,v=!1;if(C&&V){const w=d(C,V);w<0?v=!0:w>0&&(I=!0)}else C!=null?v=!0:I=!0;I?(f(V),V=Ii(A)):v?(m(C),C=Ii(_)):(C=Ii(_),V=Ii(A))}}(s,i,Er,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),N.waitFor(o)}yn(e){let t=1;return xi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Er(o,a)).filter((o,a,u)=>!a||Er(o,u[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Er(o,e),u=Er(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&u<0)s.push(o),s.push(o.Zt());else if(u>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,au,[]],u=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,au,[]];i.push(IDBKeyRange.bound(a,u))}return i}Cn(e,t){return Er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(k_)}getMinOffset(e,t){return N.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||Y())).next(k_)}}function b_(n){return rt(n,"collectionParents")}function Ti(n){return rt(n,"indexEntries")}function ta(n){return rt(n,"indexConfiguration")}function xi(n){return rt(n,"indexState")}function k_(n){ee(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Dp(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new on(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class qt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new qt(e,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.J({range:o},(d,f,m)=>(a++,m.delete()));i.push(u.next(()=>{ee(a===1)}));const c=[];for(const d of t.mutations){const f=rE(e,d.key.path,t.batchId);i.push(s.delete(f)),c.push(d.key)}return N.waitFor(i).next(()=>c)}function pc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qt.DEFAULT_COLLECTION_PERCENTILE=10,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qt.DEFAULT=new qt(41943040,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qt.DISABLED=new qt(-1,0,0);class Gc{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){ee(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Gc(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ir(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=bi(e),o=Ir(e);return o.add({}).next(a=>{ee(typeof a=="number");const u=new zp(a,t,r,s),c=function(_,A,C){const V=C.baseMutations.map(v=>tl(_.ct,v)),I=C.mutations.map(v=>tl(_.ct,v));return{userId:A,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:V,mutations:I}}(this.serializer,this.userId,u),d=[];let f=new xe((m,_)=>le(m.canonicalString(),_.canonicalString()));for(const m of s){const _=rE(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),d.push(o.put(c)),d.push(i.put(_,wR))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),N.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Ir(e).get(t).next(r=>r?(ee(r.userId===this.userId),Ps(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?N.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ir(e).J({index:"userMutationsIndex",range:s},(o,a,u)=>{a.userId===this.userId&&(ee(a.batchId>=r),i=Ps(this.serializer,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ir(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ir(e).U("userMutationsIndex",t).next(r=>r.map(s=>Ps(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Ru(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return bi(e).J({range:s},(o,a,u)=>{const[c,d,f]=o,m=Vn(d);if(c===this.userId&&t.path.isEqual(m))return Ir(e).get(f).next(_=>{if(!_)throw Y();ee(_.userId===this.userId),i.push(Ps(this.serializer,_))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new xe(le);const s=[];return t.forEach(i=>{const o=Ru(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=bi(e).J({range:a},(c,d,f)=>{const[m,_,A]=c,C=Vn(_);m===this.userId&&i.path.isEqual(C)?r=r.add(A):f.done()});s.push(u)}),N.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Ru(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new xe(le);return bi(e).J({range:o},(u,c,d)=>{const[f,m,_]=u,A=Vn(m);f===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(Ir(e).get(i).next(o=>{if(o===null)throw Y();ee(o.userId===this.userId),r.push(Ps(this.serializer,o))}))}),N.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return tI(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),N.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return N.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return bi(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=Vn(i[1]);s.push(u)}else a.done()}).next(()=>{ee(s.length===0)})})}containsKey(e,t){return nI(e,this.userId,t)}Nn(e){return rI(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function nI(n,e,t){const r=Ru(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return bi(n).J({range:i,H:!0},(a,u,c)=>{const[d,f,m]=a;d===e&&f===s&&(o=!0),c.done()}).next(()=>o)}function Ir(n){return rt(n,"mutations")}function bi(n){return rt(n,"documentMutations")}function rI(n){return rt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ni(0)}static kn(){return new ni(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new ni(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>re.fromTimestamp(new Le(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Si(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(ee(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Si(e).J((o,a)=>{const u=ha(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>N.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Si(e).J((r,s)=>{const i=ha(s);t(i)})}qn(e){return V_(e).get("targetGlobalKey").next(t=>(ee(t!==null),t))}Qn(e,t){return V_(e).put("targetGlobalKey",t)}Kn(e,t){return Si(e).put(JE(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Xs(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Si(e).J({range:s,index:"queryTargetsIndex"},(o,a,u)=>{const c=ha(a);pl(t,c.target)&&(i=c,u.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=Cr(e);return t.forEach(o=>{const a=Ft(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(s)}removeMatchingKeys(e,t,r){const s=Cr(e);return N.forEach(t,i=>{const o=Ft(i.path);return N.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=Cr(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Cr(e);let i=ue();return s.J({range:r,H:!0},(o,a,u)=>{const c=Vn(o[1]),d=new K(c);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=Ft(t.path),s=IDBKeyRange.bound([r],[Y0(r)],!1,!0);let i=0;return Cr(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],u,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return Si(e).get(t).next(r=>r?ha(r):null)}}function Si(n){return rt(n,"targets")}function V_(n){return rt(n,"targetGlobal")}function Cr(n){return rt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_([n,e],[t,r]){const s=le(n,t);return s===0?le(e,r):s}class LP{constructor(e){this.Un=e,this.buffer=new xe(D_),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();D_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class MP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ls(t)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await as(t)}await this.Hn(3e5)})}}class FP{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return N.resolve(Wt.oe);const r=new LP(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(N_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),N_):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),Ai()<=ge.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${f} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function jP(n,e){return new FP(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,t){this.db=e,this.garbageCollector=jP(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return lu(e,r)}removeReference(e,t,r){return lu(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return lu(e,t)}nr(e,t){return function(s,i){let o=!1;return rI(s).Y(a=>nI(s,a,i).next(u=>(u&&(o=!0),N.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const u=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,re.min()),Cr(e).delete(function(f){return[0,Ft(f.path)]}(o))))});s.push(u)}}).next(()=>N.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return lu(e,t)}tr(e,t){const r=Cr(e);let s,i=Wt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(i!==Wt.oe&&t(new K(Vn(s)),i),i=c,s=u):i=Wt.oe}).next(()=>{i!==Wt.oe&&t(new K(Vn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lu(n,e){return Cr(n).put(function(r,s){return{targetId:0,path:Ft(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(){this.changes=new us(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,be.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Is(e).put(r)}removeEntry(e,t,r){return Is(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],dc(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=be.newInvalidDocument(t);return Is(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(na(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:be.newInvalidDocument(t)};return Is(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(na(t))},(s,i)=>{r={document:this.ir(t,i),size:pc(i)}}).next(()=>r)}getEntries(e,t){let r=Ht();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=Ht(),s=new Re(K.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,pc(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return N.resolve();let s=new xe(M_);t.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(na(s.first()),na(s.last())),o=s.getIterator();let a=o.getNext();return Is(e).J({index:"documentKeyIndex",range:i},(u,c,d)=>{const f=K.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&M_(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(na(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),dc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Is(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=Ht();for(const f of c){const m=this.ir(K.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(gl(t,m)||s.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=Ht();const o=L_(t,r),a=L_(t,on.max());return Is(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,d)=>{const f=this.ir(K.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new $P(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return O_(e).get("remoteDocumentGlobalKey").next(t=>(ee(!!t),t))}rr(e,t){return O_(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=SP(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(re.min())))return r}return be.newInvalidDocument(e)}}function iI(n){return new UP(n)}class $P extends sI{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new us(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new xe((i,o)=>le(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=E_(this.cr.serializer,o);s=s.add(i.path.popLast());const c=pc(u);r+=c-a.size,t.push(this.cr.addEntry(e,i,u))}else if(r-=a.size,this.trackRemovals){const u=E_(this.cr.serializer,o.convertToNoDocument(re.min()));t.push(this.cr.addEntry(e,i,u))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),N.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function O_(n){return rt(n,"remoteDocumentGlobal")}function Is(n){return rt(n,"remoteDocumentsV14")}function na(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function L_(n,e){const t=e.documentKey.path.toArray();return[n,dc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function M_(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=le(t[i],r[i]),s)return s;return s=le(t.length,r.length),s||(s=le(t[t.length-2],r[r.length-2]),s||le(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&xa(r.mutation,s,Qt.empty(),Le.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ue()){const s=Dn();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=ua();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Dn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ue()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Ht();const o=Ta(),a=function(){return Ta()}();return t.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof fr)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),xa(d.mutation,c,d.mutation.getFieldMask(),Le.now())):o.set(c.key,Qt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var f;return a.set(c,new zP(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Ta();let s=new Re((o,a)=>o-a),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(c===null)return;let d=r.get(u)||Qt.empty();d=a.applyToLocalView(c,d),r.set(u,d);const f=(s.get(a.batchId)||ue()).add(u);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,d=u.value,f=SE();d.forEach(m=>{if(!i.has(m)){const _=NE(t.get(m),r.get(m));_!==null&&f.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):jp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):N.resolve(Dn());let a=-1,u=i;return o.next(c=>N.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,ue())).next(d=>({batchId:a,changes:xE(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(r=>{let s=ua();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=ua();return this.indexManager.getCollectionParents(e,i).next(a=>N.forEach(a,u=>{const c=function(f,m){return new dr(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,be.newInvalidDocument(d)))});let a=ua();return o.forEach((u,c)=>{const d=i.get(u);d!==void 0&&xa(d.mutation,c,Qt.empty(),Le.now()),gl(t,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return N.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Qe(s.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:Qp(s.bundledQuery),readTime:Qe(s.readTime)}}(t)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.overlays=new Re(K.comparator),this.Ir=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Dn();return N.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),N.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){const s=Dn(),i=t.length+1,o=new K(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return N.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Re((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=Dn(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Dn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return N.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Kp(t,r));let i=this.Ir.get(t);i===void 0&&(i=ue(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(){this.sessionToken=Ke.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(){this.Tr=new xe(ot.Er),this.dr=new xe(ot.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new ot(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ot(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new K(new fe([])),r=new ot(t,e),s=new ot(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new K(new fe([])),r=new ot(t,e),s=new ot(t,e+1);let i=ue();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new ot(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ot{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return K.comparator(e.key,t.key)||le(e.wr,t.wr)}static Ar(e,t){return le(e.wr,t.wr)||K.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new xe(ot.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new zp(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new ot(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return N.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ot(t,0),s=new ot(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),N.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new xe(le);return t.forEach(s=>{const i=new ot(s,0),o=new ot(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;K.isDocumentKey(i)||(i=i.child(""));const o=new ot(new K(i),0);let a=new xe(le);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(u.wr)),!0)},o),N.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ee(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(t.mutations,s=>{const i=new ot(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new ot(t,0),s=this.br.firstAfterOrEqual(r);return N.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e){this.Mr=e,this.docs=function(){return new Re(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():be.newInvalidDocument(t))}getEntries(e,t){let r=Ht();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():be.newInvalidDocument(s))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ht();const o=t.path,a=new K(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Dp(J0(d),r)<=0||(s.has(d.key)||gl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return N.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Y()}Or(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new HP(this)}getSize(e){return N.resolve(this.size)}}class HP extends sI{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.persistence=e,this.Nr=new us(t=>Xs(t),pl),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Xp,this.targetCount=0,this.kr=ni.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),N.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new ni(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Kn(t),N.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),N.waitFor(i).next(()=>s)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),N.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),N.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Wt(0),this.Kr=!1,this.Kr=!0,this.$r=new GP,this.referenceDelegate=e(this),this.Ur=new YP(this),this.indexManager=new VP,this.remoteDocumentCache=function(s){return new QP(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new XE(t),this.Gr=new qP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new WP(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);const s=new XP(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class XP extends eE{constructor(e){super(),this.currentSequenceNumber=e}}class Wc{constructor(e){this.persistence=e,this.Jr=new Xp,this.Yr=null}static Zr(e){return new Wc(e)}get Xr(){if(this.Yr)return this.Yr;throw Y()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),N.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{const s=K.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,re.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return N.or([()=>N.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e){this.serializer=e}O(e,t,r,s){const i=new Bc("createOrUpgrade",t);r<1&&s>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Xy,{unique:!0}),u.createObjectStore("documentMutations")}(e),F_(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=N.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),F_(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Xy,{unique:!0});const f=c.store("mutations"),m=d.map(_=>f.put(_));return N.waitFor(m)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore("documentOverlays",{keyPath:NR});c.createIndex("collectionPathOverlayIndex",VR,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",DR,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:ER});c.createIndex("documentKeyIndex",IR),c.createIndex("collectionGroupIndex",TR)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:PR}).createIndex("sequenceNumberIndex",CR,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:bR}).createIndex("documentKeyIndex",kR,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=pc(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>N.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>N.forEach(a,u=>{ee(u.userId===i.userId);const c=Ps(this.serializer,u);return tI(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const u=new fe(o),c=function(f){return[0,Ft(f)]}(u);i.push(t.get(c).next(d=>d?N.resolve():(f=>t.put({targetId:0,path:Ft(f),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>N.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:RR});const r=t.store("collectionParents"),s=new Yp,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Ft(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new fe(o);return i(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],c)=>{const d=Vn(a);return i(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=ha(s),o=JE(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),u=function(f){return f.document?new K(fe.fromString(f.document.name).popFirst(5)):f.noDocument?K.fromSegments(f.noDocument.path):f.unknownDocument?K.fromSegments(f.unknownDocument.path):Y()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>N.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=iI(this.serializer),i=new aI(Wc.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var c;let d=(c=a.get(u.userId))!==null&&c!==void 0?c:ue();Ps(this.serializer,u).keys().forEach(f=>d=d.add(f)),a.set(u.userId,d)}),N.forEach(a,(u,c)=>{const d=new lt(c),f=Kc.lt(this.serializer,d),m=i.getIndexManager(d),_=Gc.lt(d,this.serializer,m,i.referenceDelegate);return new oI(s,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new sf(t,Wt.oe),u).next()})})}}function F_(n){n.createObjectStore("targetDocuments",{keyPath:SR}).createIndex("documentTargetsIndex",AR,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",xR,{unique:!0}),n.createObjectStore("targetGlobal")}const td="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Jp{constructor(e,t,r,s,i,o,a,u,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!Jp.D())throw new B(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BP(this,s),this.Ai=t+"main",this.serializer=new XE(u),this.Ri=new Fn(this.Ai,this.hi,new JP(this.serializer)),this.$r=new RP,this.Ur=new OP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=iI(this.serializer),this.Gr=new AP,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&We("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new B(O.FAILED_PRECONDITION,td);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Wt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>uu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(ls(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ra(e).get("owner").next(t=>N.resolve(this.vi(t)))}Ci(e){return uu(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=rt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return N.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?N.resolve(!0):ra(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new B(O.FAILED_PRECONDITION,td);return!1}}return!(!this.networkEnabled||!this.inForeground)||uu(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new sf(e,Wt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>uu(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Gc.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new DP(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Kc.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(u){return u===17?MR:u===16?LR:u===15?Lp:u===14?oE:u===13?iE:u===12?OR:u===11?sE:void Y()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new sf(a,this.Qr?this.Qr.next():Wt.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw We(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new B(O.FAILED_PRECONDITION,Z0);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return ra(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new B(O.FAILED_PRECONDITION,td)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ra(e).put("owner",t)}static D(){return Fn.D()}bi(e){const t=ra(e);return t.get("owner").next(r=>this.vi(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):N.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(We(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;R0()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return We("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){We("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ra(n){return rt(n,"owner")}function uu(n){return rt(n,"clientMetadata")}function Zp(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=ue(),s=ue();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new em(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return R0()?8:tE(oc())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ZP;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Ai()<=ge.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",Ri(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(Ai()<=ge.DEBUG&&U("QueryEngine","Query:",Ri(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Ai()<=ge.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",Ri(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jt(t))):N.resolve())}Yi(e,t){if(c_(t))return N.resolve(null);let r=jt(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=hc(t,null,"F"),r=jt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ue(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(t,a);return this.ns(t,c,o,u.readTime)?this.Yi(e,hc(t,null,"F")):this.rs(e,c,t,u)}))})))}Zi(e,t,r,s){return c_(t)||s.isEqual(re.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?N.resolve(null):(Ai()<=ge.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ri(t)),this.rs(e,o,t,X0(s,-1)).next(a=>a))})}ts(e,t){let r=new xe(IE(e));return t.forEach((s,i)=>{gl(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return Ai()<=ge.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Ri(t)),this.Ji.getDocumentsMatchingQuery(e,t,on.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Re(le),this._s=new us(i=>Xs(i),pl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function uI(n,e,t,r){return new eC(n,e,t,r)}async function cI(n,e){const t=G(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=ue();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function tC(n,e){const t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,c,d){const f=c.batch,m=f.keys();let _=N.resolve();return m.forEach(A=>{_=_.next(()=>d.getEntry(u,A)).next(C=>{const V=c.docVersions.get(A);ee(V!==null),C.version.compareTo(V)<0&&(f.applyToRemoteDocument(C,c),C.isValidDocument()&&(C.setReadTime(c.commitVersion),d.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ue();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function hI(n){const e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function nC(n,e){const t=G(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const m=s.get(f);if(!m)return;a.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Ke.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(f,_),function(C,V,I){return C.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,_,d)&&a.push(t.Ur.updateTargetData(i,_))});let u=Ht(),c=ue();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(dI(i,o,e.documentUpdates).next(d=>{u=d.Ps,c=d.Is})),!r.isEqual(re.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return N.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(t.os=s,i))}function dI(n,e,t){let r=ue(),s=ue();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Ht();return t.forEach((a,u)=>{const c=i.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(re.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):U("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function rC(n,e){const t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mo(n,e){const t=G(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,N.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new er(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function go(n,e,t){const r=G(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ls(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function mc(n,e,t){const r=G(n);let s=re.min(),i=ue();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const f=G(u),m=f._s.get(d);return m!==void 0?N.resolve(f.os.get(m)):f.Ur.getTargetData(c,d)}(r,o,jt(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:re.min(),t?i:ue())).next(a=>(mI(r,EE(e),a),{documents:a,Ts:i})))}function fI(n,e){const t=G(n),r=G(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function pI(n,e){const t=G(n),r=t.us.get(e)||re.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,X0(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(mI(t,e,s),s))}function mI(n,e,t){let r=n.us.get(e)||re.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}async function sC(n,e,t,r){const s=G(n);let i=ue(),o=Ht();for(const c of t){const d=e.Es(c.metadata.name);c.document&&(i=i.add(d));const f=e.ds(c);f.setReadTime(e.As(c.metadata.readTime)),o=o.insert(d,f)}const a=s.cs.newChangeBuffer({trackRemovals:!0}),u=await mo(s,function(d){return jt(Ao(fe.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>dI(c,a,o).next(d=>(a.apply(c),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(c,u.targetId).next(()=>s.Ur.addMatchingKeys(c,i,u.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,d.Ps,d.Is)).next(()=>d.Ps)))}async function iC(n,e,t=ue()){const r=await mo(n,jt(Qp(e.bundledQuery))),s=G(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Qe(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const a=r.withResumeToken(Ke.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(a.targetId,a),s.Ur.updateTargetData(i,a).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,t,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function j_(n,e){return`firestore_clients_${n}_${e}`}function B_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function nd(n,e){return`firestore_targets_${n}_${e}`}class gc{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new B(s.error.code,s.error.message))),o?new gc(e,t,s.state,i):(We("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sa{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new B(r.error.code,r.error.message))),i?new Sa(e,r.state,s):(We("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class yc{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Bp();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=nE(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new yc(e,i):(We("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class tm{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new tm(t.clientId,t.onlineState):(We("SharedClientState",`Failed to parse online state: ${e}`),null)}}class vf{constructor(){this.activeTargetIds=Bp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rd{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Re(le),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=j_(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new vf),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(j_(this.persistenceKey,r));if(s){const i=yc.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(nd(this.persistenceKey,e));if(s){const i=Sa.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(nd(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(U("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void We("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=Wt.oe;if(i!=null)try{const a=JSON.parse(i);ee(typeof a=="number"),o=a}catch(a){We("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Wt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new gc(this.currentUser,e,t,r),i=B_(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=B_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=nd(this.persistenceKey,e),i=new Sa(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return yc.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return gc.Rs(new lt(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return Sa.Rs(s,t)}Ls(e){return tm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(u=>{s.has(u)||o.push(u)}),s.forEach(u=>{i.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Bp();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class gI{constructor(){this.so=new vf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new vf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cu=null;function sd(){return cu===null?cu=function(){return 268435456+Math.round(2147483648*Math.random())}():cu++,"0x"+cu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et="WebChannelConnection";class uC extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=sd(),u=this.xo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${a}:`,u,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,u,c,s).then(d=>(U("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Bn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",s),d})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+So}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=aC[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=sd();return new Promise((o,a)=>{const u=new z0;u.setWithCredentials(!0),u.listenOnce(q0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Su.NO_ERROR:const d=u.getResponseJson();U(Et,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Su.TIMEOUT:U(Et,`RPC '${e}' ${i} timed out`),a(new B(O.DEADLINE_EXCEEDED,"Request time out"));break;case Su.HTTP_ERROR:const f=u.getStatus();if(U(Et,`RPC '${e}' ${i} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const A=function(V){const I=V.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(I)>=0?I:O.UNKNOWN}(_.status);a(new B(A,_.message))}else a(new B(O.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new B(O.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{U(Et,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);U(Et,`RPC '${e}' ${i} sending request:`,s),u.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=sd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=W0(),a=G0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=i.join("");U(Et,`Creating RPC '${e}' stream ${s}: ${d}`,u);const f=o.createWebChannel(d,u);let m=!1,_=!1;const A=new lC({Io:V=>{_?U(Et,`Not sending because RPC '${e}' stream ${s} is closed:`,V):(m||(U(Et,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),U(Et,`RPC '${e}' stream ${s} sending:`,V),f.send(V))},To:()=>f.close()}),C=(V,I,v)=>{V.listen(I,w=>{try{v(w)}catch(D){setTimeout(()=>{throw D},0)}})};return C(f,la.EventType.OPEN,()=>{_||(U(Et,`RPC '${e}' stream ${s} transport opened.`),A.yo())}),C(f,la.EventType.CLOSE,()=>{_||(_=!0,U(Et,`RPC '${e}' stream ${s} transport closed`),A.So())}),C(f,la.EventType.ERROR,V=>{_||(_=!0,Bn(Et,`RPC '${e}' stream ${s} transport errored:`,V),A.So(new B(O.UNAVAILABLE,"The operation could not be completed")))}),C(f,la.EventType.MESSAGE,V=>{var I;if(!_){const v=V.data[0];ee(!!v);const w=v,D=w.error||((I=w[0])===null||I===void 0?void 0:I.error);if(D){U(Et,`RPC '${e}' stream ${s} received error:`,D);const F=D.status;let j=function(T){const x=Xe[T];if(x!==void 0)return OE(x)}(F),E=D.message;j===void 0&&(j=O.INTERNAL,E="Unknown error status: "+F+" with message "+D.message),_=!0,A.So(new B(j,E)),f.close()}else U(Et,`RPC '${e}' stream ${s} received:`,v),A.bo(v)}}),C(a,K0.STAT_EVENT,V=>{V.stat===nf.PROXY?U(Et,`RPC '${e}' stream ${s} detected buffering proxy`):V.stat===nf.NOPROXY&&U(Et,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(){return typeof window<"u"?window:null}function Nu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(n){return new mP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&U("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,t,r,s,i,o,a,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new nm(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(We(t.toString()),We("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new B(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cC extends _I{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=_P(this.serializer,e),r=function(i){if(!("targetChange"in i))return re.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?Qe(o.readTime):re.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=pf(this.serializer),t.addTarget=function(i,o){let a;const u=o.target;if(a=uc(u)?{documents:KE(i,u)}:{query:GE(i,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=jE(i,o.resumeToken);const c=df(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(re.min())>0){a.readTime=po(i,o.snapshotVersion.toTimestamp());const c=df(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=wP(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=pf(this.serializer),t.removeTarget=e,this.a_(t)}}class hC extends _I{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ee(!!e.streamToken),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ee(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=vP(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=pf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>tl(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,ff(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new B(O.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,ff(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new B(O.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class fC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(We(t),this.D_=!1):U("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{cs(this)&&(U("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=G(u);c.L_.add(4),await Co(c),c.q_.set("Unknown"),c.L_.delete(4),await El(c)}(this))})}),this.q_=new fC(r,s)}}async function El(n){if(cs(n))for(const e of n.B_)await e(!0)}async function Co(n){for(const e of n.B_)await e(!1)}function Qc(n,e){const t=G(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),im(t)?sm(t):ko(t).r_()&&rm(t,e))}function yo(n,e){const t=G(n),r=ko(t);t.N_.delete(e),r.r_()&&vI(t,e),t.N_.size===0&&(r.r_()?r.o_():cs(t)&&t.q_.set("Unknown"))}function rm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ko(n).A_(e)}function vI(n,e){n.Q_.xe(e),ko(n).R_(e)}function sm(n){n.Q_=new hP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ko(n).start(),n.q_.v_()}function im(n){return cs(n)&&!ko(n).n_()&&n.N_.size>0}function cs(n){return G(n).L_.size===0}function wI(n){n.Q_=void 0}async function mC(n){n.q_.set("Online")}async function gC(n){n.N_.forEach((e,t)=>{rm(n,e)})}async function yC(n,e){wI(n),im(n)?(n.q_.M_(e),sm(n)):n.q_.set("Unknown")}async function _C(n,e,t){if(n.q_.set("Online"),e instanceof FE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _c(n,r)}else if(e instanceof ku?n.Q_.Ke(e):e instanceof ME?n.Q_.He(e):n.Q_.We(e),!t.isEqual(re.min()))try{const r=await hI(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.N_.get(c);d&&i.N_.set(c,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const d=i.N_.get(u);if(!d)return;i.N_.set(u,d.withResumeToken(Ke.EMPTY_BYTE_STRING,d.snapshotVersion)),vI(i,u);const f=new er(d.target,u,c,d.sequenceNumber);rm(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){U("RemoteStore","Failed to raise snapshot:",r),await _c(n,r)}}async function _c(n,e,t){if(!ls(e))throw e;n.L_.add(1),await Co(n),n.q_.set("Offline"),t||(t=()=>hI(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{U("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await El(n)})}function EI(n,e){return e().catch(t=>_c(n,t,e))}async function bo(n){const e=G(n),t=es(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;vC(e);)try{const s=await rC(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,wC(e,s)}catch(s){await _c(e,s)}II(e)&&TI(e)}function vC(n){return cs(n)&&n.O_.length<10}function wC(n,e){n.O_.push(e);const t=es(n);t.r_()&&t.V_&&t.m_(e.mutations)}function II(n){return cs(n)&&!es(n).n_()&&n.O_.length>0}function TI(n){es(n).start()}async function EC(n){es(n).p_()}async function IC(n){const e=es(n);for(const t of n.O_)e.m_(t.mutations)}async function TC(n,e,t){const r=n.O_.shift(),s=qp.from(r,e,t);await EI(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await bo(n)}async function xC(n,e){e&&es(n).V_&&await async function(r,s){if(function(o){return DE(o)&&o!==O.ABORTED}(s.code)){const i=r.O_.shift();es(r).s_(),await EI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await bo(r)}}(n,e),II(n)&&TI(n)}async function $_(n,e){const t=G(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");const r=cs(t);t.L_.add(3),await Co(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await El(t)}async function wf(n,e){const t=G(n);e?(t.L_.delete(2),await El(t)):e||(t.L_.add(2),await Co(t),t.q_.set("Unknown"))}function ko(n){return n.K_||(n.K_=function(t,r,s){const i=G(t);return i.w_(),new cC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:mC.bind(null,n),Ro:gC.bind(null,n),mo:yC.bind(null,n),d_:_C.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),im(n)?sm(n):n.q_.set("Unknown")):(await n.K_.stop(),wI(n))})),n.K_}function es(n){return n.U_||(n.U_=function(t,r,s){const i=G(t);return i.w_(),new hC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:EC.bind(null,n),mo:xC.bind(null,n),f_:IC.bind(null,n),g_:TC.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await bo(n)):(await n.U_.stop(),n.O_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new om(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new B(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function No(n,e){if(We("AsyncQueue",`${e}: ${n}`),ls(n))return new B(O.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.comparator=e?(t,r)=>e(t,r)||K.comparator(t.key,r.key):(t,r)=>K.comparator(t.key,r.key),this.keyedMap=ua(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new Xi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Xi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(){this.W_=new Re(K.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Y():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class _o{constructor(e,t,r,s,i,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new _o(e,t,Xi.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ml(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class AC{constructor(){this.queries=q_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=G(t),i=s.queries;s.queries=q_(),i.forEach((o,a)=>{for(const u of a.j_)u.onError(r)})})(this,new B(O.ABORTED,"Firestore shutting down"))}}function q_(){return new us(n=>wE(n),ml)}async function am(n,e){const t=G(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new SC,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=No(o,`Initialization of query '${Ri(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&um(t)}async function lm(n,e){const t=G(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function RC(n,e){const t=G(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&um(t)}function PC(n,e,t){const r=G(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function um(n){n.Y_.forEach(e=>{e.next()})}var Ef,K_;(K_=Ef||(Ef={})).ea="default",K_.Cache="cache";class cm{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new _o(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=_o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ef.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e){this.serializer=e}Es(e){return jn(this.serializer,e)}ds(e){return e.metadata.exists?qE(this.serializer,e.document,!1):be.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Qe(e)}}class bC{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=xI(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=fe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new G_(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||ue()).add(i);t.set(o,a)}}return t}async complete(){const e=await sC(this.localStore,new G_(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await iC(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function xI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e){this.key=e}}class AI{constructor(e){this.key=e}}class RI{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ue(),this.mutatedKeys=ue(),this.Aa=IE(e),this.Ra=new Xi(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new z_,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const m=s.get(d),_=gl(this.query,f)?f:null,A=!!m&&this.mutatedKeys.has(m.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let V=!1;m&&_?m.data.isEqual(_.data)?A!==C&&(r.track({type:3,doc:_}),V=!0):this.ga(m,_)||(r.track({type:2,doc:_}),V=!0,(u&&this.Aa(_,u)>0||c&&this.Aa(_,c)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),V=!0):m&&!_&&(r.track({type:1,doc:m}),V=!0,(u||c)&&(a=!0)),V&&(_?(o=o.add(_),i=C?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(_,A){const C=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return C(_)-C(A)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new _o(this.query,e.Ra,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new z_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ue(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new AI(r))}),this.da.forEach(r=>{e.has(r)||t.push(new SI(r))}),t}ba(e){this.Ta=e.Ts,this.da=ue();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return _o.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class kC{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class NC{constructor(e){this.key=e,this.va=!1}}class VC{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new us(a=>wE(a),ml),this.Ma=new Map,this.xa=new Set,this.Oa=new Re(K.comparator),this.Na=new Map,this.La=new Xp,this.Ba={},this.ka=new Map,this.qa=ni.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function DC(n,e,t=!0){const r=Hc(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await PI(r,e,t,!0),s}async function OC(n,e){const t=Hc(n);await PI(t,e,!0,!1)}async function PI(n,e,t,r){const s=await mo(n.localStore,jt(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await hm(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Qc(n.remoteStore,s),a}async function hm(n,e,t,r,s){n.Ka=(f,m,_)=>async function(C,V,I,v){let w=V.view.ma(I);w.ns&&(w=await mc(C.localStore,V.query,!1).then(({documents:E})=>V.view.ma(E,w)));const D=v&&v.targetChanges.get(V.targetId),F=v&&v.targetMismatches.get(V.targetId)!=null,j=V.view.applyChanges(w,C.isPrimaryClient,D,F);return If(C,V.targetId,j.wa),j.snapshot}(n,f,m,_);const i=await mc(n.localStore,e,!0),o=new RI(e,i.Ts),a=o.ma(i.documents),u=vl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,u);If(n,t,c.wa);const d=new kC(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function LC(n,e,t){const r=G(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!ml(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await go(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&yo(r.remoteStore,s.targetId),vo(r,s.targetId)}).catch(as)):(vo(r,s.targetId),await go(r.localStore,s.targetId,!0))}async function MC(n,e){const t=G(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),yo(t.remoteStore,r.targetId))}async function FC(n,e,t){const r=mm(n);try{const s=await function(o,a){const u=G(o),c=Le.now(),d=a.reduce((_,A)=>_.add(A.key),ue());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let A=Ht(),C=ue();return u.cs.getEntries(_,d).next(V=>{A=V,A.forEach((I,v)=>{v.isValidDocument()||(C=C.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,A)).next(V=>{f=V;const I=[];for(const v of a){const w=lP(v,f.get(v.key).overlayedDocument);w!=null&&I.push(new fr(v.key,w,hE(w.value.mapValue),Oe.exists(!0)))}return u.mutationQueue.addMutationBatch(_,c,I,a)}).next(V=>{m=V;const I=V.applyToLocalDocumentSet(f,C);return u.documentOverlayCache.saveOverlays(_,V.batchId,I)})}).then(()=>({batchId:m.batchId,changes:xE(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new Re(le)),c=c.insert(a,u),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await pr(r,s.changes),await bo(r.remoteStore)}catch(s){const i=No(s,"Failed to persist write");t.reject(i)}}async function CI(n,e){const t=G(n);try{const r=await nC(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ee(o.va):s.removedDocuments.size>0&&(ee(o.va),o.va=!1))}),await pr(t,r,e)}catch(r){await as(r)}}function W_(n,e,t){const r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=G(o);u.onlineState=a;let c=!1;u.queries.forEach((d,f)=>{for(const m of f.j_)m.Z_(a)&&(c=!0)}),c&&um(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function jC(n,e,t){const r=G(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Re(K.comparator);o=o.insert(i,be.newNoDocument(i,re.min()));const a=ue().add(i),u=new _l(re.min(),new Map,new Re(le),o,a);await CI(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),pm(r)}else await go(r.localStore,e,!1).then(()=>vo(r,e,t)).catch(as)}async function BC(n,e){const t=G(n),r=e.batch.batchId;try{const s=await tC(t.localStore,e);fm(t,r,null),dm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await pr(t,s)}catch(s){await as(s)}}async function UC(n,e,t){const r=G(n);try{const s=await function(o,a){const u=G(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,a).next(f=>(ee(f!==null),d=f.keys(),u.mutationQueue.removeMutationBatch(c,f))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);fm(r,e,t),dm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await pr(r,s)}catch(s){await as(s)}}async function $C(n,e){const t=G(n);cs(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=G(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();const s=t.ka.get(r)||[];s.push(e),t.ka.set(r,s)}catch(r){const s=No(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function dm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function fm(n,e,t){const r=G(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function vo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||bI(n,r)})}function bI(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(yo(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),pm(n))}function If(n,e,t){for(const r of t)r instanceof SI?(n.La.addReference(r.key,e),zC(n,r)):r instanceof AI?(U("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||bI(n,r.key)):Y()}function zC(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(U("SyncEngine","New document in limbo: "+t),n.xa.add(r),pm(n))}function pm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new K(fe.fromString(e)),r=n.qa.next();n.Na.set(r,new NC(t)),n.Oa=n.Oa.insert(t,r),Qc(n.remoteStore,new er(jt(Ao(t.path)),r,"TargetPurposeLimboResolution",Wt.oe))}}async function pr(n,e,t){const r=G(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(c){s.push(c);const f=em.Wi(u.targetId,c);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,c){const d=G(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>N.forEach(c,m=>N.forEach(m.$i,_=>d.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>N.forEach(m.Ui,_=>d.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!ls(f))throw f;U("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const _=d.os.get(m),A=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(A);d.os=d.os.insert(m,C)}}}(r.localStore,i))}async function qC(n,e){const t=G(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());const r=await cI(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(u=>{u.reject(new B(O.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await pr(t,r.hs)}}function KC(n,e){const t=G(n),r=t.Na.get(e);if(r&&r.va)return ue().add(r.key);{let s=ue();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function GC(n,e){const t=G(n),r=await mc(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&If(t,e.targetId,s.wa),s}async function WC(n,e){const t=G(n);return pI(t.localStore,e).then(r=>pr(t,r))}async function QC(n,e,t,r){const s=G(n),i=await function(a,u){const c=G(a),d=G(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,u).next(m=>m?c.localDocuments.getDocuments(f,m):N.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await bo(s.remoteStore):t==="acknowledged"||t==="rejected"?(fm(s,e,r||null),dm(s,e),function(a,u){G(G(a).mutationQueue).On(u)}(s.localStore,e)):Y(),await pr(s,i)):U("SyncEngine","Cannot apply mutation batch with id: "+e)}async function HC(n,e){const t=G(n);if(Hc(t),mm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await Q_(t,r.toArray());t.Qa=!0,await wf(t.remoteStore,!0);for(const i of s)Qc(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(vo(t,o),go(t.localStore,o,!0))),yo(t.remoteStore,o)}),await s,await Q_(t,r),function(o){const a=G(o);a.Na.forEach((u,c)=>{yo(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new Re(K.comparator)}(t),t.Qa=!1,await wf(t.remoteStore,!1)}}async function Q_(n,e,t){const r=G(n),s=[],i=[];for(const o of e){let a;const u=r.Ma.get(o);if(u&&u.length!==0){a=await mo(r.localStore,jt(u[0]));for(const c of u){const d=r.Fa.get(c),f=await GC(r,d);f.snapshot&&i.push(f.snapshot)}}else{const c=await fI(r.localStore,o);a=await mo(r.localStore,c),await hm(r,kI(c),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function kI(n){return vE(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function YC(n){return function(t){return G(G(t).persistence).Qi()}(G(n).localStore)}async function XC(n,e,t,r){const s=G(n);if(s.Qa)return void U("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await pI(s.localStore,EE(i[0])),a=_l.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ke.EMPTY_BYTE_STRING);await pr(s,o,a);break}case"rejected":await go(s.localStore,e,!0),vo(s,e,r);break;default:Y()}}async function JC(n,e,t){const r=Hc(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){U("SyncEngine","Adding an already active target "+s);continue}const i=await fI(r.localStore,s),o=await mo(r.localStore,i);await hm(r,kI(i),o.targetId,!1,o.resumeToken),Qc(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await go(r.localStore,s,!1).then(()=>{yo(r.remoteStore,s),vo(r,s)}).catch(as)}}function Hc(n){const e=G(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=CI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jC.bind(null,e),e.Ca.d_=RC.bind(null,e.eventManager),e.Ca.$a=PC.bind(null,e.eventManager),e}function mm(n){const e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=UC.bind(null,e),e}function ZC(n,e,t){const r=G(n);(async function(i,o,a){try{const u=await o.getMetadata();if(await function(_,A){const C=G(_),V=Qe(A.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",I=>C.Gr.getBundleMetadata(I,A.id)).then(I=>!!I&&I.createTime.compareTo(V)>=0)}(i.localStore,u))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(xI(u));const c=new bC(u,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const m=await c.la(d);m&&a._updateProgress(m),d=await o.Ua()}const f=await c.complete();return await pr(i,f.Ia,void 0),await function(_,A){const C=G(_);return C.persistence.runTransaction("Save bundle","readwrite",V=>C.Gr.saveBundleMetadata(V,A))}(i.localStore,u),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(u){return Bn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class nl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return uI(this.persistence,new lI,e.initialUser,this.serializer)}Ga(e){return new aI(Wc.Zr,this.serializer)}Wa(e){return new gI}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nl.provider={build:()=>new nl};class NI extends nl{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await mm(this.Ja.syncEngine),await bo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return uI(this.persistence,new lI,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new MP(r,e.asyncQueue,t)}Ha(e,t){const r=new _R(t,this.persistence);return new yR(e.asyncQueue,r)}Ga(e){const t=Zp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?qt.withCacheSize(this.cacheSizeBytes):qt.DEFAULT;return new Jp(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,yI(),Nu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new gI}}class eb extends NI{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof rd&&(this.sharedClientState.syncEngine={no:QC.bind(null,t),ro:XC.bind(null,t),io:JC.bind(null,t),Qi:YC.bind(null,t),eo:WC.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await HC(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=yI();if(!rd.D(t))throw new B(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Zp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new rd(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class rl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>W_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=qC.bind(null,this.syncEngine),await wf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AC}()}createDatastore(e){const t=wl(e.databaseInfo.databaseId),r=function(i){return new uC(i)}(e.databaseInfo);return function(i,o,a,u){return new dC(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new pC(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>W_(this.syncEngine,t,0),function(){return U_.D()?new U_:new oC}())}createSyncEngine(e,t){return function(s,i,o,a,u,c,d){const f=new VC(s,i,o,a,u,c);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=G(s);U("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Co(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}rl.provider={build:()=>new rl};function H_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):We("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new mt,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(r);return new CC(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e===123)}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new B(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,i){const o=G(s),a={documents:i.map(f=>el(o.serializer,f))},u=await o.Lo("BatchGetDocuments",o.serializer.databaseId,fe.emptyPath(),a,i.length),c=new Map;u.forEach(f=>{const m=yP(o.serializer,f);c.set(m.key.toString(),m)});const d=[];return i.forEach(f=>{const m=c.get(f.toString());ee(!!m),d.push(m)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Po(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=K.fromPath(r);this.mutations.push(new $p(s,this.precondition(s)))}),await async function(r,s){const i=G(r),o={writes:s.map(a=>tl(i.serializer,a))};await i.Mo("Commit",i.serializer.databaseId,fe.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new B(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(re.min())?Oe.exists(!1):Oe.updateTime(t):Oe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(re.min()))throw new B(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(t)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new nm(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new nb(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!fl(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!DE(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=lt.UNAUTHENTICATED,this.clientId=H0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{U("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(U("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=No(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function id(n,e){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await cI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Y_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await gm(n);U("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>$_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>$_(e.remoteStore,s)),n._onlineComponents=e}async function gm(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{await id(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===O.FAILED_PRECONDITION||s.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Bn("Error using user provided cache. Falling back to memory cache: "+t),await id(n,new nl)}}else U("FirestoreClient","Using default OfflineComponentProvider"),await id(n,new nl);return n._offlineComponents}async function Xc(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),await Y_(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),await Y_(n,new rl))),n._onlineComponents}function VI(n){return gm(n).then(e=>e.persistence)}function ym(n){return gm(n).then(e=>e.localStore)}function DI(n){return Xc(n).then(e=>e.remoteStore)}function _m(n){return Xc(n).then(e=>e.syncEngine)}function ib(n){return Xc(n).then(e=>e.datastore)}async function wo(n){const e=await Xc(n),t=e.eventManager;return t.onListen=DC.bind(null,e.syncEngine),t.onUnlisten=LC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=OC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=MC.bind(null,e.syncEngine),t}function ob(n){return n.asyncQueue.enqueue(async()=>{const e=await VI(n),t=await DI(n);return e.setNetworkEnabled(!0),function(s){const i=G(s);return i.L_.delete(0),El(i)}(t)})}function ab(n){return n.asyncQueue.enqueue(async()=>{const e=await VI(n),t=await DI(n);return e.setNetworkEnabled(!1),async function(s){const i=G(s);i.L_.add(0),await Co(i),i.q_.set("Offline")}(t)})}function lb(n,e){const t=new mt;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,d){const f=G(c);return f.persistence.runTransaction("read document","readonly",m=>f.localDocuments.getDocument(m,d))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new B(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const u=No(a,`Failed to get document '${i} from cache`);o.reject(u)}}(await ym(n),e,t)),t.promise}function OI(n,e,t={}){const r=new mt;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new Yc({next:m=>{d.Za(),o.enqueueAndForget(()=>lm(i,f));const _=m.docs.has(a);!_&&m.fromCache?c.reject(new B(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&u.source==="server"?c.reject(new B(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new cm(Ao(a.path),d,{includeMetadataChanges:!0,_a:!0});return am(i,f)}(await wo(n),n.asyncQueue,e,t,r)),r.promise}function ub(n,e){const t=new mt;return n.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await mc(s,i,!0),u=new RI(i,a.Ts),c=u.ma(a.documents),d=u.applyChanges(c,!1);o.resolve(d.snapshot)}catch(a){const u=No(a,`Failed to execute query '${i} against cache`);o.reject(u)}}(await ym(n),e,t)),t.promise}function LI(n,e,t={}){const r=new mt;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new Yc({next:m=>{d.Za(),o.enqueueAndForget(()=>lm(i,f)),m.fromCache&&u.source==="server"?c.reject(new B(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new cm(a,d,{includeMetadataChanges:!0,_a:!0});return am(i,f)}(await wo(n),n.asyncQueue,e,t,r)),r.promise}function cb(n,e){const t=new Yc(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,i){G(s).Y_.add(i),i.next()}(await wo(n),t)),()=>{t.Za(),n.asyncQueue.enqueueAndForget(async()=>function(s,i){G(s).Y_.delete(i)}(await wo(n),t))}}function hb(n,e,t,r){const s=function(o,a){let u;return u=typeof o=="string"?LE().encode(o):o,function(d,f){return new tb(d,f)}(function(d,f){if(d instanceof Uint8Array)return H_(d,f);if(d instanceof ArrayBuffer)return H_(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,wl(e));n.asyncQueue.enqueueAndForget(async()=>{ZC(await _m(n),s,r)})}function db(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const i=G(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await ym(n),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(n,e,t){if(!t)throw new B(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function FI(n,e,t,r){if(e===!0&&r===!0)throw new B(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function J_(n){if(!K.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Z_(n){if(K.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Y()}function Ee(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new B(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Jc(n);throw new B(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function jI(n,e){if(e<=0)throw new B(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new B(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new B(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=MI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Il{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ev({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new B(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new B(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ev(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oR;switch(r.type){case"firstParty":return new cR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new B(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=X_.get(t);r&&(U("ComponentProvider","Removing Datastore"),X_.delete(t),r.terminate())}(this),Promise.resolve()}}function fb(n,e,t,r={}){var s;const i=(n=Ee(n,Il))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Bn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=lt.MOCK_USER;else{a=AA(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new B(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new lt(c)}n._authCredentials=new aR(new Q0(a,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bt=class BI{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new BI(this.firestore,e,this._query)}},je=class UI{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new UI(this.firestore,e,this._key)}},qr=class $I extends Bt{constructor(e,t,r){super(e,t,Ao(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new K(e))}withConverter(e){return new $I(this.firestore,e,this._path)}};function zI(n,e,...t){if(n=Ze(n),vm("collection","path",e),n instanceof Il){const r=fe.fromString(e,...t);return Z_(r),new qr(n,null,r)}{if(!(n instanceof je||n instanceof qr))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(fe.fromString(e,...t));return Z_(r),new qr(n.firestore,null,r)}}function pb(n,e){if(n=Ee(n,Il),vm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new B(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bt(n,null,function(r){return new dr(fe.emptyPath(),r)}(e))}function vc(n,e,...t){if(n=Ze(n),arguments.length===1&&(e=H0.newId()),vm("doc","path",e),n instanceof Il){const r=fe.fromString(e,...t);return J_(r),new je(n,null,new K(r))}{if(!(n instanceof je||n instanceof qr))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(fe.fromString(e,...t));return J_(r),new je(n.firestore,n instanceof qr?n.converter:null,new K(r))}}function qI(n,e){return n=Ze(n),e=Ze(e),(n instanceof je||n instanceof qr)&&(e instanceof je||e instanceof qr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function KI(n,e){return n=Ze(n),e=Ze(e),n instanceof Bt&&e instanceof Bt&&n.firestore===e.firestore&&ml(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new nm(this,"async_queue_retry"),this.Vu=()=>{const r=Nu();r&&U("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Nu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Nu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new mt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ls(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw We("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=om.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Y()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Tf(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class mb{constructor(){this._progressObserver={},this._taskCompletionResolver=new mt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb=-1;let He=class extends Il{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new tv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tv(e),this._firestoreClient=void 0,await e}}};function St(n){if(n._terminated)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||GI(n),n._firestoreClient}function GI(n){var e,t,r;const s=n._freezeSettings(),i=function(a,u,c,d){return new BR(a,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,MI(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new sb(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(n._componentsProvider))}function yb(n,e){Bn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return WI(n,rl.provider,{build:r=>new NI(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function _b(n){Bn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();WI(n,rl.provider,{build:t=>new eb(t,e.cacheSizeBytes)})}function WI(n,e,t){if((n=Ee(n,He))._firestoreClient||n._terminated)throw new B(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new B(O.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},GI(n)}function vb(n){if(n._initialized&&!n._terminated)throw new B(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new mt;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Fn.D())return Promise.resolve();const s=r+"main";await Fn.delete(s)}(Zp(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function wb(n){return function(t){const r=new mt;return t.asyncQueue.enqueueAndForget(async()=>$C(await _m(t),r)),r.promise}(St(n=Ee(n,He)))}function Eb(n){return ob(St(n=Ee(n,He)))}function Ib(n){return ab(St(n=Ee(n,He)))}function Tb(n,e){const t=St(n=Ee(n,He)),r=new mb;return hb(t,n._databaseId,e,r),r}function xb(n,e){return db(St(n=Ee(n,He)),e).then(t=>t?new Bt(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $n(Ke.fromBase64String(e))}catch(t){throw new B(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new $n(Ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ts=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new B(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new De(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let li=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new B(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new B(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=/^__.*__$/;class Ab{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new fr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ro(e,this.data,t,this.fieldTransforms)}}class QI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new fr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function HI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}class eh{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new eh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return wc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(HI(this.Cu)&&Sb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Rb{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wl(e)}Qu(e,t,r,s=!1){return new eh({Cu:e,methodName:t,qu:r,path:De.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ui(n){const e=n._freezeSettings(),t=wl(n._databaseId);return new Rb(n._databaseId,!!e.ignoreUndefinedProperties,t)}function th(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);Rm("Data must be an object, but it was:",o,r);const a=JI(r,o);let u,c;if(i.merge)u=new Qt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const m=xf(e,f,t);if(!o.contains(m))throw new B(O.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);eT(d,m)||d.push(m)}u=new Qt(d),c=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,c=o.fieldTransforms;return new Ab(new ft(a),u,c)}class Tl extends li{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tl}}function YI(n,e,t){return new eh({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Em extends li{_toFieldTransform(e){return new yl(e.path,new ho)}isEqual(e){return e instanceof Em}}class Im extends li{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=YI(this,e,!0),r=this.Ku.map(i=>ci(i,t)),s=new Js(r);return new yl(e.path,s)}isEqual(e){return e instanceof Im&&qa(this.Ku,e.Ku)}}class Tm extends li{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=YI(this,e,!0),r=this.Ku.map(i=>ci(i,t)),s=new Zs(r);return new yl(e.path,s)}isEqual(e){return e instanceof Tm&&qa(this.Ku,e.Ku)}}class xm extends li{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new fo(e.serializer,RE(e.serializer,this.$u));return new yl(e.path,t)}isEqual(e){return e instanceof xm&&this.$u===e.$u}}function Sm(n,e,t,r){const s=n.Qu(1,e,t);Rm("Data must be an object, but it was:",s,r);const i=[],o=ft.empty();ai(r,(u,c)=>{const d=Pm(e,u,t);c=Ze(c);const f=s.Nu(d);if(c instanceof Tl)i.push(d);else{const m=ci(c,f);m!=null&&(i.push(d),o.set(d,m))}});const a=new Qt(i);return new QI(o,a,s.fieldTransforms)}function Am(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[xf(e,r,t)],u=[s];if(i.length%2!=0)throw new B(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(xf(e,i[m])),u.push(i[m+1]);const c=[],d=ft.empty();for(let m=a.length-1;m>=0;--m)if(!eT(c,a[m])){const _=a[m];let A=u[m];A=Ze(A);const C=o.Nu(_);if(A instanceof Tl)c.push(_);else{const V=ci(A,C);V!=null&&(c.push(_),d.set(_,V))}}const f=new Qt(c);return new QI(d,f,o.fieldTransforms)}function XI(n,e,t,r=!1){return ci(t,n.Qu(r?4:3,e))}function ci(n,e){if(ZI(n=Ze(n)))return Rm("Unsupported field value:",e,n),JI(n,e);if(n instanceof li)return function(r,s){if(!HI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let u=ci(a,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return RE(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Le.fromDate(r);return{timestampValue:po(s.serializer,i)}}if(r instanceof Le){const i=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:po(s.serializer,i)}}if(r instanceof Zc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $n)return{bytesValue:jE(s.serializer,r._byteString)};if(r instanceof je){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Wp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof wm)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return Up(a.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Jc(r)}`)}(n,e)}function JI(n,e){const t={};return aE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ai(n,(r,s)=>{const i=ci(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function ZI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Le||n instanceof Zc||n instanceof $n||n instanceof je||n instanceof li||n instanceof wm)}function Rm(n,e,t){if(!ZI(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Jc(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function xf(n,e,t){if((e=Ze(e))instanceof ts)return e._internalPath;if(typeof e=="string")return Pm(n,e);throw wc("Field path arguments must be of type string or ",n,!1,void 0,t)}const Pb=new RegExp("[~\\*/\\[\\]]");function Pm(n,e,t){if(e.search(Pb)>=0)throw wc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ts(...e.split("."))._internalPath}catch{throw wc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wc(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new B(O.INVALID_ARGUMENT,a+n+u)}function eT(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Cb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(nh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Cb extends sl{data(){return super.data()}}function nh(n,e){return typeof e=="string"?Pm(n,e):e instanceof ts?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new B(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cm{}class xl extends Cm{}function Tr(n,e,...t){let r=[];e instanceof Cm&&r.push(e),r=r.concat(t),function(i){const o=i.filter(u=>u instanceof bm).length,a=i.filter(u=>u instanceof rh).length;if(o>1||o>0&&a>0)throw new B(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class rh extends xl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new rh(e,t,r)}_apply(e){const t=this._parse(e);return rT(e._query,t),new Bt(e.firestore,e.converter,hf(e._query,t))}_parse(e){const t=ui(e.firestore);return function(i,o,a,u,c,d,f){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new B(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){rv(f,d);const _=[];for(const A of f)_.push(nv(u,i,A));m={arrayValue:{values:_}}}else m=nv(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||rv(f,d),m=XI(a,o,f,d==="in"||d==="not-in");return pe.create(c,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bb(n,e,t){const r=e,s=nh("where",n);return rh._create(s,r,t)}class bm extends Cm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new bm(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ie.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const u of a)rT(o,u),o=hf(o,u)}(e._query,t),new Bt(e.firestore,e.converter,hf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class km extends xl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new km(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Za(i,o)}(e._query,this._field,this._direction);return new Bt(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new dr(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function kb(n,e="asc"){const t=e,r=nh("orderBy",n);return km._create(r,t)}class sh extends xl{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new sh(e,t,r)}_apply(e){return new Bt(e.firestore,e.converter,hc(e._query,this._limit,this._limitType))}}function Nb(n){return jI("limit",n),sh._create("limit",n,"F")}function Vb(n){return jI("limitToLast",n),sh._create("limitToLast",n,"L")}class ih extends xl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new ih(e,t,r)}_apply(e){const t=nT(e,this.type,this._docOrFields,this._inclusive);return new Bt(e.firestore,e.converter,function(s,i){return new dr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,t))}}function Db(...n){return ih._create("startAt",n,!0)}function Ob(...n){return ih._create("startAfter",n,!1)}class oh extends xl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new oh(e,t,r)}_apply(e){const t=nT(e,this.type,this._docOrFields,this._inclusive);return new Bt(e.firestore,e.converter,function(s,i){return new dr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,t))}}function Lb(...n){return oh._create("endBefore",n,!1)}function Mb(...n){return oh._create("endAt",n,!0)}function nT(n,e,t,r){if(t[0]=Ze(t[0]),t[0]instanceof sl)return function(i,o,a,u,c){if(!u)throw new B(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of Yi(i))if(f.field.isKeyField())d.push(Ys(o,u.key));else{const m=u.data.field(f.field);if(Uc(m))throw new B(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=f.field.canonicalString();throw new B(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new Zr(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=ui(n.firestore);return function(o,a,u,c,d,f){const m=o.explicitOrderBy;if(d.length>m.length)throw new B(O.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let A=0;A<d.length;A++){const C=d[A];if(m[A].field.isKeyField()){if(typeof C!="string")throw new B(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof C}`);if(!jp(o)&&C.indexOf("/")!==-1)throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${C}' contains a slash.`);const V=o.path.child(fe.fromString(C));if(!K.isDocumentKey(V))throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const I=new K(V);_.push(Ys(a,I))}else{const V=XI(u,c,C);_.push(V)}}return new Zr(_,f)}(n._query,n.firestore._databaseId,s,e,t,r)}}function nv(n,e,t){if(typeof(t=Ze(t))=="string"){if(t==="")throw new B(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jp(e)&&t.indexOf("/")!==-1)throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(fe.fromString(t));if(!K.isDocumentKey(r))throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ys(n,new K(r))}if(t instanceof je)return Ys(n,t._key);throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jc(t)}.`)}function rv(n,e){if(!Array.isArray(n)||n.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rT(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Nm{convertValue(e,t="none"){switch(Hs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ai(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ne(o.doubleValue));return new wm(i)}convertGeoPoint(e){return new Zc(Ne(e.latitude),Ne(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Mp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ya(e));default:return null}}convertTimestamp(e){const t=lr(e);return new Le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=fe.fromString(e);ee(YE(r));const s=new Xr(r.get(1),r.get(3)),i=new K(r.popFirst(5));return s.isEqual(t)||We(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Fb extends Nm{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let ur=class extends sl{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Aa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(nh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Aa=class extends ur{data(e={}){return super.data(e)}},ns=class{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Os(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Aa(this._firestore,this._userDataWriter,r.key,r,new Os(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new B(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const u=new Aa(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Os(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new Aa(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Os(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:jb(a.type),doc:u,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function jb(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function sT(n,e){return n instanceof ur&&e instanceof ur?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ns&&e instanceof ns&&n._firestore===e._firestore&&KI(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(n){n=Ee(n,je);const e=Ee(n.firestore,He);return OI(St(e),n._key).then(t=>Vm(e,n,t))}class hi extends Nm{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,t)}}function Ub(n){n=Ee(n,je);const e=Ee(n.firestore,He),t=St(e),r=new hi(e);return lb(t,n._key).then(s=>new ur(e,r,n._key,s,new Os(s!==null&&s.hasLocalMutations,!0),n.converter))}function $b(n){n=Ee(n,je);const e=Ee(n.firestore,He);return OI(St(e),n._key,{source:"server"}).then(t=>Vm(e,n,t))}function zb(n){n=Ee(n,Bt);const e=Ee(n.firestore,He),t=St(e),r=new hi(e);return tT(n._query),LI(t,n._query).then(s=>new ns(e,r,n,s))}function qb(n){n=Ee(n,Bt);const e=Ee(n.firestore,He),t=St(e),r=new hi(e);return ub(t,n._query).then(s=>new ns(e,r,n,s))}function Kb(n){n=Ee(n,Bt);const e=Ee(n.firestore,He),t=St(e),r=new hi(e);return LI(t,n._query,{source:"server"}).then(s=>new ns(e,r,n,s))}function sv(n,e,t){n=Ee(n,je);const r=Ee(n.firestore,He),s=ah(n.converter,e,t);return Sl(r,[th(ui(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Oe.none())])}function iv(n,e,t,...r){n=Ee(n,je);const s=Ee(n.firestore,He),i=ui(s);let o;return o=typeof(e=Ze(e))=="string"||e instanceof ts?Am(i,"updateDoc",n._key,e,t,r):Sm(i,"updateDoc",n._key,e),Sl(s,[o.toMutation(n._key,Oe.exists(!0))])}function Gb(n){return Sl(Ee(n.firestore,He),[new Po(n._key,Oe.none())])}function Wb(n,e){const t=Ee(n.firestore,He),r=vc(n),s=ah(n.converter,e);return Sl(t,[th(ui(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function iT(n,...e){var t,r,s;n=Ze(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Tf(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Tf(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let u,c,d;if(n instanceof je)c=Ee(n.firestore,He),d=Ao(n._key.path),u={next:f=>{e[o]&&e[o](Vm(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Ee(n,Bt);c=Ee(f.firestore,He),d=f._query;const m=new hi(c);u={next:_=>{e[o]&&e[o](new ns(c,m,f,_))},error:e[o+1],complete:e[o+2]},tT(n._query)}return function(m,_,A,C){const V=new Yc(C),I=new cm(_,V,A);return m.asyncQueue.enqueueAndForget(async()=>am(await wo(m),I)),()=>{V.Za(),m.asyncQueue.enqueueAndForget(async()=>lm(await wo(m),I))}}(St(c),d,a,u)}function Qb(n,e){return cb(St(n=Ee(n,He)),Tf(e)?e:{next:e})}function Sl(n,e){return function(r,s){const i=new mt;return r.asyncQueue.enqueueAndForget(async()=>FC(await _m(r),s,i)),i.promise}(St(n),e)}function Vm(n,e,t){const r=t.docs.get(e._key),s=new hi(n);return new ur(n,s,e._key,r,new Os(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yb=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ui(e)}set(e,t,r){this._verifyNotCommitted();const s=br(e,this._firestore),i=ah(s.converter,t,r),o=th(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Oe.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=br(e,this._firestore);let o;return o=typeof(t=Ze(t))=="string"||t instanceof ts?Am(this._dataReader,"WriteBatch.update",i._key,t,r,s):Sm(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=br(e,this._firestore);return this._mutations=this._mutations.concat(new Po(t._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new B(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function br(n,e){if((n=Ze(n)).firestore!==e)throw new B(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xb=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=ui(t)}get(t){const r=br(t,this._firestore),s=new Fb(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return Y();const o=i[0];if(o.isFoundDocument())return new sl(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new sl(this._firestore,s,r._key,null,r.converter);throw Y()})}set(t,r,s){const i=br(t,this._firestore),o=ah(i.converter,r,s),a=th(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(t,r,s,...i){const o=br(t,this._firestore);let a;return a=typeof(r=Ze(r))=="string"||r instanceof ts?Am(this._dataReader,"Transaction.update",o._key,r,s,i):Sm(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=br(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=br(e,this._firestore),r=new hi(this._firestore);return super.get(e).then(s=>new ur(this._firestore,r,t._key,s._document,new Os(!1,!1),t.converter))}};function Jb(n,e,t){n=Ee(n,He);const r=Object.assign(Object.assign({},Hb),t);return function(i){if(i.maxAttempts<1)throw new B(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const u=new mt;return i.asyncQueue.enqueueAndForget(async()=>{const c=await ib(i);new rb(i.asyncQueue,c,a,o,u).au()}),u.promise}(St(n),s=>e(new Xb(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(){return new Tl("deleteField")}function ek(){return new Em("serverTimestamp")}function tk(...n){return new Im("arrayUnion",n)}function nk(...n){return new Tm("arrayRemove",n)}function rk(n){return new xm("increment",n)}(function(e,t=!0){(function(s){So=s})(bp),ao(new Ws("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new He(new lR(r.getProvider("auth-internal")),new dR(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new B(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xr(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),nr(Qy,"4.7.3",e),nr(Qy,"4.7.3","esm2017")})();const sk="@firebase/firestore-compat",ik="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new B("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(){if(typeof Uint8Array>"u")throw new B("unimplemented","Uint8Arrays are not available in this environment.")}function av(){if(!FR())throw new B("unimplemented","Blobs are unavailable in Firestore in this environment.")}class il{constructor(e){this._delegate=e}static fromBase64String(e){return av(),new il($n.fromBase64String(e))}static fromUint8Array(e){return ov(),new il($n.fromUint8Array(e))}toBase64(){return av(),this._delegate.toBase64()}toUint8Array(){return ov(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(n){return ok(n,["next","error","complete"])}function ok(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{enableIndexedDbPersistence(e,t){return yb(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return _b(e._delegate)}clearIndexedDbPersistence(e){return vb(e._delegate)}}class oT{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Xr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Bn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){fb(this._delegate,e,t,r)}enableNetwork(){return Eb(this._delegate)}disableNetwork(){return Ib(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,FI("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return wb(this._delegate)}onSnapshotsInSync(e){return Qb(this._delegate,e)}get app(){if(!this._appCompat)throw new B("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Eo(this,zI(this._delegate,e))}catch(t){throw Lt(t,"collection()","Firestore.collection()")}}doc(e){try{return new fn(this,vc(this._delegate,e))}catch(t){throw Lt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ot(this,pb(this._delegate,e))}catch(t){throw Lt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Jb(this._delegate,t=>e(new aT(this,t)))}batch(){return St(this._delegate),new lT(new Yb(this._delegate,e=>Sl(this._delegate,e)))}loadBundle(e){return Tb(this._delegate,e)}namedQuery(e){return xb(this._delegate,e).then(t=>t?new Ot(this,t):null)}}class lh extends Nm{constructor(e){super(),this.firestore=e}convertBytes(e){return new il(new $n(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return fn.forKey(t,this.firestore,null)}}function lk(n){sR(n)}class aT{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new lh(e)}get(e){const t=Ls(e);return this._delegate.get(t).then(r=>new ol(this._firestore,new ur(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=Ls(e);return r?(Dm("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=Ls(e);return arguments.length===2?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=Ls(e);return this._delegate.delete(t),this}}class lT{constructor(e){this._delegate=e}set(e,t,r){const s=Ls(e);return r?(Dm("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=Ls(e);return arguments.length===2?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=Ls(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ri{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Aa(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new al(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=ri.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(t);return i||(i=new ri(e,new lh(e),t),s.set(t,i)),i}}ri.INSTANCES=new WeakMap;class fn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new lh(e)}static forPath(e,t,r){if(e.length%2!==0)throw new B("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new fn(t,new je(t._delegate,r,new K(e)))}static forKey(e,t,r){return new fn(t,new je(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Eo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Eo(this.firestore,zI(this._delegate,e))}catch(t){throw Lt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ze(e),e instanceof je?qI(this._delegate,e):!1}set(e,t){t=Dm("DocumentReference.set",t);try{return t?sv(this._delegate,e,t):sv(this._delegate,e)}catch(r){throw Lt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?iv(this._delegate,e):iv(this._delegate,e,t,...r)}catch(s){throw Lt(s,"updateDoc()","DocumentReference.update()")}}delete(){return Gb(this._delegate)}onSnapshot(...e){const t=uT(e),r=cT(e,s=>new ol(this.firestore,new ur(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return iT(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Ub(this._delegate):(e==null?void 0:e.source)==="server"?t=$b(this._delegate):t=Bb(this._delegate),t.then(r=>new ol(this.firestore,new ur(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new fn(this.firestore,e?this._delegate.withConverter(ri.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Lt(n,e,t){return n.message=n.message.replace(e,t),n}function uT(n){for(const e of n)if(typeof e=="object"&&!Sf(e))return e;return{}}function cT(n,e){var t,r;let s;return Sf(n[0])?s=n[0]:Sf(n[1])?s=n[1]:typeof n[0]=="function"?s={next:n[0],error:n[1],complete:n[2]}:s={next:n[1],error:n[2],complete:n[3]},{next:i=>{s.next&&s.next(e(i))},error:(t=s.error)===null||t===void 0?void 0:t.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class ol{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new fn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return sT(this._delegate,e._delegate)}}class al extends ol{data(e){const t=this._delegate.data(e);return this._delegate._converter||iR(t!==void 0),t}}class Ot{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new lh(e)}where(e,t,r){try{return new Ot(this.firestore,Tr(this._delegate,bb(e,t,r)))}catch(s){throw Lt(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ot(this.firestore,Tr(this._delegate,kb(e,t)))}catch(r){throw Lt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ot(this.firestore,Tr(this._delegate,Nb(e)))}catch(t){throw Lt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ot(this.firestore,Tr(this._delegate,Vb(e)))}catch(t){throw Lt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ot(this.firestore,Tr(this._delegate,Db(...e)))}catch(t){throw Lt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ot(this.firestore,Tr(this._delegate,Ob(...e)))}catch(t){throw Lt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ot(this.firestore,Tr(this._delegate,Lb(...e)))}catch(t){throw Lt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ot(this.firestore,Tr(this._delegate,Mb(...e)))}catch(t){throw Lt(t,"endAt()","Query.endAt()")}}isEqual(e){return KI(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=qb(this._delegate):(e==null?void 0:e.source)==="server"?t=Kb(this._delegate):t=zb(this._delegate),t.then(r=>new Af(this.firestore,new ns(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=uT(e),r=cT(e,s=>new Af(this.firestore,new ns(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return iT(this._delegate,t,r)}withConverter(e){return new Ot(this.firestore,e?this._delegate.withConverter(ri.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class uk{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new al(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Af{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ot(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new al(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new uk(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new al(this._firestore,r))})}isEqual(e){return sT(this._delegate,e._delegate)}}class Eo extends Ot{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new fn(this.firestore,e):null}doc(e){try{return e===void 0?new fn(this.firestore,vc(this._delegate)):new fn(this.firestore,vc(this._delegate,e))}catch(t){throw Lt(t,"doc()","CollectionReference.doc()")}}add(e){return Wb(this._delegate,e).then(t=>new fn(this.firestore,t))}isEqual(e){return qI(this._delegate,e._delegate)}withConverter(e){return new Eo(this.firestore,e?this._delegate.withConverter(ri.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ls(n){return Ee(n,je)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(...e){this._delegate=new ts(...e)}static documentId(){return new Om(De.keyField().canonicalString())}isEqual(e){return e=Ze(e),e instanceof ts?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this._delegate=e}static serverTimestamp(){const e=ek();return e._methodName="FieldValue.serverTimestamp",new ks(e)}static delete(){const e=Zb();return e._methodName="FieldValue.delete",new ks(e)}static arrayUnion(...e){const t=tk(...e);return t._methodName="FieldValue.arrayUnion",new ks(t)}static arrayRemove(...e){const t=nk(...e);return t._methodName="FieldValue.arrayRemove",new ks(t)}static increment(e){const t=rk(e);return t._methodName="FieldValue.increment",new ks(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck={Firestore:oT,GeoPoint:Zc,Timestamp:Le,Blob:il,Transaction:aT,WriteBatch:lT,DocumentReference:fn,DocumentSnapshot:ol,Query:Ot,QueryDocumentSnapshot:al,QuerySnapshot:Af,CollectionReference:Eo,FieldPath:Om,FieldValue:ks,setLogLevel:lk,CACHE_SIZE_UNLIMITED:gb};function hk(n,e){n.INTERNAL.registerComponent(new Ws("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},ck)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(n){hk(n,(e,t)=>new oT(e,t,new ak)),n.registerVersion(sk,ik)}dk(Qs);const fk={apiKey:"AIzaSyCEvN1NTncNhRxERbFMKrNGg6h5pUxoW5U",authDomain:"shashki-a6b99.firebaseapp.com",projectId:"shashki-a6b99",storageBucket:"shashki-a6b99.firebasestorage.app",messagingSenderId:"160125139960",appId:"1:160125139960:web:e1973baf30fe245ad6f40d"};Qs.apps.length||Qs.initializeApp(fk);const an=Qs.firestore(),Tt=8,ki=()=>{const n=Array(Tt).fill(null).map(()=>Array(Tt).fill(null));for(let e=0;e<Tt;e++)for(let t=0;t<Tt;t++)(e+t)%2===1&&(e<3?n[e][t]={color:Q.BLACK,isKing:!1}:e>4&&(n[e][t]={color:Q.WHITE,isKing:!1}));return n},pk=n=>n.map(e=>e.map(t=>t?{...t}:null)),Bs=(n,e)=>{let t=[],r=!1;for(let s=0;s<Tt;s++)for(let i=0;i<Tt;i++){const o=n[s][i];if(!o||o.color!==e)continue;const a={row:s,col:i},u=Rf(n,a,o,[],[],[],a),c=mk(n,a,o);u.length>0?(r=!0,t.push(...u)):t.push(...c)}return r?t.filter(s=>s.captures.length>0):t},mk=(n,e,t)=>{const r=[],s=t.isKing?[[-1,-1],[-1,1],[1,-1],[1,1]]:t.color===Q.WHITE?[[-1,-1],[-1,1]]:[[1,-1],[1,1]];for(const[i,o]of s){let a=e.row+i,u=e.col+o;if(t.isKing)for(;a>=0&&a<Tt&&u>=0&&u<Tt&&n[a][u]===null;)r.push({from:e,to:{row:a,col:u},captures:[],path:[{row:a,col:u}],becomesKing:!1}),a+=i,u+=o;else if(a>=0&&a<Tt&&u>=0&&u<Tt&&n[a][u]===null){const c=t.color===Q.WHITE&&a===0||t.color===Q.BLACK&&a===7;r.push({from:e,to:{row:a,col:u},captures:[],path:[{row:a,col:u}],becomesKing:c})}}return r},Rf=(n,e,t,r,s,i,o)=>{const a=[],u=[[-1,-1],[-1,1],[1,-1],[1,1]];for(const[c,d]of u)if(t.isKing){let f=e.row+c,m=e.col+d;for(;f>=0&&f<Tt&&m>=0&&m<Tt;){const _=n[f][m];if(_){const A=_.color!==t.color,C=s.some(v=>v.row===f&&v.col===m);if(!A||C)break;let V=f+c,I=m+d;for(;V>=0&&V<Tt&&I>=0&&I<Tt;){const v=n[V][I],w=V===o.row&&I===o.col;if(v!==null&&!w)break;const D=[...r,{row:f,col:m}],F=[...s,{row:f,col:m}],j=[...i,{row:V,col:I}],E=Rf(n,{row:V,col:I},t,D,F,j,o);E.length>0?a.push(...E):a.push({from:o,to:{row:V,col:I},captures:D,path:j,becomesKing:!0}),V+=c,I+=d}break}f+=c,m+=d}}else{const f=e.row+c,m=e.col+d,_=e.row+2*c,A=e.col+2*d;if(_>=0&&_<Tt&&A>=0&&A<Tt){const C=n[f][m],V=n[_][A],I=C&&C.color!==t.color,v=s.some(F=>F.row===f&&F.col===m),w=_===o.row&&A===o.col;if(I&&!v&&(V===null||w)){const F=[...r,{row:f,col:m}],j=[...s,{row:f,col:m}],E=[...i,{row:_,col:A}],y=t.color===Q.WHITE&&_===0||t.color===Q.BLACK&&_===7;let T={...t};y&&(T.isKing=!0);const x=Rf(n,{row:_,col:A},T,F,j,E,o);x.length>0?a.push(...x):a.push({from:o,to:{row:_,col:A},captures:F,path:E,becomesKing:y||t.isKing})}}}return a},rs=(n,e)=>{const t=pk(n),r=t[e.from.row][e.from.col];return r&&(t[e.from.row][e.from.col]=null,t[e.to.row][e.to.col]={color:r.color,isKing:r.isKing||e.becomesKing},e.captures.forEach(s=>{t[s.row][s.col]=null})),t},gk=()=>Math.random().toString(36).substring(2,9),yk=()=>{let n=localStorage.getItem("checkers_player_id");return n||(typeof crypto<"u"&&crypto.randomUUID?n=crypto.randomUUID():n=Math.random().toString(36).substring(2)+Date.now().toString(36),localStorage.setItem("checkers_player_id",n)),{id:n,name:`Player ${n.substring(0,4)}`}},hT=async(n,e,t=!1,r)=>{const s=gk(),i=r||ki(),o=24*60*60*1e3,a=new Date(Date.now()+o),u={board:JSON.stringify(i),turn:Q.WHITE,players:{white:e===Q.WHITE?n:null,black:e===Q.BLACK?n:null},status:ae.WAITING,winner:null,version:0,halfMoveClock:0,createdAt:Date.now(),expireAt:a.getTime(),metadata:{isRandomColor:t},previousState:null,takebackRequest:null};return await an.collection("games").doc(s).set(u),s},_k=async(n,e)=>{const t=an.collection("games").doc(n);await an.runTransaction(async r=>{const s=await r.get(t);if(!s.exists)throw new Error("Game not found");const i=s.data();if(!(i.players.white===e||i.players.black===e))if(i.players.black===null&&i.players.white!==null)r.update(t,{"players.black":e,status:ae.ACTIVE,version:i.version+1});else if(i.players.white===null&&i.players.black!==null)r.update(t,{"players.white":e,status:ae.ACTIVE,version:i.version+1});else throw new Error("Game is full")})},vk=(n,e)=>an.collection("games").doc(n).onSnapshot(t=>{t.exists&&e(t.data())}),wk=async(n,e,t,r)=>{const s=an.collection("games").doc(n),i=JSON.parse(e.board),o=i[t.from.row][t.from.col],a=o&&!o.isKing,u=t.captures.length>0,c=rs(i,t);let d=e.status,f=null;Bs(c,r).length===0&&(d=ae.FINISHED,f=e.turn);let _=0,A=0,C=0,V=0;for(let I=0;I<8;I++)for(let v=0;v<8;v++){const w=c[I][v];w&&(w.color===Q.WHITE?(_++,w.isKing&&C++):(A++,w.isKing&&V++))}d!==ae.FINISHED&&_===1&&C===1&&A===1&&V===1&&(d=ae.DRAW),await an.runTransaction(async I=>{const v=await I.get(s);if(!v.exists)throw new Error("Game missing");const w=v.data();if(w.version!==e.version)throw new Error("Game state has changed, reload recommended");let D=w.halfMoveClock+1;(a||u)&&(D=0),d!==ae.FINISHED&&d!==ae.DRAW&&D>=60&&(d=ae.DRAW);const F=24*60*60*1e3,j=Date.now()+F,E={board:w.board,turn:w.turn,halfMoveClock:w.halfMoveClock,lastMove:w.lastMove||null};I.update(s,{board:JSON.stringify(c),turn:r,lastMove:{from:t.from,to:t.to,path:t.path,ts:Date.now()},halfMoveClock:D,status:d,winner:f,version:w.version+1,expireAt:j,previousState:E,takebackRequest:null})})},Ek=async(n,e)=>{await an.collection("games").doc(n).update({takebackRequest:{requesterId:e,createdAt:Date.now()},version:Qs.firestore.FieldValue.increment(1)})},Ik=async(n,e)=>{const t=an.collection("games").doc(n);await an.runTransaction(async r=>{const s=await r.get(t);if(!s.exists)return;const i=s.data();if(!e){r.update(t,{takebackRequest:null,version:i.version+1});return}i.previousState?r.update(t,{board:i.previousState.board,turn:i.previousState.turn,halfMoveClock:i.previousState.halfMoveClock,lastMove:i.previousState.lastMove||Qs.firestore.FieldValue.delete(),previousState:null,takebackRequest:null,version:i.version+1}):r.update(t,{takebackRequest:null,version:i.version+1})})},Tk=async(n,e)=>{const t=an.collection("games").doc(n);await an.runTransaction(async r=>{const s=await r.get(t);if(!s.exists)return;const i=s.data();let o=null;i.players.white===e&&(o=Q.BLACK),i.players.black===e&&(o=Q.WHITE),o&&r.update(t,{status:ae.FINISHED,winner:o,version:i.version+1})})},xk=async(n,e,t,r)=>{const s=an.collection("games").doc(n);return await an.runTransaction(async i=>{const o=await i.get(s);if(!o.exists)throw new Error("Game not found");const a=o.data();if(a.rematchId)return a.rematchId;const u=t===Q.WHITE?Q.BLACK:Q.WHITE,c=await hT(e,u,r);return i.update(s,{rematchId:c}),c})},Sk=3,Ak=2,Us=1e6,Lm=500,xr={WIN:1e5,KING:800,PIECE:100,BACK_ROW:40,CENTER:15,ADVANCE:8},Pf=(n,e)=>{let t=0;for(let r=0;r<8;r++)for(let s=0;s<8;s++){const i=n[r][s];if(!i)continue;let o=0;o+=i.isKing?xr.KING:xr.PIECE,s>=2&&s<=5&&r>=2&&r<=5&&(o+=xr.CENTER),i.isKing||(i.color===Q.WHITE?o+=(7-r)*xr.ADVANCE:o+=r*xr.ADVANCE),i.color===Q.WHITE&&r===7&&!i.isKing&&(o+=xr.BACK_ROW),i.color===Q.BLACK&&r===0&&!i.isKing&&(o+=xr.BACK_ROW),i.color===e?t+=o:t-=o}return t};let Ec=0;const Cf=(n,e,t,r,s,i)=>{if(Date.now()-Ec>Lm)return Pf(n,s);const o=r?s:s===Q.WHITE?Q.BLACK:Q.WHITE,a=Bs(n,o);if(!(a.length>0&&a[0].captures.length>0)||i===0)return Pf(n,s);if(r){let c=-Us;a.sort((d,f)=>f.captures.length-d.captures.length);for(const d of a){const f=rs(n,d),m=Cf(f,e,t,!1,s,i-1);if(c=Math.max(c,m),e=Math.max(e,m),t<=e)break}return c}else{let c=Us;a.sort((d,f)=>f.captures.length-d.captures.length);for(const d of a){const f=rs(n,d),m=Cf(f,e,t,!0,s,i-1);if(c=Math.min(c,m),t=Math.min(t,m),t<=e)break}return c}},bf=(n,e,t,r,s,i)=>{if(Date.now()-Ec>Lm)return Pf(n,i);if(e===0)return Cf(n,t,r,s,i,Ak);const o=s?i:i===Q.WHITE?Q.BLACK:Q.WHITE,a=Bs(n,o);if(a.length===0)return s?-1e5+e:xr.WIN-e;if(s){let u=-Us;a.sort((c,d)=>d.captures.length-c.captures.length);for(const c of a){const d=rs(n,c),f=bf(d,e-1,t,r,!1,i);if(u=Math.max(u,f),t=Math.max(t,f),r<=t)break}return u}else{let u=Us;a.sort((c,d)=>d.captures.length-c.captures.length);for(const c of a){const d=rs(n,c),f=bf(d,e-1,t,r,!0,i);if(u=Math.min(u,f),r=Math.min(r,f),r<=t)break}return u}},Rk=(n,e)=>{const t=Bs(n,e);if(t.length===0)return null;if(t.length===1)return t[0];Ec=Date.now();let r=null,s=-Us;t.sort(()=>Math.random()-.5),t.sort((i,o)=>o.captures.length-i.captures.length);for(const i of t){if(Date.now()-Ec>Lm)break;const o=rs(n,i),a=bf(o,Sk-1,-Us,Us,!1,e);a>s&&(s=a,r=i)}return r||t[0]},Pk=({board:n,validMoves:e,selectedPos:t,onSquareClick:r,onMovePiece:s,lastMove:i,rotated:o=!1})=>{const a=H.useRef(null),u=H.useRef(n),{movesStartMap:c}=H.useMemo(()=>{const se=new Map;return e.forEach(te=>{const X=`${te.from.row}-${te.from.col}`;se.has(X)||se.set(X,[]),se.get(X).push(te)}),{movesStartMap:se}},[e]),[d,f]=H.useState({isDragging:!1,startPos:null,currentX:0,currentY:0,hasMoved:!1}),[m,_]=H.useState(null),[A,C]=H.useState(null),V=H.useRef(i),[I,v]=H.useState([]);H.useEffect(()=>{if(i&&i!==V.current&&(!V.current||i.from.row!==V.current.from.row||i.from.col!==V.current.from.col||i.to.row!==V.current.to.row||i.to.col!==V.current.to.col)){const X=n[i.to.row][i.to.col];if(X){const M=i.path?[...i.path]:[i.to],q=M[M.length-1];(q.row!==i.to.row||q.col!==i.to.col)&&M.push(i.to);const Z=[i.from,...M];C({piece:X,currentPathIndex:0,fullPath:Z,style:x(i.from.row,i.from.col)})}}V.current=i;const se=[];if(i)for(let te=0;te<8;te++)for(let X=0;X<8;X++){const M=u.current[te][X],q=n[te][X];M&&!q&&(te!==i.from.row||X!==i.from.col)&&se.push({piece:M,r:te,c:X})}se.length>0&&(v(te=>[...te,...se]),setTimeout(()=>{v(te=>te.filter(X=>!se.includes(X)))},600)),u.current=n},[i,n]),H.useEffect(()=>{if(!A)return;const se=A.fullPath.length>2,te=A.currentPathIndex===A.fullPath.length-2,q=se&&!te?220:350,Z=se&&!te?"linear":"cubic-bezier(0.25, 1, 0.5, 1)";if(A.currentPathIndex<A.fullPath.length-1){const oe=A.currentPathIndex+1,ie=A.fullPath[oe],ne=A.currentPathIndex===0?50:q,ce=setTimeout(()=>{C(Ue=>Ue?{...Ue,currentPathIndex:oe,style:{...x(ie.row,ie.col),transition:`top ${q}ms ${Z}, left ${q}ms ${Z}`}}:null)},ne);return()=>clearTimeout(ce)}else{const oe=setTimeout(()=>{C(null)},q);return()=>clearTimeout(oe)}},[A==null?void 0:A.currentPathIndex]);const w=(se,te)=>{if(!a.current)return null;const X=a.current.getBoundingClientRect(),M=se-X.left,q=te-X.top;if(M<0||M>X.width||q<0||q>X.height)return null;const Z=Math.floor(M/X.width*8),oe=Math.floor(q/X.height*8),ie=Math.max(0,Math.min(7,Z)),ne=Math.max(0,Math.min(7,oe));return o?{row:7-ne,col:7-ie}:{row:ne,col:ie}};H.useEffect(()=>{const se=X=>{if(!d.isDragging)return;X.preventDefault();const M=X.clientX-D.current,q=X.clientY-F.current,Z=d.hasMoved||Math.abs(M)>5||Math.abs(q)>5;f(ie=>({...ie,currentX:M,currentY:q,hasMoved:Z}));const oe=w(X.clientX,X.clientY);if(oe&&d.startPos){const ie=`${d.startPos.row}-${d.startPos.col}`,ne=c.get(ie),ce=ne==null?void 0:ne.find(Ue=>Ue.to.row===oe.row&&Ue.to.col===oe.col);_(ce||null)}else _(null)},te=X=>{if(!d.isDragging||!d.startPos)return;const M=w(X.clientX,X.clientY);let q=!1;if(M&&d.hasMoved&&(M.row!==d.startPos.row||M.col!==d.startPos.col)){const Z=`${d.startPos.row}-${d.startPos.col}`,oe=c.get(Z);(oe==null?void 0:oe.find(ne=>ne.to.row===M.row&&ne.to.col===M.col))&&(s(d.startPos,M),q=!0)}q||r(d.startPos),f({isDragging:!1,startPos:null,currentX:0,currentY:0,hasMoved:!1}),_(null)};return d.isDragging&&(window.addEventListener("pointermove",se),window.addEventListener("pointerup",te)),()=>{window.removeEventListener("pointermove",se),window.removeEventListener("pointerup",te)}},[d,s,c,r]);const D=H.useRef(0),F=H.useRef(0),j=(se,te,X)=>{se.button===0&&(se.preventDefault(),se.stopPropagation(),D.current=se.clientX,F.current=se.clientY,f({isDragging:!0,startPos:{row:te,col:X},currentX:0,currentY:0,hasMoved:!1}))},E=(se,te)=>{if(!d.isDragging&&t){const X=`${t.row}-${t.col}`,M=c.get(X),q=M==null?void 0:M.find(Z=>Z.to.row===se&&Z.to.col===te);_(q||null)}},y=()=>{d.isDragging||_(null)},T=se=>{se.stopPropagation()},x=(se,te)=>o?{top:`${(7-se)*12.5}%`,left:`${(7-te)*12.5}%`}:{top:`${se*12.5}%`,left:`${te*12.5}%`},P=(se,te)=>(se+te)%2===1,b=(se,te,X,M=!1,q,Z="")=>{var bt,_n;const oe=se.color===Q.WHITE,ie=q||x(te,X),ne=!M&&d.isDragging&&((bt=d.startPos)==null?void 0:bt.row)===te&&((_n=d.startPos)==null?void 0:_n.col)===X;if(!M&&A&&A.piece===se&&te===(i==null?void 0:i.to.row)&&X===(i==null?void 0:i.to.col))return null;const Ue=se.isKing,At=oe?"bg-gradient-to-br from-[#f0e4cc] via-[#e6dcc0] to-[#d6c4a8]":"bg-gradient-to-br from-[#383838] via-[#242424] to-[#121212]",Rt=oe?"border-[#bcaaa4]":"border-gray-700",Pt="shadow-[0_4px_8px_rgba(0,0,0,0.5),_0_8px_16px_rgba(0,0,0,0.3)]",Ct=ne?{transform:`translate(${d.currentX}px, ${d.currentY}px)`,zIndex:50,cursor:"grabbing",pointerEvents:"none"}:{zIndex:M?20:30,cursor:M?"default":"pointer",touchAction:"none",pointerEvents:M?"none":"auto"},st=ne?"scale-110 shadow-2xl":M?"scale-100":"transition-transform duration-100 ease-out hover:scale-105";return R.jsx("div",{className:`absolute w-[12.5%] h-[12.5%] flex items-center justify-center will-change-transform ${Z}`,style:{...ie,...Ct},onPointerDown:M?void 0:kt=>j(kt,te,X),onClick:M?void 0:T,onPointerEnter:M?void 0:()=>E(te,X),onPointerLeave:M?void 0:y,children:R.jsxs("div",{className:`
              w-[85%] h-[85%] rounded-full ${At} ${Pt}
              flex items-center justify-center relative
              border-[1px] ${oe?"border-[#f5f0e1]":"border-[#444]"}
              ${st}
            `,children:[R.jsx("div",{className:`w-[75%] h-[75%] rounded-full border-[3px] opacity-20 ${Rt} shadow-inner absolute`}),Ue&&R.jsx("div",{className:"absolute inset-0 flex items-center justify-center animate-fade-in",children:R.jsxs("svg",{viewBox:"0 0 24 24",className:"w-[60%] h-[60%] drop-shadow-md",fill:"url(#goldGradient)",children:[R.jsx("defs",{children:R.jsxs("linearGradient",{id:"goldGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[R.jsx("stop",{offset:"0%",stopColor:"#FFD700"}),R.jsx("stop",{offset:"50%",stopColor:"#FDB931"}),R.jsx("stop",{offset:"100%",stopColor:"#DAA520"})]})}),R.jsx("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z"})]})})]})},`p-${te}-${X}${M?"-ghost":""}`)},S=()=>{const se=[],te=[];let X,M;d.isDragging&&d.startPos?(X=d.startPos.row,M=d.startPos.col):t&&(X=t.row,M=t.col);const q=X!==void 0&&M!==void 0?n[X][M]:null,Z=["A","B","C","D","E","F","G","H"],oe=["8","7","6","5","4","3","2","1"];let ie=[];if(X!==void 0&&M!==void 0){const ne=`${X}-${M}`,ce=c.get(ne);ce&&(ie=ce)}for(let ne=0;ne<8;ne++)for(let ce=0;ce<8;ce++){const Ue=P(ne,ce),At=(t==null?void 0:t.row)===ne&&(t==null?void 0:t.col)===ce,Rt=(i==null?void 0:i.from.row)===ne&&(i==null?void 0:i.from.col)===ce,Pt=(i==null?void 0:i.to.row)===ne&&(i==null?void 0:i.to.col)===ce;let Ct=!1,st=!1,bt=!1,_n;if(ie.length>0)for(const zt of ie)zt.to.row===ne&&zt.to.col===ce?(st=!0,_n=zt,zt.becomesKing&&q&&!q.isKing&&(bt=!0)):zt.path.some(vn=>vn.row===ne&&vn.col===ce)&&(Ct=!0);let kt=Ue?"bg-[#8B5A2B]":"bg-[#E3C193]";const ds=Rt||Pt?"bg-yellow-500/40":"",mr=At?"bg-[#5e4b35]/60 ring-inset ring-4 ring-[#ffff00]/50":"",fs=x(ne,ce),di=o?ce===7:ce===0,fi=o?ne===0:ne===7,ps=Ue?"text-[#E3C193]":"text-[#8B5A2B]";if(st&&q&&_n){const zt=(m==null?void 0:m.to.row)===ne&&(m==null?void 0:m.to.col)===ce;let vn=m?zt?.7:.2:.35;const zn={...q,isKing:bt?!0:q.isKing};te.push(b(zn,ne,ce,!0,{...fs,opacity:vn}))}se.push(R.jsxs("div",{"data-pos":`${ne}-${ce}`,className:`absolute w-[12.5%] h-[12.5%] box-border ${kt} ${ds} ${mr} flex items-center justify-center`,style:fs,onClick:()=>r({row:ne,col:ce}),onPointerEnter:()=>E(ne,ce),onPointerLeave:y,children:[di&&R.jsx("span",{className:`absolute top-1 left-1 text-[10px] lg:text-xs font-bold ${ps} select-none pointer-events-none z-20 opacity-90`,children:oe[ne]}),fi&&R.jsx("span",{className:`absolute bottom-0.5 right-1 text-[10px] lg:text-xs font-bold ${ps} select-none pointer-events-none z-20 opacity-90`,children:Z[ce]}),Ct&&!st&&R.jsx("div",{className:"w-3 h-3 rounded-full bg-stone-900/30 shadow-inner pointer-events-none z-10"})]},`sq-${ne}-${ce}`))}return[...se,...te]},Ye=()=>{const se=[];for(let te=0;te<8;te++)for(let X=0;X<8;X++){const M=n[te][X];M&&se.push(b(M,te,X))}return I.forEach(te=>{se.push(b(te.piece,te.r,te.c,!0,void 0,"animate-fadeOut opacity-0"))}),A&&se.push(b(A.piece,0,0,!0,{...A.style,zIndex:100,opacity:1})),se};return R.jsxs("div",{className:"relative w-full h-full shadow-[0_20px_50px_rgba(0,0,0,0.7)] border-[12px] md:border-[16px] lg:border-[20px] border-[#3e2723] rounded-md bg-[#3e2723] select-none",style:{touchAction:"none"},children:[R.jsx("style",{children:`
        @keyframes fadeOut {
          0% { opacity: 1; transform: scale(1); }
          50% { opacity: 1; transform: scale(0.9); }
          100% { opacity: 0; transform: scale(0.5); }
        }
        .animate-fadeOut {
          animation: fadeOut 0.6s forwards;
        }
      `}),R.jsxs("div",{ref:a,className:"w-full h-full relative overflow-hidden bg-[#E3C193]",children:[S(),Ye()]})]})};let Ck={data:""},bk=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||Ck},kk=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Nk=/\/\*[^]*?\*\/|  +/g,lv=/\n+/g,kr=(n,e)=>{let t="",r="",s="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":r+=i[1]=="f"?kr(o,i):i+"{"+kr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=kr(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,a):a?a+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=kr.p?kr.p(i,o):i+":"+o+";")}return t+(e&&s?e+"{"+s+"}":s)+r},Hn={},dT=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+dT(n[t]);return e}return n},Vk=(n,e,t,r,s)=>{let i=dT(n),o=Hn[i]||(Hn[i]=(u=>{let c=0,d=11;for(;c<u.length;)d=101*d+u.charCodeAt(c++)>>>0;return"go"+d})(i));if(!Hn[o]){let u=i!==n?n:(c=>{let d,f,m=[{}];for(;d=kk.exec(c.replace(Nk,""));)d[4]?m.shift():d[3]?(f=d[3].replace(lv," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][d[1]]=d[2].replace(lv," ").trim();return m[0]})(n);Hn[o]=kr(s?{["@keyframes "+o]:u}:u,t?"":"."+o)}let a=t&&Hn.g?Hn.g:null;return t&&(Hn.g=Hn[o]),((u,c,d,f)=>{f?c.data=c.data.replace(f,u):c.data.indexOf(u)===-1&&(c.data=d?u+c.data:c.data+u)})(Hn[o],e,r,a),o},Dk=(n,e,t)=>n.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(t),u=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=u?"."+u:a&&typeof a=="object"?a.props?"":kr(a,""):a===!1?"":a}return r+s+(o??"")},"");function uh(n){let e=this||{},t=n.call?n(e.p):n;return Vk(t.unshift?t.raw?Dk(t,[].slice.call(arguments,1),e.p):t.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):t,bk(e.target),e.g,e.o,e.k)}let fT,kf,Nf;uh.bind({g:1});let cr=uh.bind({k:1});function Ok(n,e,t,r){kr.p=e,fT=n,kf=t,Nf=r}function hs(n,e){let t=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),u=a.className||s.className;t.p=Object.assign({theme:kf&&kf()},a),t.o=/ *go\d+/.test(u),a.className=uh.apply(t,r)+(u?" "+u:"");let c=n;return n[0]&&(c=a.as||n,delete a.as),Nf&&c[0]&&Nf(a),fT(c,a)}return s}}var Lk=n=>typeof n=="function",Ic=(n,e)=>Lk(n)?n(e):n,Mk=(()=>{let n=0;return()=>(++n).toString()})(),pT=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),Fk=20,Mm="default",mT=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return mT(n,{type:n.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...n,toasts:n.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Vu=[],gT={toasts:[],pausedAt:void 0,settings:{toastLimit:Fk}},On={},yT=(n,e=Mm)=>{On[e]=mT(On[e]||gT,n),Vu.forEach(([t,r])=>{t===e&&r(On[e])})},_T=n=>Object.keys(On).forEach(e=>yT(n,e)),jk=n=>Object.keys(On).find(e=>On[e].toasts.some(t=>t.id===n)),ch=(n=Mm)=>e=>{yT(e,n)},Bk={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Uk=(n={},e=Mm)=>{let[t,r]=H.useState(On[e]||gT),s=H.useRef(On[e]);H.useEffect(()=>(s.current!==On[e]&&r(On[e]),Vu.push([e,r]),()=>{let o=Vu.findIndex(([a])=>a===e);o>-1&&Vu.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var a,u,c;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((a=n[o.type])==null?void 0:a.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||Bk[o.type],style:{...n.style,...(c=n[o.type])==null?void 0:c.style,...o.style}}});return{...t,toasts:i}},$k=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Mk()}),Al=n=>(e,t)=>{let r=$k(e,n,t);return ch(r.toasterId||jk(r.id))({type:2,toast:r}),r.id},me=(n,e)=>Al("blank")(n,e);me.error=Al("error");me.success=Al("success");me.loading=Al("loading");me.custom=Al("custom");me.dismiss=(n,e)=>{let t={type:3,toastId:n};e?ch(e)(t):_T(t)};me.dismissAll=n=>me.dismiss(void 0,n);me.remove=(n,e)=>{let t={type:4,toastId:n};e?ch(e)(t):_T(t)};me.removeAll=n=>me.remove(void 0,n);me.promise=(n,e,t)=>{let r=me.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(s=>{let i=e.success?Ic(e.success,s):void 0;return i?me.success(i,{id:r,...t,...t==null?void 0:t.success}):me.dismiss(r),s}).catch(s=>{let i=e.error?Ic(e.error,s):void 0;i?me.error(i,{id:r,...t,...t==null?void 0:t.error}):me.dismiss(r)}),n};var zk=1e3,qk=(n,e="default")=>{let{toasts:t,pausedAt:r}=Uk(n,e),s=H.useRef(new Map).current,i=H.useCallback((f,m=zk)=>{if(s.has(f))return;let _=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},m);s.set(f,_)},[]);H.useEffect(()=>{if(r)return;let f=Date.now(),m=t.map(_=>{if(_.duration===1/0)return;let A=(_.duration||0)+_.pauseDuration-(f-_.createdAt);if(A<0){_.visible&&me.dismiss(_.id);return}return setTimeout(()=>me.dismiss(_.id,e),A)});return()=>{m.forEach(_=>_&&clearTimeout(_))}},[t,r,e]);let o=H.useCallback(ch(e),[e]),a=H.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=H.useCallback((f,m)=>{o({type:1,toast:{id:f,height:m}})},[o]),c=H.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),d=H.useCallback((f,m)=>{let{reverseOrder:_=!1,gutter:A=8,defaultPosition:C}=m||{},V=t.filter(w=>(w.position||C)===(f.position||C)&&w.height),I=V.findIndex(w=>w.id===f.id),v=V.filter((w,D)=>D<I&&w.visible).length;return V.filter(w=>w.visible).slice(..._?[v+1]:[0,v]).reduce((w,D)=>w+(D.height||0)+A,0)},[t]);return H.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let m=s.get(f.id);m&&(clearTimeout(m),s.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:a,endPause:c,calculateOffset:d}}},Kk=cr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Gk=cr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Wk=cr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Qk=hs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Kk} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Gk} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Wk} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Hk=cr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Yk=hs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${Hk} 1s linear infinite;
`,Xk=cr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Jk=cr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Zk=hs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Xk} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Jk} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,e2=hs("div")`
  position: absolute;
`,t2=hs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,n2=cr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,r2=hs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${n2} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,s2=({toast:n})=>{let{icon:e,type:t,iconTheme:r}=n;return e!==void 0?typeof e=="string"?H.createElement(r2,null,e):e:t==="blank"?null:H.createElement(t2,null,H.createElement(Yk,{...r}),t!=="loading"&&H.createElement(e2,null,t==="error"?H.createElement(Qk,{...r}):H.createElement(Zk,{...r})))},i2=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,o2=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,a2="0%{opacity:0;} 100%{opacity:1;}",l2="0%{opacity:1;} 100%{opacity:0;}",u2=hs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,c2=hs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,h2=(n,e)=>{let t=n.includes("top")?1:-1,[r,s]=pT()?[a2,l2]:[i2(t),o2(t)];return{animation:e?`${cr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${cr(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},d2=H.memo(({toast:n,position:e,style:t,children:r})=>{let s=n.height?h2(n.position||e||"top-center",n.visible):{opacity:0},i=H.createElement(s2,{toast:n}),o=H.createElement(c2,{...n.ariaProps},Ic(n.message,n));return H.createElement(u2,{className:n.className,style:{...s,...t,...n.style}},typeof r=="function"?r({icon:i,message:o}):H.createElement(H.Fragment,null,i,o))});Ok(H.createElement);var f2=({id:n,className:e,style:t,onHeightUpdate:r,children:s})=>{let i=H.useCallback(o=>{if(o){let a=()=>{let u=o.getBoundingClientRect().height;r(n,u)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,r]);return H.createElement("div",{ref:i,className:e,style:t},s)},p2=(n,e)=>{let t=n.includes("top"),r=t?{top:0}:{bottom:0},s=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:pT()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...s}},m2=uh`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,hu=16,du=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:u,handlers:c}=qk(t,i);return H.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:hu,left:hu,right:hu,bottom:hu,pointerEvents:"none",...o},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},u.map(d=>{let f=d.position||e,m=c.calculateOffset(d,{reverseOrder:n,gutter:r,defaultPosition:e}),_=p2(f,m);return H.createElement(f2,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?m2:"",style:_},d.type==="custom"?Ic(d.message,d):s?s(d):H.createElement(d2,{toast:d,position:f}))}))};const g2=({gameId:n,gameData:e,playerId:t,onCancel:r})=>{var _;const s=`${window.location.origin}${window.location.pathname}`,i=`${s}${s.includes("?")?"&":"?"}game=${n}`,o=`https://api.qrserver.com/v1/create-qr-code/?size=250x250&color=e3c193&bgcolor=2a2622&data=${encodeURIComponent(i)}`,a=()=>{navigator.clipboard.writeText(i),me.success(" !")},u=(_=e.metadata)==null?void 0:_.isRandomColor,d=(e.players.white===t?Q.WHITE:Q.BLACK)===Q.WHITE,f=u?" ":d?"":"",m=u?"":d?"":"";return R.jsx("div",{className:"flex flex-col items-center justify-center w-full max-w-4xl px-4 animate-fade-in",children:R.jsxs("div",{className:"w-full bg-[#2a2622] rounded-xl shadow-2xl border border-stone-700 overflow-hidden",children:[R.jsxs("div",{className:"bg-[#3d3632] p-6 border-b border-stone-600 flex flex-col md:flex-row justify-between items-center gap-4",children:[R.jsxs("div",{children:[R.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-[#e3c193] mb-1",children:" "}),R.jsx("p",{className:"text-stone-400 text-sm uppercase tracking-wider",children:"   8x8"})]}),R.jsxs("div",{className:"flex items-center gap-2 bg-[#2a2622] px-3 py-1.5 rounded-full border border-stone-700",children:[R.jsx("span",{className:"animate-pulse w-2.5 h-2.5 rounded-full bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)]"}),R.jsx("span",{className:"text-stone-300 text-xs font-bold uppercase tracking-wider",children:" ..."})]})]}),R.jsxs("div",{className:"p-6 lg:p-10 grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-start",children:[R.jsxs("div",{className:"space-y-6",children:[R.jsxs("div",{className:"bg-[#1e1b18] rounded-lg border border-stone-700/50 overflow-hidden",children:[R.jsxs("div",{className:"p-4 flex items-center gap-4 border-b border-stone-700/50 bg-[#25211d]",children:[u?R.jsx("div",{className:"w-12 h-12 rounded-full shadow-lg border-2 border-stone-500 bg-gradient-to-br from-[#f0e4cc] to-[#383838] flex items-center justify-center relative overflow-hidden",children:R.jsx("span",{className:"text-stone-800 font-bold text-lg mix-blend-difference z-10",children:"?"})}):R.jsx("div",{className:`w-12 h-12 rounded-full shadow-lg border-2 flex items-center justify-center ${d?"bg-[#f0e4cc] border-[#e6dcc0]":"bg-[#383838] border-[#555]"}`,children:R.jsx("div",{className:`w-8 h-8 rounded-full border-2 opacity-50 ${d?"border-[#bcaaa4]":"border-gray-600"}`})}),R.jsxs("div",{children:[R.jsx("div",{className:"text-[#e3c193] font-bold text-lg leading-tight",children:u?" ":`  ${f}`}),R.jsx("div",{className:"text-stone-500 text-xs font-bold uppercase tracking-wider mt-0.5",children:u?"  ":" "})]})]}),R.jsx("div",{className:"p-3 bg-[#1e1b18] text-center",children:R.jsxs("span",{className:"text-stone-400 text-sm",children:["  ",m,"..."]})})]}),R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-stone-500 text-xs font-bold uppercase tracking-widest",children:"  "}),R.jsxs("div",{className:"flex gap-0 shadow-lg rounded-lg overflow-hidden group",children:[R.jsx("input",{readOnly:!0,value:i,className:"bg-[#1e1b18] text-stone-300 px-4 py-4 w-full outline-none font-mono text-xs md:text-sm border-y border-l border-stone-700 group-hover:border-stone-500 transition-colors",onClick:A=>A.target.select()}),R.jsx("button",{onClick:a,className:"bg-[#3d3632] hover:bg-stone-600 text-stone-200 px-6 font-bold border border-stone-700 border-l-0 transition-colors",title:"",children:""})]})]})]}),R.jsxs("div",{className:"flex flex-col items-center justify-center space-y-6 h-full",children:[R.jsx("div",{className:"p-4 bg-white rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-300",children:R.jsx("img",{src:o,alt:"Scan to Join",className:"w-40 h-40 lg:w-48 lg:h-48 mix-blend-multiply opacity-90"})}),R.jsx("p",{className:"text-stone-500 text-xs text-center uppercase tracking-widest max-w-[200px]",children:",    "})]})]}),R.jsx("div",{className:"bg-[#1e1b18] p-6 border-t border-stone-700 flex justify-center",children:R.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-8 py-3 rounded-lg bg-red-900/10 hover:bg-red-900/20 text-red-400/80 border border-red-900/20 transition-all font-bold uppercase text-xs tracking-wider hover:scale-105",children:[R.jsx("span",{children:""}),"  "]})})]})})},y2=({gameData:n,onJoin:e})=>{var i;const t=(i=n.metadata)==null?void 0:i.isRandomColor,s=!!n.players.white?Q.BLACK:Q.WHITE;return R.jsx("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center p-4",children:R.jsxs("div",{className:"w-full max-w-lg bg-[#2a2622] rounded-xl shadow-2xl border border-stone-700 overflow-hidden animate-fade-in",children:[R.jsxs("div",{className:"bg-[#3d3632] p-5 border-b border-stone-600 flex justify-between items-center",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)] animate-pulse"}),R.jsx("span",{className:"text-[#e3c193] font-bold text-sm uppercase tracking-wider",children:"  "})]}),R.jsx("div",{className:"text-stone-500 text-xs font-bold uppercase",children:" "})]}),R.jsxs("div",{className:"p-8 lg:p-10 flex flex-col items-center gap-8",children:[R.jsxs("div",{className:"text-center space-y-2",children:[R.jsx("h2",{className:"text-stone-300 text-2xl lg:text-3xl font-bold",children:""}),R.jsx("p",{className:"text-stone-500 text-sm font-medium uppercase tracking-widest",children:"  "})]}),R.jsxs("div",{className:"w-full bg-[#1e1b18] border border-stone-700/50 rounded-xl flex items-center p-5 gap-5 shadow-inner",children:[t?R.jsx("div",{className:"w-16 h-16 rounded-full flex-shrink-0 flex items-center justify-center shadow-lg border-2 border-stone-600 bg-gradient-to-br from-[#f0e4cc] to-[#383838]",children:R.jsx("span",{className:"text-2xl font-black text-stone-400 mix-blend-difference",children:"?"})}):R.jsx("div",{className:`w-16 h-16 rounded-full flex-shrink-0 flex items-center justify-center shadow-lg border-2 ${s===Q.WHITE?"bg-[#f0e4cc] border-[#e6dcc0]":"bg-[#1e1e1e] border-[#555]"}`,children:R.jsx("div",{className:`w-12 h-12 rounded-full border-4 opacity-30 ${s===Q.WHITE?"border-[#a18e6e]":"border-[#888]"}`})}),R.jsxs("div",{className:"flex-1 space-y-1",children:[R.jsx("div",{className:"text-[#e3c193] font-bold text-xl",children:t?" ":s===Q.WHITE?"  ":"  "}),R.jsxs("div",{className:"text-stone-500 text-sm flex flex-col gap-1",children:[R.jsx("span",{children:t?"   ":"  "}),R.jsx("div",{className:"flex items-center gap-2 mt-1",children:R.jsx("span",{className:"text-xs font-bold bg-stone-800 px-2 py-0.5 rounded border border-stone-700",children:"  "})})]})]})]})]}),R.jsx("div",{className:"p-6 bg-[#1e1b18] flex justify-center border-t border-stone-700",children:R.jsx("button",{onClick:e,className:"w-full py-4 bg-gradient-to-r from-amber-700 to-orange-800 hover:from-amber-600 hover:to-orange-700 active:scale-[0.98] transition-all text-white font-bold text-lg rounded-xl shadow-lg border border-amber-600/30 uppercase tracking-wider",children:"  "})})]})})},_2=()=>{var et,it;const[n,e]=H.useState(null),[t,r]=H.useState(null),[s,i]=H.useState(!1),[o,a]=H.useState(!1),[u,c]=H.useState(!1),[d,f]=H.useState(ki()),[m,_]=H.useState("WHITE_PAWN"),[A,C]=H.useState(null),V=H.useRef(null),[I,v]=H.useState(null),[w]=H.useState(()=>yk().id),[D,F]=H.useState(!1),[j,E]=H.useState(!1),[y,T]=H.useState(Q.WHITE),[x,P]=H.useState(!1),[b,S]=H.useState(!1),Ye=H.useRef(!1),se=W=>{try{window.history.pushState({},"",W)}catch(he){console.warn("URL update failed:",he)}};H.useEffect(()=>{const W=()=>{const ve=new URLSearchParams(window.location.search).get("game");ve!==n&&(ve?(e(ve),r(null),C(null),c(!1)):(e(null),r(null),C(null),i(!1),c(!1)))};return window.addEventListener("popstate",W),()=>window.removeEventListener("popstate",W)},[n]),H.useEffect(()=>{const he=new URLSearchParams(window.location.search).get("game");he&&!n&&e(he)},[]),H.useEffect(()=>{if(!n||n==="local_bot")return;const W=vk(n,he=>{Ye.current?he.version>((t==null?void 0:t.version)||0)&&(Ye.current=!1,r(he)):r(he)});return()=>W()},[n,t==null?void 0:t.version]);const te=async()=>{if(n){F(!0);try{await _k(n,w),a(!1),me.success("   !")}catch(W){W.message==="Game is full"?(a(!0),me(" .    .",{icon:""})):me.error(" ")}finally{F(!1)}}},X=(W,he,ve)=>({board:JSON.stringify(ve),turn:Q.WHITE,players:{white:W===Q.WHITE?w:null,black:W===Q.BLACK?w:null},status:ae.WAITING,winner:null,version:0,halfMoveClock:0,createdAt:Date.now(),expireAt:Date.now()+864e5,metadata:{isRandomColor:he},takebackRequest:null,previousState:null}),M=(W,he)=>{S(!1),E(!1),v(null),i(!1),a(!1),C(null),c(!1),r(he||null),e(W),se(`${window.location.pathname}?game=${W}`)},q=()=>{const W=u?d:ki(),he=24*60*60*1e3,ve={board:JSON.stringify(W),turn:Q.WHITE,players:{white:"local",black:"bot"},status:ae.ACTIVE,winner:null,version:0,halfMoveClock:0,createdAt:Date.now(),expireAt:Date.now()+he,takebackRequest:null,previousState:null};r(ve),i(!0),C(null),c(!1),e("local_bot"),S(!1),se(window.location.pathname)},Z=async()=>{F(!0);try{const W=y==="RANDOM",he=W?Math.random()<.5?Q.WHITE:Q.BLACK:y,ve=u?d:ki(),$e=await hT(w,he,W,ve),Nt=X(he,W,ve);M($e,Nt),me.success(" !")}catch(W){console.error(W),me.error("  .")}finally{F(!1)}},oe=async()=>{var W;if(!j)if(E(!0),t!=null&&t.rematchId)M(t.rematchId,void 0);else try{const he=!!((W=t==null?void 0:t.metadata)!=null&&W.isRandomColor);S(!0);const ve=await xk(n,w,Ct,he);t==null||t.rematchId}catch(he){console.error(he),me.error("   "),E(!1),S(!1)}},ie=()=>{se(window.location.pathname),e(null),r(null),C(null),V.current&&clearTimeout(V.current),i(!1),a(!1),S(!1),E(!1),c(!1)},ne=async()=>{if(!x){if(s&&t){A&&(V.current&&clearTimeout(V.current),r(A),C(null),me.success(" "));return}if(n){P(!0);try{await Ek(n,w),me.success("    ")}catch{me.error("  "),P(!1)}}}},ce=async W=>{if(!(!n||s))try{await Ik(n,W)}catch{me.error("")}},Ue=W=>{if((W.row+W.col)%2===0)return;const he=d.map(ve=>[...ve]);if(m==="ERASER")he[W.row][W.col]=null;else{const ve=m.startsWith("WHITE"),$e=m.endsWith("KING");he[W.row][W.col]={color:ve?Q.WHITE:Q.BLACK,isKing:$e}}f(he)},At=()=>{const W=Array(8).fill(null).map(()=>Array(8).fill(null));f(W)},Rt=()=>{f(ki())},Pt=H.useMemo(()=>{if(u)return d;if(!t||!t.board)return[];try{return JSON.parse(t.board)}catch{return[]}},[t,u,d]),Ct=H.useMemo(()=>u?Q.WHITE:t?s||t.players.white===w?Q.WHITE:t.players.black===w?Q.BLACK:null:null,[t,w,s,u]),st=o||t&&Ct===null&&!s,bt=(t==null?void 0:t.status)===ae.ACTIVE&&(t==null?void 0:t.turn)===Ct&&!st,_n=Ct===Q.BLACK,kt=H.useMemo(()=>u?[]:!t||!Ct||Pt.length===0||st?[]:t.status!==ae.ACTIVE?[]:Bs(Pt,t.turn),[Pt,t==null?void 0:t.turn,t==null?void 0:t.status,Ct,st,u]),ds=H.useMemo(()=>kt.length===0?0:Math.max(...kt.map(W=>W.captures.length)),[kt]);H.useEffect(()=>{if(!u&&!(!s||!t||t.status!==ae.ACTIVE)&&t.turn!==Q.WHITE)return V.current&&clearTimeout(V.current),V.current=window.setTimeout(()=>{const W=Rk(Pt,Q.BLACK);if(!W){r(Zt=>Zt?{...Zt,status:ae.FINISHED,winner:Q.WHITE}:null),me.success(" !");return}const he=rs(Pt,W),ve=Bs(he,Q.WHITE);let $e=null,Nt=ae.ACTIVE;ve.length===0&&(Nt=ae.FINISHED,$e=Q.BLACK,me.error(" !"));let ms=0,qn=0,Pn=0,gs=0;for(let Zt=0;Zt<8;Zt++)for(let Kn=0;Kn<8;Kn++){const Cn=he[Zt][Kn];Cn&&(Cn.color===Q.WHITE?(ms++,Cn.isKing&&Pn++):(qn++,Cn.isKing&&gs++))}ms===1&&Pn===1&&qn===1&&gs===1&&(Nt=ae.DRAW,me("! (  )",{icon:""}));const gi={...t,board:JSON.stringify(he),turn:Q.WHITE,version:t.version+1,lastMove:{from:W.from,to:W.to,path:W.path,ts:Date.now()},halfMoveClock:0,status:Nt,winner:$e};r(gi)},600),()=>{V.current&&clearTimeout(V.current)}},[t,s,Pt,u]);const mr=async(W,he)=>{if(u||!t||!bt)return;const ve=kt.find($e=>$e.from.row===W.row&&$e.from.col===W.col&&$e.to.row===he.row&&$e.to.col===he.col);if(ve){const $e=t.turn===Q.WHITE?Q.BLACK:Q.WHITE,Nt=rs(Pt,ve),ms=t.version+1;Ye.current=!0;const qn={...t};s&&C(qn);const Pn={...t,board:JSON.stringify(Nt),turn:$e,lastMove:{from:ve.from,to:ve.to,path:ve.path,ts:Date.now()},version:ms,takebackRequest:null};if(r(Pn),v(null),s){Ye.current=!1,Bs(Nt,Q.BLACK).length===0&&(r({...Pn,status:ae.FINISHED,winner:Q.WHITE}),me.success(" !"));let gi=0,Zt=0,Kn=0,Cn=0;for(let Gn=0;Gn<8;Gn++)for(let ys=0;ys<8;ys++){const gr=Nt[Gn][ys];gr&&(gr.color===Q.WHITE?(gi++,gr.isKing&&Kn++):(Zt++,gr.isKing&&Cn++))}gi===1&&Kn===1&&Zt===1&&Cn===1&&(r({...Pn,status:ae.DRAW}),me("! (  )",{icon:""}));return}try{await wk(n,qn,ve,$e)}catch(gs){console.error(gs),me.error(" ."),Ye.current=!1,r(qn)}}else v(null)},fs=async W=>{if(u){Ue(W);return}if(I){if(I.row===W.row&&I.col===W.col){v(null);return}if(kt.find($e=>$e.from.row===I.row&&$e.from.col===I.col&&$e.to.row===W.row&&$e.to.col===W.col)){await mr(I,W);return}}kt.filter(ve=>ve.from.row===W.row&&ve.from.col===W.col).length>0?v(W):v(null)};if(!n&&!u)return R.jsxs("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center p-4",children:[R.jsxs("div",{className:"max-w-xl w-full bg-[#2a2622] p-6 lg:p-8 rounded-3xl shadow-2xl border border-stone-700 space-y-6 lg:space-y-8 animate-fade-in",children:[R.jsxs("div",{className:"text-center",children:[R.jsx("h1",{className:"text-5xl lg:text-6xl font-black text-[#e3c193] tracking-widest uppercase drop-shadow-lg mb-2",children:""}),R.jsx("p",{className:"text-stone-500 tracking-wider text-sm uppercase",children:" "})]}),R.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[R.jsxs("button",{onClick:q,className:"w-full py-4 lg:py-5 rounded-2xl bg-stone-700 hover:bg-stone-600 active:scale-95 border border-stone-500 transition-all shadow-xl group flex items-center justify-center gap-3",children:[R.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""}),R.jsx("span",{className:"text-white font-bold text-lg",children:"  "})]}),R.jsxs("div",{className:"relative flex items-center justify-center",children:[R.jsx("div",{className:"absolute w-full border-t border-stone-600"}),R.jsx("span",{className:"relative bg-[#2a2622] px-4 text-stone-500 text-xs font-bold uppercase tracking-wider",children:"  "})]}),R.jsxs("div",{className:"grid grid-cols-3 gap-3 lg:gap-4",children:[R.jsxs("button",{onClick:()=>T(Q.WHITE),className:`relative overflow-hidden h-24 lg:h-32 rounded-2xl border-2 transition-all duration-200 group ${y===Q.WHITE?"border-[#e3c193] ring-2 ring-[#e3c193]/30 scale-105":"border-stone-700 bg-stone-800/50 hover:border-stone-500"}`,children:[R.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#f8f8f8] to-[#d0d0d0] opacity-90"}),R.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 z-10",children:[R.jsx("div",{className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full bg-white shadow-lg border-2 border-gray-200"}),R.jsx("span",{className:"font-bold text-black text-xs lg:text-sm",children:""})]})]}),R.jsxs("button",{onClick:()=>T("RANDOM"),className:`relative overflow-hidden h-24 lg:h-32 rounded-2xl border-2 transition-all duration-200 group ${y==="RANDOM"?"border-purple-500 ring-2 ring-purple-500/30 scale-105":"border-stone-700 bg-stone-800/50 hover:border-stone-500"}`,children:[R.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900 to-indigo-900 opacity-90"}),R.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 z-10",children:[R.jsx("span",{className:"text-xl lg:text-2xl",children:""}),R.jsx("span",{className:"font-bold text-white text-xs lg:text-sm",children:""})]})]}),R.jsxs("button",{onClick:()=>T(Q.BLACK),className:`relative overflow-hidden h-24 lg:h-32 rounded-2xl border-2 transition-all duration-200 group ${y===Q.BLACK?"border-gray-500 ring-2 ring-gray-500/30 scale-105":"border-stone-700 bg-stone-800/50 hover:border-stone-500"}`,children:[R.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#303030] to-[#101010] opacity-90"}),R.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 z-10",children:[R.jsx("div",{className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full bg-black shadow-lg border-2 border-gray-700"}),R.jsx("span",{className:"font-bold text-white text-xs lg:text-sm",children:""})]})]})]}),R.jsx("button",{onClick:Z,disabled:D,className:`w-full py-4 lg:py-5 font-bold rounded-2xl text-lg lg:text-xl transition-all shadow-xl ${D?"bg-stone-700 cursor-not-allowed text-stone-500":"bg-gradient-to-r from-amber-600 to-orange-700 text-white hover:brightness-110 active:scale-95"}`,children:D?"...":" "}),R.jsx("button",{onClick:()=>{c(!0),f(ki())},className:"w-full py-3 bg-[#3d3632] hover:bg-[#4a423d] text-stone-300 font-bold uppercase tracking-wider text-xs rounded-xl border border-stone-600 transition-colors",children:"  "})]})]}),R.jsx(du,{})]});if(n&&!t)return R.jsx("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center",children:R.jsxs("div",{className:"flex flex-col items-center gap-4 animate-pulse",children:[R.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-stone-700 border-t-amber-600 animate-spin"}),R.jsx("span",{className:"text-stone-500 text-xs uppercase tracking-widest",children:"..."})]})});const di=(t==null?void 0:t.players.white)===w||(t==null?void 0:t.players.black)===w;if((t==null?void 0:t.status)===ae.WAITING&&!di&&!s)return R.jsxs(R.Fragment,{children:[R.jsx(y2,{gameData:t,onJoin:te}),D&&R.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:R.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-white border-t-transparent rounded-full"})}),R.jsx(du,{position:"top-center"})]});if((t==null?void 0:t.status)===ae.WAITING&&!s&&di)return R.jsxs("div",{className:"min-h-[100dvh] bg-[#1e1b18] flex items-center justify-center",children:[R.jsx(g2,{gameId:n,gameData:t,playerId:w,onCancel:ie}),R.jsx(du,{position:"top-center",toastOptions:{style:{background:"#2a2622",color:"#e3c193",border:"1px solid #444"}}})]});const fi={[ae.WAITING]:"...",[ae.ACTIVE]:s?"  ":"",[ae.FINISHED]:"",[ae.DRAW]:""},ps=bt?" ":(t==null?void 0:t.turn)===Q.WHITE?" ":" ",zt=st?"":s?"":Ct===Q.WHITE?"":"",vn=!!((et=t==null?void 0:t.takebackRequest)!=null&&et.requesterId)&&t.takebackRequest.requesterId!==w,zn=((it=t==null?void 0:t.takebackRequest)==null?void 0:it.requesterId)===w;(zn&&x||!zn&&x&&!s)&&P(!1);const Vo=s?(t==null?void 0:t.status)===ae.ACTIVE&&!!A:!zn&&!vn&&(t==null?void 0:t.status)===ae.ACTIVE&&!!(t!=null&&t.previousState),pi=!!(t!=null&&t.rematchId)&&!b,mi=!!(t!=null&&t.rematchId)&&b;return R.jsxs("div",{className:"h-[100dvh] w-screen bg-[#1e1b18] overflow-hidden relative pt-safe flex items-center justify-center",children:[R.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-center gap-0 lg:max-w-[1250px] lg:w-full",children:[!u&&R.jsxs("div",{className:"lg:hidden w-full flex justify-between items-center px-4 py-2 mb-2 bg-[#2a2622] border-y border-stone-700/50",children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("div",{className:`w-2 h-2 rounded-full ${(t==null?void 0:t.status)===ae.ACTIVE?"bg-green-500 animate-pulse":"bg-yellow-500"}`}),R.jsx("span",{className:"text-stone-400 text-xs font-bold uppercase",children:fi[(t==null?void 0:t.status)||ae.WAITING]})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"text-stone-500 text-xs",children:":"}),R.jsx("span",{className:"text-[#e3c193] font-bold text-sm",children:zt})]})]}),R.jsx("div",{className:"flex items-center justify-center relative z-10",children:R.jsx("div",{className:"relative aspect-square w-[min(98vw,80vh)] h-[min(98vw,80vh)] lg:w-[min(85vh,85vh)] lg:h-[min(85vh,85vh)] max-w-[900px] max-h-[900px] shadow-2xl",children:(t||u)&&Pt.length>0?R.jsxs(R.Fragment,{children:[R.jsx(Pk,{board:Pt,validMoves:kt,selectedPos:I,onSquareClick:fs,onMovePiece:mr,lastMove:t==null?void 0:t.lastMove,rotated:_n}),!u&&ds>0&&bt&&!I&&R.jsx("div",{className:"absolute -top-8 lg:-top-12 left-0 w-full text-center pointer-events-none z-20",children:R.jsx("span",{className:"bg-amber-600/95 text-white px-3 py-1 lg:px-4 lg:py-1 rounded-full text-xs lg:text-sm font-bold shadow-lg animate-bounce inline-block border border-amber-400/30",children:"  "})})]}):R.jsx("div",{className:"w-full h-full bg-[#3e2723] rounded-md border-[16px] border-[#3e2723] shadow-[0_20px_50px_rgba(0,0,0,0.7)] flex items-center justify-center",children:R.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-stone-700 border-t-amber-600 animate-spin"})})})}),R.jsx("div",{className:"w-full lg:w-[420px] flex flex-col gap-2 lg:gap-6 z-20 shrink-0 mt-4 lg:mt-0 lg:h-[min(85vh,85vh)] bg-[#1e1b18] lg:bg-transparent lg:pl-0",children:R.jsx("div",{className:"flex flex-col h-full gap-4 lg:bg-[#1e1b18] lg:border-l lg:border-[#3d3632] lg:pl-6 lg:justify-center",children:u?R.jsxs("div",{className:"bg-[#2a2622] p-4 lg:p-6 rounded-3xl shadow-xl border border-stone-700 space-y-4",children:[R.jsxs("div",{className:"flex justify-between items-center mb-2",children:[R.jsx("h2",{className:"text-[#e3c193] font-bold text-lg uppercase tracking-wider",children:""}),R.jsx("button",{onClick:ie,className:"text-stone-500 hover:text-stone-300 text-xs uppercase font-bold",children:""})]}),R.jsx("div",{className:"grid grid-cols-5 gap-2",children:[{id:"WHITE_PAWN",label:""},{id:"WHITE_KING",label:""},{id:"BLACK_PAWN",label:""},{id:"BLACK_KING",label:""},{id:"ERASER",label:""}].map(W=>R.jsx("button",{onClick:()=>_(W.id),className:`aspect-square rounded-lg flex items-center justify-center text-2xl border-2 transition-all ${m===W.id?"bg-amber-700 border-amber-500 text-white scale-110 shadow-lg":"bg-stone-800 border-stone-600 text-stone-400 hover:bg-stone-700"}`,children:W.label},W.id))}),R.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[R.jsx("button",{onClick:At,className:"py-2 text-xs font-bold uppercase text-stone-400 bg-stone-800 hover:bg-stone-700 rounded-lg",children:""}),R.jsx("button",{onClick:Rt,className:"py-2 text-xs font-bold uppercase text-stone-400 bg-stone-800 hover:bg-stone-700 rounded-lg",children:""})]}),R.jsxs("div",{className:"pt-4 border-t border-stone-700 space-y-2",children:[R.jsx("button",{onClick:q,className:"w-full py-3 bg-gradient-to-r from-blue-700 to-blue-900 text-white font-bold rounded-xl shadow-lg border border-blue-500/30",children:"  "}),R.jsx("button",{onClick:Z,className:"w-full py-3 bg-gradient-to-r from-amber-700 to-orange-800 text-white font-bold rounded-xl shadow-lg border border-amber-500/30",children:"  ()"})]})]}):R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"hidden lg:block bg-[#2a2622] p-6 rounded-3xl shadow-xl border border-stone-700 min-h-[140px]",children:t?R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"flex justify-between items-center mb-4",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("div",{className:`w-3 h-3 rounded-full ${(t==null?void 0:t.status)===ae.ACTIVE?"bg-green-500 animate-pulse":"bg-yellow-500"}`}),R.jsx("span",{className:"text-stone-300 font-bold text-sm uppercase tracking-wider",children:fi[(t==null?void 0:t.status)||ae.WAITING]})]}),!s&&R.jsxs("span",{className:"font-mono text-xs text-stone-500 border border-stone-800 bg-[#1e1b18] px-2 py-1 rounded select-all",children:["#",n]})]}),R.jsx("div",{className:"flex items-center justify-between",children:R.jsxs("div",{children:[R.jsx("p",{className:"text-xs font-bold text-stone-500 uppercase tracking-widest mb-2",children:"  "}),R.jsxs("div",{className:"flex items-center gap-3",children:[st?R.jsx("span",{className:"text-3xl",children:""}):R.jsx("div",{className:`w-8 h-8 rounded-full border-2 shadow-sm ${Ct===Q.WHITE?"bg-[#f2e8d5] border-[#e6e0d0]":"bg-black border-gray-600"}`}),R.jsx("span",{className:"font-black text-3xl text-[#e3c193]",children:zt})]})]})})]}):R.jsx("div",{className:"h-full flex items-center justify-center",children:R.jsx("span",{className:"text-stone-600 text-xs animate-pulse",children:"..."})})}),vn&&R.jsxs("div",{className:"mx-4 lg:mx-0 p-4 rounded-xl bg-[#2a2622] border border-stone-600 shadow-xl animate-fade-in flex flex-col gap-3",children:[R.jsxs("div",{className:"flex items-center gap-2 text-stone-300",children:[R.jsx("span",{className:"text-xl",children:""}),R.jsx("span",{className:"text-sm font-bold",children:"   "})]}),R.jsxs("div",{className:"flex gap-2",children:[R.jsx("button",{onClick:()=>ce(!0),className:"flex-1 py-3 bg-green-800/50 hover:bg-green-700 text-green-200 border border-green-700 rounded-lg font-bold text-sm uppercase tracking-wider transition",children:" "}),R.jsx("button",{onClick:()=>ce(!1),className:"flex-1 py-3 bg-red-900/40 hover:bg-red-900/60 text-red-300 border border-red-800 rounded-lg font-bold text-sm uppercase tracking-wider transition",children:" "})]})]}),zn&&R.jsxs("div",{className:"mx-4 lg:mx-0 p-3 rounded-xl bg-[#2a2622] border border-stone-700 shadow-xl flex items-center justify-center gap-2",children:[R.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-stone-500 border-t-amber-600 animate-spin"}),R.jsx("span",{className:"text-stone-400 text-sm font-bold",children:"  ..."})]}),!vn&&!zn&&((t==null?void 0:t.status)===ae.ACTIVE||(t==null?void 0:t.status)===ae.FINISHED||(t==null?void 0:t.status)===ae.DRAW)&&R.jsxs("div",{className:`mx-4 lg:mx-0 p-3 lg:p-6 rounded-xl lg:rounded-2xl border-2 transition-all duration-300 shadow-lg ${bt?"bg-gradient-to-br from-green-900/90 to-green-800/90 border-green-500/50":"bg-[#2a2622] border-stone-700"}`,children:[R.jsx("h3",{className:"text-lg lg:text-2xl font-black text-center text-white tracking-widest uppercase leading-tight",children:t.status===ae.FINISHED?R.jsxs("span",{className:"text-yellow-400",children:[" ",t.winner===Q.WHITE?" ":" "]}):t.status===ae.DRAW?R.jsx("span",{className:"text-stone-400",children:" "}):ps}),t.status===ae.DRAW&&R.jsx("p",{className:"text-stone-500 text-center text-xs mt-1 uppercase font-bold",children:"50    1x1"})]}),R.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3 px-4 lg:px-0 mt-auto pb-4 lg:pb-0",children:[R.jsx("button",{onClick:ie,disabled:j,className:"py-3 px-2 bg-[#3d3632] hover:bg-[#4a423d] rounded-xl text-stone-300 font-bold text-xs uppercase tracking-wider transition shadow-lg border-2 border-stone-700/50",children:""}),(t==null?void 0:t.status)===ae.ACTIVE&&!t.winner&&!st&&R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:ne,disabled:!Vo||x,className:`py-3 px-2 bg-[#3d3632] hover:bg-[#4a423d] disabled:opacity-30 disabled:cursor-not-allowed rounded-xl text-stone-300 border-2 border-stone-700/50 flex items-center justify-center transition shadow-lg group ${x?"animate-pulse":""}`,title:" ",children:x?R.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-stone-500 border-t-amber-600 animate-spin"}):R.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6 text-stone-400 group-hover:text-white transition-colors",children:[R.jsx("path",{d:"M3 10h10a5 5 0 0 1 5 5v2"}),R.jsx("path",{d:"M3 10l6-6"}),R.jsx("path",{d:"M3 10l6 6"})]})}),R.jsx("button",{onClick:()=>{s?r(W=>W?{...W,status:ae.FINISHED,winner:Q.BLACK}:null):Tk(n,w)},className:"py-3 px-2 bg-red-900/30 hover:bg-red-900/50 border-2 border-red-900/30 rounded-xl text-red-200 font-bold text-xs uppercase tracking-wider transition shadow-lg",children:""})]}),((t==null?void 0:t.status)===ae.FINISHED||(t==null?void 0:t.status)===ae.DRAW)&&!st&&!s&&R.jsx("button",{onClick:oe,disabled:mi||j,className:`col-span-2 py-3 px-4 rounded-xl font-bold text-xs lg:text-sm uppercase tracking-wider transition-all shadow-lg border-2 
                            ${j?"bg-stone-800 border-stone-700 text-stone-500 cursor-wait":pi?"bg-green-700 hover:bg-green-600 text-white border-green-600/50 animate-pulse scale-105":mi?"bg-stone-700 text-stone-400 border-stone-600 cursor-default":"bg-amber-700 hover:bg-amber-600 text-white border-amber-600/50"}`,children:j?t.rematchId?"...":"...":pi?"  !":mi?" ...":" "}),((t==null?void 0:t.status)===ae.FINISHED||(t==null?void 0:t.status)===ae.DRAW)&&s&&R.jsx("button",{onClick:q,className:"col-span-2 py-3 px-4 bg-amber-700 hover:bg-amber-600 rounded-xl text-white font-bold text-xs lg:text-sm uppercase tracking-wider transition shadow-lg border-2 border-amber-600/50",children:" "})]})]})})})]}),R.jsx(du,{position:"top-center",toastOptions:{style:{background:"#2a2622",color:"#e3c193",border:"1px solid #444"}}})]})},vT=document.getElementById("root");if(!vT)throw new Error("Could not find root element to mount to");const v2=od.createRoot(vT);v2.render(R.jsx(ix.StrictMode,{children:R.jsx(_2,{})}));
